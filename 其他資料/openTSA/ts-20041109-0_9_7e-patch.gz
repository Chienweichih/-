Index: openssl/Configure
diff -u openssl/Configure:1.1.1.9 openssl/Configure:1.1.1.9.2.1
--- openssl/Configure:1.1.1.9	Mon Nov  8 15:32:17 2004
+++ openssl/Configure	Mon Nov  8 16:30:56 2004
@@ -1140,6 +1140,7 @@
 		{
 		$cflags = "$shared_cflag $cflags";
 		}
+	$shared_mark = "\$(SHARED_LIBS)";
 	}
 
 if ($sys_id ne "")
Index: openssl/Makefile
diff -u openssl/Makefile:1.1.1.1 openssl/Makefile:1.1.1.1.2.1
--- openssl/Makefile:1.1.1.1	Mon Nov  8 15:32:17 2004
+++ openssl/Makefile	Mon Nov  8 16:30:56 2004
@@ -11,11 +11,11 @@
 SHLIB_VERSION_HISTORY=
 SHLIB_MAJOR=0
 SHLIB_MINOR=9.7
-SHLIB_EXT=
-PLATFORM=dist
+SHLIB_EXT=.so.$(SHLIB_MAJOR).$(SHLIB_MINOR)
+PLATFORM=linux-elf
 OPTIONS= no-krb5
-CONFIGURE_ARGS=dist
-SHLIB_TARGET=
+CONFIGURE_ARGS=linux-elf
+SHLIB_TARGET=linux-shared
 
 # HERE indicates where this Makefile lives.  This can be used to indicate
 # where sub-Makefiles are expected to be.  Currently has very limited usage,
@@ -59,20 +59,20 @@
 # equal 4.
 # PKCS1_CHECK - pkcs1 tests.
 
-CC= cc
+CC= gcc
 #CFLAG= -DL_ENDIAN -DTERMIO -O3 -fomit-frame-pointer -m486 -Wall -Wuninitialized -DSHA1_ASM -DMD5_ASM -DRMD160_ASM
-CFLAG= -DOPENSSL_NO_KRB5 -O
+CFLAG= -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -DOPENSSL_NO_KRB5 -DL_ENDIAN -DTERMIO -O3 -fomit-frame-pointer -m486 -Wall -DSHA1_ASM -DMD5_ASM -DRMD160_ASM
 DEPFLAG= 
 PEX_LIBS= 
-EX_LIBS= 
+EX_LIBS= -ldl
 EXE_EXT= 
 ARFLAGS= 
 AR=ar $(ARFLAGS) r
 RANLIB= /usr/bin/ranlib
-PERL= /usr/bin/perl
+PERL= /usr/local/bin/perl
 TAR= tar
 TARFLAGS= --no-recursion
-MAKEDEPPROG=makedepend
+MAKEDEPPROG= gcc
 
 # We let the C compiler driver to take care of .s files. This is done in
 # order to be excused from maintaining a separate set of architecture
@@ -83,7 +83,7 @@
 ASFLAG=$(CFLAG)
 
 # Set BN_ASM to bn_asm.o if you want to use the C version
-BN_ASM= bn_asm.o
+BN_ASM= asm/bn86-elf.o asm/co86-elf.o
 #BN_ASM= bn_asm.o
 #BN_ASM= asm/bn86-elf.o	# elf, linux-elf
 #BN_ASM= asm/bn86-sol.o # solaris
@@ -104,7 +104,7 @@
 # Set DES_ENC to des_enc.o if you want to use the C version
 #There are 4 x86 assember options.
 FIPS_DES_ENC= fips_des_enc.o
-DES_ENC= des_enc.o fcrypt_b.o
+DES_ENC= asm/dx86-elf.o asm/yx86-elf.o
 #DES_ENC= des_enc.o fcrypt_b.o          # C
 #DES_ENC= asm/dx86-elf.o asm/yx86-elf.o # elf
 #DES_ENC= asm/dx86-sol.o asm/yx86-sol.o # solaris
@@ -113,7 +113,7 @@
 
 # Set BF_ENC to bf_enc.o if you want to use the C version
 #There are 4 x86 assember options.
-BF_ENC= bf_enc.o
+BF_ENC= asm/bx86-elf.o
 #BF_ENC= bf_enc.o
 #BF_ENC= asm/bx86-elf.o # elf
 #BF_ENC= asm/bx86-sol.o # solaris
@@ -122,7 +122,7 @@
 
 # Set CAST_ENC to c_enc.o if you want to use the C version
 #There are 4 x86 assember options.
-CAST_ENC= c_enc.o
+CAST_ENC= asm/cx86-elf.o
 #CAST_ENC= c_enc.o
 #CAST_ENC= asm/cx86-elf.o # elf
 #CAST_ENC= asm/cx86-sol.o # solaris
@@ -131,7 +131,7 @@
 
 # Set RC4_ENC to rc4_enc.o if you want to use the C version
 #There are 4 x86 assember options.
-RC4_ENC= rc4_enc.o
+RC4_ENC= asm/rx86-elf.o
 #RC4_ENC= rc4_enc.o
 #RC4_ENC= asm/rx86-elf.o # elf
 #RC4_ENC= asm/rx86-sol.o # solaris
@@ -140,7 +140,7 @@
 
 # Set RC5_ENC to rc5_enc.o if you want to use the C version
 #There are 4 x86 assember options.
-RC5_ENC= rc5_enc.o
+RC5_ENC= asm/r586-elf.o
 #RC5_ENC= rc5_enc.o
 #RC5_ENC= asm/r586-elf.o # elf
 #RC5_ENC= asm/r586-sol.o # solaris
@@ -148,14 +148,14 @@
 #RC5_ENC= asm/r586bsdi.o # bsdi
 
 # Also need MD5_ASM defined
-MD5_ASM_OBJ= 
+MD5_ASM_OBJ= asm/mx86-elf.o
 #MD5_ASM_OBJ= asm/mx86-elf.o        # elf
 #MD5_ASM_OBJ= asm/mx86-sol.o        # solaris
 #MD5_ASM_OBJ= asm/mx86-out.o        # a.out, FreeBSD
 #MD5_ASM_OBJ= asm/mx86bsdi.o        # bsdi
 
 # Also need SHA1_ASM defined
-SHA1_ASM_OBJ= 
+SHA1_ASM_OBJ= asm/sx86-elf.o
 FIPS_SHA1_ASM_OBJ= 
 #SHA1_ASM_OBJ= asm/sx86-elf.o       # elf
 #SHA1_ASM_OBJ= asm/sx86-sol.o       # solaris
@@ -163,7 +163,7 @@
 #SHA1_ASM_OBJ= asm/sx86bsdi.o       # bsdi
 
 # Also need RMD160_ASM defined
-RMD160_ASM_OBJ= 
+RMD160_ASM_OBJ= asm/rm86-elf.o
 #RMD160_ASM_OBJ= asm/rm86-elf.o       # elf
 #RMD160_ASM_OBJ= asm/rm86-sol.o       # solaris
 #RMD160_ASM_OBJ= asm/rm86-out.o       # a.out, FreeBSD
@@ -186,7 +186,8 @@
 	des rc2 rc4 rc5 idea bf cast \
 	bn ec rsa dsa dh dso engine aes \
 	buffer bio stack lhash rand err \
-	evp asn1 pem x509 x509v3 conf txt_db pkcs7 pkcs12 comp ocsp ui krb5
+	evp asn1 pem x509 x509v3 conf txt_db pkcs7 pkcs12 comp ocsp ui krb5 \
+	ts
 
 FDIRS=	sha1 rand des aes dsa rsa dh
 
@@ -211,7 +212,7 @@
 SHARED_CRYPTO=libcrypto$(SHLIB_EXT)
 SHARED_SSL=libssl$(SHLIB_EXT)
 SHARED_LIBS=
-SHARED_LIBS_LINK_EXTS=
+SHARED_LIBS_LINK_EXTS=.so.$(SHLIB_MAJOR) .so
 SHARED_LDFLAGS=
 
 GENERAL=        Makefile
Index: openssl/Makefile.org
diff -u openssl/Makefile.org:1.1.1.9 openssl/Makefile.org:1.1.1.9.2.1
--- openssl/Makefile.org:1.1.1.9	Mon Nov  8 15:32:17 2004
+++ openssl/Makefile.org	Mon Nov  8 16:30:56 2004
@@ -184,7 +184,8 @@
 	des rc2 rc4 rc5 idea bf cast \
 	bn ec rsa dsa dh dso engine aes \
 	buffer bio stack lhash rand err \
-	evp asn1 pem x509 x509v3 conf txt_db pkcs7 pkcs12 comp ocsp ui krb5
+	evp asn1 pem x509 x509v3 conf txt_db pkcs7 pkcs12 comp ocsp ui krb5 \
+	ts
 
 FDIRS=	sha1 rand des aes dsa rsa dh
 
Index: openssl/apps/CA.pl
diff -u openssl/apps/CA.pl:1.1.1.5 openssl/apps/CA.pl:1.1.1.5.2.1
--- openssl/apps/CA.pl:1.1.1.5	Mon Nov  8 15:32:18 2004
+++ openssl/apps/CA.pl	Mon Nov  8 16:31:06 2004
@@ -1,4 +1,4 @@
-#!/usr/bin/perl
+#!/usr/local/bin/perl
 #
 # CA - wrapper around ca to make it easier to use ... basically ca requires
 #      some setup stuff to be done before you can use it and this makes
Index: openssl/apps/Makefile
diff -u openssl/apps/Makefile:1.1.1.1 openssl/apps/Makefile:1.1.1.1.2.2
--- openssl/apps/Makefile:1.1.1.1	Mon Nov  8 15:32:18 2004
+++ openssl/apps/Makefile	Tue Nov  9 21:24:35 2004
@@ -36,7 +36,7 @@
 
 PROGRAM= openssl
 
-SCRIPTS=CA.sh CA.pl der_chop
+SCRIPTS=CA.sh CA.pl der_chop tsget
 
 EXE= $(PROGRAM)$(EXE_EXT)
 
@@ -44,7 +44,7 @@
 	ca crl rsa rsautl dsa dsaparam \
 	x509 genrsa gendsa s_server s_client speed \
 	s_time version pkcs7 crl2pkcs7 sess_id ciphers nseq pkcs12 \
-	pkcs8 spkac smime rand engine ocsp prime
+	pkcs8 spkac smime rand engine ocsp prime ts
 
 PROGS= $(PROGRAM).c
 
@@ -60,14 +60,14 @@
 	rsa.o rsautl.o dsa.o dsaparam.o \
 	x509.o genrsa.o gendsa.o s_server.o s_client.o speed.o \
 	s_time.o $(A_OBJ) $(S_OBJ) $(RAND_OBJ) version.o sess_id.o \
-	ciphers.o nseq.o pkcs12.o pkcs8.o spkac.o smime.o rand.o engine.o ocsp.o prime.o
+	ciphers.o nseq.o pkcs12.o pkcs8.o spkac.o smime.o rand.o engine.o ocsp.o prime.o ts.o
 
 E_SRC=	verify.c asn1pars.c req.c dgst.c dh.c enc.c passwd.c gendh.c errstr.c ca.c \
 	pkcs7.c crl2p7.c crl.c \
 	rsa.c rsautl.c dsa.c dsaparam.c \
 	x509.c genrsa.c gendsa.c s_server.c s_client.c speed.c \
 	s_time.c $(A_SRC) $(S_SRC) $(RAND_SRC) version.c sess_id.c \
-	ciphers.c nseq.c pkcs12.c pkcs8.c spkac.c smime.c rand.c engine.c ocsp.c prime.c
+	ciphers.c nseq.c pkcs12.c pkcs8.c spkac.c smime.c rand.c engine.c ocsp.c prime.c ts.c
 
 SRC=$(E_SRC)
 
@@ -1098,6 +1098,30 @@
 spkac.o: ../include/openssl/symhacks.h ../include/openssl/txt_db.h
 spkac.o: ../include/openssl/ui.h ../include/openssl/ui_compat.h
 spkac.o: ../include/openssl/x509.h ../include/openssl/x509_vfy.h apps.h spkac.c
+ts.o: ../e_os.h ../include/openssl/aes.h ../include/openssl/asn1.h
+ts.o: ../include/openssl/bio.h ../include/openssl/blowfish.h
+ts.o: ../include/openssl/bn.h ../include/openssl/buffer.h
+ts.o: ../include/openssl/cast.h ../include/openssl/conf.h
+ts.o: ../include/openssl/crypto.h ../include/openssl/des.h
+ts.o: ../include/openssl/des_old.h ../include/openssl/dh.h
+ts.o: ../include/openssl/dsa.h ../include/openssl/e_os2.h
+ts.o: ../include/openssl/engine.h ../include/openssl/err.h
+ts.o: ../include/openssl/evp.h ../include/openssl/idea.h
+ts.o: ../include/openssl/lhash.h ../include/openssl/md2.h
+ts.o: ../include/openssl/md4.h ../include/openssl/md5.h
+ts.o: ../include/openssl/mdc2.h ../include/openssl/obj_mac.h
+ts.o: ../include/openssl/objects.h ../include/openssl/opensslconf.h
+ts.o: ../include/openssl/opensslv.h ../include/openssl/ossl_typ.h
+ts.o: ../include/openssl/pem.h ../include/openssl/pem2.h
+ts.o: ../include/openssl/pkcs7.h ../include/openssl/rand.h
+ts.o: ../include/openssl/rc2.h ../include/openssl/rc4.h
+ts.o: ../include/openssl/rc5.h ../include/openssl/ripemd.h
+ts.o: ../include/openssl/rsa.h ../include/openssl/safestack.h
+ts.o: ../include/openssl/sha.h ../include/openssl/stack.h
+ts.o: ../include/openssl/symhacks.h ../include/openssl/ts.h
+ts.o: ../include/openssl/txt_db.h ../include/openssl/ui.h
+ts.o: ../include/openssl/ui_compat.h ../include/openssl/x509.h
+ts.o: ../include/openssl/x509_vfy.h ../include/openssl/x509v3.h apps.h ts.c
 verify.o: ../e_os.h ../include/openssl/aes.h ../include/openssl/asn1.h
 verify.o: ../include/openssl/bio.h ../include/openssl/blowfish.h
 verify.o: ../include/openssl/bn.h ../include/openssl/buffer.h
Index: openssl/apps/der_chop
diff -u openssl/apps/der_chop:1.1.1.4 openssl/apps/der_chop:1.1.1.4.2.1
--- openssl/apps/der_chop:1.1.1.4	Mon Nov  8 15:32:18 2004
+++ openssl/apps/der_chop	Mon Nov  8 16:31:06 2004
@@ -1,4 +1,4 @@
-#!/usr/bin/perl
+#!/usr/local/bin/perl
 #
 # der_chop ... this is one total hack that Eric is really not proud of
 #              so don't look at it and don't ask for support
Index: openssl/apps/openssl.cnf
diff -u openssl/apps/openssl.cnf:1.1.1.4 openssl/apps/openssl.cnf:1.1.1.4.2.1
--- openssl/apps/openssl.cnf:1.1.1.4	Mon Nov  8 15:32:19 2004
+++ openssl/apps/openssl.cnf	Mon Nov  8 16:31:06 2004
@@ -21,12 +21,17 @@
 
 [ new_oids ]
 
-# We can add new OIDs in here for use by 'ca' and 'req'.
+# We can add new OIDs in here for use by 'ca', 'req' and 'ts'.
 # Add a simple OID like this:
 # testoid1=1.2.3.4
 # Or use config file substitution like this:
 # testoid2=${testoid1}.5.6
 
+# Policies used by the TSA examples.
+tsa_policy1 = 1.2.3.4.1
+tsa_policy2 = 1.2.3.4.5.6
+tsa_policy3 = 1.2.3.4.5.7
+
 ####################################################################
 [ ca ]
 default_ca	= CA_default		# The default ca section
@@ -207,6 +212,9 @@
 #nsCaPolicyUrl
 #nsSslServerName
 
+# This is required for TSA certificates.
+extendedKeyUsage = critical,timeStamping
+
 [ v3_req ]
 
 # Extensions to add to a certificate request
@@ -258,3 +266,33 @@
 
 # issuerAltName=issuer:copy
 authorityKeyIdentifier=keyid:always,issuer:always
+
+####################################################################
+[ tsa ]
+
+default_tsa = tsa_config1	# the default TSA section
+
+[ tsa_config1 ]
+
+# These are used by the TSA reply generation only.
+dir		= ./demoCA		# TSA root directory
+serial		= $dir/tsaserial	# The current serial number (mandatory)
+crypto_device	= builtin		# OpenSSL engine to use for signing
+signer_cert	= $dir/tsacert.pem 	# The TSA signing certificate
+					# (optional)
+certs		= $dir/cacert.pem	# Certificate chain to include in reply
+					# (optional)
+signer_key	= $dir/private/tsakey.pem # The TSA private key (optional)
+
+default_policy	= tsa_policy1		# Policy if request did not specify it
+					# (optional)
+other_policies	= tsa_policy2, tsa_policy3	# acceptable policies (optional)
+digests		= md5, sha1		# Acceptable message digests (mandatory)
+accuracy	= secs:1, millisecs:500, microsecs:100	# (optional)
+clock_precision_digits  = 0	# number of digits after dot. (optional)
+ordering		= yes	# Is ordering defined for timestamps?
+				# (optional, default: no)
+tsa_name		= yes	# Must the TSA name be included in the reply?
+				# (optional, default: no)
+ess_cert_id_chain	= no	# Must the ESS cert id chain be included?
+				# (optional, default: no)
Index: openssl/apps/progs.h
diff -u openssl/apps/progs.h:1.1.1.4 openssl/apps/progs.h:1.1.1.4.2.1
--- openssl/apps/progs.h:1.1.1.4	Mon Nov  8 15:32:19 2004
+++ openssl/apps/progs.h	Mon Nov  8 16:31:06 2004
@@ -40,6 +40,7 @@
 extern int engine_main(int argc,char *argv[]);
 #endif
 extern int ocsp_main(int argc,char *argv[]);
+extern int ts_main(int argc,char *argv[]);
 
 #define FUNC_TYPE_GENERAL	1
 #define FUNC_TYPE_MD		2
@@ -121,6 +122,7 @@
 	{FUNC_TYPE_GENERAL,"engine",engine_main},
 #endif
 	{FUNC_TYPE_GENERAL,"ocsp",ocsp_main},
+	{FUNC_TYPE_GENERAL,"ts",ts_main},
 #ifndef OPENSSL_NO_MD2
 	{FUNC_TYPE_MD,"md2",dgst_main},
 #endif
Index: openssl/apps/ts.c
diff -u /dev/null openssl/apps/ts.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:43:51 2004
+++ openssl/apps/ts.c	Mon Nov  8 16:31:06 2004
@@ -0,0 +1,1143 @@
+/* apps/ts.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include "apps.h"
+#include <openssl/bio.h>
+#include <openssl/err.h>
+#include <openssl/pem.h>
+#include <openssl/rand.h>
+#include <openssl/ts.h>
+
+#undef PROG
+#define PROG	ts_main
+
+/* Length of the nonce of the request in bits (must be a multiple of 8). */
+#define	NONCE_LENGTH		64
+
+/* Macro definitions for the configuration file. */
+#define	ENV_OID_FILE		"oid_file"
+
+/* Local function declarations. */
+
+static ASN1_OBJECT *txt2obj(const char *oid);
+static CONF *load_config_file(const char *configfile);
+
+/* Query related functions. */
+static int query_command(const char *data, char *digest,
+			 const EVP_MD *md, const char *policy, int no_nonce, 
+			 int cert, const char *in, const char *out, int text);
+static BIO *BIO_open_with_default(const char *file, const char *mode, 
+				  FILE *default_fp);
+static TS_REQ *create_query(BIO *data_bio, char *digest, const EVP_MD *md,
+			    const char *policy, int no_nonce, int cert);
+static int create_digest(BIO *input, char *digest,
+			 const EVP_MD *md, unsigned char **md_value);
+static ASN1_INTEGER *create_nonce(int bits);
+
+/* Reply related functions. */
+static int reply_command(CONF *conf, char *section, char *engine, 
+			 char *queryfile, char *passin, char *inkey, 
+			 char *signer, char *chain, const char *policy, 
+			 char *in, int token_in, char *out, int token_out,
+			 int text);
+static TS_RESP *read_PKCS7(BIO *in_bio);
+static TS_RESP *create_response(CONF *conf, char *section, char *engine,
+				char *queryfile, char *passin, char *inkey,
+				char *signer, char *chain, const char *policy);
+static ASN1_INTEGER * MS_CALLBACK serial_cb(TS_RESP_CTX *ctx, void *data);
+static ASN1_INTEGER *next_serial(const char *serialfile);
+static int save_ts_serial(const char *serialfile, ASN1_INTEGER *serial);
+
+/* Verify related functions. */
+static int verify_command(char *data, char *digest, char *queryfile,
+			  char *in, int token_in,
+			  char *ca_path, char *ca_file, char *untrusted);
+static TS_VERIFY_CTX *create_verify_ctx(char *data, char *digest, 
+					char *queryfile, 
+					char *ca_path, char *ca_file,
+					char *untrusted);
+static X509_STORE *create_cert_store(char *ca_path, char *ca_file);
+static int MS_CALLBACK verify_cb(int ok, X509_STORE_CTX *ctx);
+
+/* Main function definition. */
+
+int MAIN(int argc, char **argv)
+	{
+	int ret = 1;
+	char *configfile = NULL;
+	char *section = NULL;
+	CONF *conf = NULL;
+	enum mode {
+	CMD_NONE, CMD_QUERY, CMD_REPLY, CMD_VERIFY 
+	} mode = CMD_NONE;
+	char *data = NULL;
+	char *digest = NULL;
+	const EVP_MD *md = NULL;
+	char *rand = NULL;
+	char *policy = NULL;
+	int no_nonce = 0;
+	int cert = 0;
+	char *in = NULL;
+	char *out = NULL;
+	int text = 0;
+	char *queryfile = NULL;
+	char *passin = NULL;	/* Password source. */
+	char *password =NULL;	/* Password itself. */
+	char *inkey = NULL;
+	char *signer = NULL;
+	char *chain = NULL;
+	char *ca_path = NULL;
+	char *ca_file = NULL;
+	char *untrusted = NULL;
+	char *engine = NULL;
+	/* Input is ContentInfo instead of TimeStampResp. */
+	int token_in = 0;	
+	/* Output is ContentInfo instead of TimeStampResp. */
+	int token_out = 0;
+	int free_bio_err = 0;
+
+	ERR_load_crypto_strings();
+	apps_startup();
+
+	if (bio_err == NULL && (bio_err = BIO_new(BIO_s_file())) != NULL)
+		{
+		free_bio_err = 1;
+		BIO_set_fp(bio_err, stderr, BIO_NOCLOSE | BIO_FP_TEXT);
+		}
+
+	for (argc--, argv++; argc > 0; argc--, argv++)
+		{
+		if (strcmp(*argv, "-config") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			configfile = *++argv;
+			}
+		else if (strcmp(*argv, "-section") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			section = *++argv;
+			}
+		else if (strcmp(*argv, "-query") == 0)
+			{
+			if (mode != CMD_NONE) goto usage;
+			mode = CMD_QUERY;
+			}
+		else if (strcmp(*argv, "-data") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			data = *++argv;
+			}
+		else if (strcmp(*argv, "-digest") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			digest = *++argv;
+			}
+		else if (strcmp(*argv, "-md2") == 0
+			|| strcmp(*argv, "-md4") == 0
+			|| strcmp(*argv, "-md5") == 0
+			|| strcmp(*argv, "-sha") == 0
+			|| strcmp(*argv, "-sha1") == 0
+			|| strcmp(*argv, "-mdc2") == 0
+			|| strcmp(*argv, "-ripemd160") == 0)
+			{
+			md = EVP_get_digestbyname(*argv + 1);
+			}
+		else if (strcmp(*argv, "-rand") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			rand = *++argv;
+			}
+		else if (strcmp(*argv, "-policy") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			policy = *++argv;
+			}
+		else if (strcmp(*argv, "-no_nonce") == 0)
+			{
+			no_nonce = 1;
+			}
+		else if (strcmp(*argv, "-cert") == 0)
+			{
+			cert = 1;
+			}
+		else if (strcmp(*argv, "-in") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			in = *++argv;
+			}
+		else if (strcmp(*argv, "-token_in") == 0)
+			{
+			token_in = 1;
+			}
+		else if (strcmp(*argv, "-out") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			out = *++argv;
+			}
+		else if (strcmp(*argv, "-token_out") == 0)
+			{
+			token_out = 1;
+			}
+		else if (strcmp(*argv, "-text") == 0)
+			{
+			text = 1;
+			}
+		else if (strcmp(*argv, "-reply") == 0)
+			{
+			if (mode != CMD_NONE) goto usage;
+			mode = CMD_REPLY;
+			}
+		else if (strcmp(*argv, "-queryfile") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			queryfile = *++argv;
+			}
+		else if (strcmp(*argv, "-passin") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			passin = *++argv;
+			}
+		else if (strcmp(*argv, "-inkey") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			inkey = *++argv;
+			}
+		else if (strcmp(*argv, "-signer") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			signer = *++argv;
+			}
+		else if (strcmp(*argv, "-chain") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			chain = *++argv;
+			}
+		else if (strcmp(*argv, "-verify") == 0)
+			{
+			if (mode != CMD_NONE) goto usage;
+			mode = CMD_VERIFY;
+			}
+		else if (strcmp(*argv, "-CApath") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			ca_path = *++argv;
+			}
+		else if (strcmp(*argv, "-CAfile") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			ca_file = *++argv;
+			}
+		else if (strcmp(*argv, "-untrusted") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			untrusted = *++argv;
+			}
+		else if (strcmp(*argv, "-engine") == 0)
+			{
+			if (argc-- < 1) goto usage;
+			engine = *++argv;
+			}
+		else
+			goto usage;
+		}
+	
+	/* Seed the random number generator if it is going to be used. */
+	if (mode == CMD_QUERY && !no_nonce)
+		{
+		if (!app_RAND_load_file(NULL, bio_err, 1) && rand == NULL)
+			BIO_printf(bio_err, "warning, not much extra random "
+				   "data, consider using the -rand option\n");
+		if (rand != NULL)
+			BIO_printf(bio_err,"%ld semi-random bytes loaded\n",
+				   app_RAND_load_files(rand));
+		}
+
+	/* Get the password if required. */
+	if(mode == CMD_REPLY && passin &&
+	   !app_passwd(bio_err, passin, NULL, &password, NULL))
+		{
+		BIO_printf(bio_err,"Error getting password.\n");
+		goto cleanup;
+		}
+
+	/* Check consistency of parameters and execute 
+	   the appropriate function. */
+	switch (mode)
+		{
+	case CMD_NONE:
+		goto usage;
+	case CMD_QUERY:
+		/* Data file and message imprint cannot be specified
+		   at the same time. */
+		ret = data != NULL && digest != NULL;
+		if (ret) goto usage;
+		/* Load the config file for possible policy OIDs. */
+		conf = load_config_file(configfile);
+		ret = !query_command(data, digest, md, policy, no_nonce, cert,
+				     in, out, text);
+		break;
+	case CMD_REPLY:
+		conf = load_config_file(configfile);
+		if (in == NULL)
+			{
+			ret = !(queryfile != NULL && conf != NULL && !token_in);
+			if (ret) goto usage;
+			}
+		else
+			{
+			/* 'in' and 'queryfile' are exclusive. */
+			ret = !(queryfile == NULL);
+			if (ret) goto usage;
+			}
+
+		ret = !reply_command(conf, section, engine, queryfile, 
+				     password, inkey, signer, chain, policy, 
+				     in, token_in, out, token_out, text);
+		break;
+	case CMD_VERIFY:
+		ret = !(((queryfile && !data && !digest)
+			 || (!queryfile && data && !digest)
+			 || (!queryfile && !data && digest))
+			&& in != NULL);
+		if (ret) goto usage;
+
+		ret = !verify_command(data, digest, queryfile, in, token_in,
+				      ca_path, ca_file, untrusted);
+		}
+
+	goto cleanup;
+
+ usage:
+	BIO_printf(bio_err, "usage:\n"
+		   "ts -query [-rand file%cfile%c...] [-config configfile] "
+		   "[-data file_to_hash] [-digest digest_bytes]"
+		   "[-md2|-md4|-md5|-sha|-sha1|-mdc2|-ripemd160] "
+		   "[-policy object_id] [-no_nonce] [-cert] "
+		   "[-in request.tsq] [-out request.tsq] [-text]\n",
+		   LIST_SEPARATOR_CHAR, LIST_SEPARATOR_CHAR);
+	BIO_printf(bio_err, "or\n"
+		   "ts -reply [-config configfile] [-section tsa_section] "
+		   "[-queryfile request.tsq] [-passin password] "
+		   "[-signer tsa_cert.pem] [-inkey private_key.pem] "
+		   "[-chain certs_file.pem] [-policy object_id] "
+		   "[-in response.tsr] [-token_in] "
+		   "[-out response.tsr] [-token_out] [-text] [-engine id]\n");
+	BIO_printf(bio_err, "or\n"
+		   "ts -verify [-data file_to_hash] [-digest digest_bytes] "
+		   "[-queryfile request.tsq] "
+		   "-in response.tsr [-token_in] "
+		   "-CApath ca_path -CAfile ca_file.pem "
+		   "-untrusted cert_file.pem\n");
+ cleanup:
+	/* Clean up. */
+	app_RAND_write_file(NULL, bio_err);
+	NCONF_free(conf);
+	OPENSSL_free(password);
+	OBJ_cleanup();
+	if (free_bio_err)
+		{
+		BIO_free_all(bio_err);
+		bio_err = NULL;
+		}
+
+	OPENSSL_EXIT(ret);
+	}
+
+/*
+ * Configuration file-related function definitions.
+ */
+
+static ASN1_OBJECT *txt2obj(const char *oid)
+	{
+	ASN1_OBJECT *oid_obj = NULL;
+
+	if (!(oid_obj = OBJ_txt2obj(oid, 0)))
+		BIO_printf(bio_err, "cannot convert %s to OID\n", oid);
+
+	return oid_obj;
+	}
+
+static CONF *load_config_file(const char *configfile)
+	{
+	CONF *conf = NULL;
+	long errorline = -1;
+
+	if (!configfile) configfile = getenv("OPENSSL_CONF");
+	if (!configfile) configfile = getenv("SSLEAY_CONF");
+
+	if (configfile &&
+	    (!(conf = NCONF_new(NULL)) ||
+	     NCONF_load(conf, configfile, &errorline) <= 0))
+		{
+		if (errorline <= 0)
+			BIO_printf(bio_err, "error loading the config file "
+				   "'%s'\n", configfile);
+		else
+			BIO_printf(bio_err, "error on line %ld of config file "
+				   "'%s'\n", errorline, configfile);
+		}
+
+	if (conf != NULL)
+		{
+		const char *p;
+
+		BIO_printf(bio_err,"Using configuration from %s\n", configfile);
+		p = NCONF_get_string(conf, NULL, ENV_OID_FILE);
+		if (p != NULL)
+			{
+			BIO *oid_bio = BIO_new_file(p, "r");
+			if (!oid_bio) 
+				ERR_print_errors(bio_err);
+			else
+				{
+				OBJ_create_objects(oid_bio);
+				BIO_free_all(oid_bio);
+				}
+			}
+		else
+			ERR_clear_error();
+		if(!add_oid_section(bio_err, conf)) 
+			ERR_print_errors(bio_err);
+		}
+	return conf;
+	}
+
+/*
+ * Query-related method definitions.
+ */
+
+static int query_command(const char *data, char *digest, const EVP_MD *md,
+			 const char *policy, int no_nonce, 
+			 int cert, const char *in, const char *out, int text)
+	{
+	int ret = 0;
+	TS_REQ *query = NULL;
+	BIO *in_bio = NULL;
+	BIO *data_bio = NULL;
+	BIO *out_bio = NULL;
+
+	/* Build query object either from file or from scratch. */
+	if (in != NULL)
+		{
+		if ((in_bio = BIO_new_file(in, "rb")) == NULL) goto end;
+		query = d2i_TS_REQ_bio(in_bio, NULL);
+		}
+	else
+		{
+		/* Open the file if no explicit digest bytes were specified. */
+		if (!digest 
+		    && !(data_bio = BIO_open_with_default(data, "rb", stdin)))
+			goto end;
+		/* Creating the query object. */
+		query = create_query(data_bio, digest, md,
+				     policy, no_nonce, cert);
+		/* Saving the random number generator state. */
+		}
+	if (query == NULL) goto end;
+
+	/* Write query either in ASN.1 or in text format. */
+	if ((out_bio = BIO_open_with_default(out, "wb", stdout)) == NULL)
+		goto end;
+	if (text)
+		{
+		/* Text output. */
+		if (!TS_REQ_print_bio(out_bio, query))
+			goto end;
+		}
+	else
+		{
+		/* ASN.1 output. */
+		if (!i2d_TS_REQ_bio(out_bio, query))
+			goto end;
+		}
+
+	ret = 1;
+
+ end:
+	ERR_print_errors(bio_err);
+
+	/* Clean up. */
+	BIO_free_all(in_bio);
+	BIO_free_all(data_bio);
+	BIO_free_all(out_bio);
+	TS_REQ_free(query);
+
+	return ret;
+	}
+
+static BIO *BIO_open_with_default(const char *file, const char *mode, 
+				  FILE *default_fp)
+	{
+	return file == NULL ? 
+		BIO_new_fp(default_fp, BIO_NOCLOSE) 
+		: BIO_new_file(file, mode);
+	}
+
+static TS_REQ *create_query(BIO *data_bio, char *digest, const EVP_MD *md,
+			    const char *policy, int no_nonce, int cert)
+	{
+	int ret = 0;
+	TS_REQ *ts_req = NULL;
+	int len;
+	TS_MSG_IMPRINT *msg_imprint = NULL;
+	X509_ALGOR *algo = NULL;
+	unsigned char *data = NULL;
+	ASN1_OBJECT *policy_obj = NULL;
+	ASN1_INTEGER *nonce_asn1 = NULL;
+
+	/* Setting default message digest. */
+	if (!md && !(md = EVP_get_digestbyname("sha1"))) goto err;
+
+	/* Creating request object. */
+	if (!(ts_req = TS_REQ_new())) goto err;
+
+	/* Setting version. */
+	if (!TS_REQ_set_version(ts_req, 1)) goto err;
+
+	/* Creating and adding MSG_IMPRINT object. */
+	if (!(msg_imprint = TS_MSG_IMPRINT_new())) goto err;
+
+	/* Adding algorithm. */
+	if (!(algo = X509_ALGOR_new())) goto err;
+	if (!(algo->algorithm = OBJ_nid2obj(EVP_MD_type(md)))) goto err;
+	if (!(algo->parameter = ASN1_TYPE_new())) goto err;
+	algo->parameter->type = V_ASN1_NULL;
+	if (!TS_MSG_IMPRINT_set_algo(msg_imprint, algo)) goto err;
+
+	/* Adding message digest. */
+	if ((len = create_digest(data_bio, digest, md, &data)) == 0)
+		goto err;
+	if (!TS_MSG_IMPRINT_set_msg(msg_imprint, data, len)) goto err;
+
+	if (!TS_REQ_set_msg_imprint(ts_req, msg_imprint)) goto err;
+	
+	/* Setting policy if requested. */
+	if (policy && !(policy_obj = txt2obj(policy))) goto err;
+	if (policy_obj && !TS_REQ_set_policy_id(ts_req, policy_obj)) goto err;
+
+	/* Setting nonce if requested. */
+	if (!no_nonce && !(nonce_asn1 = create_nonce(NONCE_LENGTH))) goto err;
+	if (nonce_asn1 && !TS_REQ_set_nonce(ts_req, nonce_asn1)) goto err;
+
+	/* Setting certificate request flag if requested. */
+	if (!TS_REQ_set_cert_req(ts_req, cert)) goto err;
+
+	ret = 1;
+ err:
+	if (!ret)
+		{
+		TS_REQ_free(ts_req);
+		ts_req = NULL;
+		BIO_printf(bio_err, "could not create query\n");
+		}
+	TS_MSG_IMPRINT_free(msg_imprint);
+	X509_ALGOR_free(algo);
+	OPENSSL_free(data);
+	ASN1_OBJECT_free(policy_obj);
+	ASN1_INTEGER_free(nonce_asn1);
+	return ts_req;
+	}
+
+static int create_digest(BIO *input, char *digest, const EVP_MD *md,
+			 unsigned char **md_value)
+	{
+	int md_value_len;
+
+	md_value_len = EVP_MD_size(md);
+	if (input)
+		{
+		/* Digest must be computed from an input file. */
+		EVP_MD_CTX md_ctx;
+		unsigned char buffer[4096];
+		int length;
+
+		*md_value = OPENSSL_malloc(md_value_len);
+		if (*md_value == 0) goto err;
+
+		EVP_DigestInit(&md_ctx, md);
+		while ((length = BIO_read(input, buffer, sizeof(buffer))) > 0)
+			{
+			EVP_DigestUpdate(&md_ctx, buffer, length);
+			}
+		EVP_DigestFinal(&md_ctx, *md_value, NULL);
+		}
+	else
+		{
+		/* Digest bytes are specified with digest. */
+		long digest_len;
+		*md_value = string_to_hex(digest, &digest_len);
+		if (!*md_value || md_value_len != digest_len)
+			{
+			OPENSSL_free(*md_value);
+			*md_value = NULL;
+			BIO_printf(bio_err, "bad digest, %d bytes "
+				   "must be specified\n", md_value_len);
+			goto err;
+			}
+		}
+
+	return md_value_len;
+ err:
+	return 0;
+	}
+
+static ASN1_INTEGER *create_nonce(int bits)
+	{
+	char buf[20];
+	ASN1_INTEGER *nonce = NULL;
+	int len = (bits - 1) / 8 + 1;
+	int i;
+
+	/* Generating random byte sequence. */
+	if (len > sizeof(buf)) goto err;
+	if (!RAND_bytes(buf, len)) goto err;
+
+	/* Find the first non-zero byte and creating ASN1_INTEGER object. */
+	for (i = 0; i < len && !buf[i]; ++i);
+	if (!(nonce = ASN1_INTEGER_new())) goto err;
+	OPENSSL_free(nonce->data);
+	/* Allocate at least one byte. */
+	nonce->length = len - i;
+	if (!(nonce->data = OPENSSL_malloc(nonce->length + 1))) goto err;
+	memcpy(nonce->data, buf + i, nonce->length);
+
+	return nonce;
+ err:
+	BIO_printf(bio_err, "could not create nonce\n");
+	ASN1_INTEGER_free(nonce);
+	return NULL;
+	}
+/*
+ * Reply-related method definitions.
+ */
+
+static int reply_command(CONF *conf, char *section, char *engine, 
+			 char *queryfile, char *passin, char *inkey,
+			 char *signer, char *chain, const char *policy, 
+			 char *in, int token_in,
+			 char *out, int token_out, int text)
+	{
+	int ret = 0;
+	TS_RESP *response = NULL;
+	BIO *in_bio = NULL;
+	BIO *query_bio = NULL;
+	BIO *inkey_bio = NULL;
+	BIO *signer_bio = NULL;
+	BIO *out_bio = NULL;
+
+	/* Build response object either from response or query. */
+	if (in != NULL)
+		{
+		if ((in_bio = BIO_new_file(in, "rb")) == NULL) goto end;
+		if (token_in)
+			{
+			/* We have a ContentInfo (PKCS7) object, add
+			   'granted' status info around it. */
+			response = read_PKCS7(in_bio);
+			}
+		else
+			{
+			/* We have a ready-made TS_RESP object. */
+			response = d2i_TS_RESP_bio(in_bio, NULL);
+			}
+		}
+	else
+		{
+		response = create_response(conf, section, engine, queryfile,
+					   passin, inkey, signer, chain,
+					   policy);
+		if (response)
+			BIO_printf(bio_err, "Response has been generated.\n");
+		else
+			BIO_printf(bio_err, "Response is not generated.\n");
+		}
+	if (response == NULL) goto end;
+
+	/* Write response either in ASN.1 or text format. */
+	if ((out_bio = BIO_open_with_default(out, "wb", stdout)) == NULL)
+		goto end;
+	if (text)
+		{
+		/* Text output. */
+		if (token_out)
+			{
+			TS_TST_INFO *tst_info = TS_RESP_get_tst_info(response);
+			if (!TS_TST_INFO_print_bio(out_bio, tst_info)) goto end;
+			}
+		else
+			{
+			if (!TS_RESP_print_bio(out_bio, response)) goto end;
+			}
+		}
+	else
+		{
+		/* ASN.1 DER output. */
+		if (token_out)
+			{
+			PKCS7 *token = TS_RESP_get_token(response);
+			if (!i2d_PKCS7_bio(out_bio, token)) goto end;
+			}
+		else
+			{
+			if (!i2d_TS_RESP_bio(out_bio, response)) goto end;
+			}
+		}
+
+	ret = 1;
+
+ end:
+	ERR_print_errors(bio_err);
+
+	/* Clean up. */
+	BIO_free_all(in_bio);
+	BIO_free_all(query_bio);
+	BIO_free_all(inkey_bio);
+	BIO_free_all(signer_bio);
+	BIO_free_all(out_bio);
+	TS_RESP_free(response);
+
+	return ret;
+	}
+
+/* Reads a PKCS7 token and adds default 'granted' status info to it. */
+static TS_RESP *read_PKCS7(BIO *in_bio)
+	{
+	int ret = 0;
+	PKCS7 *token = NULL;
+	TS_TST_INFO *tst_info = NULL;
+	TS_RESP *resp = NULL;
+	TS_STATUS_INFO *si = NULL;
+
+	/* Read PKCS7 object and extract the signed time stamp info. */
+	if (!(token = d2i_PKCS7_bio(in_bio, NULL))) goto end;
+	if (!(tst_info = PKCS7_to_TS_TST_INFO(token))) goto end;
+
+	/* Creating response object. */
+	if (!(resp = TS_RESP_new())) goto end;
+
+	/* Create granted status info. */
+	if (!(si = TS_STATUS_INFO_new())) goto end;
+	if (!(ASN1_INTEGER_set(si->status, TS_STATUS_GRANTED))) goto end;
+	if (!TS_RESP_set_status_info(resp, si)) goto end;
+
+	/* Setting encapsulated token. */
+	TS_RESP_set_tst_info(resp, token, tst_info);
+	token = NULL;		/* Ownership is lost. */
+	tst_info = NULL;	/* Ownership is lost. */
+
+	ret = 1;
+ end:
+	PKCS7_free(token);
+	TS_TST_INFO_free(tst_info);
+	if (!ret)
+		{
+		TS_RESP_free(resp);
+		resp = NULL;
+		}
+	TS_STATUS_INFO_free(si);
+	return resp;
+	}
+
+static TS_RESP *create_response(CONF *conf, char *section, char *engine, 
+				char *queryfile, char *passin, char *inkey,
+				char *signer, char *chain, const char *policy)
+	{
+	int ret = 0;
+	TS_RESP *response = NULL;
+	BIO *query_bio = NULL;
+	TS_RESP_CTX *resp_ctx = NULL;
+
+	if (!(query_bio = BIO_new_file(queryfile, "rb")))
+		goto end;
+
+	/* Getting TSA configuration section. */
+	if (!(section = (char *)TS_CONF_get_tsa_section(conf, section)))
+		goto end;
+
+	/* Setting up response generation context. */
+	if (!(resp_ctx = TS_RESP_CTX_new())) goto end;
+
+	/* Setting serial number provider callback. */
+	if (!TS_CONF_set_serial(conf, section, serial_cb, resp_ctx)) goto end;
+
+	/* Setting default OpenSSL engine. */
+	if (!TS_CONF_set_crypto_device(conf, section, engine)) goto end;
+
+	/* Setting TSA signer certificate. */
+	if (!TS_CONF_set_signer_cert(conf, section, signer, resp_ctx)) goto end;
+
+	/* Setting TSA signer certificate chain. */
+	if (!TS_CONF_set_certs(conf, section, chain, resp_ctx)) goto end;
+
+	/* Setting TSA signer private key. */
+	if (!TS_CONF_set_signer_key(conf, section, inkey, passin, resp_ctx))
+		goto end;
+
+	/* Setting default policy OID. */
+	if (!TS_CONF_set_def_policy(conf, section, policy, resp_ctx)) goto end;
+
+	/* Setting acceptable policy OIDs. */
+	if (!TS_CONF_set_policies(conf, section, resp_ctx)) goto end;
+
+	/* Setting the acceptable one-way hash algorithms. */
+	if (!TS_CONF_set_digests(conf, section, resp_ctx)) goto end;
+
+	/* Setting guaranteed time stamp accuracy. */
+	if (!TS_CONF_set_accuracy(conf, section, resp_ctx)) goto end;
+
+	/* Setting the precision of the time. */
+	if (!TS_CONF_set_clock_precision_digits(conf, section, resp_ctx))
+		goto end;
+
+	/* Setting the ordering flaf if requested. */
+	if (!TS_CONF_set_ordering(conf, section, resp_ctx)) goto end;
+
+	/* Setting the TSA name required flag if requested. */
+	if (!TS_CONF_set_tsa_name(conf, section, resp_ctx)) goto end;
+
+	/* Setting the ESS cert id chain flag if requested. */
+	if (!TS_CONF_set_ess_cert_id_chain(conf, section, resp_ctx)) goto end;
+
+	/* Creating the response. */
+	if (!(response = TS_RESP_create_response(resp_ctx, query_bio)))
+		goto end;
+
+	ret = 1;
+ end:
+	if (!ret) 
+		{
+		TS_RESP_free(response);
+		response = NULL;
+		}
+	TS_RESP_CTX_free(resp_ctx);
+	BIO_free_all(query_bio);
+
+	return response;
+	}
+
+static ASN1_INTEGER * MS_CALLBACK serial_cb(TS_RESP_CTX *ctx, void *data)
+	{
+	const char *serial_file = (const char *) data;
+	ASN1_INTEGER *serial = next_serial(serial_file);
+
+	if (!serial)
+		{
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Error during serial number "
+					    "generation.");
+		TS_RESP_CTX_add_failure_info(ctx,
+					     TS_INFO_ADD_INFO_NOT_AVAILABLE);
+		}
+	else
+		save_ts_serial(serial_file, serial);
+
+	return serial;
+	}
+
+static ASN1_INTEGER *next_serial(const char *serialfile)
+	{
+	int ret = 0;
+	BIO *in = NULL;
+	ASN1_INTEGER *serial = NULL;
+	BIGNUM *bn = NULL;
+
+	if (!(serial = ASN1_INTEGER_new())) goto err;
+
+	if (!(in = BIO_new_file(serialfile, "r"))) 
+		{
+		ERR_clear_error();
+		BIO_printf(bio_err, "Warning: could not open file %s for "
+			   "reading, using serial number: 1\n", serialfile);
+		if (!ASN1_INTEGER_set(serial, 1)) goto err;
+		}
+	else
+		{
+		char buf[1024];
+		if (!a2i_ASN1_INTEGER(in, serial, buf, sizeof(buf)))
+			{
+			BIO_printf(bio_err, "unable to load number from %s\n",
+				   serialfile);
+			goto err;
+			}
+		if (!(bn = ASN1_INTEGER_to_BN(serial, NULL))) goto err;
+		ASN1_INTEGER_free(serial);
+		serial = NULL;
+		if (!BN_add_word(bn, 1)) goto err;
+		if (!(serial = BN_to_ASN1_INTEGER(bn, NULL))) goto err;
+		}
+	ret = 1;
+ err:
+	if (!ret)
+		{
+		ASN1_INTEGER_free(serial);
+		serial = NULL;
+		}
+	BIO_free_all(in);
+	BN_free(bn);
+	return serial;
+	}
+
+static int save_ts_serial(const char *serialfile, ASN1_INTEGER *serial)
+	{
+	int ret = 0;
+	BIO *out = NULL;
+
+	if (!(out = BIO_new_file(serialfile, "w"))) goto err;
+	if (i2a_ASN1_INTEGER(out, serial) <= 0) goto err;
+	if (BIO_puts(out, "\n") <= 0) goto err;
+	ret = 1;
+ err:
+	if (!ret)
+		BIO_printf(bio_err, "could not save serial number to %s\n",
+			   serialfile);
+	BIO_free_all(out);
+	return ret;
+	}
+
+/*
+ * Verify-related method definitions.
+ */
+
+static int verify_command(char *data, char *digest, char *queryfile,
+			  char *in, int token_in,
+			  char *ca_path, char *ca_file, char *untrusted)
+	{
+	BIO *in_bio = NULL;
+	PKCS7 *token = NULL;
+	TS_RESP *response = NULL;
+	TS_VERIFY_CTX *verify_ctx = NULL;
+	int ret = 0;
+
+	/* Decode the token (PKCS7) or response (TS_RESP) files. */
+	if (!(in_bio = BIO_new_file(in, "rb"))) goto end;
+	if (token_in)
+		{
+		if (!(token = d2i_PKCS7_bio(in_bio, NULL))) goto end;
+		}
+	else
+		{
+		if (!(response = d2i_TS_RESP_bio(in_bio, NULL))) goto end;
+		}
+
+	if (!(verify_ctx = create_verify_ctx(data, digest, queryfile, 
+					     ca_path, ca_file, untrusted)))
+		goto end;
+
+	/* Checking the token or response against the request. */
+	ret = token_in ?
+		TS_RESP_verify_token(verify_ctx, token) :
+		TS_RESP_verify_response(verify_ctx, response);
+
+ end:
+	printf("Verification: ");
+	if (ret)
+		printf("OK\n");
+	else
+		{
+		printf("FAILED\n");
+		/* Print errors, if there are any. */
+		ERR_print_errors(bio_err);
+		}
+	
+	/* Clean up. */
+	BIO_free_all(in_bio);
+	PKCS7_free(token);
+	TS_RESP_free(response);
+	TS_VERIFY_CTX_free(verify_ctx);
+	return ret;
+	}
+
+static TS_VERIFY_CTX *create_verify_ctx(char *data, char *digest, 
+					char *queryfile, 
+					char *ca_path, char *ca_file,
+					char *untrusted)
+	{
+	TS_VERIFY_CTX *ctx = NULL;
+	BIO *input = NULL;
+	TS_REQ *request = NULL;
+	int ret = 0;
+
+	if (data != NULL || digest != NULL)
+		{
+		if (!(ctx = TS_VERIFY_CTX_new())) goto err;
+		ctx->flags = TS_VFY_VERSION | TS_VFY_SIGNER;
+		if (data != NULL)
+			{
+			ctx->flags |= TS_VFY_DATA;
+			if (!(ctx->data = BIO_new_file(data, "rb"))) goto err;
+			}
+		else if (digest != NULL)
+			{
+			long imprint_len;
+			ctx->flags |= TS_VFY_IMPRINT;
+			if (!(ctx->imprint = string_to_hex(digest,
+							   &imprint_len)))
+				{
+				BIO_printf(bio_err, "invalid digest string\n");
+				goto err;
+				}
+			ctx->imprint_len = imprint_len;
+			}
+		
+		}
+	else if (queryfile != NULL)
+		{
+		/* The request has just to be read, decoded and converted to
+		   a verify context object. */
+		if (!(input = BIO_new_file(queryfile, "rb"))) goto err;
+		if (!(request = d2i_TS_REQ_bio(input, NULL))) goto err;
+		if (!(ctx = TS_REQ_to_TS_VERIFY_CTX(request, NULL))) goto err;
+		}
+
+	/* Add the signature verification flag and arguments. */
+	ctx->flags |= TS_VFY_SIGNATURE;
+
+	/* Initialising the X509_STORE object. */
+	if (!(ctx->store = create_cert_store(ca_path, ca_file))) goto err;
+
+	/* Loading untrusted certificates. */
+	if (untrusted && !(ctx->certs = TS_CONF_load_certs(untrusted))) 
+		goto err;
+
+	ret = 1;
+ err:
+	if (!ret)
+		{
+		TS_VERIFY_CTX_free(ctx);
+		ctx = NULL;
+		}
+	BIO_free_all(input);
+	TS_REQ_free(request);
+	return ctx;
+	}
+
+static X509_STORE *create_cert_store(char *ca_path, char *ca_file)
+	{
+	X509_STORE *cert_ctx = NULL;
+	X509_LOOKUP *lookup = NULL;
+	int i;
+
+	/* Creating the X509_STORE object. */
+	cert_ctx = X509_STORE_new();
+
+	/* Setting the callback for certificate chain verification. */
+	X509_STORE_set_verify_cb_func(cert_ctx, verify_cb);
+
+	/* Adding a trusted certificate directory source. */
+	if (ca_path)
+		{
+		lookup = X509_STORE_add_lookup(cert_ctx,
+					       X509_LOOKUP_hash_dir());
+		if (lookup == NULL)
+			{
+			BIO_printf(bio_err, "memory allocation failure\n");
+			goto err;
+			}
+		i = X509_LOOKUP_add_dir(lookup, ca_path, X509_FILETYPE_PEM);
+		if (!i)
+			{
+			BIO_printf(bio_err, "Error loading directory %s\n",
+				   ca_path);
+			goto err;
+			}
+		}
+
+	/* Adding a trusted certificate file source. */
+	if (ca_file)
+		{
+		lookup = X509_STORE_add_lookup(cert_ctx, X509_LOOKUP_file());
+		if (lookup == NULL)
+			{
+			BIO_printf(bio_err, "memory allocation failure\n");
+			goto err;
+			}
+		i = X509_LOOKUP_load_file(lookup, ca_file, X509_FILETYPE_PEM);
+		if (!i)
+			{
+			BIO_printf(bio_err, "Error loading file %s\n", ca_file);
+			goto err;
+			}
+		}
+
+	return cert_ctx;
+ err:
+	X509_STORE_free(cert_ctx);
+	return NULL;
+	}
+
+static int MS_CALLBACK verify_cb(int ok, X509_STORE_CTX *ctx)
+	{
+	/*
+	char buf[256];
+
+	if (!ok)
+		{
+		X509_NAME_oneline(X509_get_subject_name(ctx->current_cert),
+				  buf, sizeof(buf));
+		printf("%s\n", buf);
+		printf("error %d at %d depth lookup: %s\n",
+		       ctx->error, ctx->error_depth,
+			X509_verify_cert_error_string(ctx->error));
+		}
+	*/
+
+	return ok;
+	}
Index: openssl/apps/tsget
diff -u /dev/null openssl/apps/tsget:1.1.14.1
--- /dev/null	Tue Nov  9 22:43:51 2004
+++ openssl/apps/tsget	Mon Nov  8 16:31:06 2004
@@ -0,0 +1,195 @@
+#!/usr/bin/perl -w
+# Written by Zoltan Glozik <zglozik@stones.com>.
+# Copyright (c) 2002 The OpenTSA Project.  All rights reserved.
+$::version = '$Id: tsget,v 1.1.14.1 2004/11/08 16:31:06 zglozik Exp $';
+
+use strict;
+use IO::Handle;
+use Getopt::Std;
+use File::Basename;
+use WWW::Curl::easy;
+
+use vars qw(%options);
+
+# Callback for reading the body.
+sub read_body {
+    my ($maxlength, $state) = @_;
+    my $return_data = "";
+    my $data_len = length ${$state->{data}};
+    if ($state->{bytes} < $data_len) {
+	$data_len = $data_len - $state->{bytes};
+	$data_len = $maxlength if $data_len > $maxlength;
+	$return_data = substr ${$state->{data}}, $state->{bytes}, $data_len;
+	$state->{bytes} += $data_len;
+    }
+    return $return_data;
+}
+
+# Callback for writing the body into a variable.
+sub write_body {
+    my ($data, $pointer) = @_;
+    ${$pointer} .= $data;
+    return length($data);
+}
+
+# Initialise a new Curl object.
+sub create_curl {
+    my $url = shift;
+
+    # Create Curl object.
+    my $curl = WWW::Curl::easy::new();
+
+    # Error-handling related options.
+    $curl->setopt(CURLOPT_VERBOSE, 1) if $options{d};
+    $curl->setopt(CURLOPT_FAILONERROR, 1);
+    $curl->setopt(CURLOPT_USERAGENT, "OpenTSA tsget.pl/" . (split / /, $::version)[2]);
+
+    # Options for POST method.
+    $curl->setopt(CURLOPT_UPLOAD, 1);
+    $curl->setopt(CURLOPT_CUSTOMREQUEST, "POST");
+    $curl->setopt(CURLOPT_HTTPHEADER,
+		["Content-Type: application/timestamp-query",
+		"Accept: application/timestamp-reply"]);
+    $curl->setopt(CURLOPT_READFUNCTION, \&read_body);
+    $curl->setopt(CURLOPT_HEADERFUNCTION, sub { return length($_[0]); });
+
+    # Options for getting the result.
+    $curl->setopt(CURLOPT_WRITEFUNCTION, \&write_body);
+
+    # SSL related options.
+    $curl->setopt(CURLOPT_SSLKEYTYPE, "PEM");
+    $curl->setopt(CURLOPT_SSL_VERIFYPEER, 1);	# Verify server's certificate.
+    $curl->setopt(CURLOPT_SSL_VERIFYHOST, 2);	# Check server's CN.
+    $curl->setopt(CURLOPT_SSLKEY, $options{k}) if defined($options{k});
+    $curl->setopt(CURLOPT_SSLKEYPASSWD, $options{p}) if defined($options{p});
+    $curl->setopt(CURLOPT_SSLCERT, $options{c}) if defined($options{c});
+    $curl->setopt(CURLOPT_CAINFO, $options{C}) if defined($options{C});
+    $curl->setopt(CURLOPT_CAPATH, $options{P}) if defined($options{P});
+    $curl->setopt(CURLOPT_RANDOM_FILE, $options{r}) if defined($options{r});
+    $curl->setopt(CURLOPT_EGDSOCKET, $options{g}) if defined($options{g});
+
+    # Setting destination.
+    $curl->setopt(CURLOPT_URL, $url);
+
+    return $curl;
+}
+
+# Send a request and returns the body back.
+sub get_timestamp {
+    my $curl = shift;
+    my $body = shift;
+    my $ts_body;
+    local $::error_buf;
+
+    # Error-handling related options.
+    $curl->setopt(CURLOPT_ERRORBUFFER, "::error_buf");
+
+    # Options for POST method.
+    $curl->setopt(CURLOPT_INFILE, {data => $body, bytes => 0});
+    $curl->setopt(CURLOPT_INFILESIZE, length(${$body}));
+
+    # Options for getting the result.
+    $curl->setopt(CURLOPT_FILE, \$ts_body);
+
+    # Send the request...
+    my $error_code = $curl->perform();
+    my $error_string;
+    if ($error_code != 0) {
+        my $http_code = $curl->getinfo(CURLINFO_HTTP_CODE);
+	$error_string = "could not get timestamp";
+	$error_string .= ", http code: $http_code" unless $http_code == 0;
+	$error_string .= ", curl code: $error_code";
+	$error_string .= " ($::error_buf)" if defined($::error_buf);
+    } else {
+        my $ct = $curl->getinfo(CURLINFO_CONTENT_TYPE);
+	if (lc($ct) ne "application/timestamp-reply") {
+	    $error_string = "unexpected content type returned: $ct";
+        }
+    }
+    return ($ts_body, $error_string);
+
+}
+
+# Print usage information and exists.
+sub usage {
+
+    print STDERR "usage: $0 -h <server_url> [-e <extension>] [-o <output>] ";
+    print STDERR "[-v] [-d] [-k <private_key.pem>] [-p <key_password>] ";
+    print STDERR "[-c <client_cert.pem>] [-C <CA_certs.pem>] [-P <CA_path>] ";
+    print STDERR "[-r <file:file...>] [-g <EGD_socket>] [<request>]...\n";
+    exit 1;
+}
+
+# ----------------------------------------------------------------------
+#   Main program
+# ----------------------------------------------------------------------
+
+# Getting command-line options (default comes from TSGET environment variable).
+my $getopt_arg =  "h:e:o:vdk:p:c:C:P:r:g:";
+if (exists $ENV{TSGET}) {
+    my @old_argv = @ARGV;
+    @ARGV = split /\s+/, $ENV{TSGET};
+    getopts($getopt_arg, \%options) or usage;
+    @ARGV = @old_argv;
+}
+getopts($getopt_arg, \%options) or usage;
+
+# Checking argument consistency.
+if (!exists($options{h}) || (@ARGV == 0 && !exists($options{o}))
+    || (@ARGV > 1 && exists($options{o}))) {
+    print STDERR "Inconsistent command line options.\n";
+    usage;
+}
+# Setting defaults.
+@ARGV = ("-") unless @ARGV != 0;
+$options{e} = ".tsr" unless defined($options{e});
+
+# Processing requests.
+my $curl = create_curl $options{h};
+undef $/;   # For reading whole files.
+REQUEST: foreach (@ARGV) {
+    my $input = $_;
+    my ($base, $path) = fileparse($input, '\.[^.]*');
+    my $output_base = $base . $options{e};
+    my $output = defined($options{o}) ? $options{o} : $path . $output_base;
+
+    STDERR->printflush("$input: ") if $options{v};
+    # Read request.
+    my $body;
+    if ($input eq "-") {
+	# Read the request from STDIN;
+	$body = <STDIN>;
+    } else {
+	# Read the request from file.
+        open INPUT, "<" . $input
+	    or warn("$input: could not open input file: $!\n"), next REQUEST;
+        $body = <INPUT>;
+        close INPUT
+	    or warn("$input: could not close input file: $!\n"), next REQUEST;
+    }
+
+    # Send request.
+    STDERR->printflush("sending request") if $options{v};
+
+    my ($ts_body, $error) = get_timestamp $curl, \$body;
+    if (defined($error)) {
+	die "$input: fatal error: $error\n";
+    }
+    STDERR->printflush(", reply received") if $options{v};
+
+    # Write response.
+    if ($output eq "-") {
+	# Write to STDOUT.
+        print $ts_body;
+    } else {
+	# Write to file.
+        open OUTPUT, ">", $output
+	    or warn("$output: could not open output file: $!\n"), next REQUEST;
+        print OUTPUT $ts_body;
+        close OUTPUT
+	    or warn("$output: could not close output file: $!\n"), next REQUEST;
+    }
+    STDERR->printflush(", $output written.\n") if $options{v};
+}
+$curl->cleanup();
+WWW::Curl::easy::global_cleanup();
Index: openssl/crypto/cpt_err.c
diff -u openssl/crypto/cpt_err.c:1.1.1.2 openssl/crypto/cpt_err.c:1.1.1.2.12.1
--- openssl/crypto/cpt_err.c:1.1.1.2	Fri Jan 17 22:07:36 2003
+++ openssl/crypto/cpt_err.c	Mon Nov  8 16:31:06 2004
@@ -1,6 +1,6 @@
 /* crypto/cpt_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -66,7 +66,6 @@
 #ifndef OPENSSL_NO_ERR
 static ERR_STRING_DATA CRYPTO_str_functs[]=
 	{
-{ERR_PACK(0,CRYPTO_F_CRYPTO_GET_EX_NEW_INDEX,0),	"CRYPTO_get_ex_new_index"},
 {ERR_PACK(0,CRYPTO_F_CRYPTO_GET_NEW_DYNLOCKID,0),	"CRYPTO_get_new_dynlockid"},
 {ERR_PACK(0,CRYPTO_F_CRYPTO_GET_NEW_LOCKID,0),	"CRYPTO_get_new_lockid"},
 {ERR_PACK(0,CRYPTO_F_CRYPTO_SET_EX_DATA,0),	"CRYPTO_set_ex_data"},
Index: openssl/crypto/crypto.h
diff -u openssl/crypto/crypto.h:1.1.1.4 openssl/crypto/crypto.h:1.1.1.4.2.1
--- openssl/crypto/crypto.h:1.1.1.4	Mon Nov  8 15:32:20 2004
+++ openssl/crypto/crypto.h	Mon Nov  8 16:31:06 2004
@@ -450,15 +450,14 @@
 /* Error codes for the CRYPTO functions. */
 
 /* Function codes. */
-#define CRYPTO_F_CRYPTO_GET_EX_NEW_INDEX		 100
-#define CRYPTO_F_CRYPTO_GET_NEW_DYNLOCKID		 103
+#define CRYPTO_F_CRYPTO_GET_NEW_DYNLOCKID		 100
 #define CRYPTO_F_CRYPTO_GET_NEW_LOCKID			 101
 #define CRYPTO_F_CRYPTO_SET_EX_DATA			 102
-#define CRYPTO_F_DEF_ADD_INDEX				 104
-#define CRYPTO_F_DEF_GET_CLASS				 105
-#define CRYPTO_F_INT_DUP_EX_DATA			 106
-#define CRYPTO_F_INT_FREE_EX_DATA			 107
-#define CRYPTO_F_INT_NEW_EX_DATA			 108
+#define CRYPTO_F_DEF_ADD_INDEX				 103
+#define CRYPTO_F_DEF_GET_CLASS				 104
+#define CRYPTO_F_INT_DUP_EX_DATA			 105
+#define CRYPTO_F_INT_FREE_EX_DATA			 106
+#define CRYPTO_F_INT_NEW_EX_DATA			 107
 
 /* Reason codes. */
 #define CRYPTO_R_NO_DYNLOCK_CREATE_CALLBACK		 100
Index: openssl/crypto/opensslconf.h
diff -u openssl/crypto/opensslconf.h:1.1.1.2 openssl/crypto/opensslconf.h:1.1.1.2.12.1
--- openssl/crypto/opensslconf.h:1.1.1.2	Fri Jan 17 22:07:36 2003
+++ openssl/crypto/opensslconf.h	Mon Nov  8 16:31:06 2004
@@ -9,6 +9,9 @@
 #endif
 
 #endif /* OPENSSL_DOING_MAKEDEPEND */
+#ifndef OPENSSL_THREADS
+# define OPENSSL_THREADS
+#endif
 
 /* The OPENSSL_NO_* macros are also defined as NO_* if the application
    asks for it.  This is a transient feature that is provided for those
@@ -79,7 +82,7 @@
 
 #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)
 #define CONFIG_HEADER_BN_H
-#undef BN_LLONG
+#define BN_LLONG
 
 /* Should we define BN_DIV2W here? */
 
@@ -98,7 +101,7 @@
 #define CONFIG_HEADER_RC4_LOCL_H
 /* if this is defined data[i] is used instead of *data, this is a %20
  * speedup on x86 */
-#undef RC4_INDEX
+#define RC4_INDEX
 #endif
 
 #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)
@@ -112,14 +115,14 @@
 /* the following is tweaked from a config script, that is why it is a
  * protected undef/define */
 #ifndef DES_PTR
-#undef DES_PTR
+#define DES_PTR
 #endif
 
 /* This helps C compiler generate the correct code for multiple functional
  * units.  It reduces register dependancies at the expense of 2 more
  * registers */
 #ifndef DES_RISC1
-#undef DES_RISC1
+#define DES_RISC1
 #endif
 
 #ifndef DES_RISC2
@@ -133,7 +136,7 @@
 /* Unroll the inner loop, this sometimes helps, sometimes hinders.
  * Very mucy CPU dependant */
 #ifndef DES_UNROLL
-#undef DES_UNROLL
+#define DES_UNROLL
 #endif
 
 /* These default values were supplied by
Index: openssl/crypto/asn1/Makefile
diff -u openssl/crypto/asn1/Makefile:1.1.1.1 openssl/crypto/asn1/Makefile:1.1.1.1.2.1
--- openssl/crypto/asn1/Makefile:1.1.1.1	Mon Nov  8 15:32:22 2004
+++ openssl/crypto/asn1/Makefile	Mon Nov  8 16:31:06 2004
@@ -33,7 +33,8 @@
 	f_int.c f_string.c n_pkey.c \
 	f_enum.c a_hdr.c x_pkey.c a_bool.c x_exten.c \
 	asn1_par.c asn1_lib.c asn1_err.c a_meth.c a_bytes.c a_strnid.c \
-	evp_asn1.c asn_pack.c p5_pbe.c p5_pbev2.c p8_pkey.c asn_moid.c
+	evp_asn1.c asn_pack.c p5_pbe.c p5_pbev2.c p8_pkey.c asn_moid.c \
+	ts_req.c ts_resp.c
 LIBOBJ= a_object.o a_bitstr.o a_utctm.o a_gentm.o a_time.o a_int.o a_octet.o \
 	a_print.o a_type.o a_set.o a_dup.o a_d2i_fp.o a_i2d_fp.o \
 	a_enum.o a_utf8.o a_sign.o a_digest.o a_verify.o a_mbstr.o a_strex.o \
@@ -45,7 +46,8 @@
 	f_int.o f_string.o n_pkey.o \
 	f_enum.o a_hdr.o x_pkey.o a_bool.o x_exten.o \
 	asn1_par.o asn1_lib.o asn1_err.o a_meth.o a_bytes.o a_strnid.o \
-	evp_asn1.o asn_pack.o p5_pbe.o p5_pbev2.o p8_pkey.o asn_moid.o
+	evp_asn1.o asn_pack.o p5_pbe.o p5_pbev2.o p8_pkey.o asn_moid.o \
+	ts_req.o ts_resp.o
 
 SRC= $(LIBSRC)
 
@@ -832,6 +834,52 @@
 tasn_utl.o: ../../include/openssl/opensslv.h ../../include/openssl/ossl_typ.h
 tasn_utl.o: ../../include/openssl/safestack.h ../../include/openssl/stack.h
 tasn_utl.o: ../../include/openssl/symhacks.h tasn_utl.c
+ts_req.o: ../../e_os.h ../../include/openssl/aes.h ../../include/openssl/asn1.h
+ts_req.o: ../../include/openssl/asn1_mac.h ../../include/openssl/bio.h
+ts_req.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_req.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_req.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_req.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_req.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_req.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_req.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_req.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_req.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_req.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_req.o: ../../include/openssl/objects.h ../../include/openssl/opensslconf.h
+ts_req.o: ../../include/openssl/opensslv.h ../../include/openssl/ossl_typ.h
+ts_req.o: ../../include/openssl/pkcs7.h ../../include/openssl/rc2.h
+ts_req.o: ../../include/openssl/rc4.h ../../include/openssl/rc5.h
+ts_req.o: ../../include/openssl/ripemd.h ../../include/openssl/rsa.h
+ts_req.o: ../../include/openssl/safestack.h ../../include/openssl/sha.h
+ts_req.o: ../../include/openssl/stack.h ../../include/openssl/symhacks.h
+ts_req.o: ../../include/openssl/ts.h ../../include/openssl/ui.h
+ts_req.o: ../../include/openssl/ui_compat.h ../../include/openssl/x509.h
+ts_req.o: ../../include/openssl/x509_vfy.h ../../include/openssl/x509v3.h
+ts_req.o: ../cryptlib.h ts_req.c
+ts_resp.o: ../../e_os.h ../../include/openssl/aes.h
+ts_resp.o: ../../include/openssl/asn1.h ../../include/openssl/asn1_mac.h
+ts_resp.o: ../../include/openssl/bio.h ../../include/openssl/blowfish.h
+ts_resp.o: ../../include/openssl/bn.h ../../include/openssl/buffer.h
+ts_resp.o: ../../include/openssl/cast.h ../../include/openssl/conf.h
+ts_resp.o: ../../include/openssl/crypto.h ../../include/openssl/des.h
+ts_resp.o: ../../include/openssl/des_old.h ../../include/openssl/dh.h
+ts_resp.o: ../../include/openssl/dsa.h ../../include/openssl/e_os2.h
+ts_resp.o: ../../include/openssl/err.h ../../include/openssl/evp.h
+ts_resp.o: ../../include/openssl/idea.h ../../include/openssl/lhash.h
+ts_resp.o: ../../include/openssl/md2.h ../../include/openssl/md4.h
+ts_resp.o: ../../include/openssl/md5.h ../../include/openssl/mdc2.h
+ts_resp.o: ../../include/openssl/obj_mac.h ../../include/openssl/objects.h
+ts_resp.o: ../../include/openssl/opensslconf.h ../../include/openssl/opensslv.h
+ts_resp.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_resp.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_resp.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_resp.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_resp.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_resp.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_resp.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_resp.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_resp.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_resp.c
 x_algor.o: ../../include/openssl/aes.h ../../include/openssl/asn1.h
 x_algor.o: ../../include/openssl/asn1t.h ../../include/openssl/bio.h
 x_algor.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
Index: openssl/crypto/asn1/a_bitstr.c
diff -u openssl/crypto/asn1/a_bitstr.c:1.1.1.3 openssl/crypto/asn1/a_bitstr.c:1.1.1.3.12.1
--- openssl/crypto/asn1/a_bitstr.c:1.1.1.3	Fri Jan 17 22:07:38 2003
+++ openssl/crypto/asn1/a_bitstr.c	Mon Nov  8 16:31:06 2004
@@ -216,3 +216,26 @@
 	return((a->data[w]&v) != 0);
 	}
 
+/*
+ * Checks if the given bit string contains only bits specified by 
+ * the flags vector. Returns 0 if there is at least one bit set in 'a'
+ * which is not specified in 'flags', 1 otherwise.
+ * 'len' is the length of 'flags'.
+ */
+int ASN1_BIT_STRING_check(ASN1_BIT_STRING *a,
+			  unsigned char *flags, int flags_len)
+	{
+	int i, ok;
+	/* Check if there is one bit set at all. */
+	if (!a || !a->data) return 1;
+
+	/* Check each byte of the internal representation of the bit string. */
+	ok = 1;
+	for (i = 0; i < a->length && ok; ++i)
+		{
+		unsigned char mask = i < flags_len ? ~flags[i] : 0xff;
+		/* We are done if there is an unneeded bit set. */
+		ok = (a->data[i] & mask) == 0;
+		}
+	return ok;
+	}
Index: openssl/crypto/asn1/a_gentm.c
diff -u openssl/crypto/asn1/a_gentm.c:1.1.1.3 openssl/crypto/asn1/a_gentm.c:1.1.1.3.4.1
--- openssl/crypto/asn1/a_gentm.c:1.1.1.3	Sat Mar 20 17:03:34 2004
+++ openssl/crypto/asn1/a_gentm.c	Mon Nov  8 16:31:06 2004
@@ -176,6 +176,11 @@
 			o++;
 			}
 		}
+	else
+		{
+		/* Missing time zone information. */
+		goto err;
+		}
 	return(o == l);
 err:
 	return(0);
Index: openssl/crypto/asn1/a_type.c
diff -u openssl/crypto/asn1/a_type.c:1.1.1.2 openssl/crypto/asn1/a_type.c:1.1.1.2.12.2
--- openssl/crypto/asn1/a_type.c:1.1.1.2	Fri Jan 17 22:07:42 2003
+++ openssl/crypto/asn1/a_type.c	Tue Nov  9 22:43:00 2004
@@ -58,6 +58,7 @@
 
 #include <stdio.h>
 #include <openssl/asn1t.h>
+#include <openssl/objects.h>
 #include "cryptlib.h"
 
 int ASN1_TYPE_get(ASN1_TYPE *a)
@@ -79,3 +80,49 @@
 
 IMPLEMENT_STACK_OF(ASN1_TYPE)
 IMPLEMENT_ASN1_SET_OF(ASN1_TYPE)
+
+/* Returns 0 if they are equal, != 0 otherwise. */
+int ASN1_TYPE_cmp(ASN1_TYPE *a, ASN1_TYPE *b)
+	{
+	int result = -1;
+
+	if (!a || !b || a->type != b->type) return -1;
+
+	switch (a->type)
+		{
+	case V_ASN1_OBJECT:
+		result = OBJ_cmp(a->value.object, b->value.object);
+		break;
+	case V_ASN1_NULL:
+		result = 0;	/* They do not have content. */
+		break;
+	case V_ASN1_INTEGER:
+	case V_ASN1_NEG_INTEGER:
+	case V_ASN1_ENUMERATED:
+	case V_ASN1_NEG_ENUMERATED:
+	case V_ASN1_BIT_STRING:
+	case V_ASN1_OCTET_STRING:
+	case V_ASN1_SEQUENCE:
+	case V_ASN1_SET:
+	case V_ASN1_NUMERICSTRING:
+	case V_ASN1_PRINTABLESTRING:
+	case V_ASN1_T61STRING:
+	case V_ASN1_VIDEOTEXSTRING:
+	case V_ASN1_IA5STRING:
+	case V_ASN1_UTCTIME:
+	case V_ASN1_GENERALIZEDTIME:
+	case V_ASN1_GRAPHICSTRING:
+	case V_ASN1_VISIBLESTRING:
+	case V_ASN1_GENERALSTRING:
+	case V_ASN1_UNIVERSALSTRING:
+	case V_ASN1_BMPSTRING:
+	case V_ASN1_UTF8STRING:
+	case V_ASN1_OTHER:
+	default:
+		result = ASN1_STRING_cmp((ASN1_STRING *) a->value.ptr,
+					 (ASN1_STRING *) b->value.ptr);
+		break;
+		}
+
+	return result;
+	}
Index: openssl/crypto/asn1/asn1.h
diff -u openssl/crypto/asn1/asn1.h:1.1.1.4 openssl/crypto/asn1/asn1.h:1.1.1.4.8.1
--- openssl/crypto/asn1/asn1.h:1.1.1.4	Tue May  6 21:29:12 2003
+++ openssl/crypto/asn1/asn1.h	Mon Nov  8 16:31:07 2004
@@ -696,6 +696,7 @@
 
 int ASN1_TYPE_get(ASN1_TYPE *a);
 void ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value);
+int		ASN1_TYPE_cmp(ASN1_TYPE *a, ASN1_TYPE *b);
 
 ASN1_OBJECT *	ASN1_OBJECT_new(void );
 void		ASN1_OBJECT_free(ASN1_OBJECT *a);
@@ -731,6 +732,10 @@
 			int length );
 int		ASN1_BIT_STRING_set_bit(ASN1_BIT_STRING *a, int n, int value);
 int		ASN1_BIT_STRING_get_bit(ASN1_BIT_STRING *a, int n);
+int		ASN1_BIT_STRING_check(ASN1_BIT_STRING *a,
+				      unsigned char *flags, int flags_len);
+/* The following macro helps you create the flag vector for bit string check. */
+#define ASN1_BIT(bit, byte)	((bit)/8 == (byte) ? 1<<(7 - ((bit)&0x07)) : 0)
 
 #ifndef OPENSSL_NO_BIO
 int ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,
@@ -980,124 +985,151 @@
 #define ASN1_F_ASN1_TEMPLATE_D2I			 131
 #define ASN1_F_ASN1_TEMPLATE_EX_D2I			 132
 #define ASN1_F_ASN1_TEMPLATE_NEW			 133
-#define ASN1_F_ASN1_TIME_SET				 175
-#define ASN1_F_ASN1_TYPE_GET_INT_OCTETSTRING		 134
-#define ASN1_F_ASN1_TYPE_GET_OCTETSTRING		 135
-#define ASN1_F_ASN1_UNPACK_STRING			 136
-#define ASN1_F_ASN1_VERIFY				 137
-#define ASN1_F_BN_TO_ASN1_ENUMERATED			 138
-#define ASN1_F_BN_TO_ASN1_INTEGER			 139
-#define ASN1_F_COLLECT_DATA				 140
-#define ASN1_F_D2I_ASN1_BIT_STRING			 141
-#define ASN1_F_D2I_ASN1_BOOLEAN				 142
-#define ASN1_F_D2I_ASN1_BYTES				 143
-#define ASN1_F_D2I_ASN1_GENERALIZEDTIME			 144
-#define ASN1_F_D2I_ASN1_HEADER				 145
-#define ASN1_F_D2I_ASN1_INTEGER				 146
-#define ASN1_F_D2I_ASN1_OBJECT				 147
-#define ASN1_F_D2I_ASN1_SET				 148
-#define ASN1_F_D2I_ASN1_TYPE_BYTES			 149
-#define ASN1_F_D2I_ASN1_UINTEGER			 150
-#define ASN1_F_D2I_ASN1_UTCTIME				 151
-#define ASN1_F_D2I_NETSCAPE_RSA				 152
-#define ASN1_F_D2I_NETSCAPE_RSA_2			 153
-#define ASN1_F_D2I_PRIVATEKEY				 154
-#define ASN1_F_D2I_PUBLICKEY				 155
-#define ASN1_F_D2I_X509					 156
-#define ASN1_F_D2I_X509_CINF				 157
-#define ASN1_F_D2I_X509_NAME				 158
-#define ASN1_F_D2I_X509_PKEY				 159
-#define ASN1_F_I2D_ASN1_TIME				 160
-#define ASN1_F_I2D_DSA_PUBKEY				 161
-#define ASN1_F_I2D_NETSCAPE_RSA				 162
-#define ASN1_F_I2D_PRIVATEKEY				 163
-#define ASN1_F_I2D_PUBLICKEY				 164
-#define ASN1_F_I2D_RSA_PUBKEY				 165
-#define ASN1_F_LONG_C2I					 166
-#define ASN1_F_OID_MODULE_INIT				 174
-#define ASN1_F_PKCS5_PBE2_SET				 167
-#define ASN1_F_X509_CINF_NEW				 168
-#define ASN1_F_X509_CRL_ADD0_REVOKED			 169
-#define ASN1_F_X509_INFO_NEW				 170
-#define ASN1_F_X509_NAME_NEW				 171
-#define ASN1_F_X509_NEW					 172
-#define ASN1_F_X509_PKEY_NEW				 173
+#define ASN1_F_ASN1_TIME_SET				 134
+#define ASN1_F_ASN1_TYPE_GET_INT_OCTETSTRING		 135
+#define ASN1_F_ASN1_TYPE_GET_OCTETSTRING		 136
+#define ASN1_F_ASN1_UNPACK_STRING			 137
+#define ASN1_F_ASN1_VERIFY				 138
+#define ASN1_F_BN_TO_ASN1_ENUMERATED			 139
+#define ASN1_F_BN_TO_ASN1_INTEGER			 140
+#define ASN1_F_COLLECT_DATA				 141
+#define ASN1_F_D2I_ASN1_BIT_STRING			 142
+#define ASN1_F_D2I_ASN1_BOOLEAN				 143
+#define ASN1_F_D2I_ASN1_BYTES				 144
+#define ASN1_F_D2I_ASN1_GENERALIZEDTIME			 145
+#define ASN1_F_D2I_ASN1_HEADER				 146
+#define ASN1_F_D2I_ASN1_INTEGER				 147
+#define ASN1_F_D2I_ASN1_OBJECT				 148
+#define ASN1_F_D2I_ASN1_SET				 149
+#define ASN1_F_D2I_ASN1_TYPE_BYTES			 150
+#define ASN1_F_D2I_ASN1_UINTEGER			 151
+#define ASN1_F_D2I_ASN1_UTCTIME				 152
+#define ASN1_F_D2I_ESS_CERT_ID				 153
+#define ASN1_F_D2I_ESS_ISSUER_SERIAL			 154
+#define ASN1_F_D2I_ESS_SIGNING_CERT			 155
+#define ASN1_F_D2I_NETSCAPE_RSA				 156
+#define ASN1_F_D2I_NETSCAPE_RSA_2			 157
+#define ASN1_F_D2I_PRIVATEKEY				 158
+#define ASN1_F_D2I_PUBLICKEY				 159
+#define ASN1_F_D2I_TS_ACCURACY				 160
+#define ASN1_F_D2I_TS_MSG_IMPRINT			 161
+#define ASN1_F_D2I_TS_REQ				 162
+#define ASN1_F_D2I_TS_RESP				 163
+#define ASN1_F_D2I_TS_STATUS_INFO			 164
+#define ASN1_F_D2I_TS_TST_INFO				 165
+#define ASN1_F_D2I_X509					 166
+#define ASN1_F_D2I_X509_CINF				 167
+#define ASN1_F_D2I_X509_NAME				 168
+#define ASN1_F_D2I_X509_PKEY				 169
+#define ASN1_F_ESS_CERT_ID_NEW				 170
+#define ASN1_F_ESS_ISSUER_SERIAL_NEW			 171
+#define ASN1_F_ESS_SIGNING_CERT_NEW			 172
+#define ASN1_F_I2D_ASN1_TIME				 173
+#define ASN1_F_I2D_DSA_PUBKEY				 174
+#define ASN1_F_I2D_NETSCAPE_RSA				 175
+#define ASN1_F_I2D_PRIVATEKEY				 176
+#define ASN1_F_I2D_PUBLICKEY				 177
+#define ASN1_F_I2D_RSA_PUBKEY				 178
+#define ASN1_F_LONG_C2I					 179
+#define ASN1_F_OID_MODULE_INIT				 180
+#define ASN1_F_PKCS5_PBE2_SET				 181
+#define ASN1_F_PKCS7_TO_TS_TST_INFO			 182
+#define ASN1_F_TS_ACCURACY_NEW				 183
+#define ASN1_F_TS_MSG_IMPRINT_NEW			 184
+#define ASN1_F_TS_REQ_NEW				 185
+#define ASN1_F_TS_RESP_NEW				 186
+#define ASN1_F_TS_STATUS_INFO_CHECK_FAILURE_INFO	 187
+#define ASN1_F_TS_STATUS_INFO_CHECK_STATUS		 188
+#define ASN1_F_TS_STATUS_INFO_NEW			 189
+#define ASN1_F_TS_TST_INFO_NEW				 190
+#define ASN1_F_X509_CINF_NEW				 191
+#define ASN1_F_X509_CRL_ADD0_REVOKED			 192
+#define ASN1_F_X509_INFO_NEW				 193
+#define ASN1_F_X509_NAME_NEW				 194
+#define ASN1_F_X509_NEW					 195
+#define ASN1_F_X509_PKEY_NEW				 196
 
 /* Reason codes. */
-#define ASN1_R_ADDING_OBJECT				 171
-#define ASN1_R_AUX_ERROR				 100
-#define ASN1_R_BAD_CLASS				 101
-#define ASN1_R_BAD_OBJECT_HEADER			 102
-#define ASN1_R_BAD_PASSWORD_READ			 103
-#define ASN1_R_BAD_TAG					 104
-#define ASN1_R_BN_LIB					 105
-#define ASN1_R_BOOLEAN_IS_WRONG_LENGTH			 106
-#define ASN1_R_BUFFER_TOO_SMALL				 107
-#define ASN1_R_CIPHER_HAS_NO_OBJECT_IDENTIFIER		 108
-#define ASN1_R_DATA_IS_WRONG				 109
-#define ASN1_R_DECODE_ERROR				 110
-#define ASN1_R_DECODING_ERROR				 111
-#define ASN1_R_ENCODE_ERROR				 112
-#define ASN1_R_ERROR_GETTING_TIME			 173
-#define ASN1_R_ERROR_LOADING_SECTION			 172
-#define ASN1_R_ERROR_PARSING_SET_ELEMENT		 113
-#define ASN1_R_ERROR_SETTING_CIPHER_PARAMS		 114
-#define ASN1_R_EXPECTING_AN_INTEGER			 115
-#define ASN1_R_EXPECTING_AN_OBJECT			 116
-#define ASN1_R_EXPECTING_A_BOOLEAN			 117
-#define ASN1_R_EXPECTING_A_TIME				 118
-#define ASN1_R_EXPLICIT_LENGTH_MISMATCH			 119
-#define ASN1_R_EXPLICIT_TAG_NOT_CONSTRUCTED		 120
-#define ASN1_R_FIELD_MISSING				 121
-#define ASN1_R_FIRST_NUM_TOO_LARGE			 122
-#define ASN1_R_HEADER_TOO_LONG				 123
-#define ASN1_R_ILLEGAL_CHARACTERS			 124
-#define ASN1_R_ILLEGAL_NULL				 125
-#define ASN1_R_ILLEGAL_OPTIONAL_ANY			 126
-#define ASN1_R_ILLEGAL_OPTIONS_ON_ITEM_TEMPLATE		 170
-#define ASN1_R_ILLEGAL_TAGGED_ANY			 127
-#define ASN1_R_INTEGER_TOO_LARGE_FOR_LONG		 128
-#define ASN1_R_INVALID_BMPSTRING_LENGTH			 129
-#define ASN1_R_INVALID_DIGIT				 130
-#define ASN1_R_INVALID_SEPARATOR			 131
-#define ASN1_R_INVALID_TIME_FORMAT			 132
-#define ASN1_R_INVALID_UNIVERSALSTRING_LENGTH		 133
-#define ASN1_R_INVALID_UTF8STRING			 134
-#define ASN1_R_IV_TOO_LARGE				 135
-#define ASN1_R_LENGTH_ERROR				 136
-#define ASN1_R_MISSING_EOC				 137
-#define ASN1_R_MISSING_SECOND_NUMBER			 138
-#define ASN1_R_MSTRING_NOT_UNIVERSAL			 139
-#define ASN1_R_MSTRING_WRONG_TAG			 140
-#define ASN1_R_NON_HEX_CHARACTERS			 141
-#define ASN1_R_NOT_ENOUGH_DATA				 142
-#define ASN1_R_NO_MATCHING_CHOICE_TYPE			 143
-#define ASN1_R_NULL_IS_WRONG_LENGTH			 144
-#define ASN1_R_ODD_NUMBER_OF_CHARS			 145
-#define ASN1_R_PRIVATE_KEY_HEADER_MISSING		 146
-#define ASN1_R_SECOND_NUMBER_TOO_LARGE			 147
-#define ASN1_R_SEQUENCE_LENGTH_MISMATCH			 148
-#define ASN1_R_SEQUENCE_NOT_CONSTRUCTED			 149
-#define ASN1_R_SHORT_LINE				 150
-#define ASN1_R_STRING_TOO_LONG				 151
-#define ASN1_R_STRING_TOO_SHORT				 152
-#define ASN1_R_TAG_VALUE_TOO_HIGH			 153
-#define ASN1_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD 154
-#define ASN1_R_TOO_LONG					 155
-#define ASN1_R_TYPE_NOT_CONSTRUCTED			 156
-#define ASN1_R_UNABLE_TO_DECODE_RSA_KEY			 157
-#define ASN1_R_UNABLE_TO_DECODE_RSA_PRIVATE_KEY		 158
-#define ASN1_R_UNEXPECTED_EOC				 159
-#define ASN1_R_UNKNOWN_FORMAT				 160
-#define ASN1_R_UNKNOWN_MESSAGE_DIGEST_ALGORITHM		 161
-#define ASN1_R_UNKNOWN_OBJECT_TYPE			 162
-#define ASN1_R_UNKNOWN_PUBLIC_KEY_TYPE			 163
-#define ASN1_R_UNSUPPORTED_ANY_DEFINED_BY_TYPE		 164
-#define ASN1_R_UNSUPPORTED_CIPHER			 165
-#define ASN1_R_UNSUPPORTED_ENCRYPTION_ALGORITHM		 166
-#define ASN1_R_UNSUPPORTED_PUBLIC_KEY_TYPE		 167
-#define ASN1_R_WRONG_TAG				 168
-#define ASN1_R_WRONG_TYPE				 169
+#define ASN1_R_ADDING_OBJECT				 100
+#define ASN1_R_AUX_ERROR				 101
+#define ASN1_R_BAD_CLASS				 102
+#define ASN1_R_BAD_OBJECT_HEADER			 103
+#define ASN1_R_BAD_PASSWORD_READ			 104
+#define ASN1_R_BAD_PKCS7_TYPE				 105
+#define ASN1_R_BAD_TAG					 106
+#define ASN1_R_BAD_TYPE					 107
+#define ASN1_R_BN_LIB					 108
+#define ASN1_R_BOOLEAN_IS_WRONG_LENGTH			 109
+#define ASN1_R_BUFFER_TOO_SMALL				 110
+#define ASN1_R_CIPHER_HAS_NO_OBJECT_IDENTIFIER		 111
+#define ASN1_R_DATA_IS_WRONG				 112
+#define ASN1_R_DECODE_ERROR				 113
+#define ASN1_R_DECODING_ERROR				 114
+#define ASN1_R_DETACHED_CONTENT				 115
+#define ASN1_R_ENCODE_ERROR				 116
+#define ASN1_R_ERROR_GETTING_TIME			 117
+#define ASN1_R_ERROR_LOADING_SECTION			 118
+#define ASN1_R_ERROR_PARSING_SET_ELEMENT		 119
+#define ASN1_R_ERROR_SETTING_CIPHER_PARAMS		 120
+#define ASN1_R_EXPECTING_AN_INTEGER			 121
+#define ASN1_R_EXPECTING_AN_OBJECT			 122
+#define ASN1_R_EXPECTING_A_BOOLEAN			 123
+#define ASN1_R_EXPECTING_A_TIME				 124
+#define ASN1_R_EXPLICIT_LENGTH_MISMATCH			 125
+#define ASN1_R_EXPLICIT_TAG_NOT_CONSTRUCTED		 126
+#define ASN1_R_FIELD_MISSING				 127
+#define ASN1_R_FIRST_NUM_TOO_LARGE			 128
+#define ASN1_R_HEADER_TOO_LONG				 129
+#define ASN1_R_ILLEGAL_CHARACTERS			 130
+#define ASN1_R_ILLEGAL_NULL				 131
+#define ASN1_R_ILLEGAL_OPTIONAL_ANY			 132
+#define ASN1_R_ILLEGAL_OPTIONS_ON_ITEM_TEMPLATE		 133
+#define ASN1_R_ILLEGAL_TAGGED_ANY			 134
+#define ASN1_R_INTEGER_TOO_LARGE_FOR_LONG		 135
+#define ASN1_R_INVALID_BMPSTRING_LENGTH			 136
+#define ASN1_R_INVALID_DIGIT				 137
+#define ASN1_R_INVALID_FIELD_VALUE			 138
+#define ASN1_R_INVALID_SEPARATOR			 139
+#define ASN1_R_INVALID_TIME_FORMAT			 140
+#define ASN1_R_INVALID_UNIVERSALSTRING_LENGTH		 141
+#define ASN1_R_INVALID_UTF8STRING			 142
+#define ASN1_R_IV_TOO_LARGE				 143
+#define ASN1_R_LENGTH_ERROR				 144
+#define ASN1_R_MISSING_EOC				 145
+#define ASN1_R_MISSING_SECOND_NUMBER			 146
+#define ASN1_R_MSTRING_NOT_UNIVERSAL			 147
+#define ASN1_R_MSTRING_WRONG_TAG			 148
+#define ASN1_R_NON_HEX_CHARACTERS			 149
+#define ASN1_R_NOT_ENOUGH_DATA				 150
+#define ASN1_R_NO_MATCHING_CHOICE_TYPE			 151
+#define ASN1_R_NULL_IS_WRONG_LENGTH			 152
+#define ASN1_R_ODD_NUMBER_OF_CHARS			 153
+#define ASN1_R_PRIVATE_KEY_HEADER_MISSING		 154
+#define ASN1_R_SECOND_NUMBER_TOO_LARGE			 155
+#define ASN1_R_SEQUENCE_LENGTH_MISMATCH			 156
+#define ASN1_R_SEQUENCE_NOT_CONSTRUCTED			 157
+#define ASN1_R_SHORT_LINE				 158
+#define ASN1_R_STRING_TOO_LONG				 159
+#define ASN1_R_STRING_TOO_SHORT				 160
+#define ASN1_R_TAG_VALUE_TOO_HIGH			 161
+#define ASN1_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD 162
+#define ASN1_R_TOKEN_NOT_PRESENT			 163
+#define ASN1_R_TOKEN_PRESENT				 164
+#define ASN1_R_TOO_LONG					 165
+#define ASN1_R_TYPE_NOT_CONSTRUCTED			 166
+#define ASN1_R_UNABLE_TO_DECODE_RSA_KEY			 167
+#define ASN1_R_UNABLE_TO_DECODE_RSA_PRIVATE_KEY		 168
+#define ASN1_R_UNEXPECTED_EOC				 169
+#define ASN1_R_UNKNOWN_FORMAT				 170
+#define ASN1_R_UNKNOWN_MESSAGE_DIGEST_ALGORITHM		 171
+#define ASN1_R_UNKNOWN_OBJECT_TYPE			 172
+#define ASN1_R_UNKNOWN_PUBLIC_KEY_TYPE			 173
+#define ASN1_R_UNSUPPORTED_ANY_DEFINED_BY_TYPE		 174
+#define ASN1_R_UNSUPPORTED_CIPHER			 175
+#define ASN1_R_UNSUPPORTED_ENCRYPTION_ALGORITHM		 176
+#define ASN1_R_UNSUPPORTED_PUBLIC_KEY_TYPE		 177
+#define ASN1_R_WRONG_TAG				 178
+#define ASN1_R_WRONG_TYPE				 179
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/asn1/asn1_err.c
diff -u openssl/crypto/asn1/asn1_err.c:1.1.1.3 openssl/crypto/asn1/asn1_err.c:1.1.1.3.10.1
--- openssl/crypto/asn1/asn1_err.c:1.1.1.3	Sat Feb 22 13:28:04 2003
+++ openssl/crypto/asn1/asn1_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/asn1/asn1_err.c */
 /* ====================================================================
- * Copyright (c) 1999-2002 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -119,14 +119,26 @@
 {ERR_PACK(0,ASN1_F_D2I_ASN1_TYPE_BYTES,0),	"d2i_ASN1_type_bytes"},
 {ERR_PACK(0,ASN1_F_D2I_ASN1_UINTEGER,0),	"d2i_ASN1_UINTEGER"},
 {ERR_PACK(0,ASN1_F_D2I_ASN1_UTCTIME,0),	"D2I_ASN1_UTCTIME"},
+{ERR_PACK(0,ASN1_F_D2I_ESS_CERT_ID,0),	"d2i_ESS_CERT_ID"},
+{ERR_PACK(0,ASN1_F_D2I_ESS_ISSUER_SERIAL,0),	"d2i_ESS_ISSUER_SERIAL"},
+{ERR_PACK(0,ASN1_F_D2I_ESS_SIGNING_CERT,0),	"d2i_ESS_SIGNING_CERT"},
 {ERR_PACK(0,ASN1_F_D2I_NETSCAPE_RSA,0),	"d2i_Netscape_RSA"},
 {ERR_PACK(0,ASN1_F_D2I_NETSCAPE_RSA_2,0),	"D2I_NETSCAPE_RSA_2"},
 {ERR_PACK(0,ASN1_F_D2I_PRIVATEKEY,0),	"d2i_PrivateKey"},
 {ERR_PACK(0,ASN1_F_D2I_PUBLICKEY,0),	"d2i_PublicKey"},
+{ERR_PACK(0,ASN1_F_D2I_TS_ACCURACY,0),	"d2i_TS_ACCURACY"},
+{ERR_PACK(0,ASN1_F_D2I_TS_MSG_IMPRINT,0),	"d2i_TS_MSG_IMPRINT"},
+{ERR_PACK(0,ASN1_F_D2I_TS_REQ,0),	"d2i_TS_REQ"},
+{ERR_PACK(0,ASN1_F_D2I_TS_RESP,0),	"d2i_TS_RESP"},
+{ERR_PACK(0,ASN1_F_D2I_TS_STATUS_INFO,0),	"d2i_TS_STATUS_INFO"},
+{ERR_PACK(0,ASN1_F_D2I_TS_TST_INFO,0),	"d2i_TS_TST_INFO"},
 {ERR_PACK(0,ASN1_F_D2I_X509,0),	"D2I_X509"},
 {ERR_PACK(0,ASN1_F_D2I_X509_CINF,0),	"D2I_X509_CINF"},
 {ERR_PACK(0,ASN1_F_D2I_X509_NAME,0),	"D2I_X509_NAME"},
 {ERR_PACK(0,ASN1_F_D2I_X509_PKEY,0),	"d2i_X509_PKEY"},
+{ERR_PACK(0,ASN1_F_ESS_CERT_ID_NEW,0),	"ESS_CERT_ID_new"},
+{ERR_PACK(0,ASN1_F_ESS_ISSUER_SERIAL_NEW,0),	"ESS_ISSUER_SERIAL_new"},
+{ERR_PACK(0,ASN1_F_ESS_SIGNING_CERT_NEW,0),	"ESS_SIGNING_CERT_new"},
 {ERR_PACK(0,ASN1_F_I2D_ASN1_TIME,0),	"I2D_ASN1_TIME"},
 {ERR_PACK(0,ASN1_F_I2D_DSA_PUBKEY,0),	"i2d_DSA_PUBKEY"},
 {ERR_PACK(0,ASN1_F_I2D_NETSCAPE_RSA,0),	"i2d_Netscape_RSA"},
@@ -136,6 +148,15 @@
 {ERR_PACK(0,ASN1_F_LONG_C2I,0),	"LONG_C2I"},
 {ERR_PACK(0,ASN1_F_OID_MODULE_INIT,0),	"OID_MODULE_INIT"},
 {ERR_PACK(0,ASN1_F_PKCS5_PBE2_SET,0),	"PKCS5_pbe2_set"},
+{ERR_PACK(0,ASN1_F_PKCS7_TO_TS_TST_INFO,0),	"PKCS7_to_TS_TST_INFO"},
+{ERR_PACK(0,ASN1_F_TS_ACCURACY_NEW,0),	"TS_ACCURACY_new"},
+{ERR_PACK(0,ASN1_F_TS_MSG_IMPRINT_NEW,0),	"TS_MSG_IMPRINT_new"},
+{ERR_PACK(0,ASN1_F_TS_REQ_NEW,0),	"TS_REQ_new"},
+{ERR_PACK(0,ASN1_F_TS_RESP_NEW,0),	"TS_RESP_new"},
+{ERR_PACK(0,ASN1_F_TS_STATUS_INFO_CHECK_FAILURE_INFO,0),	"TS_STATUS_INFO_CHECK_FAILURE_INFO"},
+{ERR_PACK(0,ASN1_F_TS_STATUS_INFO_CHECK_STATUS,0),	"TS_STATUS_INFO_CHECK_STATUS"},
+{ERR_PACK(0,ASN1_F_TS_STATUS_INFO_NEW,0),	"TS_STATUS_INFO_new"},
+{ERR_PACK(0,ASN1_F_TS_TST_INFO_NEW,0),	"TS_TST_INFO_new"},
 {ERR_PACK(0,ASN1_F_X509_CINF_NEW,0),	"X509_CINF_NEW"},
 {ERR_PACK(0,ASN1_F_X509_CRL_ADD0_REVOKED,0),	"X509_CRL_add0_revoked"},
 {ERR_PACK(0,ASN1_F_X509_INFO_NEW,0),	"X509_INFO_new"},
@@ -152,7 +173,9 @@
 {ASN1_R_BAD_CLASS                        ,"bad class"},
 {ASN1_R_BAD_OBJECT_HEADER                ,"bad object header"},
 {ASN1_R_BAD_PASSWORD_READ                ,"bad password read"},
+{ASN1_R_BAD_PKCS7_TYPE                   ,"bad pkcs7 type"},
 {ASN1_R_BAD_TAG                          ,"bad tag"},
+{ASN1_R_BAD_TYPE                         ,"bad type"},
 {ASN1_R_BN_LIB                           ,"bn lib"},
 {ASN1_R_BOOLEAN_IS_WRONG_LENGTH          ,"boolean is wrong length"},
 {ASN1_R_BUFFER_TOO_SMALL                 ,"buffer too small"},
@@ -160,6 +183,7 @@
 {ASN1_R_DATA_IS_WRONG                    ,"data is wrong"},
 {ASN1_R_DECODE_ERROR                     ,"decode error"},
 {ASN1_R_DECODING_ERROR                   ,"decoding error"},
+{ASN1_R_DETACHED_CONTENT                 ,"detached content"},
 {ASN1_R_ENCODE_ERROR                     ,"encode error"},
 {ASN1_R_ERROR_GETTING_TIME               ,"error getting time"},
 {ASN1_R_ERROR_LOADING_SECTION            ,"error loading section"},
@@ -182,6 +206,7 @@
 {ASN1_R_INTEGER_TOO_LARGE_FOR_LONG       ,"integer too large for long"},
 {ASN1_R_INVALID_BMPSTRING_LENGTH         ,"invalid bmpstring length"},
 {ASN1_R_INVALID_DIGIT                    ,"invalid digit"},
+{ASN1_R_INVALID_FIELD_VALUE              ,"invalid field value"},
 {ASN1_R_INVALID_SEPARATOR                ,"invalid separator"},
 {ASN1_R_INVALID_TIME_FORMAT              ,"invalid time format"},
 {ASN1_R_INVALID_UNIVERSALSTRING_LENGTH   ,"invalid universalstring length"},
@@ -206,6 +231,8 @@
 {ASN1_R_STRING_TOO_SHORT                 ,"string too short"},
 {ASN1_R_TAG_VALUE_TOO_HIGH               ,"tag value too high"},
 {ASN1_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD,"the asn1 object identifier is not known for this md"},
+{ASN1_R_TOKEN_NOT_PRESENT                ,"token not present"},
+{ASN1_R_TOKEN_PRESENT                    ,"token present"},
 {ASN1_R_TOO_LONG                         ,"too long"},
 {ASN1_R_TYPE_NOT_CONSTRUCTED             ,"type not constructed"},
 {ASN1_R_UNABLE_TO_DECODE_RSA_KEY         ,"unable to decode rsa key"},
Index: openssl/crypto/asn1/asn1_mac.h
diff -u openssl/crypto/asn1/asn1_mac.h:1.1.1.2 openssl/crypto/asn1/asn1_mac.h:1.1.1.2.12.1
--- openssl/crypto/asn1/asn1_mac.h:1.1.1.2	Fri Jan 17 22:07:41 2003
+++ openssl/crypto/asn1/asn1_mac.h	Mon Nov  8 16:31:07 2004
@@ -146,6 +146,13 @@
 		M_ASN1_D2I_get(b,func); \
 		}
 
+#define M_ASN1_D2I_get_int_opt(b,func,type) \
+	if ((c.slen != 0) && ((M_ASN1_next & (~V_ASN1_CONSTRUCTED)) \
+		== (V_ASN1_UNIVERSAL|(type)))) \
+		{ \
+		M_ASN1_D2I_get_int(b,func); \
+		}
+
 #define M_ASN1_D2I_get_imp(b,func, type) \
 	M_ASN1_next=(_tmp& V_ASN1_CONSTRUCTED)|type; \
 	c.q=c.p; \
Index: openssl/crypto/asn1/t_x509.c
diff -u openssl/crypto/asn1/t_x509.c:1.1.1.2 openssl/crypto/asn1/t_x509.c:1.1.1.2.12.1
--- openssl/crypto/asn1/t_x509.c:1.1.1.2	Fri Jan 17 22:07:44 2003
+++ openssl/crypto/asn1/t_x509.c	Mon Nov  8 16:31:07 2004
@@ -368,6 +368,8 @@
 	int gmt=0;
 	int i;
 	int y=0,M=0,d=0,h=0,m=0,s=0;
+	char *f = NULL;
+	int f_len = 0;
 
 	i=tm->length;
 	v=(char *)tm->data;
@@ -384,10 +386,21 @@
 	m=  (v[10]-'0')*10+(v[11]-'0');
 	if (	(v[12] >= '0') && (v[12] <= '9') &&
 		(v[13] >= '0') && (v[13] <= '9'))
+		{
 		s=  (v[12]-'0')*10+(v[13]-'0');
+		/* Check for fractions of seconds. */
+		if (v[14] == '.')
+			{
+			int l = tm->length;
+			f = &v[14];	/* The decimal point. */
+			f_len = 1;
+			while (14 + f_len < l && f[f_len] >= '0' && f[f_len] <= '9')
+				++f_len;
+			}
+		}
 
-	if (BIO_printf(bp,"%s %2d %02d:%02d:%02d %d%s",
-		mon[M-1],d,h,m,s,y,(gmt)?" GMT":"") <= 0)
+	if (BIO_printf(bp,"%s %2d %02d:%02d:%02d%.*s %d%s",
+		mon[M-1],d,h,m,s,f_len,f,y,(gmt)?" GMT":"") <= 0)
 		return(0);
 	else
 		return(1);
Index: openssl/crypto/asn1/ts_req.c
diff -u /dev/null openssl/crypto/asn1/ts_req.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:43:52 2004
+++ openssl/crypto/asn1/ts_req.c	Mon Nov  8 16:31:07 2004
@@ -0,0 +1,265 @@
+/* crypto/asn1/ts_req.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/asn1_mac.h>
+#include <openssl/x509.h>
+#include <openssl/ts.h>
+
+/* TS_REQ data type */
+
+TS_REQ *TS_REQ_new()
+	{
+	TS_REQ *ret = NULL;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, TS_REQ);
+	M_ASN1_New(ret->version, M_ASN1_INTEGER_new);
+	M_ASN1_New(ret->msg_imprint, TS_MSG_IMPRINT_new);
+	ret->policy_id = NULL;
+	ret->nonce = NULL;
+	ret->cert_req = 0;
+	ret->extensions = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_TS_REQ_NEW);
+	}
+
+void TS_REQ_free(TS_REQ *a)
+	{
+	if (a == NULL) return;
+
+	M_ASN1_INTEGER_free(a->version);
+	TS_MSG_IMPRINT_free(a->msg_imprint);
+	ASN1_OBJECT_free(a->policy_id);
+	ASN1_INTEGER_free(a->nonce);
+	/* No need to free a->cert_req. */
+	sk_X509_EXTENSION_pop_free(a->extensions, X509_EXTENSION_free);
+	OPENSSL_free(a);
+	}
+
+int i2d_TS_REQ(TS_REQ *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->version, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len(a->msg_imprint, i2d_TS_MSG_IMPRINT);
+	M_ASN1_I2D_len(a->policy_id, i2d_ASN1_OBJECT);
+	M_ASN1_I2D_len(a->nonce, i2d_ASN1_INTEGER);
+	if (a->cert_req) {
+		M_ASN1_I2D_len(a->cert_req, i2d_ASN1_BOOLEAN);
+	}
+	M_ASN1_I2D_len_IMP_SEQUENCE_opt_type(X509_EXTENSION, a->extensions,
+					     i2d_X509_EXTENSION, 0);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->version, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_put(a->msg_imprint, i2d_TS_MSG_IMPRINT);
+	M_ASN1_I2D_put(a->policy_id, i2d_ASN1_OBJECT);
+	M_ASN1_I2D_put(a->nonce, i2d_ASN1_INTEGER);
+	if (a->cert_req) {
+		M_ASN1_I2D_put(a->cert_req, i2d_ASN1_BOOLEAN);
+	}
+	M_ASN1_I2D_put_IMP_SEQUENCE_opt_type(X509_EXTENSION, a->extensions,
+					     i2d_X509_EXTENSION, 0);
+
+	M_ASN1_I2D_finish();
+	}
+
+TS_REQ *d2i_TS_REQ(TS_REQ **a, unsigned char **pp, long length)
+	{
+	M_ASN1_D2I_vars(a, TS_REQ *, TS_REQ_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->version, d2i_ASN1_INTEGER);
+	M_ASN1_D2I_get(ret->msg_imprint, d2i_TS_MSG_IMPRINT);
+
+	ASN1_OBJECT_free(ret->policy_id);
+	ret->policy_id = NULL;
+	M_ASN1_D2I_get_opt(ret->policy_id, d2i_ASN1_OBJECT, V_ASN1_OBJECT);
+
+	M_ASN1_INTEGER_free(ret->nonce);
+	ret->nonce = NULL;
+	M_ASN1_D2I_get_opt(ret->nonce, d2i_ASN1_INTEGER, V_ASN1_INTEGER);
+
+	ret->cert_req = 0;	// default false
+	M_ASN1_D2I_get_int_opt(ret->cert_req, d2i_ASN1_BOOLEAN, V_ASN1_BOOLEAN);
+
+	sk_X509_EXTENSION_pop_free(ret->extensions, X509_EXTENSION_free);
+	ret->extensions = NULL;
+	M_ASN1_D2I_get_IMP_set_opt_type(X509_EXTENSION, ret->extensions,
+					d2i_X509_EXTENSION, 
+					X509_EXTENSION_free,
+					0);
+
+	M_ASN1_D2I_Finish(a, TS_REQ_free, ASN1_F_D2I_TS_REQ);
+	}
+
+TS_REQ *TS_REQ_dup(TS_REQ *a)
+	{
+	return (TS_REQ *) ASN1_dup((int (*)()) i2d_TS_REQ,
+		(char *(*)()) d2i_TS_REQ,
+		(char *) a);
+	}
+
+TS_REQ *d2i_TS_REQ_bio(BIO *bp, TS_REQ **a)
+	{
+	return (TS_REQ *) ASN1_d2i_bio((char *(*)()) TS_REQ_new,
+		(char *(*)()) d2i_TS_REQ,
+		bp,
+		(unsigned char **) a);
+	}
+
+int i2d_TS_REQ_bio(BIO *bp, TS_REQ *a)
+	{
+	return ASN1_i2d_bio(i2d_TS_REQ, bp, (unsigned char *) a);
+	}
+
+TS_REQ *d2i_TS_REQ_fp(FILE *fp, TS_REQ **a)
+	{
+	return (TS_REQ *) ASN1_d2i_fp((char *(*)()) TS_REQ_new,
+		(char *(*)()) d2i_TS_REQ,
+		fp,
+		(unsigned char **) a);
+	}
+
+int i2d_TS_REQ_fp(FILE *fp, TS_REQ *a)
+	{
+	return ASN1_i2d_fp(i2d_TS_REQ, fp, (unsigned char *) a);
+	}
+
+/* TS_MSG_IMPRINT data type */
+
+TS_MSG_IMPRINT *TS_MSG_IMPRINT_new()
+	{
+	TS_MSG_IMPRINT *ret = NULL;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, TS_MSG_IMPRINT);
+	M_ASN1_New(ret->hash_algo, X509_ALGOR_new);
+	M_ASN1_New(ret->hashed_msg, M_ASN1_OCTET_STRING_new);
+	return ret;
+	M_ASN1_New_Error(ASN1_F_TS_MSG_IMPRINT_NEW);
+	}
+
+void TS_MSG_IMPRINT_free(TS_MSG_IMPRINT *a)
+	{
+	if (a == NULL) return;
+	X509_ALGOR_free(a->hash_algo);
+	M_ASN1_OCTET_STRING_free(a->hashed_msg);
+	OPENSSL_free(a);
+	}
+
+int i2d_TS_MSG_IMPRINT(TS_MSG_IMPRINT *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->hash_algo, i2d_X509_ALGOR);
+	M_ASN1_I2D_len(a->hashed_msg, i2d_ASN1_OCTET_STRING);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->hash_algo, i2d_X509_ALGOR);
+	M_ASN1_I2D_put(a->hashed_msg, i2d_ASN1_OCTET_STRING);
+	M_ASN1_I2D_finish();
+	}
+
+TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT(TS_MSG_IMPRINT **a, unsigned char **pp, 
+				   long length)
+	{
+	M_ASN1_D2I_vars(a, TS_MSG_IMPRINT *, TS_MSG_IMPRINT_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->hash_algo, d2i_X509_ALGOR);
+	M_ASN1_D2I_get(ret->hashed_msg, d2i_ASN1_OCTET_STRING);
+	M_ASN1_D2I_Finish(a, TS_MSG_IMPRINT_free, ASN1_F_D2I_TS_MSG_IMPRINT);
+	}
+
+TS_MSG_IMPRINT *TS_MSG_IMPRINT_dup(TS_MSG_IMPRINT *a)
+	{
+	return (TS_MSG_IMPRINT *) ASN1_dup((int (*)()) i2d_TS_MSG_IMPRINT,
+		(char *(*)()) d2i_TS_MSG_IMPRINT,
+		(char *) a);
+	}
+
+TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT_bio(BIO *bp, TS_MSG_IMPRINT **a)
+	{
+	return (TS_MSG_IMPRINT *) ASN1_d2i_bio((char *(*)()) TS_MSG_IMPRINT_new,
+		(char *(*)()) d2i_TS_MSG_IMPRINT,
+		bp,
+		(unsigned char **) a);
+	}
+
+int i2d_TS_MSG_IMPRINT_bio(BIO *bp, TS_MSG_IMPRINT *a)
+	{
+	return ASN1_i2d_bio(i2d_TS_MSG_IMPRINT, bp, (unsigned char *) a);
+	}
+
+TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT **a)
+	{
+	return (TS_MSG_IMPRINT *) ASN1_d2i_fp((char *(*)()) TS_MSG_IMPRINT_new,
+		(char *(*)()) d2i_TS_MSG_IMPRINT,
+		fp,
+		(unsigned char **) a);
+	}
+
+int i2d_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT *a)
+	{
+	return ASN1_i2d_fp(i2d_TS_MSG_IMPRINT, fp, (unsigned char *) a);
+	}
Index: openssl/crypto/asn1/ts_resp.c
diff -u /dev/null openssl/crypto/asn1/ts_resp.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:43:52 2004
+++ openssl/crypto/asn1/ts_resp.c	Mon Nov  8 16:31:07 2004
@@ -0,0 +1,719 @@
+/* crypto/asn1/ts_resp.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/asn1_mac.h>
+#include <openssl/x509.h>
+#include <openssl/x509v3.h>
+#include <openssl/ts.h>
+
+/* Static function declarations. */
+static int TS_STATUS_INFO_check_status(ASN1_INTEGER *status);
+static int TS_STATUS_INFO_check_failure_info(ASN1_BIT_STRING *failinfo);
+
+/* TS_RESP data type */
+
+TS_RESP *TS_RESP_new(void)
+	{
+	TS_RESP *ret = NULL;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, TS_RESP);
+	M_ASN1_New(ret->status_info, TS_STATUS_INFO_new);
+	ret->token = NULL;
+	ret->tst_info = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_TS_RESP_NEW);
+	}
+
+void TS_RESP_free(TS_RESP *a)
+	{
+	if (a == NULL) return;
+
+	TS_STATUS_INFO_free(a->status_info);
+	PKCS7_free(a->token);
+	TS_TST_INFO_free(a->tst_info);
+	OPENSSL_free(a);
+	}
+
+int i2d_TS_RESP(TS_RESP *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->status_info, i2d_TS_STATUS_INFO);
+	M_ASN1_I2D_len(a->token, i2d_PKCS7);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->status_info, i2d_TS_STATUS_INFO);
+	M_ASN1_I2D_put(a->token, i2d_PKCS7);
+	M_ASN1_I2D_finish();
+	}
+
+TS_RESP *d2i_TS_RESP(TS_RESP **a, unsigned char **pp, long length)
+	{
+	int status;
+
+	M_ASN1_D2I_vars(a, TS_RESP *, TS_RESP_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->status_info, d2i_TS_STATUS_INFO);
+
+	PKCS7_free(ret->token);
+	ret->token = NULL;
+	TS_TST_INFO_free(ret->tst_info);
+	ret->tst_info = NULL;
+	M_ASN1_D2I_get_opt(ret->token, d2i_PKCS7, V_ASN1_SEQUENCE);
+
+	/* Check if token must be present or not. */
+	status = ASN1_INTEGER_get(ret->status_info->status);
+	if ((status == 0 || status == 1) && !ret->token)
+		{
+		ASN1err(ASN1_F_D2I_TS_RESP, ASN1_R_TOKEN_NOT_PRESENT);
+		c.line = __LINE__; goto err;
+		}
+	if (status != 0 && status != 1 && ret->token)
+		{
+		ASN1err(ASN1_F_D2I_TS_RESP, ASN1_R_TOKEN_PRESENT);
+		c.line = __LINE__; goto err;
+		}
+
+	if (ret->token)
+		{
+		/* Initializing TS_TST_INFO object from PKCS7. */
+		ret->tst_info = PKCS7_to_TS_TST_INFO(ret->token);
+		if (ret->tst_info == NULL)
+			{ c.line = __LINE__; goto err; }
+		}
+
+	M_ASN1_D2I_Finish(a, TS_RESP_free, ASN1_F_D2I_TS_RESP);
+	}
+
+/* Getting encapsulated TS_TST_INFO object from PKCS7. */
+TS_TST_INFO *PKCS7_to_TS_TST_INFO(PKCS7 *token)
+	{
+	TS_TST_INFO *tst_info = NULL;
+	PKCS7_SIGNED *pkcs7_signed;
+	PKCS7 *enveloped;
+	ASN1_TYPE *tst_info_wrapper;
+	ASN1_OCTET_STRING *tst_info_der;
+	unsigned char *p;
+
+	if (!PKCS7_type_is_signed(token))
+		{
+		ASN1err(ASN1_F_PKCS7_TO_TS_TST_INFO, ASN1_R_BAD_PKCS7_TYPE);
+		goto err;
+		}
+
+	/* Content must be present. */
+	if (PKCS7_get_detached(token))
+		{
+		ASN1err(ASN1_F_PKCS7_TO_TS_TST_INFO, ASN1_R_DETACHED_CONTENT);
+		goto err;
+		}
+
+	/* We have a signed data with content. */
+	pkcs7_signed = token->d.sign;
+	enveloped = pkcs7_signed->contents;
+	if (OBJ_obj2nid(enveloped->type) != NID_id_smime_ct_TSTInfo)
+		{
+		ASN1err(ASN1_F_PKCS7_TO_TS_TST_INFO, ASN1_R_BAD_PKCS7_TYPE);
+		goto err;
+		}
+
+	/* We have a DER encoded TST_INFO as the signed data. */
+	tst_info_wrapper = enveloped->d.other;
+	if (tst_info_wrapper->type != V_ASN1_OCTET_STRING)
+		{
+		ASN1err(ASN1_F_PKCS7_TO_TS_TST_INFO, ASN1_R_BAD_TYPE);
+		goto err;
+		}
+
+	/* We have the correct ASN1_OCTET_STRING type. */
+	tst_info_der = tst_info_wrapper->value.octet_string;
+	/* At last, decode the TST_INFO. */
+	p = tst_info_der->data;
+	tst_info = d2i_TS_TST_INFO(NULL, &p, tst_info_der->length);
+ err:
+	return tst_info;
+	}
+
+TS_RESP *TS_RESP_dup(TS_RESP *a)
+	{
+	return (TS_RESP *) ASN1_dup((int (*)()) i2d_TS_RESP,
+				    (char *(*)()) d2i_TS_RESP,
+				    (char *) a);
+	}
+
+TS_RESP *d2i_TS_RESP_fp(FILE *fp, TS_RESP **a)
+	{
+	return (TS_RESP *) ASN1_d2i_fp((char *(*)()) TS_RESP_new,
+				       (char *(*)()) d2i_TS_RESP,
+				       fp, (unsigned char **) a);
+	}
+
+int i2d_TS_RESP_fp(FILE *fp, TS_RESP *a)
+	{
+	return ASN1_i2d_fp(i2d_TS_RESP, fp, (unsigned char *) a);
+	}
+
+TS_RESP *d2i_TS_RESP_bio(BIO *bp, TS_RESP **a)
+	{
+	return (TS_RESP *) ASN1_d2i_bio((char *(*)()) TS_RESP_new,
+				       (char *(*)()) d2i_TS_RESP,
+				       bp, (unsigned char **) a);
+	}
+
+int i2d_TS_RESP_bio(BIO *bp, TS_RESP *a)
+	{
+	return ASN1_i2d_bio(i2d_TS_RESP, bp, (unsigned char *) a);
+	}
+
+TS_STATUS_INFO *TS_STATUS_INFO_new(void)
+	{
+	TS_STATUS_INFO *ret;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, TS_STATUS_INFO);
+	M_ASN1_New(ret->status, M_ASN1_INTEGER_new);
+	ret->text = NULL;
+	ret->failure_info = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_TS_STATUS_INFO_NEW);
+	}
+
+void TS_STATUS_INFO_free(TS_STATUS_INFO *a)
+	{
+	if (a == NULL) return;
+
+	ASN1_INTEGER_free(a->status);
+	sk_ASN1_UTF8STRING_pop_free(a->text, ASN1_UTF8STRING_free);
+	ASN1_BIT_STRING_free(a->failure_info);
+	OPENSSL_free(a);
+	}
+
+int i2d_TS_STATUS_INFO(TS_STATUS_INFO *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->status, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len_SEQUENCE_opt_type(ASN1_UTF8STRING, a->text,
+					 i2d_ASN1_UTF8STRING);
+	M_ASN1_I2D_len(a->failure_info, i2d_ASN1_BIT_STRING);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->status, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_put_SEQUENCE_opt_type(ASN1_UTF8STRING, a->text,
+					 i2d_ASN1_UTF8STRING);
+	M_ASN1_I2D_put(a->failure_info, i2d_ASN1_BIT_STRING);
+	M_ASN1_I2D_finish();
+	}
+
+TS_STATUS_INFO *d2i_TS_STATUS_INFO(TS_STATUS_INFO **a, unsigned char **pp, 
+				   long length)
+	{
+	M_ASN1_D2I_vars(a, TS_STATUS_INFO *, TS_STATUS_INFO_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->status, d2i_ASN1_INTEGER);
+	if (!TS_STATUS_INFO_check_status(ret->status))
+		{ c.line = __LINE__; goto err; }
+
+	sk_ASN1_UTF8STRING_pop_free(ret->text, ASN1_UTF8STRING_free);
+	ret->text = NULL;
+	M_ASN1_D2I_get_seq_opt_type(ASN1_UTF8STRING, ret->text,
+				    d2i_ASN1_UTF8STRING, ASN1_UTF8STRING_free);
+
+	M_ASN1_BIT_STRING_free(ret->failure_info);
+	ret->failure_info = NULL;
+	M_ASN1_D2I_get_opt(ret->failure_info, d2i_ASN1_BIT_STRING,
+			   V_ASN1_BIT_STRING);
+	if (ret->failure_info &&
+	    !TS_STATUS_INFO_check_failure_info(ret->failure_info))
+		{ c.line = __LINE__; goto err; }
+
+	M_ASN1_D2I_Finish(a, TS_STATUS_INFO_free, ASN1_F_D2I_TS_STATUS_INFO);
+	}
+
+TS_STATUS_INFO *TS_STATUS_INFO_dup(TS_STATUS_INFO *a)
+	{
+	return (TS_STATUS_INFO *) ASN1_dup((int (*)()) i2d_TS_STATUS_INFO,
+					   (char *(*)()) d2i_TS_STATUS_INFO,
+					   (char *) a);
+	}
+
+static int TS_STATUS_INFO_check_status(ASN1_INTEGER *status)
+	{
+	long i = ASN1_INTEGER_get(status);
+	if (i < 0 || i > 5)
+		{
+		ASN1err(ASN1_F_TS_STATUS_INFO_CHECK_STATUS, 
+			ASN1_R_INVALID_FIELD_VALUE);
+		ERR_add_error_data(1, "field:status");
+		return 0;
+		}
+	return 1;
+	}
+
+static int TS_STATUS_INFO_check_failure_info(ASN1_BIT_STRING *failinfo)
+	{
+	unsigned char flags[] =
+		{
+		ASN1_BIT(0, 0) | ASN1_BIT(2, 0) | ASN1_BIT(5, 0),
+		ASN1_BIT(14, 1) | ASN1_BIT(15, 1),
+		ASN1_BIT(16, 2) | ASN1_BIT(17, 2),
+		ASN1_BIT(25, 3)
+		};
+
+	if (!ASN1_BIT_STRING_check(failinfo, flags, sizeof(flags)))
+		{
+		ASN1err(ASN1_F_TS_STATUS_INFO_CHECK_FAILURE_INFO, 
+			ASN1_R_INVALID_FIELD_VALUE);
+		ERR_add_error_data(1, "field:failInfo");
+		return 0;
+		}
+	return 1;
+	}
+
+TS_TST_INFO *TS_TST_INFO_new(void)
+	{
+	TS_TST_INFO *ret;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, TS_TST_INFO);
+	M_ASN1_New(ret->version, M_ASN1_INTEGER_new);
+	M_ASN1_New(ret->policy_id, ASN1_OBJECT_new);
+	M_ASN1_New(ret->msg_imprint, TS_MSG_IMPRINT_new);
+	M_ASN1_New(ret->serial, M_ASN1_INTEGER_new);
+	M_ASN1_New(ret->time, M_ASN1_GENERALIZEDTIME_new);
+	ret->accuracy = NULL;
+	ret->ordering = 0;
+	ret->nonce = NULL;
+	ret->tsa = NULL;
+	ret->extensions = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_TS_TST_INFO_NEW);
+	}
+
+void TS_TST_INFO_free(TS_TST_INFO *a)
+	{
+	if (a == NULL) return;
+
+	M_ASN1_INTEGER_free(a->version);
+	ASN1_OBJECT_free(a->policy_id);
+	TS_MSG_IMPRINT_free(a->msg_imprint);
+	M_ASN1_INTEGER_free(a->serial);
+	M_ASN1_GENERALIZEDTIME_free(a->time);
+	TS_ACCURACY_free(a->accuracy);
+	/* No need to free a->ordering. */
+	M_ASN1_INTEGER_free(a->nonce);
+	GENERAL_NAME_free(a->tsa);
+	sk_X509_EXTENSION_pop_free(a->extensions, X509_EXTENSION_free);
+	OPENSSL_free(a);
+	}
+
+int i2d_TS_TST_INFO(TS_TST_INFO *a, unsigned char **pp)
+	{
+	int len = 0;
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->version, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len(a->policy_id, i2d_ASN1_OBJECT);
+	M_ASN1_I2D_len(a->msg_imprint, i2d_TS_MSG_IMPRINT);
+	M_ASN1_I2D_len(a->serial, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len(a->time, i2d_ASN1_GENERALIZEDTIME);
+	M_ASN1_I2D_len(a->accuracy, i2d_TS_ACCURACY);
+	if (a->ordering) M_ASN1_I2D_len(a->ordering, i2d_ASN1_BOOLEAN);
+	M_ASN1_I2D_len(a->nonce, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len_EXP_opt(a->tsa, i2d_GENERAL_NAME, 0, len);
+	M_ASN1_I2D_len_IMP_SEQUENCE_opt_type(X509_EXTENSION, a->extensions,
+					     i2d_X509_EXTENSION, 1);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->version, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_put(a->policy_id, i2d_ASN1_OBJECT);
+	M_ASN1_I2D_put(a->msg_imprint, i2d_TS_MSG_IMPRINT);
+	M_ASN1_I2D_put(a->serial, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_put(a->time, i2d_ASN1_GENERALIZEDTIME);
+	M_ASN1_I2D_put(a->accuracy, i2d_TS_ACCURACY);
+	if (a->ordering) M_ASN1_I2D_put(a->ordering, i2d_ASN1_BOOLEAN);
+	M_ASN1_I2D_put(a->nonce, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_put_EXP_opt(a->tsa, i2d_GENERAL_NAME, 0, len);
+	M_ASN1_I2D_put_IMP_SEQUENCE_opt_type(X509_EXTENSION, a->extensions,
+					     i2d_X509_EXTENSION, 1);
+	M_ASN1_I2D_finish();
+	}
+
+TS_TST_INFO *d2i_TS_TST_INFO(TS_TST_INFO **a, unsigned char **pp,
+			     long length)
+	{
+	M_ASN1_D2I_vars(a, TS_TST_INFO *, TS_TST_INFO_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->version, d2i_ASN1_INTEGER);
+	M_ASN1_D2I_get(ret->policy_id, d2i_ASN1_OBJECT);
+	M_ASN1_D2I_get(ret->msg_imprint, d2i_TS_MSG_IMPRINT);
+	M_ASN1_D2I_get(ret->serial, d2i_ASN1_INTEGER);
+	M_ASN1_D2I_get(ret->time, d2i_ASN1_GENERALIZEDTIME);
+
+	TS_ACCURACY_free(ret->accuracy);
+	ret->accuracy = NULL;
+	M_ASN1_D2I_get_opt(ret->accuracy, d2i_TS_ACCURACY, V_ASN1_SEQUENCE);
+
+	ret->ordering = 0; /* Optional, default is false. */
+	M_ASN1_D2I_get_int_opt(ret->ordering, d2i_ASN1_BOOLEAN, 
+			       V_ASN1_BOOLEAN);
+
+	M_ASN1_INTEGER_free(ret->nonce);
+	ret->nonce = NULL;
+	M_ASN1_D2I_get_opt(ret->nonce, d2i_ASN1_INTEGER, V_ASN1_INTEGER);
+
+	GENERAL_NAME_free(ret->tsa);
+	ret->tsa = NULL;
+	M_ASN1_D2I_get_EXP_opt(ret->tsa, d2i_GENERAL_NAME, 0);
+
+	sk_X509_EXTENSION_pop_free(ret->extensions, X509_EXTENSION_free);
+	ret->extensions = NULL;
+	M_ASN1_D2I_get_IMP_set_opt_type(X509_EXTENSION, ret->extensions,
+					d2i_X509_EXTENSION, 
+					X509_EXTENSION_free,
+					1);
+
+	M_ASN1_D2I_Finish(a, TS_TST_INFO_free, ASN1_F_D2I_TS_TST_INFO);
+	}
+
+TS_TST_INFO *TS_TST_INFO_dup(TS_TST_INFO *a)
+	{
+	return (TS_TST_INFO *) ASN1_dup((int (*)()) i2d_TS_TST_INFO,
+					(char *(*)()) d2i_TS_TST_INFO,
+					(char *) a);
+	}
+
+TS_TST_INFO *d2i_TS_TST_INFO_bio(BIO *bp, TS_TST_INFO **a)
+	{
+	return (TS_TST_INFO *) ASN1_d2i_bio((char *(*)()) TS_TST_INFO_new,
+					    (char *(*)()) d2i_TS_TST_INFO,
+					    bp, (unsigned char **) a);
+	}
+
+int i2d_TS_TST_INFO_bio(BIO *bp, TS_TST_INFO *a)
+	{
+	return ASN1_i2d_bio(i2d_TS_TST_INFO, bp, (unsigned char *) a);
+	}
+
+TS_TST_INFO *d2i_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO **a)
+	{
+	return (TS_TST_INFO *) ASN1_d2i_fp((char *(*)()) TS_TST_INFO_new,
+					   (char *(*)()) d2i_TS_TST_INFO,
+					   fp, (unsigned char **) a);
+	}
+
+int i2d_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO *a)
+	{
+	return ASN1_i2d_fp(i2d_TS_TST_INFO, fp, (unsigned char *) a);
+	}
+
+TS_ACCURACY *TS_ACCURACY_new()
+	{
+	TS_ACCURACY *ret;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, TS_ACCURACY);
+	ret->seconds = NULL;
+	ret->millis = NULL;
+	ret->micros = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_TS_ACCURACY_NEW);
+	}
+
+void TS_ACCURACY_free(TS_ACCURACY *a)
+	{
+	if (a == NULL) return;
+
+	M_ASN1_INTEGER_free(a->seconds);
+	M_ASN1_INTEGER_free(a->millis);
+	M_ASN1_INTEGER_free(a->micros);
+	OPENSSL_free(a);
+	}
+
+int i2d_TS_ACCURACY(TS_ACCURACY *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->seconds, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len_IMP_opt(a->millis, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_len_IMP_opt(a->micros, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->seconds, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_put_IMP_opt(a->millis, i2d_ASN1_INTEGER, 0);
+	M_ASN1_I2D_put_IMP_opt(a->micros, i2d_ASN1_INTEGER, 1);
+	M_ASN1_I2D_finish();
+	}
+
+TS_ACCURACY *d2i_TS_ACCURACY(TS_ACCURACY **a, unsigned char **pp,
+			     long length)
+	{
+	M_ASN1_D2I_vars(a, TS_ACCURACY *, TS_ACCURACY_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+
+	M_ASN1_INTEGER_free(ret->seconds);
+	ret->seconds = NULL;
+	M_ASN1_D2I_get_opt(ret->seconds, d2i_ASN1_INTEGER, V_ASN1_INTEGER);
+
+	/* FIXME: check for (1..999) value */
+	M_ASN1_INTEGER_free(ret->millis);
+	ret->millis = NULL;
+	M_ASN1_D2I_get_IMP_opt(ret->millis, d2i_ASN1_INTEGER, 0, V_ASN1_INTEGER);
+
+	/* FIXME: check for (1..999) value */
+	M_ASN1_INTEGER_free(ret->micros);
+	ret->micros = NULL;
+	M_ASN1_D2I_get_IMP_opt(ret->micros, d2i_ASN1_INTEGER, 1, V_ASN1_INTEGER);
+
+	M_ASN1_D2I_Finish(a, TS_ACCURACY_free, ASN1_F_D2I_TS_ACCURACY);
+	}
+
+TS_ACCURACY *TS_ACCURACY_dup(TS_ACCURACY *a)
+	{
+	return (TS_ACCURACY *) ASN1_dup((int (*)()) i2d_TS_ACCURACY,
+					(char *(*)()) d2i_TS_ACCURACY,
+					(char *) a);
+	}
+
+ESS_ISSUER_SERIAL *ESS_ISSUER_SERIAL_new(void)
+	{
+	ESS_ISSUER_SERIAL *ret;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, ESS_ISSUER_SERIAL);
+	M_ASN1_New(ret->issuer, GENERAL_NAMES_new);
+	M_ASN1_New(ret->serial, ASN1_INTEGER_new);
+	return ret;
+	M_ASN1_New_Error(ASN1_F_ESS_ISSUER_SERIAL_NEW);
+	}
+
+void ESS_ISSUER_SERIAL_free(ESS_ISSUER_SERIAL *a)
+	{
+	if (a == NULL) return;
+
+	GENERAL_NAMES_free(a->issuer);
+	ASN1_INTEGER_free(a->serial);
+	OPENSSL_free(a);
+	}
+
+int i2d_ESS_ISSUER_SERIAL(ESS_ISSUER_SERIAL *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->issuer, i2d_GENERAL_NAMES);
+	M_ASN1_I2D_len(a->serial, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->issuer, i2d_GENERAL_NAMES);
+	M_ASN1_I2D_put(a->serial, i2d_ASN1_INTEGER);
+	M_ASN1_I2D_finish();
+	}
+
+ESS_ISSUER_SERIAL *d2i_ESS_ISSUER_SERIAL(ESS_ISSUER_SERIAL **a,
+					 unsigned char **pp, long length)
+	{
+	M_ASN1_D2I_vars(a, ESS_ISSUER_SERIAL *, ESS_ISSUER_SERIAL_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->issuer, d2i_GENERAL_NAMES);
+	M_ASN1_D2I_get(ret->serial, d2i_ASN1_INTEGER);
+
+	M_ASN1_D2I_Finish(a, ESS_ISSUER_SERIAL_free, ASN1_F_D2I_ESS_ISSUER_SERIAL);
+	}
+
+ESS_ISSUER_SERIAL *ESS_ISSUER_SERIAL_dup(ESS_ISSUER_SERIAL *a)
+	{
+	return (ESS_ISSUER_SERIAL *) ASN1_dup((int (*)()) i2d_ESS_ISSUER_SERIAL,
+					(char *(*)()) d2i_ESS_ISSUER_SERIAL,
+					(char *) a);
+	}
+
+ESS_CERT_ID *ESS_CERT_ID_new()
+	{
+	ESS_CERT_ID *ret;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, ESS_CERT_ID);
+	M_ASN1_New(ret->hash, ASN1_OCTET_STRING_new);
+	ret->issuer_serial = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_ESS_CERT_ID_NEW);
+	}
+
+void ESS_CERT_ID_free(ESS_CERT_ID *a)
+	{
+	if (a == NULL) return;
+
+	ASN1_OCTET_STRING_free(a->hash);
+	ESS_ISSUER_SERIAL_free(a->issuer_serial);
+	OPENSSL_free(a);
+	}
+
+int i2d_ESS_CERT_ID(ESS_CERT_ID *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len(a->hash, i2d_ASN1_OCTET_STRING);
+	M_ASN1_I2D_len(a->issuer_serial, i2d_ESS_ISSUER_SERIAL);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put(a->hash, i2d_ASN1_OCTET_STRING);
+	M_ASN1_I2D_put(a->issuer_serial, i2d_ESS_ISSUER_SERIAL);
+	M_ASN1_I2D_finish();
+	}
+
+ESS_CERT_ID *d2i_ESS_CERT_ID(ESS_CERT_ID **a, unsigned char **pp,
+			     long length)
+	{
+	M_ASN1_D2I_vars(a, ESS_CERT_ID *, ESS_CERT_ID_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	M_ASN1_D2I_get(ret->hash, d2i_ASN1_OCTET_STRING);
+
+	ESS_ISSUER_SERIAL_free(ret->issuer_serial);
+	ret->issuer_serial = NULL;
+	M_ASN1_D2I_get_opt(ret->issuer_serial, d2i_ESS_ISSUER_SERIAL,
+			   V_ASN1_SEQUENCE);
+
+	M_ASN1_D2I_Finish(a, ESS_CERT_ID_free, ASN1_F_D2I_ESS_CERT_ID);
+	}
+
+ESS_CERT_ID *ESS_CERT_ID_dup(ESS_CERT_ID *a)
+	{
+	return (ESS_CERT_ID *) ASN1_dup((int (*)()) i2d_ESS_CERT_ID,
+					(char *(*)()) d2i_ESS_CERT_ID,
+					(char *) a);
+	}
+
+ESS_SIGNING_CERT *ESS_SIGNING_CERT_new(void)
+	{
+	ESS_SIGNING_CERT *ret;
+	ASN1_CTX c;
+
+	M_ASN1_New_Malloc(ret, ESS_SIGNING_CERT);
+	ret->cert_ids = NULL;
+	ret->policy_info = NULL;
+	return ret;
+	M_ASN1_New_Error(ASN1_F_ESS_SIGNING_CERT_NEW);
+	}
+
+void ESS_SIGNING_CERT_free(ESS_SIGNING_CERT *a)
+	{
+	if (a == NULL) return;
+
+	sk_ESS_CERT_ID_pop_free(a->cert_ids, ESS_CERT_ID_free);
+	sk_ESS_CERT_ID_pop_free(a->policy_info, POLICYINFO_free);
+	OPENSSL_free(a);
+	}
+
+int i2d_ESS_SIGNING_CERT(ESS_SIGNING_CERT *a, unsigned char **pp)
+	{
+	M_ASN1_I2D_vars(a);
+
+	M_ASN1_I2D_len_SEQUENCE_type(ESS_CERT_ID, a->cert_ids, i2d_ESS_CERT_ID);
+	M_ASN1_I2D_len_SEQUENCE_opt_type(POLICYINFO, a->policy_info,
+					 i2d_POLICYINFO);
+	M_ASN1_I2D_seq_total();
+
+	M_ASN1_I2D_put_SEQUENCE_type(ESS_CERT_ID, a->cert_ids, i2d_ESS_CERT_ID);
+	M_ASN1_I2D_put_SEQUENCE_opt_type(POLICYINFO, a->policy_info,
+					 i2d_POLICYINFO);
+	M_ASN1_I2D_finish();
+	}
+
+ESS_SIGNING_CERT *d2i_ESS_SIGNING_CERT(ESS_SIGNING_CERT **a,
+				       unsigned char **pp, long length)
+	{
+	M_ASN1_D2I_vars(a, ESS_SIGNING_CERT *, ESS_SIGNING_CERT_new);
+
+	M_ASN1_D2I_Init();
+	M_ASN1_D2I_start_sequence();
+	
+	sk_ESS_CERT_ID_pop_free(ret->cert_ids, ESS_CERT_ID_free);
+	ret->cert_ids = NULL;
+	M_ASN1_D2I_get_seq_type(ESS_CERT_ID, ret->cert_ids, d2i_ESS_CERT_ID,
+				ESS_CERT_ID_free);
+
+	sk_POLICYINFO_pop_free(ret->policy_info, POLICYINFO_free);
+	ret->policy_info = NULL;
+	M_ASN1_D2I_get_seq_opt_type(POLICYINFO, ret->policy_info,
+				    d2i_POLICYINFO, POLICYINFO_free);
+
+	M_ASN1_D2I_Finish(a, ESS_SIGNING_CERT_free, 
+			  ASN1_F_D2I_ESS_SIGNING_CERT);
+	}
+
+ESS_SIGNING_CERT *ESS_SIGNING_CERT_dup(ESS_SIGNING_CERT *a)
+	{
+	return (ESS_SIGNING_CERT *)ASN1_dup((int (*)()) i2d_ESS_SIGNING_CERT,
+					    (char *(*)()) d2i_ESS_SIGNING_CERT,
+					    (char *) a);
+	}
Index: openssl/crypto/bio/bio.h
diff -u openssl/crypto/bio/bio.h:1.1.1.4 openssl/crypto/bio/bio.h:1.1.1.4.2.1
--- openssl/crypto/bio/bio.h:1.1.1.4	Mon Nov  8 15:32:23 2004
+++ openssl/crypto/bio/bio.h	Mon Nov  8 16:31:07 2004
@@ -630,64 +630,61 @@
 #define BIO_F_BIO_ACCEPT				 101
 #define BIO_F_BIO_BER_GET_HEADER			 102
 #define BIO_F_BIO_CTRL					 103
-#define BIO_F_BIO_GETHOSTBYNAME				 120
-#define BIO_F_BIO_GETS					 104
-#define BIO_F_BIO_GET_ACCEPT_SOCKET			 105
-#define BIO_F_BIO_GET_HOST_IP				 106
-#define BIO_F_BIO_GET_PORT				 107
-#define BIO_F_BIO_MAKE_PAIR				 121
-#define BIO_F_BIO_NEW					 108
-#define BIO_F_BIO_NEW_FILE				 109
-#define BIO_F_BIO_NEW_MEM_BUF				 126
-#define BIO_F_BIO_NREAD					 123
-#define BIO_F_BIO_NREAD0				 124
-#define BIO_F_BIO_NWRITE				 125
-#define BIO_F_BIO_NWRITE0				 122
-#define BIO_F_BIO_PUTS					 110
-#define BIO_F_BIO_READ					 111
-#define BIO_F_BIO_SOCK_INIT				 112
-#define BIO_F_BIO_WRITE					 113
-#define BIO_F_BUFFER_CTRL				 114
-#define BIO_F_CONN_CTRL					 127
-#define BIO_F_CONN_STATE				 115
-#define BIO_F_FILE_CTRL					 116
-#define BIO_F_FILE_READ					 130
-#define BIO_F_LINEBUFFER_CTRL				 129
-#define BIO_F_MEM_READ					 128
-#define BIO_F_MEM_WRITE					 117
-#define BIO_F_SSL_NEW					 118
-#define BIO_F_WSASTARTUP				 119
+#define BIO_F_BIO_GETHOSTBYNAME				 104
+#define BIO_F_BIO_GETS					 105
+#define BIO_F_BIO_GET_ACCEPT_SOCKET			 106
+#define BIO_F_BIO_GET_HOST_IP				 107
+#define BIO_F_BIO_GET_PORT				 108
+#define BIO_F_BIO_MAKE_PAIR				 109
+#define BIO_F_BIO_NEW					 110
+#define BIO_F_BIO_NEW_FILE				 111
+#define BIO_F_BIO_NEW_MEM_BUF				 112
+#define BIO_F_BIO_NREAD					 113
+#define BIO_F_BIO_NREAD0				 114
+#define BIO_F_BIO_NWRITE				 115
+#define BIO_F_BIO_NWRITE0				 116
+#define BIO_F_BIO_PUTS					 117
+#define BIO_F_BIO_READ					 118
+#define BIO_F_BIO_SOCK_INIT				 119
+#define BIO_F_BIO_WRITE					 120
+#define BIO_F_BUFFER_CTRL				 121
+#define BIO_F_CONN_CTRL					 122
+#define BIO_F_CONN_STATE				 123
+#define BIO_F_FILE_CTRL					 124
+#define BIO_F_FILE_READ					 125
+#define BIO_F_LINEBUFFER_CTRL				 126
+#define BIO_F_MEM_WRITE					 127
+#define BIO_F_SSL_NEW					 128
 
 /* Reason codes. */
 #define BIO_R_ACCEPT_ERROR				 100
 #define BIO_R_BAD_FOPEN_MODE				 101
 #define BIO_R_BAD_HOSTNAME_LOOKUP			 102
-#define BIO_R_BROKEN_PIPE				 124
-#define BIO_R_CONNECT_ERROR				 103
-#define BIO_R_EOF_ON_MEMORY_BIO				 127
-#define BIO_R_ERROR_SETTING_NBIO			 104
-#define BIO_R_ERROR_SETTING_NBIO_ON_ACCEPTED_SOCKET	 105
-#define BIO_R_ERROR_SETTING_NBIO_ON_ACCEPT_SOCKET	 106
-#define BIO_R_GETHOSTBYNAME_ADDR_IS_NOT_AF_INET		 107
-#define BIO_R_INVALID_ARGUMENT				 125
-#define BIO_R_INVALID_IP_ADDRESS			 108
-#define BIO_R_IN_USE					 123
-#define BIO_R_KEEPALIVE					 109
-#define BIO_R_NBIO_CONNECT_ERROR			 110
-#define BIO_R_NO_ACCEPT_PORT_SPECIFIED			 111
-#define BIO_R_NO_HOSTNAME_SPECIFIED			 112
-#define BIO_R_NO_PORT_DEFINED				 113
-#define BIO_R_NO_PORT_SPECIFIED				 114
-#define BIO_R_NO_SUCH_FILE				 128
-#define BIO_R_NULL_PARAMETER				 115
-#define BIO_R_TAG_MISMATCH				 116
-#define BIO_R_UNABLE_TO_BIND_SOCKET			 117
-#define BIO_R_UNABLE_TO_CREATE_SOCKET			 118
-#define BIO_R_UNABLE_TO_LISTEN_SOCKET			 119
-#define BIO_R_UNINITIALIZED				 120
-#define BIO_R_UNSUPPORTED_METHOD			 121
+#define BIO_R_BROKEN_PIPE				 103
+#define BIO_R_CONNECT_ERROR				 104
+#define BIO_R_ERROR_SETTING_NBIO			 105
+#define BIO_R_ERROR_SETTING_NBIO_ON_ACCEPTED_SOCKET	 106
+#define BIO_R_ERROR_SETTING_NBIO_ON_ACCEPT_SOCKET	 107
+#define BIO_R_GETHOSTBYNAME_ADDR_IS_NOT_AF_INET		 108
+#define BIO_R_INVALID_ARGUMENT				 109
+#define BIO_R_INVALID_IP_ADDRESS			 110
+#define BIO_R_IN_USE					 111
+#define BIO_R_KEEPALIVE					 112
+#define BIO_R_NBIO_CONNECT_ERROR			 113
+#define BIO_R_NO_ACCEPT_PORT_SPECIFIED			 114
+#define BIO_R_NO_HOSTNAME_SPECIFIED			 115
+#define BIO_R_NO_PORT_DEFINED				 116
+#define BIO_R_NO_PORT_SPECIFIED				 117
+#define BIO_R_NO_SUCH_FILE				 118
+#define BIO_R_NULL_PARAMETER				 119
+#define BIO_R_TAG_MISMATCH				 120
+#define BIO_R_UNABLE_TO_BIND_SOCKET			 121
+#define BIO_R_UNABLE_TO_CREATE_SOCKET			 122
+#define BIO_R_UNABLE_TO_LISTEN_SOCKET			 123
+#define BIO_R_UNINITIALIZED				 124
+#define BIO_R_UNSUPPORTED_METHOD			 125
 #define BIO_R_WRITE_TO_READ_ONLY_BIO			 126
-#define BIO_R_WSASTARTUP				 122
+#define BIO_R_WSASTARTUP				 127
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/bio/bio_err.c
diff -u openssl/crypto/bio/bio_err.c:1.1.1.2 openssl/crypto/bio/bio_err.c:1.1.1.2.12.1
--- openssl/crypto/bio/bio_err.c:1.1.1.2	Fri Jan 17 22:07:45 2003
+++ openssl/crypto/bio/bio_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/bio/bio_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -93,10 +93,8 @@
 {ERR_PACK(0,BIO_F_FILE_CTRL,0),	"FILE_CTRL"},
 {ERR_PACK(0,BIO_F_FILE_READ,0),	"FILE_READ"},
 {ERR_PACK(0,BIO_F_LINEBUFFER_CTRL,0),	"LINEBUFFER_CTRL"},
-{ERR_PACK(0,BIO_F_MEM_READ,0),	"MEM_READ"},
 {ERR_PACK(0,BIO_F_MEM_WRITE,0),	"MEM_WRITE"},
 {ERR_PACK(0,BIO_F_SSL_NEW,0),	"SSL_new"},
-{ERR_PACK(0,BIO_F_WSASTARTUP,0),	"WSASTARTUP"},
 {0,NULL}
 	};
 
@@ -107,7 +105,6 @@
 {BIO_R_BAD_HOSTNAME_LOOKUP               ,"bad hostname lookup"},
 {BIO_R_BROKEN_PIPE                       ,"broken pipe"},
 {BIO_R_CONNECT_ERROR                     ,"connect error"},
-{BIO_R_EOF_ON_MEMORY_BIO                 ,"EOF on memory BIO"},
 {BIO_R_ERROR_SETTING_NBIO                ,"error setting nbio"},
 {BIO_R_ERROR_SETTING_NBIO_ON_ACCEPTED_SOCKET,"error setting nbio on accepted socket"},
 {BIO_R_ERROR_SETTING_NBIO_ON_ACCEPT_SOCKET,"error setting nbio on accept socket"},
@@ -129,8 +126,8 @@
 {BIO_R_UNABLE_TO_LISTEN_SOCKET           ,"unable to listen socket"},
 {BIO_R_UNINITIALIZED                     ,"uninitialized"},
 {BIO_R_UNSUPPORTED_METHOD                ,"unsupported method"},
-{BIO_R_WRITE_TO_READ_ONLY_BIO            ,"write to read only BIO"},
-{BIO_R_WSASTARTUP                        ,"WSAStartup"},
+{BIO_R_WRITE_TO_READ_ONLY_BIO            ,"write to read only bio"},
+{BIO_R_WSASTARTUP                        ,"wsastartup"},
 {0,NULL}
 	};
 
Index: openssl/crypto/bn/bn.h
diff -u openssl/crypto/bn/bn.h:1.1.1.4 openssl/crypto/bn/bn.h:1.1.1.4.8.1
--- openssl/crypto/bn/bn.h:1.1.1.4	Tue May  6 21:29:13 2003
+++ openssl/crypto/bn/bn.h	Mon Nov  8 16:31:07 2004
@@ -507,41 +507,40 @@
 #define BN_F_BN_BLINDING_UPDATE				 103
 #define BN_F_BN_BN2DEC					 104
 #define BN_F_BN_BN2HEX					 105
-#define BN_F_BN_CTX_GET					 116
-#define BN_F_BN_CTX_NEW					 106
-#define BN_F_BN_DIV					 107
-#define BN_F_BN_EXPAND2					 108
-#define BN_F_BN_EXPAND_INTERNAL				 120
-#define BN_F_BN_MOD_EXP2_MONT				 118
-#define BN_F_BN_MOD_EXP_MONT				 109
-#define BN_F_BN_MOD_EXP_MONT_WORD			 117
-#define BN_F_BN_MOD_INVERSE				 110
-#define BN_F_BN_MOD_LSHIFT_QUICK			 119
-#define BN_F_BN_MOD_MUL_RECIPROCAL			 111
-#define BN_F_BN_MOD_SQRT				 121
-#define BN_F_BN_MPI2BN					 112
-#define BN_F_BN_NEW					 113
-#define BN_F_BN_RAND					 114
-#define BN_F_BN_RAND_RANGE				 122
-#define BN_F_BN_USUB					 115
+#define BN_F_BN_CTX_GET					 106
+#define BN_F_BN_CTX_NEW					 107
+#define BN_F_BN_DIV					 108
+#define BN_F_BN_EXPAND_INTERNAL				 109
+#define BN_F_BN_MOD_EXP2_MONT				 110
+#define BN_F_BN_MOD_EXP_MONT				 111
+#define BN_F_BN_MOD_EXP_MONT_WORD			 112
+#define BN_F_BN_MOD_INVERSE				 113
+#define BN_F_BN_MOD_LSHIFT_QUICK			 114
+#define BN_F_BN_MOD_MUL_RECIPROCAL			 115
+#define BN_F_BN_MOD_SQRT				 116
+#define BN_F_BN_MPI2BN					 117
+#define BN_F_BN_NEW					 118
+#define BN_F_BN_RAND					 119
+#define BN_F_BN_RAND_RANGE				 120
+#define BN_F_BN_USUB					 121
 
 /* Reason codes. */
 #define BN_R_ARG2_LT_ARG3				 100
 #define BN_R_BAD_RECIPROCAL				 101
-#define BN_R_BIGNUM_TOO_LONG				 114
-#define BN_R_CALLED_WITH_EVEN_MODULUS			 102
-#define BN_R_DIV_BY_ZERO				 103
-#define BN_R_ENCODING_ERROR				 104
-#define BN_R_EXPAND_ON_STATIC_BIGNUM_DATA		 105
-#define BN_R_INPUT_NOT_REDUCED				 110
-#define BN_R_INVALID_LENGTH				 106
-#define BN_R_INVALID_RANGE				 115
-#define BN_R_NOT_A_SQUARE				 111
-#define BN_R_NOT_INITIALIZED				 107
-#define BN_R_NO_INVERSE					 108
-#define BN_R_P_IS_NOT_PRIME				 112
-#define BN_R_TOO_MANY_ITERATIONS			 113
-#define BN_R_TOO_MANY_TEMPORARY_VARIABLES		 109
+#define BN_R_BIGNUM_TOO_LONG				 102
+#define BN_R_CALLED_WITH_EVEN_MODULUS			 103
+#define BN_R_DIV_BY_ZERO				 104
+#define BN_R_ENCODING_ERROR				 105
+#define BN_R_EXPAND_ON_STATIC_BIGNUM_DATA		 106
+#define BN_R_INPUT_NOT_REDUCED				 107
+#define BN_R_INVALID_LENGTH				 108
+#define BN_R_INVALID_RANGE				 109
+#define BN_R_NOT_A_SQUARE				 110
+#define BN_R_NOT_INITIALIZED				 111
+#define BN_R_NO_INVERSE					 112
+#define BN_R_P_IS_NOT_PRIME				 113
+#define BN_R_TOO_MANY_ITERATIONS			 114
+#define BN_R_TOO_MANY_TEMPORARY_VARIABLES		 115
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/bn/bn_err.c
diff -u openssl/crypto/bn/bn_err.c:1.1.1.2 openssl/crypto/bn/bn_err.c:1.1.1.2.12.1
--- openssl/crypto/bn/bn_err.c:1.1.1.2	Fri Jan 17 22:07:47 2003
+++ openssl/crypto/bn/bn_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/bn/bn_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -75,7 +75,6 @@
 {ERR_PACK(0,BN_F_BN_CTX_GET,0),	"BN_CTX_get"},
 {ERR_PACK(0,BN_F_BN_CTX_NEW,0),	"BN_CTX_new"},
 {ERR_PACK(0,BN_F_BN_DIV,0),	"BN_div"},
-{ERR_PACK(0,BN_F_BN_EXPAND2,0),	"bn_expand2"},
 {ERR_PACK(0,BN_F_BN_EXPAND_INTERNAL,0),	"BN_EXPAND_INTERNAL"},
 {ERR_PACK(0,BN_F_BN_MOD_EXP2_MONT,0),	"BN_mod_exp2_mont"},
 {ERR_PACK(0,BN_F_BN_MOD_EXP_MONT,0),	"BN_mod_exp_mont"},
Index: openssl/crypto/buffer/buf_err.c
diff -u openssl/crypto/buffer/buf_err.c:1.1.1.2 openssl/crypto/buffer/buf_err.c:1.1.1.2.12.1
--- openssl/crypto/buffer/buf_err.c:1.1.1.2	Fri Jan 17 22:07:52 2003
+++ openssl/crypto/buffer/buf_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/buffer/buf_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
Index: openssl/crypto/conf/conf.h
diff -u openssl/crypto/conf/conf.h:1.1.1.2 openssl/crypto/conf/conf.h:1.1.1.2.12.1
--- openssl/crypto/conf/conf.h:1.1.1.2	Fri Jan 17 22:07:52 2003
+++ openssl/crypto/conf/conf.h	Mon Nov  8 16:31:07 2004
@@ -207,42 +207,40 @@
 /* Error codes for the CONF functions. */
 
 /* Function codes. */
-#define CONF_F_CONF_DUMP_FP				 104
-#define CONF_F_CONF_LOAD				 100
+#define CONF_F_CONF_DUMP_FP				 100
+#define CONF_F_CONF_LOAD				 101
 #define CONF_F_CONF_LOAD_BIO				 102
 #define CONF_F_CONF_LOAD_FP				 103
-#define CONF_F_CONF_MODULES_LOAD			 116
-#define CONF_F_MODULE_INIT				 115
-#define CONF_F_MODULE_LOAD_DSO				 117
-#define CONF_F_MODULE_RUN				 118
-#define CONF_F_NCONF_DUMP_BIO				 105
-#define CONF_F_NCONF_DUMP_FP				 106
-#define CONF_F_NCONF_GET_NUMBER				 107
-#define CONF_F_NCONF_GET_NUMBER_E			 112
-#define CONF_F_NCONF_GET_SECTION			 108
-#define CONF_F_NCONF_GET_STRING				 109
+#define CONF_F_CONF_MODULES_LOAD			 104
+#define CONF_F_MODULE_INIT				 105
+#define CONF_F_MODULE_LOAD_DSO				 106
+#define CONF_F_MODULE_RUN				 107
+#define CONF_F_NCONF_DUMP_BIO				 108
+#define CONF_F_NCONF_DUMP_FP				 109
+#define CONF_F_NCONF_GET_NUMBER_E			 110
+#define CONF_F_NCONF_GET_SECTION			 111
+#define CONF_F_NCONF_GET_STRING				 112
 #define CONF_F_NCONF_LOAD				 113
-#define CONF_F_NCONF_LOAD_BIO				 110
-#define CONF_F_NCONF_LOAD_FP				 114
-#define CONF_F_NCONF_NEW				 111
-#define CONF_F_STR_COPY					 101
+#define CONF_F_NCONF_LOAD_BIO				 114
+#define CONF_F_NCONF_LOAD_FP				 115
+#define CONF_F_NCONF_NEW				 116
+#define CONF_F_STR_COPY					 117
 
 /* Reason codes. */
-#define CONF_R_ERROR_LOADING_DSO			 110
-#define CONF_R_MISSING_CLOSE_SQUARE_BRACKET		 100
-#define CONF_R_MISSING_EQUAL_SIGN			 101
-#define CONF_R_MISSING_FINISH_FUNCTION			 111
-#define CONF_R_MISSING_INIT_FUNCTION			 112
-#define CONF_R_MODULE_INITIALIZATION_ERROR		 109
-#define CONF_R_NO_CLOSE_BRACE				 102
-#define CONF_R_NO_CONF					 105
-#define CONF_R_NO_CONF_OR_ENVIRONMENT_VARIABLE		 106
-#define CONF_R_NO_SECTION				 107
-#define CONF_R_NO_SUCH_FILE				 114
-#define CONF_R_NO_VALUE					 108
-#define CONF_R_UNABLE_TO_CREATE_NEW_SECTION		 103
-#define CONF_R_UNKNOWN_MODULE_NAME			 113
-#define CONF_R_VARIABLE_HAS_NO_VALUE			 104
+#define CONF_R_ERROR_LOADING_DSO			 100
+#define CONF_R_MISSING_CLOSE_SQUARE_BRACKET		 101
+#define CONF_R_MISSING_EQUAL_SIGN			 102
+#define CONF_R_MISSING_INIT_FUNCTION			 103
+#define CONF_R_MODULE_INITIALIZATION_ERROR		 104
+#define CONF_R_NO_CLOSE_BRACE				 105
+#define CONF_R_NO_CONF					 106
+#define CONF_R_NO_CONF_OR_ENVIRONMENT_VARIABLE		 107
+#define CONF_R_NO_SECTION				 108
+#define CONF_R_NO_SUCH_FILE				 109
+#define CONF_R_NO_VALUE					 110
+#define CONF_R_UNABLE_TO_CREATE_NEW_SECTION		 111
+#define CONF_R_UNKNOWN_MODULE_NAME			 112
+#define CONF_R_VARIABLE_HAS_NO_VALUE			 113
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/conf/conf_err.c
diff -u openssl/crypto/conf/conf_err.c:1.1.1.2 openssl/crypto/conf/conf_err.c:1.1.1.2.12.1
--- openssl/crypto/conf/conf_err.c:1.1.1.2	Fri Jan 17 22:07:52 2003
+++ openssl/crypto/conf/conf_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/conf/conf_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -76,7 +76,6 @@
 {ERR_PACK(0,CONF_F_MODULE_RUN,0),	"MODULE_RUN"},
 {ERR_PACK(0,CONF_F_NCONF_DUMP_BIO,0),	"NCONF_dump_bio"},
 {ERR_PACK(0,CONF_F_NCONF_DUMP_FP,0),	"NCONF_dump_fp"},
-{ERR_PACK(0,CONF_F_NCONF_GET_NUMBER,0),	"NCONF_get_number"},
 {ERR_PACK(0,CONF_F_NCONF_GET_NUMBER_E,0),	"NCONF_get_number_e"},
 {ERR_PACK(0,CONF_F_NCONF_GET_SECTION,0),	"NCONF_get_section"},
 {ERR_PACK(0,CONF_F_NCONF_GET_STRING,0),	"NCONF_get_string"},
@@ -93,7 +92,6 @@
 {CONF_R_ERROR_LOADING_DSO                ,"error loading dso"},
 {CONF_R_MISSING_CLOSE_SQUARE_BRACKET     ,"missing close square bracket"},
 {CONF_R_MISSING_EQUAL_SIGN               ,"missing equal sign"},
-{CONF_R_MISSING_FINISH_FUNCTION          ,"missing finish function"},
 {CONF_R_MISSING_INIT_FUNCTION            ,"missing init function"},
 {CONF_R_MODULE_INITIALIZATION_ERROR      ,"module initialization error"},
 {CONF_R_NO_CLOSE_BRACE                   ,"no close brace"},
Index: openssl/crypto/dh/dh.h
diff -u openssl/crypto/dh/dh.h:1.1.1.3 openssl/crypto/dh/dh.h:1.1.1.3.12.1
--- openssl/crypto/dh/dh.h:1.1.1.3	Fri Jan 17 22:07:53 2003
+++ openssl/crypto/dh/dh.h	Mon Nov  8 16:31:07 2004
@@ -198,8 +198,8 @@
 #define DH_F_DH_NEW_METHOD				 105
 
 /* Reason codes. */
-#define DH_R_BAD_GENERATOR				 101
-#define DH_R_NO_PRIVATE_VALUE				 100
+#define DH_R_BAD_GENERATOR				 100
+#define DH_R_NO_PRIVATE_VALUE				 101
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/dsa/dsa.h
diff -u openssl/crypto/dsa/dsa.h:1.1.1.4 openssl/crypto/dsa/dsa.h:1.1.1.4.2.1
--- openssl/crypto/dsa/dsa.h:1.1.1.4	Mon Nov  8 15:32:27 2004
+++ openssl/crypto/dsa/dsa.h	Mon Nov  8 16:31:07 2004
@@ -229,20 +229,15 @@
 /* Error codes for the DSA functions. */
 
 /* Function codes. */
-#define DSA_F_D2I_DSA_SIG				 110
 #define DSA_F_DSAPARAMS_PRINT				 100
 #define DSA_F_DSAPARAMS_PRINT_FP			 101
-#define DSA_F_DSA_DO_SIGN				 112
-#define DSA_F_DSA_DO_VERIFY				 113
-#define DSA_F_DSA_NEW_METHOD				 103
-#define DSA_F_DSA_PRINT					 104
-#define DSA_F_DSA_PRINT_FP				 105
-#define DSA_F_DSA_SIGN					 106
+#define DSA_F_DSA_DO_SIGN				 102
+#define DSA_F_DSA_DO_VERIFY				 103
+#define DSA_F_DSA_NEW_METHOD				 104
+#define DSA_F_DSA_PRINT					 105
+#define DSA_F_DSA_PRINT_FP				 106
 #define DSA_F_DSA_SIGN_SETUP				 107
-#define DSA_F_DSA_SIG_NEW				 109
-#define DSA_F_DSA_VERIFY				 108
-#define DSA_F_I2D_DSA_SIG				 111
-#define DSA_F_SIG_CB					 114
+#define DSA_F_SIG_CB					 108
 
 /* Reason codes. */
 #define DSA_R_DATA_TOO_LARGE_FOR_KEY_SIZE		 100
Index: openssl/crypto/dsa/dsa_err.c
diff -u openssl/crypto/dsa/dsa_err.c:1.1.1.2 openssl/crypto/dsa/dsa_err.c:1.1.1.2.12.1
--- openssl/crypto/dsa/dsa_err.c:1.1.1.2	Fri Jan 17 22:07:53 2003
+++ openssl/crypto/dsa/dsa_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/dsa/dsa_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -66,7 +66,6 @@
 #ifndef OPENSSL_NO_ERR
 static ERR_STRING_DATA DSA_str_functs[]=
 	{
-{ERR_PACK(0,DSA_F_D2I_DSA_SIG,0),	"d2i_DSA_SIG"},
 {ERR_PACK(0,DSA_F_DSAPARAMS_PRINT,0),	"DSAparams_print"},
 {ERR_PACK(0,DSA_F_DSAPARAMS_PRINT_FP,0),	"DSAparams_print_fp"},
 {ERR_PACK(0,DSA_F_DSA_DO_SIGN,0),	"DSA_do_sign"},
@@ -74,11 +73,7 @@
 {ERR_PACK(0,DSA_F_DSA_NEW_METHOD,0),	"DSA_new_method"},
 {ERR_PACK(0,DSA_F_DSA_PRINT,0),	"DSA_print"},
 {ERR_PACK(0,DSA_F_DSA_PRINT_FP,0),	"DSA_print_fp"},
-{ERR_PACK(0,DSA_F_DSA_SIGN,0),	"DSA_sign"},
 {ERR_PACK(0,DSA_F_DSA_SIGN_SETUP,0),	"DSA_sign_setup"},
-{ERR_PACK(0,DSA_F_DSA_SIG_NEW,0),	"DSA_SIG_new"},
-{ERR_PACK(0,DSA_F_DSA_VERIFY,0),	"DSA_verify"},
-{ERR_PACK(0,DSA_F_I2D_DSA_SIG,0),	"i2d_DSA_SIG"},
 {ERR_PACK(0,DSA_F_SIG_CB,0),	"SIG_CB"},
 {0,NULL}
 	};
Index: openssl/crypto/dso/dso.h
diff -u openssl/crypto/dso/dso.h:1.1.1.2 openssl/crypto/dso/dso.h:1.1.1.2.12.1
--- openssl/crypto/dso/dso.h:1.1.1.2	Fri Jan 17 22:07:54 2003
+++ openssl/crypto/dso/dso.h	Mon Nov  8 16:31:07 2004
@@ -273,48 +273,48 @@
 #define DSO_F_DLFCN_BIND_FUNC				 100
 #define DSO_F_DLFCN_BIND_VAR				 101
 #define DSO_F_DLFCN_LOAD				 102
-#define DSO_F_DLFCN_NAME_CONVERTER			 123
-#define DSO_F_DLFCN_UNLOAD				 103
-#define DSO_F_DL_BIND_FUNC				 104
-#define DSO_F_DL_BIND_VAR				 105
-#define DSO_F_DL_LOAD					 106
-#define DSO_F_DL_NAME_CONVERTER				 124
-#define DSO_F_DL_UNLOAD					 107
-#define DSO_F_DSO_BIND_FUNC				 108
-#define DSO_F_DSO_BIND_VAR				 109
-#define DSO_F_DSO_CONVERT_FILENAME			 126
-#define DSO_F_DSO_CTRL					 110
-#define DSO_F_DSO_FREE					 111
-#define DSO_F_DSO_GET_FILENAME				 127
-#define DSO_F_DSO_GET_LOADED_FILENAME			 128
-#define DSO_F_DSO_LOAD					 112
-#define DSO_F_DSO_NEW_METHOD				 113
-#define DSO_F_DSO_SET_FILENAME				 129
-#define DSO_F_DSO_SET_NAME_CONVERTER			 122
-#define DSO_F_DSO_UP_REF				 114
-#define DSO_F_VMS_BIND_VAR				 115
-#define DSO_F_VMS_LOAD					 116
-#define DSO_F_VMS_UNLOAD				 117
-#define DSO_F_WIN32_BIND_FUNC				 118
-#define DSO_F_WIN32_BIND_VAR				 119
-#define DSO_F_WIN32_LOAD				 120
-#define DSO_F_WIN32_NAME_CONVERTER			 125
-#define DSO_F_WIN32_UNLOAD				 121
+#define DSO_F_DLFCN_NAME_CONVERTER			 103
+#define DSO_F_DLFCN_UNLOAD				 104
+#define DSO_F_DL_BIND_FUNC				 105
+#define DSO_F_DL_BIND_VAR				 106
+#define DSO_F_DL_LOAD					 107
+#define DSO_F_DL_NAME_CONVERTER				 108
+#define DSO_F_DL_UNLOAD					 109
+#define DSO_F_DSO_BIND_FUNC				 110
+#define DSO_F_DSO_BIND_VAR				 111
+#define DSO_F_DSO_CONVERT_FILENAME			 112
+#define DSO_F_DSO_CTRL					 113
+#define DSO_F_DSO_FREE					 114
+#define DSO_F_DSO_GET_FILENAME				 115
+#define DSO_F_DSO_GET_LOADED_FILENAME			 116
+#define DSO_F_DSO_LOAD					 117
+#define DSO_F_DSO_NEW_METHOD				 118
+#define DSO_F_DSO_SET_FILENAME				 119
+#define DSO_F_DSO_SET_NAME_CONVERTER			 120
+#define DSO_F_DSO_UP_REF				 121
+#define DSO_F_VMS_BIND_VAR				 122
+#define DSO_F_VMS_LOAD					 123
+#define DSO_F_VMS_UNLOAD				 124
+#define DSO_F_WIN32_BIND_FUNC				 125
+#define DSO_F_WIN32_BIND_VAR				 126
+#define DSO_F_WIN32_LOAD				 127
+#define DSO_F_WIN32_NAME_CONVERTER			 128
+#define DSO_F_WIN32_UNLOAD				 129
 
 /* Reason codes. */
 #define DSO_R_CTRL_FAILED				 100
-#define DSO_R_DSO_ALREADY_LOADED			 110
-#define DSO_R_FILENAME_TOO_BIG				 101
-#define DSO_R_FINISH_FAILED				 102
-#define DSO_R_LOAD_FAILED				 103
-#define DSO_R_NAME_TRANSLATION_FAILED			 109
-#define DSO_R_NO_FILENAME				 111
-#define DSO_R_NULL_HANDLE				 104
-#define DSO_R_SET_FILENAME_FAILED			 112
-#define DSO_R_STACK_ERROR				 105
-#define DSO_R_SYM_FAILURE				 106
-#define DSO_R_UNLOAD_FAILED				 107
-#define DSO_R_UNSUPPORTED				 108
+#define DSO_R_DSO_ALREADY_LOADED			 101
+#define DSO_R_FILENAME_TOO_BIG				 102
+#define DSO_R_FINISH_FAILED				 103
+#define DSO_R_LOAD_FAILED				 104
+#define DSO_R_NAME_TRANSLATION_FAILED			 105
+#define DSO_R_NO_FILENAME				 106
+#define DSO_R_NULL_HANDLE				 107
+#define DSO_R_SET_FILENAME_FAILED			 108
+#define DSO_R_STACK_ERROR				 109
+#define DSO_R_SYM_FAILURE				 110
+#define DSO_R_UNLOAD_FAILED				 111
+#define DSO_R_UNSUPPORTED				 112
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/dso/dso_err.c
diff -u openssl/crypto/dso/dso_err.c:1.1.1.2 openssl/crypto/dso/dso_err.c:1.1.1.2.12.1
--- openssl/crypto/dso/dso_err.c:1.1.1.2	Fri Jan 17 22:07:54 2003
+++ openssl/crypto/dso/dso_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/dso/dso_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -101,19 +101,19 @@
 
 static ERR_STRING_DATA DSO_str_reasons[]=
 	{
-{DSO_R_CTRL_FAILED                       ,"control command failed"},
+{DSO_R_CTRL_FAILED                       ,"ctrl failed"},
 {DSO_R_DSO_ALREADY_LOADED                ,"dso already loaded"},
 {DSO_R_FILENAME_TOO_BIG                  ,"filename too big"},
-{DSO_R_FINISH_FAILED                     ,"cleanup method function failed"},
-{DSO_R_LOAD_FAILED                       ,"could not load the shared library"},
+{DSO_R_FINISH_FAILED                     ,"finish failed"},
+{DSO_R_LOAD_FAILED                       ,"load failed"},
 {DSO_R_NAME_TRANSLATION_FAILED           ,"name translation failed"},
 {DSO_R_NO_FILENAME                       ,"no filename"},
-{DSO_R_NULL_HANDLE                       ,"a null shared library handle was used"},
+{DSO_R_NULL_HANDLE                       ,"null handle"},
 {DSO_R_SET_FILENAME_FAILED               ,"set filename failed"},
-{DSO_R_STACK_ERROR                       ,"the meth_data stack is corrupt"},
-{DSO_R_SYM_FAILURE                       ,"could not bind to the requested symbol name"},
-{DSO_R_UNLOAD_FAILED                     ,"could not unload the shared library"},
-{DSO_R_UNSUPPORTED                       ,"functionality not supported"},
+{DSO_R_STACK_ERROR                       ,"stack error"},
+{DSO_R_SYM_FAILURE                       ,"sym failure"},
+{DSO_R_UNLOAD_FAILED                     ,"unload failed"},
+{DSO_R_UNSUPPORTED                       ,"unsupported"},
 {0,NULL}
 	};
 
Index: openssl/crypto/ec/ec.h
diff -u openssl/crypto/ec/ec.h:1.1.1.2 openssl/crypto/ec/ec.h:1.1.1.2.10.1
--- openssl/crypto/ec/ec.h:1.1.1.2	Sat Feb 22 13:28:09 2003
+++ openssl/crypto/ec/ec.h	Mon Nov  8 16:31:07 2004
@@ -177,65 +177,64 @@
 /* Error codes for the EC functions. */
 
 /* Function codes. */
-#define EC_F_COMPUTE_WNAF				 143
-#define EC_F_EC_GFP_MONT_FIELD_DECODE			 133
-#define EC_F_EC_GFP_MONT_FIELD_ENCODE			 134
-#define EC_F_EC_GFP_MONT_FIELD_MUL			 131
-#define EC_F_EC_GFP_MONT_FIELD_SQR			 132
-#define EC_F_EC_GFP_SIMPLE_GROUP_SET_CURVE_GFP		 100
-#define EC_F_EC_GFP_SIMPLE_GROUP_SET_GENERATOR		 101
-#define EC_F_EC_GFP_SIMPLE_MAKE_AFFINE			 102
-#define EC_F_EC_GFP_SIMPLE_OCT2POINT			 103
-#define EC_F_EC_GFP_SIMPLE_POINT2OCT			 104
-#define EC_F_EC_GFP_SIMPLE_POINTS_MAKE_AFFINE		 137
-#define EC_F_EC_GFP_SIMPLE_POINT_GET_AFFINE_COORDINATES_GFP 105
-#define EC_F_EC_GFP_SIMPLE_POINT_SET_AFFINE_COORDINATES_GFP 128
-#define EC_F_EC_GFP_SIMPLE_SET_COMPRESSED_COORDINATES_GFP 129
-#define EC_F_EC_GROUP_COPY				 106
-#define EC_F_EC_GROUP_GET0_GENERATOR			 139
-#define EC_F_EC_GROUP_GET_COFACTOR			 140
-#define EC_F_EC_GROUP_GET_CURVE_GFP			 130
-#define EC_F_EC_GROUP_GET_ORDER				 141
-#define EC_F_EC_GROUP_NEW				 108
-#define EC_F_EC_GROUP_PRECOMPUTE_MULT			 142
-#define EC_F_EC_GROUP_SET_CURVE_GFP			 109
-#define EC_F_EC_GROUP_SET_EXTRA_DATA			 110
-#define EC_F_EC_GROUP_SET_GENERATOR			 111
-#define EC_F_EC_POINTS_MAKE_AFFINE			 136
-#define EC_F_EC_POINTS_MUL				 138
-#define EC_F_EC_POINT_ADD				 112
-#define EC_F_EC_POINT_CMP				 113
-#define EC_F_EC_POINT_COPY				 114
-#define EC_F_EC_POINT_DBL				 115
-#define EC_F_EC_POINT_GET_AFFINE_COORDINATES_GFP	 116
-#define EC_F_EC_POINT_GET_JPROJECTIVE_COORDINATES_GFP	 117
-#define EC_F_EC_POINT_IS_AT_INFINITY			 118
-#define EC_F_EC_POINT_IS_ON_CURVE			 119
-#define EC_F_EC_POINT_MAKE_AFFINE			 120
-#define EC_F_EC_POINT_NEW				 121
-#define EC_F_EC_POINT_OCT2POINT				 122
-#define EC_F_EC_POINT_POINT2OCT				 123
-#define EC_F_EC_POINT_SET_AFFINE_COORDINATES_GFP	 124
-#define EC_F_EC_POINT_SET_COMPRESSED_COORDINATES_GFP	 125
-#define EC_F_EC_POINT_SET_JPROJECTIVE_COORDINATES_GFP	 126
-#define EC_F_EC_POINT_SET_TO_INFINITY			 127
-#define EC_F_GFP_MONT_GROUP_SET_CURVE_GFP		 135
+#define EC_F_COMPUTE_WNAF				 100
+#define EC_F_EC_GFP_MONT_FIELD_DECODE			 101
+#define EC_F_EC_GFP_MONT_FIELD_ENCODE			 102
+#define EC_F_EC_GFP_MONT_FIELD_MUL			 103
+#define EC_F_EC_GFP_MONT_FIELD_SQR			 104
+#define EC_F_EC_GFP_SIMPLE_GROUP_SET_CURVE_GFP		 105
+#define EC_F_EC_GFP_SIMPLE_GROUP_SET_GENERATOR		 106
+#define EC_F_EC_GFP_SIMPLE_MAKE_AFFINE			 107
+#define EC_F_EC_GFP_SIMPLE_OCT2POINT			 108
+#define EC_F_EC_GFP_SIMPLE_POINT2OCT			 109
+#define EC_F_EC_GFP_SIMPLE_POINTS_MAKE_AFFINE		 110
+#define EC_F_EC_GFP_SIMPLE_POINT_GET_AFFINE_COORDINATES_GFP 111
+#define EC_F_EC_GFP_SIMPLE_POINT_SET_AFFINE_COORDINATES_GFP 112
+#define EC_F_EC_GFP_SIMPLE_SET_COMPRESSED_COORDINATES_GFP 113
+#define EC_F_EC_GROUP_COPY				 114
+#define EC_F_EC_GROUP_GET0_GENERATOR			 115
+#define EC_F_EC_GROUP_GET_COFACTOR			 116
+#define EC_F_EC_GROUP_GET_CURVE_GFP			 117
+#define EC_F_EC_GROUP_GET_ORDER				 118
+#define EC_F_EC_GROUP_NEW				 119
+#define EC_F_EC_GROUP_PRECOMPUTE_MULT			 120
+#define EC_F_EC_GROUP_SET_CURVE_GFP			 121
+#define EC_F_EC_GROUP_SET_EXTRA_DATA			 122
+#define EC_F_EC_GROUP_SET_GENERATOR			 123
+#define EC_F_EC_POINTS_MAKE_AFFINE			 124
+#define EC_F_EC_POINTS_MUL				 125
+#define EC_F_EC_POINT_ADD				 126
+#define EC_F_EC_POINT_CMP				 127
+#define EC_F_EC_POINT_COPY				 128
+#define EC_F_EC_POINT_DBL				 129
+#define EC_F_EC_POINT_GET_AFFINE_COORDINATES_GFP	 130
+#define EC_F_EC_POINT_GET_JPROJECTIVE_COORDINATES_GFP	 131
+#define EC_F_EC_POINT_IS_AT_INFINITY			 132
+#define EC_F_EC_POINT_IS_ON_CURVE			 133
+#define EC_F_EC_POINT_MAKE_AFFINE			 134
+#define EC_F_EC_POINT_NEW				 135
+#define EC_F_EC_POINT_OCT2POINT				 136
+#define EC_F_EC_POINT_POINT2OCT				 137
+#define EC_F_EC_POINT_SET_AFFINE_COORDINATES_GFP	 138
+#define EC_F_EC_POINT_SET_COMPRESSED_COORDINATES_GFP	 139
+#define EC_F_EC_POINT_SET_JPROJECTIVE_COORDINATES_GFP	 140
+#define EC_F_EC_POINT_SET_TO_INFINITY			 141
+#define EC_F_GFP_MONT_GROUP_SET_CURVE_GFP		 142
 
 /* Reason codes. */
 #define EC_R_BUFFER_TOO_SMALL				 100
 #define EC_R_INCOMPATIBLE_OBJECTS			 101
-#define EC_R_INVALID_ARGUMENT				 112
-#define EC_R_INVALID_COMPRESSED_POINT			 110
-#define EC_R_INVALID_COMPRESSION_BIT			 109
-#define EC_R_INVALID_ENCODING				 102
-#define EC_R_INVALID_FIELD				 103
-#define EC_R_INVALID_FORM				 104
-#define EC_R_NOT_INITIALIZED				 111
-#define EC_R_POINT_AT_INFINITY				 106
-#define EC_R_POINT_IS_NOT_ON_CURVE			 107
-#define EC_R_SLOT_FULL					 108
-#define EC_R_UNDEFINED_GENERATOR			 113
-#define EC_R_UNKNOWN_ORDER				 114
+#define EC_R_INVALID_COMPRESSED_POINT			 102
+#define EC_R_INVALID_COMPRESSION_BIT			 103
+#define EC_R_INVALID_ENCODING				 104
+#define EC_R_INVALID_FIELD				 105
+#define EC_R_INVALID_FORM				 106
+#define EC_R_NOT_INITIALIZED				 107
+#define EC_R_POINT_AT_INFINITY				 108
+#define EC_R_POINT_IS_NOT_ON_CURVE			 109
+#define EC_R_SLOT_FULL					 110
+#define EC_R_UNDEFINED_GENERATOR			 111
+#define EC_R_UNKNOWN_ORDER				 112
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/ec/ec_err.c
diff -u openssl/crypto/ec/ec_err.c:1.1.1.2 openssl/crypto/ec/ec_err.c:1.1.1.2.10.1
--- openssl/crypto/ec/ec_err.c:1.1.1.2	Sat Feb 22 13:28:09 2003
+++ openssl/crypto/ec/ec_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/ec/ec_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -116,7 +116,6 @@
 	{
 {EC_R_BUFFER_TOO_SMALL                   ,"buffer too small"},
 {EC_R_INCOMPATIBLE_OBJECTS               ,"incompatible objects"},
-{EC_R_INVALID_ARGUMENT                   ,"invalid argument"},
 {EC_R_INVALID_COMPRESSED_POINT           ,"invalid compressed point"},
 {EC_R_INVALID_COMPRESSION_BIT            ,"invalid compression bit"},
 {EC_R_INVALID_ENCODING                   ,"invalid encoding"},
Index: openssl/crypto/engine/eng_err.c
diff -u openssl/crypto/engine/eng_err.c:1.1.1.1 openssl/crypto/engine/eng_err.c:1.1.1.1.12.1
--- openssl/crypto/engine/eng_err.c:1.1.1.1	Fri Jan 17 22:07:54 2003
+++ openssl/crypto/engine/eng_err.c	Mon Nov  8 16:31:07 2004
@@ -1,6 +1,6 @@
 /* crypto/engine/eng_err.c */
 /* ====================================================================
- * Copyright (c) 1999-2002 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -78,7 +78,6 @@
 {ERR_PACK(0,ENGINE_F_ENGINE_FINISH,0),	"ENGINE_finish"},
 {ERR_PACK(0,ENGINE_F_ENGINE_FREE,0),	"ENGINE_free"},
 {ERR_PACK(0,ENGINE_F_ENGINE_GET_CIPHER,0),	"ENGINE_get_cipher"},
-{ERR_PACK(0,ENGINE_F_ENGINE_GET_DEFAULT_TYPE,0),	"ENGINE_GET_DEFAULT_TYPE"},
 {ERR_PACK(0,ENGINE_F_ENGINE_GET_DIGEST,0),	"ENGINE_get_digest"},
 {ERR_PACK(0,ENGINE_F_ENGINE_GET_NEXT,0),	"ENGINE_get_next"},
 {ERR_PACK(0,ENGINE_F_ENGINE_GET_PREV,0),	"ENGINE_get_prev"},
@@ -91,15 +90,12 @@
 {ERR_PACK(0,ENGINE_F_ENGINE_NEW,0),	"ENGINE_new"},
 {ERR_PACK(0,ENGINE_F_ENGINE_REMOVE,0),	"ENGINE_remove"},
 {ERR_PACK(0,ENGINE_F_ENGINE_SET_DEFAULT_STRING,0),	"ENGINE_set_default_string"},
-{ERR_PACK(0,ENGINE_F_ENGINE_SET_DEFAULT_TYPE,0),	"ENGINE_SET_DEFAULT_TYPE"},
 {ERR_PACK(0,ENGINE_F_ENGINE_SET_ID,0),	"ENGINE_set_id"},
 {ERR_PACK(0,ENGINE_F_ENGINE_SET_NAME,0),	"ENGINE_set_name"},
 {ERR_PACK(0,ENGINE_F_ENGINE_TABLE_REGISTER,0),	"ENGINE_TABLE_REGISTER"},
-{ERR_PACK(0,ENGINE_F_ENGINE_UNLOAD_KEY,0),	"ENGINE_UNLOAD_KEY"},
 {ERR_PACK(0,ENGINE_F_ENGINE_UP_REF,0),	"ENGINE_up_ref"},
 {ERR_PACK(0,ENGINE_F_INT_CTRL_HELPER,0),	"INT_CTRL_HELPER"},
 {ERR_PACK(0,ENGINE_F_INT_ENGINE_CONFIGURE,0),	"INT_ENGINE_CONFIGURE"},
-{ERR_PACK(0,ENGINE_F_LOG_MESSAGE,0),	"LOG_MESSAGE"},
 {ERR_PACK(0,ENGINE_F_SET_DATA_CTX,0),	"SET_DATA_CTX"},
 {0,NULL}
 	};
@@ -113,18 +109,15 @@
 {ENGINE_R_COMMAND_TAKES_NO_INPUT         ,"command takes no input"},
 {ENGINE_R_CONFLICTING_ENGINE_ID          ,"conflicting engine id"},
 {ENGINE_R_CTRL_COMMAND_NOT_IMPLEMENTED   ,"ctrl command not implemented"},
-{ENGINE_R_DH_NOT_IMPLEMENTED             ,"dh not implemented"},
-{ENGINE_R_DSA_NOT_IMPLEMENTED            ,"dsa not implemented"},
-{ENGINE_R_DSO_FAILURE                    ,"DSO failure"},
+{ENGINE_R_DSO_FAILURE                    ,"dso failure"},
 {ENGINE_R_DSO_NOT_FOUND                  ,"dso not found"},
 {ENGINE_R_ENGINES_SECTION_ERROR          ,"engines section error"},
-{ENGINE_R_ENGINE_IS_NOT_IN_LIST          ,"engine is not in the list"},
+{ENGINE_R_ENGINE_IS_NOT_IN_LIST          ,"engine is not in list"},
 {ENGINE_R_ENGINE_SECTION_ERROR           ,"engine section error"},
 {ENGINE_R_FAILED_LOADING_PRIVATE_KEY     ,"failed loading private key"},
 {ENGINE_R_FAILED_LOADING_PUBLIC_KEY      ,"failed loading public key"},
 {ENGINE_R_FINISH_FAILED                  ,"finish failed"},
-{ENGINE_R_GET_HANDLE_FAILED              ,"could not obtain hardware handle"},
-{ENGINE_R_ID_OR_NAME_MISSING             ,"'id' or 'name' missing"},
+{ENGINE_R_ID_OR_NAME_MISSING             ,"id or name missing"},
 {ENGINE_R_INIT_FAILED                    ,"init failed"},
 {ENGINE_R_INTERNAL_LIST_ERROR            ,"internal list error"},
 {ENGINE_R_INVALID_ARGUMENT               ,"invalid argument"},
@@ -139,9 +132,6 @@
 {ENGINE_R_NO_LOAD_FUNCTION               ,"no load function"},
 {ENGINE_R_NO_REFERENCE                   ,"no reference"},
 {ENGINE_R_NO_SUCH_ENGINE                 ,"no such engine"},
-{ENGINE_R_NO_UNLOAD_FUNCTION             ,"no unload function"},
-{ENGINE_R_PROVIDE_PARAMETERS             ,"provide parameters"},
-{ENGINE_R_RSA_NOT_IMPLEMENTED            ,"rsa not implemented"},
 {ENGINE_R_UNIMPLEMENTED_CIPHER           ,"unimplemented cipher"},
 {ENGINE_R_UNIMPLEMENTED_DIGEST           ,"unimplemented digest"},
 {ENGINE_R_VERSION_INCOMPATIBILITY        ,"version incompatibility"},
Index: openssl/crypto/engine/engine.h
diff -u openssl/crypto/engine/engine.h:1.1.1.5 openssl/crypto/engine/engine.h:1.1.1.5.4.1
--- openssl/crypto/engine/engine.h:1.1.1.5	Sat Mar 20 17:03:43 2004
+++ openssl/crypto/engine/engine.h	Mon Nov  8 16:31:08 2004
@@ -646,82 +646,72 @@
 /* Error codes for the ENGINE functions. */
 
 /* Function codes. */
-#define ENGINE_F_DYNAMIC_CTRL				 180
-#define ENGINE_F_DYNAMIC_GET_DATA_CTX			 181
-#define ENGINE_F_DYNAMIC_LOAD				 182
-#define ENGINE_F_ENGINE_ADD				 105
-#define ENGINE_F_ENGINE_BY_ID				 106
-#define ENGINE_F_ENGINE_CMD_IS_EXECUTABLE		 170
-#define ENGINE_F_ENGINE_CTRL				 142
-#define ENGINE_F_ENGINE_CTRL_CMD			 178
-#define ENGINE_F_ENGINE_CTRL_CMD_STRING			 171
-#define ENGINE_F_ENGINE_FINISH				 107
-#define ENGINE_F_ENGINE_FREE				 108
-#define ENGINE_F_ENGINE_GET_CIPHER			 185
-#define ENGINE_F_ENGINE_GET_DEFAULT_TYPE		 177
-#define ENGINE_F_ENGINE_GET_DIGEST			 186
-#define ENGINE_F_ENGINE_GET_NEXT			 115
-#define ENGINE_F_ENGINE_GET_PREV			 116
-#define ENGINE_F_ENGINE_INIT				 119
-#define ENGINE_F_ENGINE_LIST_ADD			 120
-#define ENGINE_F_ENGINE_LIST_REMOVE			 121
-#define ENGINE_F_ENGINE_LOAD_PRIVATE_KEY		 150
-#define ENGINE_F_ENGINE_LOAD_PUBLIC_KEY			 151
-#define ENGINE_F_ENGINE_MODULE_INIT			 187
-#define ENGINE_F_ENGINE_NEW				 122
-#define ENGINE_F_ENGINE_REMOVE				 123
-#define ENGINE_F_ENGINE_SET_DEFAULT_STRING		 189
-#define ENGINE_F_ENGINE_SET_DEFAULT_TYPE		 126
-#define ENGINE_F_ENGINE_SET_ID				 129
-#define ENGINE_F_ENGINE_SET_NAME			 130
-#define ENGINE_F_ENGINE_TABLE_REGISTER			 184
-#define ENGINE_F_ENGINE_UNLOAD_KEY			 152
-#define ENGINE_F_ENGINE_UP_REF				 190
-#define ENGINE_F_INT_CTRL_HELPER			 172
-#define ENGINE_F_INT_ENGINE_CONFIGURE			 188
-#define ENGINE_F_LOG_MESSAGE				 141
-#define ENGINE_F_SET_DATA_CTX				 183
+#define ENGINE_F_DYNAMIC_CTRL				 100
+#define ENGINE_F_DYNAMIC_GET_DATA_CTX			 101
+#define ENGINE_F_DYNAMIC_LOAD				 102
+#define ENGINE_F_ENGINE_ADD				 103
+#define ENGINE_F_ENGINE_BY_ID				 104
+#define ENGINE_F_ENGINE_CMD_IS_EXECUTABLE		 105
+#define ENGINE_F_ENGINE_CTRL				 106
+#define ENGINE_F_ENGINE_CTRL_CMD			 107
+#define ENGINE_F_ENGINE_CTRL_CMD_STRING			 108
+#define ENGINE_F_ENGINE_FINISH				 109
+#define ENGINE_F_ENGINE_FREE				 110
+#define ENGINE_F_ENGINE_GET_CIPHER			 111
+#define ENGINE_F_ENGINE_GET_DIGEST			 112
+#define ENGINE_F_ENGINE_GET_NEXT			 113
+#define ENGINE_F_ENGINE_GET_PREV			 114
+#define ENGINE_F_ENGINE_INIT				 115
+#define ENGINE_F_ENGINE_LIST_ADD			 116
+#define ENGINE_F_ENGINE_LIST_REMOVE			 117
+#define ENGINE_F_ENGINE_LOAD_PRIVATE_KEY		 118
+#define ENGINE_F_ENGINE_LOAD_PUBLIC_KEY			 119
+#define ENGINE_F_ENGINE_MODULE_INIT			 120
+#define ENGINE_F_ENGINE_NEW				 121
+#define ENGINE_F_ENGINE_REMOVE				 122
+#define ENGINE_F_ENGINE_SET_DEFAULT_STRING		 123
+#define ENGINE_F_ENGINE_SET_ID				 124
+#define ENGINE_F_ENGINE_SET_NAME			 125
+#define ENGINE_F_ENGINE_TABLE_REGISTER			 126
+#define ENGINE_F_ENGINE_UP_REF				 127
+#define ENGINE_F_INT_CTRL_HELPER			 128
+#define ENGINE_F_INT_ENGINE_CONFIGURE			 129
+#define ENGINE_F_SET_DATA_CTX				 130
 
 /* Reason codes. */
 #define ENGINE_R_ALREADY_LOADED				 100
-#define ENGINE_R_ARGUMENT_IS_NOT_A_NUMBER		 133
-#define ENGINE_R_CMD_NOT_EXECUTABLE			 134
-#define ENGINE_R_COMMAND_TAKES_INPUT			 135
-#define ENGINE_R_COMMAND_TAKES_NO_INPUT			 136
-#define ENGINE_R_CONFLICTING_ENGINE_ID			 103
-#define ENGINE_R_CTRL_COMMAND_NOT_IMPLEMENTED		 119
-#define ENGINE_R_DH_NOT_IMPLEMENTED			 139
-#define ENGINE_R_DSA_NOT_IMPLEMENTED			 140
-#define ENGINE_R_DSO_FAILURE				 104
-#define ENGINE_R_DSO_NOT_FOUND				 132
-#define ENGINE_R_ENGINES_SECTION_ERROR			 148
-#define ENGINE_R_ENGINE_IS_NOT_IN_LIST			 105
-#define ENGINE_R_ENGINE_SECTION_ERROR			 149
-#define ENGINE_R_FAILED_LOADING_PRIVATE_KEY		 128
-#define ENGINE_R_FAILED_LOADING_PUBLIC_KEY		 129
-#define ENGINE_R_FINISH_FAILED				 106
-#define ENGINE_R_GET_HANDLE_FAILED			 107
-#define ENGINE_R_ID_OR_NAME_MISSING			 108
-#define ENGINE_R_INIT_FAILED				 109
-#define ENGINE_R_INTERNAL_LIST_ERROR			 110
-#define ENGINE_R_INVALID_ARGUMENT			 143
-#define ENGINE_R_INVALID_CMD_NAME			 137
-#define ENGINE_R_INVALID_CMD_NUMBER			 138
-#define ENGINE_R_INVALID_INIT_VALUE			 151
-#define ENGINE_R_INVALID_STRING				 150
-#define ENGINE_R_NOT_INITIALISED			 117
-#define ENGINE_R_NOT_LOADED				 112
-#define ENGINE_R_NO_CONTROL_FUNCTION			 120
-#define ENGINE_R_NO_INDEX				 144
-#define ENGINE_R_NO_LOAD_FUNCTION			 125
-#define ENGINE_R_NO_REFERENCE				 130
-#define ENGINE_R_NO_SUCH_ENGINE				 116
-#define ENGINE_R_NO_UNLOAD_FUNCTION			 126
-#define ENGINE_R_PROVIDE_PARAMETERS			 113
-#define ENGINE_R_RSA_NOT_IMPLEMENTED			 141
-#define ENGINE_R_UNIMPLEMENTED_CIPHER			 146
-#define ENGINE_R_UNIMPLEMENTED_DIGEST			 147
-#define ENGINE_R_VERSION_INCOMPATIBILITY		 145
+#define ENGINE_R_ARGUMENT_IS_NOT_A_NUMBER		 101
+#define ENGINE_R_CMD_NOT_EXECUTABLE			 102
+#define ENGINE_R_COMMAND_TAKES_INPUT			 103
+#define ENGINE_R_COMMAND_TAKES_NO_INPUT			 104
+#define ENGINE_R_CONFLICTING_ENGINE_ID			 105
+#define ENGINE_R_CTRL_COMMAND_NOT_IMPLEMENTED		 106
+#define ENGINE_R_DSO_FAILURE				 107
+#define ENGINE_R_DSO_NOT_FOUND				 108
+#define ENGINE_R_ENGINES_SECTION_ERROR			 109
+#define ENGINE_R_ENGINE_IS_NOT_IN_LIST			 110
+#define ENGINE_R_ENGINE_SECTION_ERROR			 111
+#define ENGINE_R_FAILED_LOADING_PRIVATE_KEY		 112
+#define ENGINE_R_FAILED_LOADING_PUBLIC_KEY		 113
+#define ENGINE_R_FINISH_FAILED				 114
+#define ENGINE_R_ID_OR_NAME_MISSING			 115
+#define ENGINE_R_INIT_FAILED				 116
+#define ENGINE_R_INTERNAL_LIST_ERROR			 117
+#define ENGINE_R_INVALID_ARGUMENT			 118
+#define ENGINE_R_INVALID_CMD_NAME			 119
+#define ENGINE_R_INVALID_CMD_NUMBER			 120
+#define ENGINE_R_INVALID_INIT_VALUE			 121
+#define ENGINE_R_INVALID_STRING				 122
+#define ENGINE_R_NOT_INITIALISED			 123
+#define ENGINE_R_NOT_LOADED				 124
+#define ENGINE_R_NO_CONTROL_FUNCTION			 125
+#define ENGINE_R_NO_INDEX				 126
+#define ENGINE_R_NO_LOAD_FUNCTION			 127
+#define ENGINE_R_NO_REFERENCE				 128
+#define ENGINE_R_NO_SUCH_ENGINE				 129
+#define ENGINE_R_UNIMPLEMENTED_CIPHER			 130
+#define ENGINE_R_UNIMPLEMENTED_DIGEST			 131
+#define ENGINE_R_VERSION_INCOMPATIBILITY		 132
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/err/Makefile
diff -u openssl/crypto/err/Makefile:1.1.1.1 openssl/crypto/err/Makefile:1.1.1.1.2.1
--- openssl/crypto/err/Makefile:1.1.1.1	Mon Nov  8 15:32:34 2004
+++ openssl/crypto/err/Makefile	Mon Nov  8 16:31:08 2004
@@ -105,10 +105,10 @@
 err_all.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
 err_all.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
 err_all.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
-err_all.o: ../../include/openssl/symhacks.h ../../include/openssl/ui.h
-err_all.o: ../../include/openssl/ui_compat.h ../../include/openssl/x509.h
-err_all.o: ../../include/openssl/x509_vfy.h ../../include/openssl/x509v3.h
-err_all.o: err_all.c
+err_all.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+err_all.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+err_all.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+err_all.o: ../../include/openssl/x509v3.h err_all.c
 err_prn.o: ../../e_os.h ../../include/openssl/bio.h
 err_prn.o: ../../include/openssl/buffer.h ../../include/openssl/crypto.h
 err_prn.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
Index: openssl/crypto/err/err.c
diff -u openssl/crypto/err/err.c:1.1.1.7 openssl/crypto/err/err.c:1.1.1.7.2.1
--- openssl/crypto/err/err.c:1.1.1.7	Mon Nov  8 15:32:34 2004
+++ openssl/crypto/err/err.c	Mon Nov  8 16:31:08 2004
@@ -147,6 +147,7 @@
 {ERR_PACK(ERR_LIB_PKCS12,0,0)		,"PKCS12 routines"},
 {ERR_PACK(ERR_LIB_RAND,0,0)		,"random number generator"},
 {ERR_PACK(ERR_LIB_DSO,0,0)		,"DSO support routines"},
+{ERR_PACK(ERR_LIB_TS,0,0)		,"time stamp routines"},
 {ERR_PACK(ERR_LIB_ENGINE,0,0)		,"engine routines"},
 {ERR_PACK(ERR_LIB_OCSP,0,0)		,"OCSP routines"},
 {ERR_PACK(ERR_LIB_FIPS,0,0)		,"FIPS routines"},
@@ -196,6 +197,7 @@
 {ERR_R_DSO_LIB				,"DSO lib"},
 {ERR_R_ENGINE_LIB			,"ENGINE lib"},
 {ERR_R_OCSP_LIB				,"OCSP lib"},
+{ERR_R_TS_LIB				,"TS lib"},
 
 {ERR_R_NESTED_ASN1_ERROR		,"nested asn1 error"},
 {ERR_R_BAD_ASN1_OBJECT_HEADER		,"bad asn1 object header"},
Index: openssl/crypto/err/err.h
diff -u openssl/crypto/err/err.h:1.1.1.5 openssl/crypto/err/err.h:1.1.1.5.2.1
--- openssl/crypto/err/err.h:1.1.1.5	Mon Nov  8 15:32:34 2004
+++ openssl/crypto/err/err.h	Mon Nov  8 16:31:08 2004
@@ -132,6 +132,7 @@
 #define ERR_LIB_UI              40
 #define ERR_LIB_COMP            41
 #define ERR_LIB_FIPS		42
+#define ERR_LIB_TS		43
 
 #define ERR_LIB_USER		128
 
@@ -161,6 +162,7 @@
 #define UIerr(f,r) ERR_PUT_error(ERR_LIB_UI,(f),(r),__FILE__,__LINE__)
 #define COMPerr(f,r) ERR_PUT_error(ERR_LIB_COMP,(f),(r),__FILE__,__LINE__)
 #define FIPSerr(f,r) ERR_PUT_error(ERR_LIB_FIPS,(f),(r),__FILE__,__LINE__)
+#define TSerr(f,r) ERR_PUT_error(ERR_LIB_TS,(f),(r),__FILE__,__LINE__)
 
 /* Borland C seems too stupid to be able to shift and do longs in
  * the pre-processor :-( */
@@ -213,6 +215,7 @@
 #define ERR_R_OCSP_LIB  ERR_LIB_OCSP     /* 39 */
 #define ERR_R_UI_LIB    ERR_LIB_UI       /* 40 */
 #define ERR_R_COMP_LIB	ERR_LIB_COMP     /* 41 */
+#define ERR_R_TS_LIB	ERR_LIB_TS       /* 42 */
 
 #define ERR_R_NESTED_ASN1_ERROR			58
 #define ERR_R_BAD_ASN1_OBJECT_HEADER		59
Index: openssl/crypto/err/err_all.c
diff -u openssl/crypto/err/err_all.c:1.1.1.5 openssl/crypto/err/err_all.c:1.1.1.5.2.1
--- openssl/crypto/err/err_all.c:1.1.1.5	Mon Nov  8 15:32:34 2004
+++ openssl/crypto/err/err_all.c	Mon Nov  8 16:31:08 2004
@@ -88,6 +88,7 @@
 #include <openssl/ocsp.h>
 #include <openssl/err.h>
 #include <openssl/fips.h>
+#include <openssl/ts.h>
 
 void ERR_load_crypto_strings(void)
 	{
@@ -125,6 +126,7 @@
 	ERR_load_PKCS12_strings();
 	ERR_load_RAND_strings();
 	ERR_load_DSO_strings();
+	ERR_load_TS_strings();
 #ifndef OPENSSL_NO_ENGINE
 	ERR_load_ENGINE_strings();
 #endif
Index: openssl/crypto/err/openssl.ec
diff -u openssl/crypto/err/openssl.ec:1.1.1.4 openssl/crypto/err/openssl.ec:1.1.1.4.2.1
--- openssl/crypto/err/openssl.ec:1.1.1.4	Mon Nov  8 15:32:34 2004
+++ openssl/crypto/err/openssl.ec	Mon Nov  8 16:31:08 2004
@@ -27,6 +27,7 @@
 L ENGINE	crypto/engine/engine.h		crypto/engine/eng_err.c
 L OCSP		crypto/ocsp/ocsp.h		crypto/ocsp/ocsp_err.c
 L UI		crypto/ui/ui.h			crypto/ui/ui_err.c
+L TS		crypto/ts/ts.h			crypto/ts/ts_err.c
 L FIPS		fips/fips.h			fips/fips_err.h
 
 # additional header files to be scanned for function names
Index: openssl/crypto/evp/evp.h
diff -u openssl/crypto/evp/evp.h:1.1.1.5 openssl/crypto/evp/evp.h:1.1.1.5.2.1
--- openssl/crypto/evp/evp.h:1.1.1.5	Mon Nov  8 15:32:37 2004
+++ openssl/crypto/evp/evp.h	Mon Nov  8 16:31:08 2004
@@ -885,44 +885,40 @@
 #define EVP_R_AES_KEY_SETUP_FAILED			 140
 #define EVP_R_BAD_BLOCK_LENGTH				 136
 #define EVP_R_BAD_DECRYPT				 100
-#define EVP_R_BAD_KEY_LENGTH				 137
-#define EVP_R_BN_DECODE_ERROR				 112
-#define EVP_R_BN_PUBKEY_ERROR				 113
-#define EVP_R_CIPHER_PARAMETER_ERROR			 122
-#define EVP_R_CTRL_NOT_IMPLEMENTED			 132
-#define EVP_R_CTRL_OPERATION_NOT_IMPLEMENTED		 133
-#define EVP_R_DATA_NOT_MULTIPLE_OF_BLOCK_LENGTH		 138
-#define EVP_R_DECODE_ERROR				 114
-#define EVP_R_DIFFERENT_KEY_TYPES			 101
-#define EVP_R_ENCODE_ERROR				 115
-#define EVP_R_EVP_PBE_CIPHERINIT_ERROR			 119
-#define EVP_R_EXPECTING_AN_RSA_KEY			 127
-#define EVP_R_EXPECTING_A_DH_KEY			 128
-#define EVP_R_EXPECTING_A_DSA_KEY			 129
-#define EVP_R_INITIALIZATION_ERROR			 134
-#define EVP_R_INPUT_NOT_INITIALIZED			 111
-#define EVP_R_INVALID_KEY_LENGTH			 130
-#define EVP_R_IV_TOO_LARGE				 102
-#define EVP_R_KEYGEN_FAILURE				 120
-#define EVP_R_MISSING_PARAMETERS			 103
-#define EVP_R_NO_CIPHER_SET				 131
-#define EVP_R_NO_DIGEST_SET				 139
-#define EVP_R_NO_DSA_PARAMETERS				 116
-#define EVP_R_NO_SIGN_FUNCTION_CONFIGURED		 104
-#define EVP_R_NO_VERIFY_FUNCTION_CONFIGURED		 105
-#define EVP_R_PKCS8_UNKNOWN_BROKEN_TYPE			 117
-#define EVP_R_PUBLIC_KEY_NOT_RSA			 106
-#define EVP_R_UNKNOWN_PBE_ALGORITHM			 121
-#define EVP_R_UNSUPORTED_NUMBER_OF_ROUNDS		 135
-#define EVP_R_UNSUPPORTED_CIPHER			 107
-#define EVP_R_UNSUPPORTED_KEYLENGTH			 123
-#define EVP_R_UNSUPPORTED_KEY_DERIVATION_FUNCTION	 124
-#define EVP_R_UNSUPPORTED_KEY_SIZE			 108
-#define EVP_R_UNSUPPORTED_PRF				 125
-#define EVP_R_UNSUPPORTED_PRIVATE_KEY_ALGORITHM		 118
-#define EVP_R_UNSUPPORTED_SALT_TYPE			 126
-#define EVP_R_WRONG_FINAL_BLOCK_LENGTH			 109
-#define EVP_R_WRONG_PUBLIC_KEY_TYPE			 110
+#define EVP_R_BN_DECODE_ERROR				 101
+#define EVP_R_BN_PUBKEY_ERROR				 102
+#define EVP_R_CIPHER_PARAMETER_ERROR			 103
+#define EVP_R_CTRL_NOT_IMPLEMENTED			 104
+#define EVP_R_CTRL_OPERATION_NOT_IMPLEMENTED		 105
+#define EVP_R_DATA_NOT_MULTIPLE_OF_BLOCK_LENGTH		 106
+#define EVP_R_DECODE_ERROR				 107
+#define EVP_R_DIFFERENT_KEY_TYPES			 108
+#define EVP_R_ENCODE_ERROR				 109
+#define EVP_R_EXPECTING_AN_RSA_KEY			 110
+#define EVP_R_EXPECTING_A_DH_KEY			 111
+#define EVP_R_EXPECTING_A_DSA_KEY			 112
+#define EVP_R_INITIALIZATION_ERROR			 113
+#define EVP_R_INPUT_NOT_INITIALIZED			 114
+#define EVP_R_INVALID_KEY_LENGTH			 115
+#define EVP_R_KEYGEN_FAILURE				 116
+#define EVP_R_MISSING_PARAMETERS			 117
+#define EVP_R_NO_CIPHER_SET				 118
+#define EVP_R_NO_DIGEST_SET				 119
+#define EVP_R_NO_SIGN_FUNCTION_CONFIGURED		 120
+#define EVP_R_NO_VERIFY_FUNCTION_CONFIGURED		 121
+#define EVP_R_PKCS8_UNKNOWN_BROKEN_TYPE			 122
+#define EVP_R_PUBLIC_KEY_NOT_RSA			 123
+#define EVP_R_UNKNOWN_PBE_ALGORITHM			 124
+#define EVP_R_UNSUPORTED_NUMBER_OF_ROUNDS		 125
+#define EVP_R_UNSUPPORTED_CIPHER			 126
+#define EVP_R_UNSUPPORTED_KEYLENGTH			 127
+#define EVP_R_UNSUPPORTED_KEY_DERIVATION_FUNCTION	 128
+#define EVP_R_UNSUPPORTED_KEY_SIZE			 129
+#define EVP_R_UNSUPPORTED_PRF				 130
+#define EVP_R_UNSUPPORTED_PRIVATE_KEY_ALGORITHM		 131
+#define EVP_R_UNSUPPORTED_SALT_TYPE			 132
+#define EVP_R_WRONG_FINAL_BLOCK_LENGTH			 133
+#define EVP_R_WRONG_PUBLIC_KEY_TYPE			 134
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/evp/evp_err.c
diff -u openssl/crypto/evp/evp_err.c:1.1.1.3 openssl/crypto/evp/evp_err.c:1.1.1.3.2.1
--- openssl/crypto/evp/evp_err.c:1.1.1.3	Mon Nov  8 15:32:36 2004
+++ openssl/crypto/evp/evp_err.c	Mon Nov  8 16:31:08 2004
@@ -88,7 +88,6 @@
 {ERR_PACK(0,EVP_F_EVP_PKEY_GET1_DSA,0),	"EVP_PKEY_get1_DSA"},
 {ERR_PACK(0,EVP_F_EVP_PKEY_GET1_RSA,0),	"EVP_PKEY_get1_RSA"},
 {ERR_PACK(0,EVP_F_EVP_PKEY_NEW,0),	"EVP_PKEY_new"},
-{ERR_PACK(0,EVP_F_EVP_RIJNDAEL,0),	"EVP_RIJNDAEL"},
 {ERR_PACK(0,EVP_F_EVP_SIGNFINAL,0),	"EVP_SignFinal"},
 {ERR_PACK(0,EVP_F_EVP_VERIFYFINAL,0),	"EVP_VerifyFinal"},
 {ERR_PACK(0,EVP_F_PKCS5_PBE_KEYIVGEN,0),	"PKCS5_PBE_keyivgen"},
@@ -103,7 +102,6 @@
 {EVP_R_AES_KEY_SETUP_FAILED              ,"aes key setup failed"},
 {EVP_R_BAD_BLOCK_LENGTH                  ,"bad block length"},
 {EVP_R_BAD_DECRYPT                       ,"bad decrypt"},
-{EVP_R_BAD_KEY_LENGTH                    ,"bad key length"},
 {EVP_R_BN_DECODE_ERROR                   ,"bn decode error"},
 {EVP_R_BN_PUBKEY_ERROR                   ,"bn pubkey error"},
 {EVP_R_CIPHER_PARAMETER_ERROR            ,"cipher parameter error"},
@@ -113,19 +111,16 @@
 {EVP_R_DECODE_ERROR                      ,"decode error"},
 {EVP_R_DIFFERENT_KEY_TYPES               ,"different key types"},
 {EVP_R_ENCODE_ERROR                      ,"encode error"},
-{EVP_R_EVP_PBE_CIPHERINIT_ERROR          ,"evp pbe cipherinit error"},
 {EVP_R_EXPECTING_AN_RSA_KEY              ,"expecting an rsa key"},
 {EVP_R_EXPECTING_A_DH_KEY                ,"expecting a dh key"},
 {EVP_R_EXPECTING_A_DSA_KEY               ,"expecting a dsa key"},
 {EVP_R_INITIALIZATION_ERROR              ,"initialization error"},
 {EVP_R_INPUT_NOT_INITIALIZED             ,"input not initialized"},
 {EVP_R_INVALID_KEY_LENGTH                ,"invalid key length"},
-{EVP_R_IV_TOO_LARGE                      ,"iv too large"},
 {EVP_R_KEYGEN_FAILURE                    ,"keygen failure"},
 {EVP_R_MISSING_PARAMETERS                ,"missing parameters"},
 {EVP_R_NO_CIPHER_SET                     ,"no cipher set"},
 {EVP_R_NO_DIGEST_SET                     ,"no digest set"},
-{EVP_R_NO_DSA_PARAMETERS                 ,"no dsa parameters"},
 {EVP_R_NO_SIGN_FUNCTION_CONFIGURED       ,"no sign function configured"},
 {EVP_R_NO_VERIFY_FUNCTION_CONFIGURED     ,"no verify function configured"},
 {EVP_R_PKCS8_UNKNOWN_BROKEN_TYPE         ,"pkcs8 unknown broken type"},
Index: openssl/crypto/objects/obj_err.c
diff -u openssl/crypto/objects/obj_err.c:1.1.1.2 openssl/crypto/objects/obj_err.c:1.1.1.2.12.1
--- openssl/crypto/objects/obj_err.c:1.1.1.2	Fri Jan 17 22:07:57 2003
+++ openssl/crypto/objects/obj_err.c	Mon Nov  8 16:31:08 2004
@@ -1,6 +1,6 @@
 /* crypto/objects/obj_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
Index: openssl/crypto/ocsp/ocsp.h
diff -u openssl/crypto/ocsp/ocsp.h:1.1.1.1 openssl/crypto/ocsp/ocsp.h:1.1.1.1.12.1
--- openssl/crypto/ocsp/ocsp.h:1.1.1.1	Fri Jan 17 22:07:57 2003
+++ openssl/crypto/ocsp/ocsp.h	Mon Nov  8 16:31:08 2004
@@ -572,46 +572,44 @@
 #define OCSP_F_OCSP_CHECK_DELEGATED			 106
 #define OCSP_F_OCSP_CHECK_IDS				 107
 #define OCSP_F_OCSP_CHECK_ISSUER			 108
-#define OCSP_F_OCSP_CHECK_VALIDITY			 115
-#define OCSP_F_OCSP_MATCH_ISSUERID			 109
-#define OCSP_F_OCSP_PARSE_URL				 114
-#define OCSP_F_OCSP_REQUEST_SIGN			 110
-#define OCSP_F_OCSP_REQUEST_VERIFY			 116
-#define OCSP_F_OCSP_RESPONSE_GET1_BASIC			 111
-#define OCSP_F_OCSP_SENDREQ_BIO				 112
-#define OCSP_F_REQUEST_VERIFY				 113
+#define OCSP_F_OCSP_CHECK_VALIDITY			 109
+#define OCSP_F_OCSP_MATCH_ISSUERID			 110
+#define OCSP_F_OCSP_PARSE_URL				 111
+#define OCSP_F_OCSP_REQUEST_SIGN			 112
+#define OCSP_F_OCSP_REQUEST_VERIFY			 113
+#define OCSP_F_OCSP_RESPONSE_GET1_BASIC			 114
+#define OCSP_F_OCSP_SENDREQ_BIO				 115
 
 /* Reason codes. */
 #define OCSP_R_BAD_DATA					 100
 #define OCSP_R_CERTIFICATE_VERIFY_ERROR			 101
 #define OCSP_R_DIGEST_ERR				 102
-#define OCSP_R_ERROR_IN_NEXTUPDATE_FIELD		 122
-#define OCSP_R_ERROR_IN_THISUPDATE_FIELD		 123
-#define OCSP_R_ERROR_PARSING_URL			 121
-#define OCSP_R_MISSING_OCSPSIGNING_USAGE		 103
-#define OCSP_R_NEXTUPDATE_BEFORE_THISUPDATE		 124
-#define OCSP_R_NOT_BASIC_RESPONSE			 104
-#define OCSP_R_NO_CERTIFICATES_IN_CHAIN			 105
-#define OCSP_R_NO_CONTENT				 106
-#define OCSP_R_NO_PUBLIC_KEY				 107
-#define OCSP_R_NO_RESPONSE_DATA				 108
-#define OCSP_R_NO_REVOKED_TIME				 109
-#define OCSP_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE	 110
-#define OCSP_R_REQUEST_NOT_SIGNED			 128
-#define OCSP_R_RESPONSE_CONTAINS_NO_REVOCATION_DATA	 111
-#define OCSP_R_ROOT_CA_NOT_TRUSTED			 112
-#define OCSP_R_SERVER_READ_ERROR			 113
-#define OCSP_R_SERVER_RESPONSE_ERROR			 114
-#define OCSP_R_SERVER_RESPONSE_PARSE_ERROR		 115
-#define OCSP_R_SERVER_WRITE_ERROR			 116
-#define OCSP_R_SIGNATURE_FAILURE			 117
-#define OCSP_R_SIGNER_CERTIFICATE_NOT_FOUND		 118
-#define OCSP_R_STATUS_EXPIRED				 125
-#define OCSP_R_STATUS_NOT_YET_VALID			 126
-#define OCSP_R_STATUS_TOO_OLD				 127
-#define OCSP_R_UNKNOWN_MESSAGE_DIGEST			 119
-#define OCSP_R_UNKNOWN_NID				 120
-#define OCSP_R_UNSUPPORTED_REQUESTORNAME_TYPE		 129
+#define OCSP_R_ERROR_IN_NEXTUPDATE_FIELD		 103
+#define OCSP_R_ERROR_IN_THISUPDATE_FIELD		 104
+#define OCSP_R_ERROR_PARSING_URL			 105
+#define OCSP_R_MISSING_OCSPSIGNING_USAGE		 106
+#define OCSP_R_NEXTUPDATE_BEFORE_THISUPDATE		 107
+#define OCSP_R_NOT_BASIC_RESPONSE			 108
+#define OCSP_R_NO_CERTIFICATES_IN_CHAIN			 109
+#define OCSP_R_NO_CONTENT				 110
+#define OCSP_R_NO_RESPONSE_DATA				 111
+#define OCSP_R_NO_REVOKED_TIME				 112
+#define OCSP_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE	 113
+#define OCSP_R_REQUEST_NOT_SIGNED			 114
+#define OCSP_R_RESPONSE_CONTAINS_NO_REVOCATION_DATA	 115
+#define OCSP_R_ROOT_CA_NOT_TRUSTED			 116
+#define OCSP_R_SERVER_READ_ERROR			 117
+#define OCSP_R_SERVER_RESPONSE_ERROR			 118
+#define OCSP_R_SERVER_RESPONSE_PARSE_ERROR		 119
+#define OCSP_R_SERVER_WRITE_ERROR			 120
+#define OCSP_R_SIGNATURE_FAILURE			 121
+#define OCSP_R_SIGNER_CERTIFICATE_NOT_FOUND		 122
+#define OCSP_R_STATUS_EXPIRED				 123
+#define OCSP_R_STATUS_NOT_YET_VALID			 124
+#define OCSP_R_STATUS_TOO_OLD				 125
+#define OCSP_R_UNKNOWN_MESSAGE_DIGEST			 126
+#define OCSP_R_UNKNOWN_NID				 127
+#define OCSP_R_UNSUPPORTED_REQUESTORNAME_TYPE		 128
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/ocsp/ocsp_err.c
diff -u openssl/crypto/ocsp/ocsp_err.c:1.1.1.1 openssl/crypto/ocsp/ocsp_err.c:1.1.1.1.12.1
--- openssl/crypto/ocsp/ocsp_err.c:1.1.1.1	Fri Jan 17 22:07:57 2003
+++ openssl/crypto/ocsp/ocsp_err.c	Mon Nov  8 16:31:08 2004
@@ -1,6 +1,6 @@
 /* crypto/ocsp/ocsp_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -82,7 +82,6 @@
 {ERR_PACK(0,OCSP_F_OCSP_REQUEST_VERIFY,0),	"OCSP_request_verify"},
 {ERR_PACK(0,OCSP_F_OCSP_RESPONSE_GET1_BASIC,0),	"OCSP_response_get1_basic"},
 {ERR_PACK(0,OCSP_F_OCSP_SENDREQ_BIO,0),	"OCSP_sendreq_bio"},
-{ERR_PACK(0,OCSP_F_REQUEST_VERIFY,0),	"REQUEST_VERIFY"},
 {0,NULL}
 	};
 
@@ -99,7 +98,6 @@
 {OCSP_R_NOT_BASIC_RESPONSE               ,"not basic response"},
 {OCSP_R_NO_CERTIFICATES_IN_CHAIN         ,"no certificates in chain"},
 {OCSP_R_NO_CONTENT                       ,"no content"},
-{OCSP_R_NO_PUBLIC_KEY                    ,"no public key"},
 {OCSP_R_NO_RESPONSE_DATA                 ,"no response data"},
 {OCSP_R_NO_REVOKED_TIME                  ,"no revoked time"},
 {OCSP_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE,"private key does not match certificate"},
Index: openssl/crypto/pem/pem.h
diff -u openssl/crypto/pem/pem.h:1.1.1.2 openssl/crypto/pem/pem.h:1.1.1.2.12.1
--- openssl/crypto/pem/pem.h:1.1.1.2	Fri Jan 17 22:07:57 2003
+++ openssl/crypto/pem/pem.h	Mon Nov  8 16:31:08 2004
@@ -624,29 +624,28 @@
 /* Error codes for the PEM functions. */
 
 /* Function codes. */
-#define PEM_F_D2I_PKCS8PRIVATEKEY_BIO			 120
-#define PEM_F_D2I_PKCS8PRIVATEKEY_FP			 121
-#define PEM_F_DEF_CALLBACK				 100
-#define PEM_F_LOAD_IV					 101
-#define PEM_F_PEM_ASN1_READ				 102
-#define PEM_F_PEM_ASN1_READ_BIO				 103
-#define PEM_F_PEM_ASN1_WRITE				 104
-#define PEM_F_PEM_ASN1_WRITE_BIO			 105
-#define PEM_F_PEM_DO_HEADER				 106
-#define PEM_F_PEM_F_DO_PK8KEY_FP			 122
-#define PEM_F_PEM_F_PEM_WRITE_PKCS8PRIVATEKEY		 118
-#define PEM_F_PEM_GET_EVP_CIPHER_INFO			 107
-#define PEM_F_PEM_READ					 108
-#define PEM_F_PEM_READ_BIO				 109
-#define PEM_F_PEM_SEALFINAL				 110
-#define PEM_F_PEM_SEALINIT				 111
-#define PEM_F_PEM_SIGNFINAL				 112
-#define PEM_F_PEM_WRITE					 113
-#define PEM_F_PEM_WRITE_BIO				 114
-#define PEM_F_PEM_WRITE_BIO_PKCS8PRIVATEKEY		 119
-#define PEM_F_PEM_X509_INFO_READ			 115
-#define PEM_F_PEM_X509_INFO_READ_BIO			 116
-#define PEM_F_PEM_X509_INFO_WRITE_BIO			 117
+#define PEM_F_D2I_PKCS8PRIVATEKEY_BIO			 100
+#define PEM_F_D2I_PKCS8PRIVATEKEY_FP			 101
+#define PEM_F_DEF_CALLBACK				 102
+#define PEM_F_LOAD_IV					 103
+#define PEM_F_PEM_ASN1_READ				 104
+#define PEM_F_PEM_ASN1_READ_BIO				 105
+#define PEM_F_PEM_ASN1_WRITE				 106
+#define PEM_F_PEM_ASN1_WRITE_BIO			 107
+#define PEM_F_PEM_DO_HEADER				 108
+#define PEM_F_PEM_F_DO_PK8KEY_FP			 109
+#define PEM_F_PEM_GET_EVP_CIPHER_INFO			 110
+#define PEM_F_PEM_READ					 111
+#define PEM_F_PEM_READ_BIO				 112
+#define PEM_F_PEM_SEALFINAL				 113
+#define PEM_F_PEM_SEALINIT				 114
+#define PEM_F_PEM_SIGNFINAL				 115
+#define PEM_F_PEM_WRITE					 116
+#define PEM_F_PEM_WRITE_BIO				 117
+#define PEM_F_PEM_WRITE_BIO_PKCS8PRIVATEKEY		 118
+#define PEM_F_PEM_X509_INFO_READ			 119
+#define PEM_F_PEM_X509_INFO_READ_BIO			 120
+#define PEM_F_PEM_X509_INFO_WRITE_BIO			 121
 
 /* Reason codes. */
 #define PEM_R_BAD_BASE64_DECODE				 100
@@ -654,17 +653,17 @@
 #define PEM_R_BAD_END_LINE				 102
 #define PEM_R_BAD_IV_CHARS				 103
 #define PEM_R_BAD_PASSWORD_READ				 104
-#define PEM_R_ERROR_CONVERTING_PRIVATE_KEY		 115
-#define PEM_R_NOT_DEK_INFO				 105
-#define PEM_R_NOT_ENCRYPTED				 106
-#define PEM_R_NOT_PROC_TYPE				 107
-#define PEM_R_NO_START_LINE				 108
-#define PEM_R_PROBLEMS_GETTING_PASSWORD			 109
-#define PEM_R_PUBLIC_KEY_NO_RSA				 110
-#define PEM_R_READ_KEY					 111
-#define PEM_R_SHORT_HEADER				 112
-#define PEM_R_UNSUPPORTED_CIPHER			 113
-#define PEM_R_UNSUPPORTED_ENCRYPTION			 114
+#define PEM_R_ERROR_CONVERTING_PRIVATE_KEY		 105
+#define PEM_R_NOT_DEK_INFO				 106
+#define PEM_R_NOT_ENCRYPTED				 107
+#define PEM_R_NOT_PROC_TYPE				 108
+#define PEM_R_NO_START_LINE				 109
+#define PEM_R_PROBLEMS_GETTING_PASSWORD			 110
+#define PEM_R_PUBLIC_KEY_NO_RSA				 111
+#define PEM_R_READ_KEY					 112
+#define PEM_R_SHORT_HEADER				 113
+#define PEM_R_UNSUPPORTED_CIPHER			 114
+#define PEM_R_UNSUPPORTED_ENCRYPTION			 115
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/pem/pem_err.c
diff -u openssl/crypto/pem/pem_err.c:1.1.1.2 openssl/crypto/pem/pem_err.c:1.1.1.2.12.1
--- openssl/crypto/pem/pem_err.c:1.1.1.2	Fri Jan 17 22:07:57 2003
+++ openssl/crypto/pem/pem_err.c	Mon Nov  8 16:31:08 2004
@@ -1,6 +1,6 @@
 /* crypto/pem/pem_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -76,7 +76,6 @@
 {ERR_PACK(0,PEM_F_PEM_ASN1_WRITE_BIO,0),	"PEM_ASN1_write_bio"},
 {ERR_PACK(0,PEM_F_PEM_DO_HEADER,0),	"PEM_do_header"},
 {ERR_PACK(0,PEM_F_PEM_F_DO_PK8KEY_FP,0),	"PEM_F_DO_PK8KEY_FP"},
-{ERR_PACK(0,PEM_F_PEM_F_PEM_WRITE_PKCS8PRIVATEKEY,0),	"PEM_F_PEM_WRITE_PKCS8PRIVATEKEY"},
 {ERR_PACK(0,PEM_F_PEM_GET_EVP_CIPHER_INFO,0),	"PEM_get_EVP_CIPHER_INFO"},
 {ERR_PACK(0,PEM_F_PEM_READ,0),	"PEM_read"},
 {ERR_PACK(0,PEM_F_PEM_READ_BIO,0),	"PEM_read_bio"},
Index: openssl/crypto/pkcs12/pk12err.c
diff -u openssl/crypto/pkcs12/pk12err.c:1.1.1.2 openssl/crypto/pkcs12/pk12err.c:1.1.1.2.12.1
--- openssl/crypto/pkcs12/pk12err.c:1.1.1.2	Fri Jan 17 22:07:58 2003
+++ openssl/crypto/pkcs12/pk12err.c	Mon Nov  8 16:31:08 2004
@@ -1,6 +1,6 @@
 /* crypto/pkcs12/pk12err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -67,14 +67,10 @@
 static ERR_STRING_DATA PKCS12_str_functs[]=
 	{
 {ERR_PACK(0,PKCS12_F_PARSE_BAGS,0),	"PARSE_BAGS"},
-{ERR_PACK(0,PKCS12_F_PKCS12_ADD_FRIENDLYNAME,0),	"PKCS12_ADD_FRIENDLYNAME"},
-{ERR_PACK(0,PKCS12_F_PKCS12_ADD_FRIENDLYNAME_ASC,0),	"PKCS12_add_friendlyname_asc"},
-{ERR_PACK(0,PKCS12_F_PKCS12_ADD_FRIENDLYNAME_UNI,0),	"PKCS12_add_friendlyname_uni"},
-{ERR_PACK(0,PKCS12_F_PKCS12_ADD_LOCALKEYID,0),	"PKCS12_add_localkeyid"},
 {ERR_PACK(0,PKCS12_F_PKCS12_CREATE,0),	"PKCS12_create"},
-{ERR_PACK(0,PKCS12_F_PKCS12_DECRYPT_D2I,0),	"PKCS12_decrypt_d2i"},
+{ERR_PACK(0,PKCS12_F_PKCS12_DECRYPT_D2I,0),	"PKCS12_DECRYPT_D2I"},
 {ERR_PACK(0,PKCS12_F_PKCS12_GEN_MAC,0),	"PKCS12_gen_mac"},
-{ERR_PACK(0,PKCS12_F_PKCS12_I2D_ENCRYPT,0),	"PKCS12_i2d_encrypt"},
+{ERR_PACK(0,PKCS12_F_PKCS12_I2D_ENCRYPT,0),	"PKCS12_I2D_ENCRYPT"},
 {ERR_PACK(0,PKCS12_F_PKCS12_INIT,0),	"PKCS12_init"},
 {ERR_PACK(0,PKCS12_F_PKCS12_KEY_GEN_ASC,0),	"PKCS12_key_gen_asc"},
 {ERR_PACK(0,PKCS12_F_PKCS12_KEY_GEN_UNI,0),	"PKCS12_key_gen_uni"},
@@ -83,13 +79,12 @@
 {ERR_PACK(0,PKCS12_F_PKCS12_NEWPASS,0),	"PKCS12_newpass"},
 {ERR_PACK(0,PKCS12_F_PKCS12_PACK_P7DATA,0),	"PKCS12_pack_p7data"},
 {ERR_PACK(0,PKCS12_F_PKCS12_PACK_P7ENCDATA,0),	"PKCS12_pack_p7encdata"},
-{ERR_PACK(0,PKCS12_F_PKCS12_PACK_SAFEBAG,0),	"PKCS12_pack_safebag"},
+{ERR_PACK(0,PKCS12_F_PKCS12_PACK_SAFEBAG,0),	"PKCS12_PACK_SAFEBAG"},
 {ERR_PACK(0,PKCS12_F_PKCS12_PARSE,0),	"PKCS12_parse"},
 {ERR_PACK(0,PKCS12_F_PKCS12_PBE_CRYPT,0),	"PKCS12_pbe_crypt"},
 {ERR_PACK(0,PKCS12_F_PKCS12_PBE_KEYIVGEN,0),	"PKCS12_PBE_keyivgen"},
 {ERR_PACK(0,PKCS12_F_PKCS12_SETUP_MAC,0),	"PKCS12_setup_mac"},
 {ERR_PACK(0,PKCS12_F_PKCS12_SET_MAC,0),	"PKCS12_set_mac"},
-{ERR_PACK(0,PKCS12_F_PKCS8_ADD_KEYUSAGE,0),	"PKCS8_add_keyusage"},
 {ERR_PACK(0,PKCS12_F_PKCS8_ENCRYPT,0),	"PKCS8_encrypt"},
 {ERR_PACK(0,PKCS12_F_VERIFY_MAC,0),	"VERIFY_MAC"},
 {0,NULL}
@@ -110,7 +105,6 @@
 {PKCS12_R_MAC_GENERATION_ERROR           ,"mac generation error"},
 {PKCS12_R_MAC_SETUP_ERROR                ,"mac setup error"},
 {PKCS12_R_MAC_STRING_SET_ERROR           ,"mac string set error"},
-{PKCS12_R_MAC_VERIFY_ERROR               ,"mac verify error"},
 {PKCS12_R_MAC_VERIFY_FAILURE             ,"mac verify failure"},
 {PKCS12_R_PARSE_ERROR                    ,"parse error"},
 {PKCS12_R_PKCS12_ALGOR_CIPHERINIT_ERROR  ,"pkcs12 algor cipherinit error"},
Index: openssl/crypto/pkcs12/pkcs12.h
diff -u openssl/crypto/pkcs12/pkcs12.h:1.1.1.3 openssl/crypto/pkcs12/pkcs12.h:1.1.1.3.12.1
--- openssl/crypto/pkcs12/pkcs12.h:1.1.1.3	Fri Jan 17 22:07:58 2003
+++ openssl/crypto/pkcs12/pkcs12.h	Mon Nov  8 16:31:08 2004
@@ -264,48 +264,42 @@
 /* Error codes for the PKCS12 functions. */
 
 /* Function codes. */
-#define PKCS12_F_PARSE_BAGS				 103
-#define PKCS12_F_PKCS12_ADD_FRIENDLYNAME		 100
-#define PKCS12_F_PKCS12_ADD_FRIENDLYNAME_ASC		 127
-#define PKCS12_F_PKCS12_ADD_FRIENDLYNAME_UNI		 102
-#define PKCS12_F_PKCS12_ADD_LOCALKEYID			 104
-#define PKCS12_F_PKCS12_CREATE				 105
-#define PKCS12_F_PKCS12_DECRYPT_D2I			 106
-#define PKCS12_F_PKCS12_GEN_MAC				 107
-#define PKCS12_F_PKCS12_I2D_ENCRYPT			 108
-#define PKCS12_F_PKCS12_INIT				 109
-#define PKCS12_F_PKCS12_KEY_GEN_ASC			 110
-#define PKCS12_F_PKCS12_KEY_GEN_UNI			 111
-#define PKCS12_F_PKCS12_MAKE_KEYBAG			 112
-#define PKCS12_F_PKCS12_MAKE_SHKEYBAG			 113
-#define PKCS12_F_PKCS12_NEWPASS				 128
-#define PKCS12_F_PKCS12_PACK_P7DATA			 114
-#define PKCS12_F_PKCS12_PACK_P7ENCDATA			 115
-#define PKCS12_F_PKCS12_PACK_SAFEBAG			 117
-#define PKCS12_F_PKCS12_PARSE				 118
-#define PKCS12_F_PKCS12_PBE_CRYPT			 119
-#define PKCS12_F_PKCS12_PBE_KEYIVGEN			 120
-#define PKCS12_F_PKCS12_SETUP_MAC			 122
-#define PKCS12_F_PKCS12_SET_MAC				 123
-#define PKCS12_F_PKCS8_ADD_KEYUSAGE			 124
-#define PKCS12_F_PKCS8_ENCRYPT				 125
-#define PKCS12_F_VERIFY_MAC				 126
+#define PKCS12_F_PARSE_BAGS				 100
+#define PKCS12_F_PKCS12_CREATE				 101
+#define PKCS12_F_PKCS12_DECRYPT_D2I			 102
+#define PKCS12_F_PKCS12_GEN_MAC				 103
+#define PKCS12_F_PKCS12_I2D_ENCRYPT			 104
+#define PKCS12_F_PKCS12_INIT				 105
+#define PKCS12_F_PKCS12_KEY_GEN_ASC			 106
+#define PKCS12_F_PKCS12_KEY_GEN_UNI			 107
+#define PKCS12_F_PKCS12_MAKE_KEYBAG			 108
+#define PKCS12_F_PKCS12_MAKE_SHKEYBAG			 109
+#define PKCS12_F_PKCS12_NEWPASS				 110
+#define PKCS12_F_PKCS12_PACK_P7DATA			 111
+#define PKCS12_F_PKCS12_PACK_P7ENCDATA			 112
+#define PKCS12_F_PKCS12_PACK_SAFEBAG			 113
+#define PKCS12_F_PKCS12_PARSE				 114
+#define PKCS12_F_PKCS12_PBE_CRYPT			 115
+#define PKCS12_F_PKCS12_PBE_KEYIVGEN			 116
+#define PKCS12_F_PKCS12_SETUP_MAC			 117
+#define PKCS12_F_PKCS12_SET_MAC				 118
+#define PKCS12_F_PKCS8_ENCRYPT				 119
+#define PKCS12_F_VERIFY_MAC				 120
 
 /* Reason codes. */
 #define PKCS12_R_CANT_PACK_STRUCTURE			 100
 #define PKCS12_R_DECODE_ERROR				 101
 #define PKCS12_R_ENCODE_ERROR				 102
 #define PKCS12_R_ENCRYPT_ERROR				 103
-#define PKCS12_R_ERROR_SETTING_ENCRYPTED_DATA_TYPE	 120
-#define PKCS12_R_INVALID_NULL_ARGUMENT			 104
-#define PKCS12_R_INVALID_NULL_PKCS12_POINTER		 105
-#define PKCS12_R_IV_GEN_ERROR				 106
-#define PKCS12_R_KEY_GEN_ERROR				 107
-#define PKCS12_R_MAC_ABSENT				 108
-#define PKCS12_R_MAC_GENERATION_ERROR			 109
-#define PKCS12_R_MAC_SETUP_ERROR			 110
-#define PKCS12_R_MAC_STRING_SET_ERROR			 111
-#define PKCS12_R_MAC_VERIFY_ERROR			 112
+#define PKCS12_R_ERROR_SETTING_ENCRYPTED_DATA_TYPE	 104
+#define PKCS12_R_INVALID_NULL_ARGUMENT			 105
+#define PKCS12_R_INVALID_NULL_PKCS12_POINTER		 106
+#define PKCS12_R_IV_GEN_ERROR				 107
+#define PKCS12_R_KEY_GEN_ERROR				 108
+#define PKCS12_R_MAC_ABSENT				 109
+#define PKCS12_R_MAC_GENERATION_ERROR			 110
+#define PKCS12_R_MAC_SETUP_ERROR			 111
+#define PKCS12_R_MAC_STRING_SET_ERROR			 112
 #define PKCS12_R_MAC_VERIFY_FAILURE			 113
 #define PKCS12_R_PARSE_ERROR				 114
 #define PKCS12_R_PKCS12_ALGOR_CIPHERINIT_ERROR		 115
Index: openssl/crypto/pkcs7/pkcs7.h
diff -u openssl/crypto/pkcs7/pkcs7.h:1.1.1.3 openssl/crypto/pkcs7/pkcs7.h:1.1.1.3.6.1
--- openssl/crypto/pkcs7/pkcs7.h:1.1.1.3	Wed Oct  8 11:35:55 2003
+++ openssl/crypto/pkcs7/pkcs7.h	Mon Nov  8 16:31:08 2004
@@ -232,6 +232,9 @@
 #define PKCS7_type_is_signedAndEnveloped(a) \
 		(OBJ_obj2nid((a)->type) == NID_pkcs7_signedAndEnveloped)
 #define PKCS7_type_is_data(a)   (OBJ_obj2nid((a)->type) == NID_pkcs7_data)
+#define PKCS7_type_is_digest(a)   (OBJ_obj2nid((a)->type) == NID_pkcs7_digest)
+#define PKCS7_type_is_encrypted(a) \
+		(OBJ_obj2nid((a)->type) == NID_pkcs7_encrypted)
 
 #define PKCS7_set_detached(p,v) \
 		PKCS7_ctrl(p,PKCS7_OP_SET_DETACHED_SIGNATURE,v,NULL)
@@ -374,76 +377,76 @@
 /* Error codes for the PKCS7 functions. */
 
 /* Function codes. */
-#define PKCS7_F_B64_READ_PKCS7				 120
-#define PKCS7_F_B64_WRITE_PKCS7				 121
-#define PKCS7_F_PKCS7_ADD_ATTRIB_SMIMECAP		 118
-#define PKCS7_F_PKCS7_ADD_CERTIFICATE			 100
-#define PKCS7_F_PKCS7_ADD_CRL				 101
-#define PKCS7_F_PKCS7_ADD_RECIPIENT_INFO		 102
-#define PKCS7_F_PKCS7_ADD_SIGNER			 103
-#define PKCS7_F_PKCS7_CTRL				 104
-#define PKCS7_F_PKCS7_DATADECODE			 112
-#define PKCS7_F_PKCS7_DATAINIT				 105
-#define PKCS7_F_PKCS7_DATASIGN				 106
-#define PKCS7_F_PKCS7_DATAVERIFY			 107
-#define PKCS7_F_PKCS7_DECRYPT				 114
-#define PKCS7_F_PKCS7_ENCRYPT				 115
-#define PKCS7_F_PKCS7_GET0_SIGNERS			 124
-#define PKCS7_F_PKCS7_SET_CIPHER			 108
-#define PKCS7_F_PKCS7_SET_CONTENT			 109
-#define PKCS7_F_PKCS7_SET_TYPE				 110
-#define PKCS7_F_PKCS7_SIGN				 116
-#define PKCS7_F_PKCS7_SIGNATUREVERIFY			 113
-#define PKCS7_F_PKCS7_SIMPLE_SMIMECAP			 119
-#define PKCS7_F_PKCS7_VERIFY				 117
+#define PKCS7_F_B64_READ_PKCS7				 100
+#define PKCS7_F_B64_WRITE_PKCS7				 101
+#define PKCS7_F_PKCS7_ADD_ATTRIB_SMIMECAP		 102
+#define PKCS7_F_PKCS7_ADD_CERTIFICATE			 103
+#define PKCS7_F_PKCS7_ADD_CRL				 104
+#define PKCS7_F_PKCS7_ADD_RECIPIENT_INFO		 105
+#define PKCS7_F_PKCS7_ADD_SIGNER			 106
+#define PKCS7_F_PKCS7_CTRL				 107
+#define PKCS7_F_PKCS7_DATADECODE			 108
+#define PKCS7_F_PKCS7_DATAINIT				 109
+#define PKCS7_F_PKCS7_DATASIGN				 110
+#define PKCS7_F_PKCS7_DATAVERIFY			 111
+#define PKCS7_F_PKCS7_DECRYPT				 112
+#define PKCS7_F_PKCS7_ENCRYPT				 113
+#define PKCS7_F_PKCS7_GET0_SIGNERS			 114
+#define PKCS7_F_PKCS7_SET_CIPHER			 115
+#define PKCS7_F_PKCS7_SET_CONTENT			 116
+#define PKCS7_F_PKCS7_SET_TYPE				 117
+#define PKCS7_F_PKCS7_SIGN				 118
+#define PKCS7_F_PKCS7_SIGNATUREVERIFY			 119
+#define PKCS7_F_PKCS7_SIMPLE_SMIMECAP			 120
+#define PKCS7_F_PKCS7_VERIFY				 121
 #define PKCS7_F_SMIME_READ_PKCS7			 122
 #define PKCS7_F_SMIME_TEXT				 123
 
 /* Reason codes. */
-#define PKCS7_R_CERTIFICATE_VERIFY_ERROR		 117
-#define PKCS7_R_CIPHER_HAS_NO_OBJECT_IDENTIFIER		 144
-#define PKCS7_R_CIPHER_NOT_INITIALIZED			 116
-#define PKCS7_R_CONTENT_AND_DATA_PRESENT		 118
-#define PKCS7_R_DECODE_ERROR				 130
-#define PKCS7_R_DECRYPTED_KEY_IS_WRONG_LENGTH		 100
-#define PKCS7_R_DECRYPT_ERROR				 119
-#define PKCS7_R_DIGEST_FAILURE				 101
-#define PKCS7_R_ERROR_ADDING_RECIPIENT			 120
-#define PKCS7_R_ERROR_SETTING_CIPHER			 121
-#define PKCS7_R_INVALID_MIME_TYPE			 131
-#define PKCS7_R_INVALID_NULL_POINTER			 143
-#define PKCS7_R_MIME_NO_CONTENT_TYPE			 132
-#define PKCS7_R_MIME_PARSE_ERROR			 133
-#define PKCS7_R_MIME_SIG_PARSE_ERROR			 134
-#define PKCS7_R_MISSING_CERIPEND_INFO			 103
-#define PKCS7_R_NO_CONTENT				 122
-#define PKCS7_R_NO_CONTENT_TYPE				 135
-#define PKCS7_R_NO_MULTIPART_BODY_FAILURE		 136
-#define PKCS7_R_NO_MULTIPART_BOUNDARY			 137
-#define PKCS7_R_NO_RECIPIENT_MATCHES_CERTIFICATE	 115
-#define PKCS7_R_NO_SIGNATURES_ON_DATA			 123
-#define PKCS7_R_NO_SIGNERS				 142
-#define PKCS7_R_NO_SIG_CONTENT_TYPE			 138
-#define PKCS7_R_OPERATION_NOT_SUPPORTED_ON_THIS_TYPE	 104
-#define PKCS7_R_PKCS7_ADD_SIGNATURE_ERROR		 124
-#define PKCS7_R_PKCS7_DATAFINAL_ERROR			 125
-#define PKCS7_R_PKCS7_DATASIGN				 126
-#define PKCS7_R_PKCS7_PARSE_ERROR			 139
-#define PKCS7_R_PKCS7_SIG_PARSE_ERROR			 140
-#define PKCS7_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE	 127
-#define PKCS7_R_SIGNATURE_FAILURE			 105
-#define PKCS7_R_SIGNER_CERTIFICATE_NOT_FOUND		 128
-#define PKCS7_R_SIG_INVALID_MIME_TYPE			 141
-#define PKCS7_R_SMIME_TEXT_ERROR			 129
-#define PKCS7_R_UNABLE_TO_FIND_CERTIFICATE		 106
-#define PKCS7_R_UNABLE_TO_FIND_MEM_BIO			 107
-#define PKCS7_R_UNABLE_TO_FIND_MESSAGE_DIGEST		 108
-#define PKCS7_R_UNKNOWN_DIGEST_TYPE			 109
-#define PKCS7_R_UNKNOWN_OPERATION			 110
-#define PKCS7_R_UNSUPPORTED_CIPHER_TYPE			 111
-#define PKCS7_R_UNSUPPORTED_CONTENT_TYPE		 112
-#define PKCS7_R_WRONG_CONTENT_TYPE			 113
-#define PKCS7_R_WRONG_PKCS7_TYPE			 114
+#define PKCS7_R_CERTIFICATE_VERIFY_ERROR		 100
+#define PKCS7_R_CIPHER_HAS_NO_OBJECT_IDENTIFIER		 101
+#define PKCS7_R_CIPHER_NOT_INITIALIZED			 102
+#define PKCS7_R_CONTENT_AND_DATA_PRESENT		 103
+#define PKCS7_R_DECODE_ERROR				 104
+#define PKCS7_R_DECRYPTED_KEY_IS_WRONG_LENGTH		 105
+#define PKCS7_R_DECRYPT_ERROR				 106
+#define PKCS7_R_DIGEST_FAILURE				 107
+#define PKCS7_R_ERROR_ADDING_RECIPIENT			 108
+#define PKCS7_R_ERROR_SETTING_CIPHER			 109
+#define PKCS7_R_INVALID_MIME_TYPE			 110
+#define PKCS7_R_INVALID_NULL_POINTER			 111
+#define PKCS7_R_MIME_NO_CONTENT_TYPE			 112
+#define PKCS7_R_MIME_PARSE_ERROR			 113
+#define PKCS7_R_MIME_SIG_PARSE_ERROR			 114
+#define PKCS7_R_MISSING_CERIPEND_INFO			 115
+#define PKCS7_R_NO_CONTENT				 116
+#define PKCS7_R_NO_CONTENT_TYPE				 117
+#define PKCS7_R_NO_MULTIPART_BODY_FAILURE		 118
+#define PKCS7_R_NO_MULTIPART_BOUNDARY			 119
+#define PKCS7_R_NO_RECIPIENT_MATCHES_CERTIFICATE	 120
+#define PKCS7_R_NO_SIGNATURES_ON_DATA			 121
+#define PKCS7_R_NO_SIGNERS				 122
+#define PKCS7_R_NO_SIG_CONTENT_TYPE			 123
+#define PKCS7_R_OPERATION_NOT_SUPPORTED_ON_THIS_TYPE	 124
+#define PKCS7_R_PKCS7_ADD_SIGNATURE_ERROR		 125
+#define PKCS7_R_PKCS7_DATAFINAL_ERROR			 126
+#define PKCS7_R_PKCS7_DATASIGN				 127
+#define PKCS7_R_PKCS7_PARSE_ERROR			 128
+#define PKCS7_R_PKCS7_SIG_PARSE_ERROR			 129
+#define PKCS7_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE	 130
+#define PKCS7_R_SIGNATURE_FAILURE			 131
+#define PKCS7_R_SIGNER_CERTIFICATE_NOT_FOUND		 132
+#define PKCS7_R_SIG_INVALID_MIME_TYPE			 133
+#define PKCS7_R_SMIME_TEXT_ERROR			 134
+#define PKCS7_R_UNABLE_TO_FIND_CERTIFICATE		 135
+#define PKCS7_R_UNABLE_TO_FIND_MEM_BIO			 136
+#define PKCS7_R_UNABLE_TO_FIND_MESSAGE_DIGEST		 137
+#define PKCS7_R_UNKNOWN_DIGEST_TYPE			 138
+#define PKCS7_R_UNKNOWN_OPERATION			 139
+#define PKCS7_R_UNSUPPORTED_CIPHER_TYPE			 140
+#define PKCS7_R_UNSUPPORTED_CONTENT_TYPE		 141
+#define PKCS7_R_WRONG_CONTENT_TYPE			 142
+#define PKCS7_R_WRONG_PKCS7_TYPE			 143
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/pkcs7/pkcs7err.c
diff -u openssl/crypto/pkcs7/pkcs7err.c:1.1.1.2 openssl/crypto/pkcs7/pkcs7err.c:1.1.1.2.12.1
--- openssl/crypto/pkcs7/pkcs7err.c:1.1.1.2	Fri Jan 17 22:07:59 2003
+++ openssl/crypto/pkcs7/pkcs7err.c	Mon Nov  8 16:31:08 2004
@@ -1,6 +1,6 @@
 /* crypto/pkcs7/pkcs7err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
Index: openssl/crypto/rsa/rsa.h
diff -u openssl/crypto/rsa/rsa.h:1.1.1.6 openssl/crypto/rsa/rsa.h:1.1.1.6.2.1
--- openssl/crypto/rsa/rsa.h:1.1.1.6	Mon Nov  8 15:32:51 2004
+++ openssl/crypto/rsa/rsa.h	Mon Nov  8 16:31:08 2004
@@ -301,30 +301,30 @@
 
 /* Function codes. */
 #define RSA_F_MEMORY_LOCK				 100
-#define RSA_F_RSA_CHECK_KEY				 123
-#define RSA_F_RSA_EAY_PRIVATE_DECRYPT			 101
-#define RSA_F_RSA_EAY_PRIVATE_ENCRYPT			 102
-#define RSA_F_RSA_EAY_PUBLIC_DECRYPT			 103
-#define RSA_F_RSA_EAY_PUBLIC_ENCRYPT			 104
-#define RSA_F_RSA_GENERATE_KEY				 105
-#define RSA_F_RSA_NEW_METHOD				 106
-#define RSA_F_RSA_NULL					 124
-#define RSA_F_RSA_PADDING_ADD_NONE			 107
-#define RSA_F_RSA_PADDING_ADD_PKCS1_OAEP		 121
-#define RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_1		 108
-#define RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_2		 109
-#define RSA_F_RSA_PADDING_ADD_SSLV23			 110
-#define RSA_F_RSA_PADDING_CHECK_NONE			 111
-#define RSA_F_RSA_PADDING_CHECK_PKCS1_OAEP		 122
-#define RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_1		 112
-#define RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_2		 113
-#define RSA_F_RSA_PADDING_CHECK_SSLV23			 114
-#define RSA_F_RSA_PRINT					 115
-#define RSA_F_RSA_PRINT_FP				 116
-#define RSA_F_RSA_SIGN					 117
-#define RSA_F_RSA_SIGN_ASN1_OCTET_STRING		 118
-#define RSA_F_RSA_VERIFY				 119
-#define RSA_F_RSA_VERIFY_ASN1_OCTET_STRING		 120
+#define RSA_F_RSA_CHECK_KEY				 101
+#define RSA_F_RSA_EAY_PRIVATE_DECRYPT			 102
+#define RSA_F_RSA_EAY_PRIVATE_ENCRYPT			 103
+#define RSA_F_RSA_EAY_PUBLIC_DECRYPT			 104
+#define RSA_F_RSA_EAY_PUBLIC_ENCRYPT			 105
+#define RSA_F_RSA_GENERATE_KEY				 106
+#define RSA_F_RSA_NEW_METHOD				 107
+#define RSA_F_RSA_NULL					 108
+#define RSA_F_RSA_PADDING_ADD_NONE			 109
+#define RSA_F_RSA_PADDING_ADD_PKCS1_OAEP		 110
+#define RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_1		 111
+#define RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_2		 112
+#define RSA_F_RSA_PADDING_ADD_SSLV23			 113
+#define RSA_F_RSA_PADDING_CHECK_NONE			 114
+#define RSA_F_RSA_PADDING_CHECK_PKCS1_OAEP		 115
+#define RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_1		 116
+#define RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_2		 117
+#define RSA_F_RSA_PADDING_CHECK_SSLV23			 118
+#define RSA_F_RSA_PRINT					 119
+#define RSA_F_RSA_PRINT_FP				 120
+#define RSA_F_RSA_SIGN					 121
+#define RSA_F_RSA_SIGN_ASN1_OCTET_STRING		 122
+#define RSA_F_RSA_VERIFY				 123
+#define RSA_F_RSA_VERIFY_ASN1_OCTET_STRING		 124
 
 /* Reason codes. */
 #define RSA_R_ALGORITHM_MISMATCH			 100
@@ -332,33 +332,33 @@
 #define RSA_R_BAD_FIXED_HEADER_DECRYPT			 102
 #define RSA_R_BAD_PAD_BYTE_COUNT			 103
 #define RSA_R_BAD_SIGNATURE				 104
-#define RSA_R_BLOCK_TYPE_IS_NOT_01			 106
-#define RSA_R_BLOCK_TYPE_IS_NOT_02			 107
-#define RSA_R_DATA_GREATER_THAN_MOD_LEN			 108
-#define RSA_R_DATA_TOO_LARGE				 109
-#define RSA_R_DATA_TOO_LARGE_FOR_KEY_SIZE		 110
-#define RSA_R_DATA_TOO_LARGE_FOR_MODULUS		 132
+#define RSA_R_BLOCK_TYPE_IS_NOT_01			 105
+#define RSA_R_BLOCK_TYPE_IS_NOT_02			 106
+#define RSA_R_DATA_GREATER_THAN_MOD_LEN			 107
+#define RSA_R_DATA_TOO_LARGE				 108
+#define RSA_R_DATA_TOO_LARGE_FOR_KEY_SIZE		 109
+#define RSA_R_DATA_TOO_LARGE_FOR_MODULUS		 110
 #define RSA_R_DATA_TOO_SMALL				 111
-#define RSA_R_DATA_TOO_SMALL_FOR_KEY_SIZE		 122
-#define RSA_R_DIGEST_TOO_BIG_FOR_RSA_KEY		 112
-#define RSA_R_DMP1_NOT_CONGRUENT_TO_D			 124
-#define RSA_R_DMQ1_NOT_CONGRUENT_TO_D			 125
-#define RSA_R_D_E_NOT_CONGRUENT_TO_1			 123
-#define RSA_R_INVALID_MESSAGE_LENGTH			 131
-#define RSA_R_IQMP_NOT_INVERSE_OF_Q			 126
-#define RSA_R_KEY_SIZE_TOO_SMALL			 120
-#define RSA_R_NULL_BEFORE_BLOCK_MISSING			 113
-#define RSA_R_N_DOES_NOT_EQUAL_P_Q			 127
-#define RSA_R_OAEP_DECODING_ERROR			 121
-#define RSA_R_PADDING_CHECK_FAILED			 114
-#define RSA_R_P_NOT_PRIME				 128
-#define RSA_R_Q_NOT_PRIME				 129
-#define RSA_R_RSA_OPERATIONS_NOT_SUPPORTED		 130
-#define RSA_R_SSLV3_ROLLBACK_ATTACK			 115
-#define RSA_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD 116
-#define RSA_R_UNKNOWN_ALGORITHM_TYPE			 117
-#define RSA_R_UNKNOWN_PADDING_TYPE			 118
-#define RSA_R_WRONG_SIGNATURE_LENGTH			 119
+#define RSA_R_DATA_TOO_SMALL_FOR_KEY_SIZE		 112
+#define RSA_R_DIGEST_TOO_BIG_FOR_RSA_KEY		 113
+#define RSA_R_DMP1_NOT_CONGRUENT_TO_D			 114
+#define RSA_R_DMQ1_NOT_CONGRUENT_TO_D			 115
+#define RSA_R_D_E_NOT_CONGRUENT_TO_1			 116
+#define RSA_R_INVALID_MESSAGE_LENGTH			 117
+#define RSA_R_IQMP_NOT_INVERSE_OF_Q			 118
+#define RSA_R_KEY_SIZE_TOO_SMALL			 119
+#define RSA_R_NULL_BEFORE_BLOCK_MISSING			 120
+#define RSA_R_N_DOES_NOT_EQUAL_P_Q			 121
+#define RSA_R_OAEP_DECODING_ERROR			 122
+#define RSA_R_PADDING_CHECK_FAILED			 123
+#define RSA_R_P_NOT_PRIME				 124
+#define RSA_R_Q_NOT_PRIME				 125
+#define RSA_R_RSA_OPERATIONS_NOT_SUPPORTED		 126
+#define RSA_R_SSLV3_ROLLBACK_ATTACK			 127
+#define RSA_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD 128
+#define RSA_R_UNKNOWN_ALGORITHM_TYPE			 129
+#define RSA_R_UNKNOWN_PADDING_TYPE			 130
+#define RSA_R_WRONG_SIGNATURE_LENGTH			 131
 
 #ifdef  __cplusplus
 }
Index: openssl/crypto/rsa/rsa_err.c
diff -u openssl/crypto/rsa/rsa_err.c:1.1.1.2 openssl/crypto/rsa/rsa_err.c:1.1.1.2.12.1
--- openssl/crypto/rsa/rsa_err.c:1.1.1.2	Fri Jan 17 22:08:02 2003
+++ openssl/crypto/rsa/rsa_err.c	Mon Nov  8 16:31:08 2004
@@ -1,6 +1,6 @@
 /* crypto/rsa/rsa_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
Index: openssl/crypto/stack/safestack.h
diff -u openssl/crypto/stack/safestack.h:1.1.1.3 openssl/crypto/stack/safestack.h:1.1.1.3.2.1
--- openssl/crypto/stack/safestack.h:1.1.1.3	Mon Nov  8 15:32:52 2004
+++ openssl/crypto/stack/safestack.h	Mon Nov  8 16:31:08 2004
@@ -334,6 +334,26 @@
 #define sk_ASN1_TYPE_sort(st) SKM_sk_sort(ASN1_TYPE, (st))
 #define sk_ASN1_TYPE_is_sorted(st) SKM_sk_is_sorted(ASN1_TYPE, (st))
 
+#define sk_ASN1_UTF8STRING_new(st) SKM_sk_new(ASN1_UTF8STRING, (st))
+#define sk_ASN1_UTF8STRING_new_null() SKM_sk_new_null(ASN1_UTF8STRING)
+#define sk_ASN1_UTF8STRING_free(st) SKM_sk_free(ASN1_UTF8STRING, (st))
+#define sk_ASN1_UTF8STRING_num(st) SKM_sk_num(ASN1_UTF8STRING, (st))
+#define sk_ASN1_UTF8STRING_value(st, i) SKM_sk_value(ASN1_UTF8STRING, (st), (i))
+#define sk_ASN1_UTF8STRING_set(st, i, val) SKM_sk_set(ASN1_UTF8STRING, (st), (i), (val))
+#define sk_ASN1_UTF8STRING_zero(st) SKM_sk_zero(ASN1_UTF8STRING, (st))
+#define sk_ASN1_UTF8STRING_push(st, val) SKM_sk_push(ASN1_UTF8STRING, (st), (val))
+#define sk_ASN1_UTF8STRING_unshift(st, val) SKM_sk_unshift(ASN1_UTF8STRING, (st), (val))
+#define sk_ASN1_UTF8STRING_find(st, val) SKM_sk_find(ASN1_UTF8STRING, (st), (val))
+#define sk_ASN1_UTF8STRING_delete(st, i) SKM_sk_delete(ASN1_UTF8STRING, (st), (i))
+#define sk_ASN1_UTF8STRING_delete_ptr(st, ptr) SKM_sk_delete_ptr(ASN1_UTF8STRING, (st), (ptr))
+#define sk_ASN1_UTF8STRING_insert(st, val, i) SKM_sk_insert(ASN1_UTF8STRING, (st), (val), (i))
+#define sk_ASN1_UTF8STRING_set_cmp_func(st, cmp) SKM_sk_set_cmp_func(ASN1_UTF8STRING, (st), (cmp))
+#define sk_ASN1_UTF8STRING_dup(st) SKM_sk_dup(ASN1_UTF8STRING, st)
+#define sk_ASN1_UTF8STRING_pop_free(st, free_func) SKM_sk_pop_free(ASN1_UTF8STRING, (st), (free_func))
+#define sk_ASN1_UTF8STRING_shift(st) SKM_sk_shift(ASN1_UTF8STRING, (st))
+#define sk_ASN1_UTF8STRING_pop(st) SKM_sk_pop(ASN1_UTF8STRING, (st))
+#define sk_ASN1_UTF8STRING_sort(st) SKM_sk_sort(ASN1_UTF8STRING, (st))
+
 #define sk_ASN1_VALUE_new(st) SKM_sk_new(ASN1_VALUE, (st))
 #define sk_ASN1_VALUE_new_null() SKM_sk_new_null(ASN1_VALUE)
 #define sk_ASN1_VALUE_free(st) SKM_sk_free(ASN1_VALUE, (st))
@@ -544,6 +564,46 @@
 #define sk_ENGINE_CLEANUP_ITEM_sort(st) SKM_sk_sort(ENGINE_CLEANUP_ITEM, (st))
 #define sk_ENGINE_CLEANUP_ITEM_is_sorted(st) SKM_sk_is_sorted(ENGINE_CLEANUP_ITEM, (st))
 
+#define sk_ESS_CERT_ID_new(st) SKM_sk_new(ESS_CERT_ID, (st))
+#define sk_ESS_CERT_ID_new_null() SKM_sk_new_null(ESS_CERT_ID)
+#define sk_ESS_CERT_ID_free(st) SKM_sk_free(ESS_CERT_ID, (st))
+#define sk_ESS_CERT_ID_num(st) SKM_sk_num(ESS_CERT_ID, (st))
+#define sk_ESS_CERT_ID_value(st, i) SKM_sk_value(ESS_CERT_ID, (st), (i))
+#define sk_ESS_CERT_ID_set(st, i, val) SKM_sk_set(ESS_CERT_ID, (st), (i), (val))
+#define sk_ESS_CERT_ID_zero(st) SKM_sk_zero(ESS_CERT_ID, (st))
+#define sk_ESS_CERT_ID_push(st, val) SKM_sk_push(ESS_CERT_ID, (st), (val))
+#define sk_ESS_CERT_ID_unshift(st, val) SKM_sk_unshift(ESS_CERT_ID, (st), (val))
+#define sk_ESS_CERT_ID_find(st, val) SKM_sk_find(ESS_CERT_ID, (st), (val))
+#define sk_ESS_CERT_ID_delete(st, i) SKM_sk_delete(ESS_CERT_ID, (st), (i))
+#define sk_ESS_CERT_ID_delete_ptr(st, ptr) SKM_sk_delete_ptr(ESS_CERT_ID, (st), (ptr))
+#define sk_ESS_CERT_ID_insert(st, val, i) SKM_sk_insert(ESS_CERT_ID, (st), (val), (i))
+#define sk_ESS_CERT_ID_set_cmp_func(st, cmp) SKM_sk_set_cmp_func(ESS_CERT_ID, (st), (cmp))
+#define sk_ESS_CERT_ID_dup(st) SKM_sk_dup(ESS_CERT_ID, st)
+#define sk_ESS_CERT_ID_pop_free(st, free_func) SKM_sk_pop_free(ESS_CERT_ID, (st), (free_func))
+#define sk_ESS_CERT_ID_shift(st) SKM_sk_shift(ESS_CERT_ID, (st))
+#define sk_ESS_CERT_ID_pop(st) SKM_sk_pop(ESS_CERT_ID, (st))
+#define sk_ESS_CERT_ID_sort(st) SKM_sk_sort(ESS_CERT_ID, (st))
+
+#define sk_EVP_MD_new(st) SKM_sk_new(EVP_MD, (st))
+#define sk_EVP_MD_new_null() SKM_sk_new_null(EVP_MD)
+#define sk_EVP_MD_free(st) SKM_sk_free(EVP_MD, (st))
+#define sk_EVP_MD_num(st) SKM_sk_num(EVP_MD, (st))
+#define sk_EVP_MD_value(st, i) SKM_sk_value(EVP_MD, (st), (i))
+#define sk_EVP_MD_set(st, i, val) SKM_sk_set(EVP_MD, (st), (i), (val))
+#define sk_EVP_MD_zero(st) SKM_sk_zero(EVP_MD, (st))
+#define sk_EVP_MD_push(st, val) SKM_sk_push(EVP_MD, (st), (val))
+#define sk_EVP_MD_unshift(st, val) SKM_sk_unshift(EVP_MD, (st), (val))
+#define sk_EVP_MD_find(st, val) SKM_sk_find(EVP_MD, (st), (val))
+#define sk_EVP_MD_delete(st, i) SKM_sk_delete(EVP_MD, (st), (i))
+#define sk_EVP_MD_delete_ptr(st, ptr) SKM_sk_delete_ptr(EVP_MD, (st), (ptr))
+#define sk_EVP_MD_insert(st, val, i) SKM_sk_insert(EVP_MD, (st), (val), (i))
+#define sk_EVP_MD_set_cmp_func(st, cmp) SKM_sk_set_cmp_func(EVP_MD, (st), (cmp))
+#define sk_EVP_MD_dup(st) SKM_sk_dup(EVP_MD, st)
+#define sk_EVP_MD_pop_free(st, free_func) SKM_sk_pop_free(EVP_MD, (st), (free_func))
+#define sk_EVP_MD_shift(st) SKM_sk_shift(EVP_MD, (st))
+#define sk_EVP_MD_pop(st) SKM_sk_pop(EVP_MD, (st))
+#define sk_EVP_MD_sort(st) SKM_sk_sort(EVP_MD, (st))
+
 #define sk_GENERAL_NAME_new(st) SKM_sk_new(GENERAL_NAME, (st))
 #define sk_GENERAL_NAME_new_null() SKM_sk_new_null(GENERAL_NAME)
 #define sk_GENERAL_NAME_free(st) SKM_sk_free(GENERAL_NAME, (st))
@@ -1399,6 +1459,15 @@
 #define ASN1_seq_unpack_ASN1_TYPE(buf, len, d2i_func, free_func) \
 	SKM_ASN1_seq_unpack(ASN1_TYPE, (buf), (len), (d2i_func), (free_func))
 
+#define d2i_ASN1_SET_OF_ASN1_UTF8STRING(st, pp, length, d2i_func, free_func, ex_tag, ex_class) \
+	SKM_ASN1_SET_OF_d2i(ASN1_UTF8STRING, (st), (pp), (length), (d2i_func), (free_func), (ex_tag), (ex_class)) 
+#define i2d_ASN1_SET_OF_ASN1_UTF8STRING(st, pp, i2d_func, ex_tag, ex_class, is_set) \
+	SKM_ASN1_SET_OF_i2d(ASN1_UTF8STRING, (st), (pp), (i2d_func), (ex_tag), (ex_class), (is_set))
+#define ASN1_seq_pack_ASN1_UTF8STRING(st, i2d_func, buf, len) \
+	SKM_ASN1_seq_pack(ASN1_UTF8STRING, (st), (i2d_func), (buf), (len))
+#define ASN1_seq_unpack_ASN1_UTF8STRING(buf, len, d2i_func, free_func) \
+	SKM_ASN1_seq_unpack(ASN1_UTF8STRING, (buf), (len), (d2i_func), (free_func))
+
 #define d2i_ASN1_SET_OF_DIST_POINT(st, pp, length, d2i_func, free_func, ex_tag, ex_class) \
 	SKM_ASN1_SET_OF_d2i(DIST_POINT, (st), (pp), (length), (d2i_func), (free_func), (ex_tag), (ex_class)) 
 #define i2d_ASN1_SET_OF_DIST_POINT(st, pp, i2d_func, ex_tag, ex_class, is_set) \
@@ -1407,6 +1476,24 @@
 	SKM_ASN1_seq_pack(DIST_POINT, (st), (i2d_func), (buf), (len))
 #define ASN1_seq_unpack_DIST_POINT(buf, len, d2i_func, free_func) \
 	SKM_ASN1_seq_unpack(DIST_POINT, (buf), (len), (d2i_func), (free_func))
+
+#define d2i_ASN1_SET_OF_ESS_CERT_ID(st, pp, length, d2i_func, free_func, ex_tag, ex_class) \
+	SKM_ASN1_SET_OF_d2i(ESS_CERT_ID, (st), (pp), (length), (d2i_func), (free_func), (ex_tag), (ex_class)) 
+#define i2d_ASN1_SET_OF_ESS_CERT_ID(st, pp, i2d_func, ex_tag, ex_class, is_set) \
+	SKM_ASN1_SET_OF_i2d(ESS_CERT_ID, (st), (pp), (i2d_func), (ex_tag), (ex_class), (is_set))
+#define ASN1_seq_pack_ESS_CERT_ID(st, i2d_func, buf, len) \
+	SKM_ASN1_seq_pack(ESS_CERT_ID, (st), (i2d_func), (buf), (len))
+#define ASN1_seq_unpack_ESS_CERT_ID(buf, len, d2i_func, free_func) \
+	SKM_ASN1_seq_unpack(ESS_CERT_ID, (buf), (len), (d2i_func), (free_func))
+
+#define d2i_ASN1_SET_OF_EVP_MD(st, pp, length, d2i_func, free_func, ex_tag, ex_class) \
+	SKM_ASN1_SET_OF_d2i(EVP_MD, (st), (pp), (length), (d2i_func), (free_func), (ex_tag), (ex_class)) 
+#define i2d_ASN1_SET_OF_EVP_MD(st, pp, i2d_func, ex_tag, ex_class, is_set) \
+	SKM_ASN1_SET_OF_i2d(EVP_MD, (st), (pp), (i2d_func), (ex_tag), (ex_class), (is_set))
+#define ASN1_seq_pack_EVP_MD(st, i2d_func, buf, len) \
+	SKM_ASN1_seq_pack(EVP_MD, (st), (i2d_func), (buf), (len))
+#define ASN1_seq_unpack_EVP_MD(buf, len, d2i_func, free_func) \
+	SKM_ASN1_seq_unpack(EVP_MD, (buf), (len), (d2i_func), (free_func))
 
 #define d2i_ASN1_SET_OF_GENERAL_NAME(st, pp, length, d2i_func, free_func, ex_tag, ex_class) \
 	SKM_ASN1_SET_OF_d2i(GENERAL_NAME, (st), (pp), (length), (d2i_func), (free_func), (ex_tag), (ex_class)) 
Index: openssl/crypto/ts/Makefile
diff -u /dev/null openssl/crypto/ts/Makefile:1.1.2.1
--- /dev/null	Tue Nov  9 22:44:02 2004
+++ openssl/crypto/ts/Makefile	Mon Nov  8 16:31:11 2004
@@ -0,0 +1,322 @@
+#
+# SSLeay/crypto/ts/Makefile
+#
+
+DIR=	ts
+TOP=	../..
+CC=	cc
+INCLUDES= -I.. -I../../include
+CFLAG = -g
+INSTALL_PREFIX=
+OPENSSLDIR=     /usr/local/ssl
+INSTALLTOP=/usr/local/ssl
+MAKEDEPPROG=	makedepend
+MAKEDEPEND=	$(TOP)/util/domd $(TOP) -MD $(MAKEDEPPROG)
+MAKEFILE=	Makefile
+AR=		ar r
+
+PEX_LIBS=
+EX_LIBS=
+ 
+CFLAGS= $(INCLUDES) $(CFLAG)
+
+GENERAL= Makefile
+TEST=
+APPS=
+
+LIB=$(TOP)/libcrypto.a
+LIBSRC=	ts_err.c ts_req_utils.c ts_req_print.c ts_resp_utils.c ts_resp_print.c \
+	ts_resp_sign.c ts_resp_verify.c ts_verify_ctx.c ts_lib.c ts_conf.c
+LIBOBJ= ts_err.o ts_req_utils.o ts_req_print.o ts_resp_utils.o ts_resp_print.o \
+	ts_resp_sign.o ts_resp_verify.o ts_verify_ctx.o ts_lib.o ts_conf.o
+
+SRC= $(LIBSRC)
+
+EXHEADER= ts.h
+HEADER=	$(EXHEADER)
+
+ALL=    $(GENERAL) $(SRC) $(HEADER)
+
+top:
+	(cd ../..; $(MAKE) DIRS=crypto SDIRS=$(DIR) sub_all)
+
+test:
+
+all:	lib
+
+lib:	$(LIBOBJ)
+	$(AR) $(LIB) $(LIBOBJ)
+	$(RANLIB) $(LIB) || echo Never mind.
+	@touch lib
+
+files:
+	$(PERL) $(TOP)/util/files.pl Makefile >> $(TOP)/MINFO
+
+links:
+	@$(PERL) $(TOP)/util/mklink.pl ../../include/openssl $(EXHEADER)
+	@$(PERL) $(TOP)/util/mklink.pl ../../test $(TEST)
+	@$(PERL) $(TOP)/util/mklink.pl ../../apps $(APPS)
+
+install:
+	@for i in $(EXHEADER) ; \
+	do  \
+	(cp $$i $(INSTALL_PREFIX)$(INSTALLTOP)/include/openssl/$$i; \
+	chmod 644 $(INSTALL_PREFIX)$(INSTALLTOP)/include/openssl/$$i ); \
+	done;
+
+tags:
+	ctags $(SRC)
+
+lint:
+	lint -DLINT $(INCLUDES) $(SRC)>fluff
+
+depend:
+	$(MAKEDEPEND) -- $(CFLAG) $(INCLUDES) $(DEPFLAG) -- $(LIBSRC)
+
+dclean:
+	$(PERL) -pe 'if (/^# DO NOT DELETE THIS LINE/) {print; exit(0);}' $(MAKEFILE) >Makefile.new
+	mv -f Makefile.new $(MAKEFILE)
+
+clean:
+	rm -f *.o *.obj lib tags core .pure .nfs* *.old *.bak fluff enc dec sign verify
+
+# DO NOT DELETE THIS LINE -- make depend depends on it.
+
+ts_conf.o: ../../include/openssl/aes.h ../../include/openssl/asn1.h
+ts_conf.o: ../../include/openssl/bio.h ../../include/openssl/blowfish.h
+ts_conf.o: ../../include/openssl/bn.h ../../include/openssl/buffer.h
+ts_conf.o: ../../include/openssl/cast.h ../../include/openssl/conf.h
+ts_conf.o: ../../include/openssl/crypto.h ../../include/openssl/des.h
+ts_conf.o: ../../include/openssl/des_old.h ../../include/openssl/dh.h
+ts_conf.o: ../../include/openssl/dsa.h ../../include/openssl/e_os2.h
+ts_conf.o: ../../include/openssl/engine.h ../../include/openssl/err.h
+ts_conf.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_conf.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_conf.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_conf.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_conf.o: ../../include/openssl/objects.h ../../include/openssl/opensslconf.h
+ts_conf.o: ../../include/openssl/opensslv.h ../../include/openssl/ossl_typ.h
+ts_conf.o: ../../include/openssl/pem.h ../../include/openssl/pem2.h
+ts_conf.o: ../../include/openssl/pkcs7.h ../../include/openssl/rand.h
+ts_conf.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_conf.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_conf.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_conf.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_conf.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_conf.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_conf.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_conf.o: ../../include/openssl/x509v3.h ts_conf.c
+ts_err.o: ../../include/openssl/aes.h ../../include/openssl/asn1.h
+ts_err.o: ../../include/openssl/bio.h ../../include/openssl/blowfish.h
+ts_err.o: ../../include/openssl/bn.h ../../include/openssl/buffer.h
+ts_err.o: ../../include/openssl/cast.h ../../include/openssl/conf.h
+ts_err.o: ../../include/openssl/crypto.h ../../include/openssl/des.h
+ts_err.o: ../../include/openssl/des_old.h ../../include/openssl/dh.h
+ts_err.o: ../../include/openssl/dsa.h ../../include/openssl/e_os2.h
+ts_err.o: ../../include/openssl/err.h ../../include/openssl/evp.h
+ts_err.o: ../../include/openssl/idea.h ../../include/openssl/lhash.h
+ts_err.o: ../../include/openssl/md2.h ../../include/openssl/md4.h
+ts_err.o: ../../include/openssl/md5.h ../../include/openssl/mdc2.h
+ts_err.o: ../../include/openssl/obj_mac.h ../../include/openssl/objects.h
+ts_err.o: ../../include/openssl/opensslconf.h ../../include/openssl/opensslv.h
+ts_err.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_err.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_err.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_err.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_err.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_err.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_err.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_err.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_err.o: ../../include/openssl/x509v3.h ts_err.c
+ts_lib.o: ../../e_os.h ../../include/openssl/aes.h ../../include/openssl/asn1.h
+ts_lib.o: ../../include/openssl/bio.h ../../include/openssl/blowfish.h
+ts_lib.o: ../../include/openssl/bn.h ../../include/openssl/buffer.h
+ts_lib.o: ../../include/openssl/cast.h ../../include/openssl/conf.h
+ts_lib.o: ../../include/openssl/crypto.h ../../include/openssl/des.h
+ts_lib.o: ../../include/openssl/des_old.h ../../include/openssl/dh.h
+ts_lib.o: ../../include/openssl/dsa.h ../../include/openssl/e_os2.h
+ts_lib.o: ../../include/openssl/err.h ../../include/openssl/evp.h
+ts_lib.o: ../../include/openssl/idea.h ../../include/openssl/lhash.h
+ts_lib.o: ../../include/openssl/md2.h ../../include/openssl/md4.h
+ts_lib.o: ../../include/openssl/md5.h ../../include/openssl/mdc2.h
+ts_lib.o: ../../include/openssl/obj_mac.h ../../include/openssl/objects.h
+ts_lib.o: ../../include/openssl/opensslconf.h ../../include/openssl/opensslv.h
+ts_lib.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_lib.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_lib.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_lib.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_lib.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_lib.o: ../../include/openssl/symhacks.h ../../include/openssl/ui.h
+ts_lib.o: ../../include/openssl/ui_compat.h ../../include/openssl/x509.h
+ts_lib.o: ../../include/openssl/x509_vfy.h ../../include/openssl/x509v3.h
+ts_lib.o: ../cryptlib.h ts.h ts_lib.c
+ts_req_print.o: ../../e_os.h ../../include/openssl/aes.h
+ts_req_print.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_req_print.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_req_print.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_req_print.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_req_print.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_req_print.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_req_print.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_req_print.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_req_print.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_req_print.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_req_print.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_req_print.o: ../../include/openssl/objects.h
+ts_req_print.o: ../../include/openssl/opensslconf.h
+ts_req_print.o: ../../include/openssl/opensslv.h
+ts_req_print.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_req_print.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_req_print.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_req_print.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_req_print.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_req_print.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_req_print.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_req_print.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_req_print.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_req_print.c
+ts_req_utils.o: ../../e_os.h ../../include/openssl/aes.h
+ts_req_utils.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_req_utils.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_req_utils.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_req_utils.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_req_utils.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_req_utils.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_req_utils.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_req_utils.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_req_utils.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_req_utils.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_req_utils.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_req_utils.o: ../../include/openssl/objects.h
+ts_req_utils.o: ../../include/openssl/opensslconf.h
+ts_req_utils.o: ../../include/openssl/opensslv.h
+ts_req_utils.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_req_utils.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_req_utils.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_req_utils.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_req_utils.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_req_utils.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_req_utils.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_req_utils.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_req_utils.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_req_utils.c
+ts_resp_print.o: ../../e_os.h ../../include/openssl/aes.h
+ts_resp_print.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_resp_print.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_resp_print.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_resp_print.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_resp_print.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_resp_print.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_resp_print.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_resp_print.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_resp_print.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_resp_print.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_resp_print.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_resp_print.o: ../../include/openssl/objects.h
+ts_resp_print.o: ../../include/openssl/opensslconf.h
+ts_resp_print.o: ../../include/openssl/opensslv.h
+ts_resp_print.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_resp_print.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_resp_print.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_resp_print.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_resp_print.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_resp_print.o: ../../include/openssl/symhacks.h ../../include/openssl/ui.h
+ts_resp_print.o: ../../include/openssl/ui_compat.h ../../include/openssl/x509.h
+ts_resp_print.o: ../../include/openssl/x509_vfy.h
+ts_resp_print.o: ../../include/openssl/x509v3.h ../cryptlib.h ts.h
+ts_resp_print.o: ts_resp_print.c
+ts_resp_sign.o: ../../e_os.h ../../include/openssl/aes.h
+ts_resp_sign.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_resp_sign.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_resp_sign.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_resp_sign.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_resp_sign.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_resp_sign.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_resp_sign.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_resp_sign.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_resp_sign.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_resp_sign.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_resp_sign.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_resp_sign.o: ../../include/openssl/objects.h
+ts_resp_sign.o: ../../include/openssl/opensslconf.h
+ts_resp_sign.o: ../../include/openssl/opensslv.h
+ts_resp_sign.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_resp_sign.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_resp_sign.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_resp_sign.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_resp_sign.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_resp_sign.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_resp_sign.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_resp_sign.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_resp_sign.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_resp_sign.c
+ts_resp_utils.o: ../../e_os.h ../../include/openssl/aes.h
+ts_resp_utils.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_resp_utils.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_resp_utils.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_resp_utils.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_resp_utils.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_resp_utils.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_resp_utils.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_resp_utils.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_resp_utils.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_resp_utils.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_resp_utils.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_resp_utils.o: ../../include/openssl/objects.h
+ts_resp_utils.o: ../../include/openssl/opensslconf.h
+ts_resp_utils.o: ../../include/openssl/opensslv.h
+ts_resp_utils.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_resp_utils.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_resp_utils.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_resp_utils.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_resp_utils.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_resp_utils.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_resp_utils.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_resp_utils.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_resp_utils.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_resp_utils.c
+ts_resp_verify.o: ../../e_os.h ../../include/openssl/aes.h
+ts_resp_verify.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_resp_verify.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_resp_verify.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_resp_verify.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_resp_verify.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_resp_verify.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_resp_verify.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_resp_verify.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_resp_verify.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_resp_verify.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_resp_verify.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_resp_verify.o: ../../include/openssl/objects.h
+ts_resp_verify.o: ../../include/openssl/opensslconf.h
+ts_resp_verify.o: ../../include/openssl/opensslv.h
+ts_resp_verify.o: ../../include/openssl/ossl_typ.h
+ts_resp_verify.o: ../../include/openssl/pkcs7.h ../../include/openssl/rc2.h
+ts_resp_verify.o: ../../include/openssl/rc4.h ../../include/openssl/rc5.h
+ts_resp_verify.o: ../../include/openssl/ripemd.h ../../include/openssl/rsa.h
+ts_resp_verify.o: ../../include/openssl/safestack.h ../../include/openssl/sha.h
+ts_resp_verify.o: ../../include/openssl/stack.h
+ts_resp_verify.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_resp_verify.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_resp_verify.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_resp_verify.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_resp_verify.c
+ts_verify_ctx.o: ../../e_os.h ../../include/openssl/aes.h
+ts_verify_ctx.o: ../../include/openssl/asn1.h ../../include/openssl/bio.h
+ts_verify_ctx.o: ../../include/openssl/blowfish.h ../../include/openssl/bn.h
+ts_verify_ctx.o: ../../include/openssl/buffer.h ../../include/openssl/cast.h
+ts_verify_ctx.o: ../../include/openssl/conf.h ../../include/openssl/crypto.h
+ts_verify_ctx.o: ../../include/openssl/des.h ../../include/openssl/des_old.h
+ts_verify_ctx.o: ../../include/openssl/dh.h ../../include/openssl/dsa.h
+ts_verify_ctx.o: ../../include/openssl/e_os2.h ../../include/openssl/err.h
+ts_verify_ctx.o: ../../include/openssl/evp.h ../../include/openssl/idea.h
+ts_verify_ctx.o: ../../include/openssl/lhash.h ../../include/openssl/md2.h
+ts_verify_ctx.o: ../../include/openssl/md4.h ../../include/openssl/md5.h
+ts_verify_ctx.o: ../../include/openssl/mdc2.h ../../include/openssl/obj_mac.h
+ts_verify_ctx.o: ../../include/openssl/objects.h
+ts_verify_ctx.o: ../../include/openssl/opensslconf.h
+ts_verify_ctx.o: ../../include/openssl/opensslv.h
+ts_verify_ctx.o: ../../include/openssl/ossl_typ.h ../../include/openssl/pkcs7.h
+ts_verify_ctx.o: ../../include/openssl/rc2.h ../../include/openssl/rc4.h
+ts_verify_ctx.o: ../../include/openssl/rc5.h ../../include/openssl/ripemd.h
+ts_verify_ctx.o: ../../include/openssl/rsa.h ../../include/openssl/safestack.h
+ts_verify_ctx.o: ../../include/openssl/sha.h ../../include/openssl/stack.h
+ts_verify_ctx.o: ../../include/openssl/symhacks.h ../../include/openssl/ts.h
+ts_verify_ctx.o: ../../include/openssl/ui.h ../../include/openssl/ui_compat.h
+ts_verify_ctx.o: ../../include/openssl/x509.h ../../include/openssl/x509_vfy.h
+ts_verify_ctx.o: ../../include/openssl/x509v3.h ../cryptlib.h ts_verify_ctx.c
Index: openssl/crypto/ts/input.txt
diff -u /dev/null openssl/crypto/ts/input.txt:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:02 2004
+++ openssl/crypto/ts/input.txt	Mon Nov  8 16:31:11 2004
@@ -0,0 +1 @@
+kjfsdkjkasdbnksadfksdndsflsdkjkjhhgkajsdgkjdsagkjhdaksjgkf
Index: openssl/crypto/ts/ts.h
diff -u /dev/null openssl/crypto/ts/ts.h:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:02 2004
+++ openssl/crypto/ts/ts.h	Mon Nov  8 16:31:12 2004
@@ -0,0 +1,853 @@
+/* crypto/ts/ts.h */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#ifndef HEADER_TS_H
+#define HEADER_TS_H
+
+#include <openssl/symhacks.h>
+#ifndef NO_BUFFER
+#include <openssl/buffer.h>
+#endif
+#ifndef NO_EVP
+#include <openssl/evp.h>
+#endif
+#ifndef NO_BIO
+#include <openssl/bio.h>
+#endif
+#include <openssl/stack.h>
+#include <openssl/asn1.h>
+#include <openssl/safestack.h>
+
+#ifndef NO_RSA
+#include <openssl/rsa.h>
+#endif
+
+#ifndef NO_DSA
+#include <openssl/dsa.h>
+#endif
+
+#ifndef NO_DH
+#include <openssl/dh.h>
+#endif
+
+#include <openssl/evp.h>
+
+
+#ifdef  __cplusplus
+extern "C" {
+#endif
+
+#ifdef WIN32
+/* Under Win32 this is defined in wincrypt.h */
+#undef X509_NAME
+#endif
+
+#include <openssl/x509.h>
+#include <openssl/x509v3.h>
+
+/*
+MessageImprint ::= SEQUENCE  {
+     hashAlgorithm                AlgorithmIdentifier,
+     hashedMessage                OCTET STRING  }
+*/
+
+typedef struct TS_msg_imprint_st
+	{
+	X509_ALGOR *hash_algo;
+	ASN1_OCTET_STRING *hashed_msg;
+	} TS_MSG_IMPRINT;
+
+/*
+TimeStampReq ::= SEQUENCE  {
+   version                  INTEGER  { v1(1) },
+   messageImprint           MessageImprint,
+     --a hash algorithm OID and the hash value of the data to be
+     --time-stamped
+   reqPolicy                TSAPolicyId                OPTIONAL,
+   nonce                    INTEGER                    OPTIONAL,
+   certReq                  BOOLEAN                    DEFAULT FALSE,
+   extensions               [0] IMPLICIT Extensions    OPTIONAL  }
+*/
+
+typedef struct TS_req_st
+	{
+	ASN1_INTEGER *version;
+	TS_MSG_IMPRINT *msg_imprint;
+	ASN1_OBJECT *policy_id;		/* OPTIONAL */
+	ASN1_INTEGER *nonce;		/* OPTIONAL */
+	ASN1_BOOLEAN cert_req;		/* DEFAULT FALSE */
+	STACK_OF(X509_EXTENSION) *extensions;	/* [0] OPTIONAL */
+	} TS_REQ;
+
+/*
+Accuracy ::= SEQUENCE {
+                seconds        INTEGER           OPTIONAL,
+                millis     [0] INTEGER  (1..999) OPTIONAL,
+                micros     [1] INTEGER  (1..999) OPTIONAL  }
+*/
+
+typedef struct TS_accuracy_st
+	{
+	ASN1_INTEGER *seconds;
+	ASN1_INTEGER *millis;
+	ASN1_INTEGER *micros;
+	} TS_ACCURACY;
+
+/*
+TSTInfo ::= SEQUENCE  {
+    version                      INTEGER  { v1(1) },
+    policy                       TSAPolicyId,
+    messageImprint               MessageImprint,
+      -- MUST have the same value as the similar field in
+      -- TimeStampReq
+    serialNumber                 INTEGER,
+     -- Time-Stamping users MUST be ready to accommodate integers
+     -- up to 160 bits.
+    genTime                      GeneralizedTime,
+    accuracy                     Accuracy                 OPTIONAL,
+    ordering                     BOOLEAN             DEFAULT FALSE,
+    nonce                        INTEGER                  OPTIONAL,
+      -- MUST be present if the similar field was present
+      -- in TimeStampReq.  In that case it MUST have the same value.
+    tsa                          [0] GeneralName          OPTIONAL,
+    extensions                   [1] IMPLICIT Extensions  OPTIONAL   }
+*/
+
+typedef struct TS_tst_info_st
+	{
+	ASN1_INTEGER *version;
+	ASN1_OBJECT *policy_id;
+	TS_MSG_IMPRINT *msg_imprint;
+	ASN1_INTEGER *serial;
+	ASN1_GENERALIZEDTIME *time;
+	TS_ACCURACY *accuracy;
+	ASN1_BOOLEAN ordering;
+	ASN1_INTEGER *nonce;
+	GENERAL_NAME *tsa;
+	STACK_OF(X509_EXTENSION) *extensions;
+	} TS_TST_INFO;	
+
+/*
+PKIStatusInfo ::= SEQUENCE {
+    status        PKIStatus,
+    statusString  PKIFreeText     OPTIONAL,
+    failInfo      PKIFailureInfo  OPTIONAL  }
+
+From RFC 1510 - section 3.1.1:
+PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
+	-- text encoded as UTF-8 String (note:  each UTF8String SHOULD
+	-- include an RFC 1766 language tag to indicate the language
+	-- of the contained text)
+*/
+
+/* Possible values for status. See ts_resp_print.c && ts_resp_verify.c. */
+
+#define	TS_STATUS_GRANTED			0
+#define	TS_STATUS_GRANTED_WITH_MODS		1
+#define	TS_STATUS_REJECTION			2
+#define	TS_STATUS_WAITING			3
+#define	TS_STATUS_REVOCATION_WARNING		4
+#define	TS_STATUS_REVOCATION_NOTIFICATION	5
+
+/* Possible values for failure_info. See ts_resp_print.c && ts_resp_verify.c */
+
+#define	TS_INFO_BAD_ALG			0
+#define	TS_INFO_BAD_REQUEST		2
+#define	TS_INFO_BAD_DATA_FORMAT		5
+#define	TS_INFO_TIME_NOT_AVAILABLE	14
+#define	TS_INFO_UNACCEPTED_POLICY	15
+#define	TS_INFO_UNACCEPTED_EXTENSION	16
+#define	TS_INFO_ADD_INFO_NOT_AVAILABLE	17
+#define	TS_INFO_SYSTEM_FAILURE		25
+
+typedef struct TS_status_info_st
+	{
+	ASN1_INTEGER *status;
+	STACK_OF(ASN1_UTF8STRING) *text;
+	ASN1_BIT_STRING *failure_info;
+	} TS_STATUS_INFO;
+
+DECLARE_STACK_OF(ASN1_UTF8STRING)
+DECLARE_ASN1_SET_OF(ASN1_UTF8STRING)
+
+/*
+TimeStampResp ::= SEQUENCE  {
+     status                  PKIStatusInfo,
+     timeStampToken          TimeStampToken     OPTIONAL }
+*/
+
+typedef struct TS_resp_st
+	{
+	TS_STATUS_INFO *status_info;
+	PKCS7 *token;
+	TS_TST_INFO *tst_info;
+	} TS_RESP;
+
+/* The structure below would belong to the ESS component. */
+
+/*
+IssuerSerial ::= SEQUENCE {
+	issuer                   GeneralNames,
+	serialNumber             CertificateSerialNumber
+	}
+*/
+
+typedef struct ESS_issuer_serial
+	{
+	STACK_OF(GENERAL_NAME)	*issuer;
+	ASN1_INTEGER		*serial;
+	} ESS_ISSUER_SERIAL;
+
+/*
+ESSCertID ::=  SEQUENCE {
+        certHash                 Hash,
+        issuerSerial             IssuerSerial OPTIONAL
+}
+*/
+
+typedef struct ESS_cert_id
+	{
+	ASN1_OCTET_STRING *hash;	/* Always SHA-1 digest. */
+	ESS_ISSUER_SERIAL *issuer_serial;
+	} ESS_CERT_ID;
+
+DECLARE_STACK_OF(ESS_CERT_ID)
+DECLARE_ASN1_SET_OF(ESS_CERT_ID)
+
+/*
+SigningCertificate ::=  SEQUENCE {
+       certs        SEQUENCE OF ESSCertID,
+       policies     SEQUENCE OF PolicyInformation OPTIONAL
+}
+*/
+
+typedef struct ESS_signing_cert
+	{
+	STACK_OF(ESS_CERT_ID) *cert_ids;
+	STACK_OF(POLICY_INFO) *policy_info;
+	} ESS_SIGNING_CERT;
+
+/* ASN.1 request management functions defined in asn1/ts_req.c */
+
+TS_REQ	*TS_REQ_new(void);
+void	TS_REQ_free(TS_REQ *a);
+int	i2d_TS_REQ(TS_REQ *a, unsigned char **pp);
+TS_REQ	*d2i_TS_REQ(TS_REQ **a, unsigned char **pp, long length);
+
+TS_REQ	*TS_REQ_dup(TS_REQ *a);
+
+TS_REQ	*d2i_TS_REQ_fp(FILE *fp, TS_REQ **a);
+int	i2d_TS_REQ_fp(FILE *fp, TS_REQ *a);
+TS_REQ	*d2i_TS_REQ_bio(BIO *fp, TS_REQ **a);
+int	i2d_TS_REQ_bio(BIO *fp, TS_REQ *a);
+
+TS_MSG_IMPRINT	*TS_MSG_IMPRINT_new(void);
+void		TS_MSG_IMPRINT_free(TS_MSG_IMPRINT *a);
+int		i2d_TS_MSG_IMPRINT(TS_MSG_IMPRINT *a, unsigned char **pp);
+TS_MSG_IMPRINT	*d2i_TS_MSG_IMPRINT(TS_MSG_IMPRINT **a, unsigned char **pp, 
+				   long length);
+
+TS_MSG_IMPRINT	*TS_MSG_IMPRINT_dup(TS_MSG_IMPRINT *a);
+
+TS_MSG_IMPRINT	*d2i_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT **a);
+int		i2d_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT *a);
+TS_MSG_IMPRINT	*d2i_TS_MSG_IMPRINT_bio(BIO *fp, TS_MSG_IMPRINT **a);
+int		i2d_TS_MSG_IMPRINT_bio(BIO *fp, TS_MSG_IMPRINT *a);
+
+/* ASN.1 response management functions defined in asn1/ts_resp.c */
+
+TS_RESP	*TS_RESP_new(void);
+void	TS_RESP_free(TS_RESP *a);
+int	i2d_TS_RESP(TS_RESP *a, unsigned char **pp);
+TS_RESP	*d2i_TS_RESP(TS_RESP **a, unsigned char **pp, long length);
+TS_TST_INFO *PKCS7_to_TS_TST_INFO(PKCS7 *token);
+TS_RESP	*TS_RESP_dup(TS_RESP *a);
+
+TS_RESP	*d2i_TS_RESP_fp(FILE *fp, TS_RESP **a);
+int	i2d_TS_RESP_fp(FILE *fp, TS_RESP *a);
+TS_RESP	*d2i_TS_RESP_bio(BIO *fp, TS_RESP **a);
+int	i2d_TS_RESP_bio(BIO *fp, TS_RESP *a);
+
+TS_STATUS_INFO	*TS_STATUS_INFO_new(void);
+void		TS_STATUS_INFO_free(TS_STATUS_INFO *a);
+int		i2d_TS_STATUS_INFO(TS_STATUS_INFO *a, unsigned char **pp);
+TS_STATUS_INFO	*d2i_TS_STATUS_INFO(TS_STATUS_INFO **a, unsigned char **pp,
+				    long length);
+TS_STATUS_INFO	*TS_STATUS_INFO_dup(TS_STATUS_INFO *a);
+
+TS_TST_INFO	*TS_TST_INFO_new(void);
+void		TS_TST_INFO_free(TS_TST_INFO *a);
+int		i2d_TS_TST_INFO(TS_TST_INFO *a, unsigned char **pp);
+TS_TST_INFO	*d2i_TS_TST_INFO(TS_TST_INFO **a, unsigned char **pp,
+				    long length);
+TS_TST_INFO	*TS_TST_INFO_dup(TS_TST_INFO *a);
+
+TS_TST_INFO	*d2i_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO **a);
+int		i2d_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO *a);
+TS_TST_INFO	*d2i_TS_TST_INFO_bio(BIO *fp, TS_TST_INFO **a);
+int		i2d_TS_TST_INFO_bio(BIO *fp, TS_TST_INFO *a);
+
+TS_ACCURACY	*TS_ACCURACY_new(void);
+void		TS_ACCURACY_free(TS_ACCURACY *a);
+int		i2d_TS_ACCURACY(TS_ACCURACY *a, unsigned char **pp);
+TS_ACCURACY	*d2i_TS_ACCURACY(TS_ACCURACY **a, unsigned char **pp,
+				    long length);
+TS_ACCURACY	*TS_ACCURACY_dup(TS_ACCURACY *a);
+
+ESS_ISSUER_SERIAL *ESS_ISSUER_SERIAL_new(void);
+void		  ESS_ISSUER_SERIAL_free(ESS_ISSUER_SERIAL *a);
+int		  i2d_ESS_ISSUER_SERIAL(ESS_ISSUER_SERIAL *a,
+					unsigned char **pp);
+ESS_ISSUER_SERIAL *d2i_ESS_ISSUER_SERIAL(ESS_ISSUER_SERIAL **a,
+					 unsigned char **pp, long length);
+ESS_ISSUER_SERIAL *ESS_ISSUER_SERIAL_dup(ESS_ISSUER_SERIAL *a);
+
+ESS_CERT_ID	*ESS_CERT_ID_new(void);
+void		ESS_CERT_ID_free(ESS_CERT_ID *a);
+int		i2d_ESS_CERT_ID(ESS_CERT_ID *a, unsigned char **pp);
+ESS_CERT_ID	*d2i_ESS_CERT_ID(ESS_CERT_ID **a, unsigned char **pp,
+				 long length);
+ESS_CERT_ID	*ESS_CERT_ID_dup(ESS_CERT_ID *a);
+
+ESS_SIGNING_CERT *ESS_SIGNING_CERT_new(void);
+void		 ESS_SIGNING_CERT_free(ESS_SIGNING_CERT *a);
+int		 i2d_ESS_SIGNING_CERT(ESS_SIGNING_CERT *a, unsigned char **pp);
+ESS_SIGNING_CERT *d2i_ESS_SIGNING_CERT(ESS_SIGNING_CERT **a,
+				       unsigned char **pp, long length);
+ESS_SIGNING_CERT *ESS_SIGNING_CERT_dup(ESS_SIGNING_CERT *a);
+
+void ERR_load_TS_strings(void);
+
+/* Function declarations for TS_REQ defined in ts/ts_req_utils.c */
+
+int TS_REQ_set_version(TS_REQ *a, long version);
+long TS_REQ_get_version(TS_REQ *a);
+
+int TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint);
+TS_MSG_IMPRINT *TS_REQ_get_msg_imprint(TS_REQ *a);
+
+int TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg);
+X509_ALGOR *TS_MSG_IMPRINT_get_algo(TS_MSG_IMPRINT *a);
+
+int TS_MSG_IMPRINT_set_msg(TS_MSG_IMPRINT *a, unsigned char *d, int len);
+ASN1_OCTET_STRING *TS_MSG_IMPRINT_get_msg(TS_MSG_IMPRINT *a);
+
+int TS_REQ_set_policy_id(TS_REQ *a, ASN1_OBJECT *policy);
+ASN1_OBJECT *TS_REQ_get_policy_id(TS_REQ *a);
+
+int TS_REQ_set_nonce(TS_REQ *a, ASN1_INTEGER *nonce);
+ASN1_INTEGER *TS_REQ_get_nonce(TS_REQ *a);
+
+int TS_REQ_set_cert_req(TS_REQ *a, int cert_req);
+int TS_REQ_get_cert_req(TS_REQ *a);
+
+STACK_OF(X509_EXTENSION) *TS_REQ_get_exts(TS_REQ *a);
+void TS_REQ_ext_free(TS_REQ *a);
+int TS_REQ_get_ext_count(TS_REQ *a);
+int TS_REQ_get_ext_by_NID(TS_REQ *a, int nid, int lastpos);
+int TS_REQ_get_ext_by_OBJ(TS_REQ *a, ASN1_OBJECT *obj, int lastpos);
+int TS_REQ_get_ext_by_critical(TS_REQ *a, int crit, int lastpos);
+X509_EXTENSION *TS_REQ_get_ext(TS_REQ *a, int loc);
+X509_EXTENSION *TS_REQ_delete_ext(TS_REQ *a, int loc);
+int TS_REQ_add_ext(TS_REQ *a, X509_EXTENSION *ex, int loc);
+void *TS_REQ_get_ext_d2i(TS_REQ *a, int nid, int *crit, int *idx);
+
+/* Function declarations for TS_REQ defined in ts/ts_req_print.c */
+
+int TS_REQ_print_bio(BIO *bio, TS_REQ *a);
+
+/* Function declarations for TS_RESP defined in ts/ts_resp_utils.c */
+
+int TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *info);
+TS_STATUS_INFO *TS_RESP_get_status_info(TS_RESP *a);
+
+/* Caller loses ownership of PKCS7 and TS_TST_INFO objects. */
+void TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info);
+PKCS7 *TS_RESP_get_token(TS_RESP *a);
+TS_TST_INFO *TS_RESP_get_tst_info(TS_RESP *a);
+
+int TS_TST_INFO_set_version(TS_TST_INFO *a, long version);
+long TS_TST_INFO_get_version(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy_id);
+ASN1_OBJECT *TS_TST_INFO_get_policy_id(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint);
+TS_MSG_IMPRINT *TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_serial(TS_TST_INFO *a, ASN1_INTEGER *serial);
+ASN1_INTEGER *TS_TST_INFO_get_serial(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_time(TS_TST_INFO *a, ASN1_GENERALIZEDTIME *time);
+ASN1_GENERALIZEDTIME *TS_TST_INFO_get_time(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy);
+TS_ACCURACY *TS_TST_INFO_get_accuracy(TS_TST_INFO *a);
+
+int TS_ACCURACY_set_seconds(TS_ACCURACY *a, ASN1_INTEGER *seconds);
+ASN1_INTEGER *TS_ACCURACY_get_seconds(TS_ACCURACY *a);
+
+int TS_ACCURACY_set_millis(TS_ACCURACY *a, ASN1_INTEGER *millis);
+ASN1_INTEGER *TS_ACCURACY_get_millis(TS_ACCURACY *a);
+
+int TS_ACCURACY_set_micros(TS_ACCURACY *a, ASN1_INTEGER *micros);
+ASN1_INTEGER *TS_ACCURACY_get_micros(TS_ACCURACY *a);
+
+int TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering);
+int TS_TST_INFO_get_ordering(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_nonce(TS_TST_INFO *a, ASN1_INTEGER *nonce);
+ASN1_INTEGER *TS_TST_INFO_get_nonce(TS_TST_INFO *a);
+
+int TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa);
+GENERAL_NAME *TS_TST_INFO_get_tsa(TS_TST_INFO *a);
+
+STACK_OF(X509_EXTENSION) *TS_TST_INFO_get_exts(TS_TST_INFO *a);
+void TS_TST_INFO_ext_free(TS_TST_INFO *a);
+int TS_TST_INFO_get_ext_count(TS_TST_INFO *a);
+int TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos);
+int TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, ASN1_OBJECT *obj, int lastpos);
+int TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos);
+X509_EXTENSION *TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc);
+X509_EXTENSION *TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc);
+int TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc);
+void *TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx);
+
+/* Declarations related to response generation, defined in ts/ts_resp_sign.c. */
+
+/* Optional flags for response generation. */
+
+/* Don't include the TSA name in response. */
+#define	TS_TSA_NAME		0x01
+
+/* Set ordering to true in response. */
+#define	TS_ORDERING		0x02
+
+/*
+ * Include the signer certificate and the other specified certificates in
+ * the ESS signing certificate attribute beside the PKCS7 signed data.
+ * Only the signer certificates is included by default.
+ */
+#define	TS_ESS_CERT_ID_CHAIN	0x04
+
+/* Forward declaration. */
+struct TS_resp_ctx;
+
+/* This must return a unique number less than 160 bits long. */
+typedef ASN1_INTEGER *(*TS_serial_cb)(struct TS_resp_ctx *, void *);
+
+/* This must return the seconds and microseconds since Jan 1, 1970 in
+   the sec and usec variables allocated by the caller. 
+   Return non-zero for success and zero for failure. */
+typedef	int (*TS_time_cb)(struct TS_resp_ctx *, void *, long *sec, long *usec);
+
+/* This must process the given extension.
+ * It can modify the TS_TST_INFO object of the context.
+ * Return values: !0 (processed), 0 (error, it must set the 
+ * status info/failure info of the response).
+ */
+typedef	int (*TS_extension_cb)(struct TS_resp_ctx *, X509_EXTENSION *, void *);
+
+typedef struct TS_resp_ctx
+	{
+	X509		*signer_cert;
+	EVP_PKEY	*signer_key;
+	STACK_OF(X509)	*certs;	/* Certs to include in signed data. */
+	STACK_OF(ASN1_OBJECT)	*policies;	/* Acceptable policies. */
+	ASN1_OBJECT	*default_policy; /* It may appear in policies, too. */
+	STACK_OF(EVP_MD)	*mds;	/* Acceptable message digests. */
+	ASN1_INTEGER	*seconds;	/* accuracy, 0 means not specified. */
+	ASN1_INTEGER	*millis;	/* accuracy, 0 means not specified. */
+	ASN1_INTEGER	*micros;	/* accuracy, 0 means not specified. */
+	unsigned	clock_precision_digits; /* fraction of seconds in
+						   time stamp token. */
+	unsigned	flags;		/* Optional info, see values above. */
+
+	/* Callback functions. */
+	TS_serial_cb serial_cb;
+	void *serial_cb_data;	/* User data for serial_cb. */
+	
+	TS_time_cb time_cb;
+	void *time_cb_data;	/* User data for time_cb. */
+	
+	TS_extension_cb extension_cb;
+	void *extension_cb_data;	/* User data for extension_cb. */
+
+	/* These members are used only while creating the response. */
+	TS_REQ		*request;
+	TS_RESP		*response;
+	TS_TST_INFO	*tst_info;
+	} TS_RESP_CTX;
+
+DECLARE_STACK_OF(EVP_MD)
+DECLARE_ASN1_SET_OF(EVP_MD)
+
+/* Creates a response context that can be used for generating responses. */
+TS_RESP_CTX *TS_RESP_CTX_new(void);
+void TS_RESP_CTX_free(TS_RESP_CTX *ctx);
+
+/* This parameter must be set. */
+int TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer);
+
+/* This parameter must be set. */
+int TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key);
+
+/* This parameter must be set. */
+int TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, ASN1_OBJECT *def_policy);
+
+/* No additional certs are included in the response by default. */
+int TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs);
+
+/* Adds a new acceptable policy, only the default policy 
+   is accepted by default. */
+int TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, ASN1_OBJECT *policy);
+
+/* Adds a new acceptable message digest. Note that no message digests 
+   are accepted by default. The md argument is shared with the caller. */
+int TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md);
+
+/* Accuracy is not included by default. */
+int TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx,
+			     int secs, int millis, int micros);
+
+/* Clock precision digits, i.e. the number of decimal digits: 
+   '0' means sec, '3' msec, '6' usec, and so on. Default is 0. */ 
+int TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
+					   unsigned clock_precision_digits);
+/* At most we accept usec precision. */	
+#define TS_MAX_CLOCK_PRECISION_DIGITS	6
+
+/* No flags are set by default. */
+void TS_RESP_CTX_add_flags(TS_RESP_CTX *ctx, int flags);
+
+/* Default callback always returns a constant. */
+void TS_RESP_CTX_set_serial_cb(TS_RESP_CTX *ctx, TS_serial_cb cb, void *data);
+
+/* Default callback uses the gettimeofday() and gmtime() system calls. */
+void TS_RESP_CTX_set_time_cb(TS_RESP_CTX *ctx, TS_time_cb cb, void *data);
+
+/* Default callback rejects all extensions. The extension callback is called 
+ * when the TS_TST_INFO object is already set up and not signed yet. */
+/* FIXME: extension handling is not tested yet. */
+void TS_RESP_CTX_set_extension_cb(TS_RESP_CTX *ctx, 
+				  TS_extension_cb cb, void *data);
+
+/* The following methods can be used in the callbacks. */
+int TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx, 
+				int status, const char *text);
+
+/* Sets the status info only if it is still TS_STATUS_GRANTED. */
+int TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx, 
+				     int status, const char *text);
+
+int TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure);
+
+/* The get methods below can be used in the extension callback. */
+TS_REQ *TS_RESP_CTX_get_request(TS_RESP_CTX *ctx);
+
+TS_TST_INFO *TS_RESP_CTX_get_tst_info(TS_RESP_CTX *ctx);
+
+/* 
+ * Creates the signed TS_TST_INFO and puts it in TS_RESP.
+ * In case of errors it sets the status info properly.
+ * Returns NULL only in case of memory allocation/fatal error.
+ */
+TS_RESP *TS_RESP_create_response(TS_RESP_CTX *ctx, BIO *req_bio);
+
+/*
+ * Declarations related to response verification,
+ * they are defined in ts/ts_resp_verify.c.
+ */
+
+int TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
+			     X509_STORE *store, X509 **signer_out);
+
+/* Context structure for the generic verify method. */
+
+/* Verify the signer's certificate and the signature of the response. */
+#define	TS_VFY_SIGNATURE	(1u << 0)
+/* Verify the version number of the response. */
+#define	TS_VFY_VERSION		(1u << 1)
+/* Verify if the policy supplied by the user matches the policy of the TSA. */
+#define	TS_VFY_POLICY		(1u << 2)
+/* Verify the message imprint provided by the user. This flag should not be
+   specified with TS_VFY_DATA. */
+#define	TS_VFY_IMPRINT		(1u << 3)
+/* Verify the message imprint computed by the verify method from the user
+   provided data and the MD algorithm of the response. This flag should not be
+   specified with TS_VFY_IMPRINT. */
+#define	TS_VFY_DATA		(1u << 4)
+/* Verify the nonce value. */
+#define	TS_VFY_NONCE		(1u << 5)
+/* Verify if the TSA name field matches the signer certificate. */
+#define	TS_VFY_SIGNER		(1u << 6)
+/* Verify if the TSA name field equals to the user provided name. */
+#define	TS_VFY_TSA_NAME		(1u << 7)
+
+/* You can use the following convenience constants. */
+#define	TS_VFY_ALL_IMPRINT	(TS_VFY_SIGNATURE	\
+				 | TS_VFY_VERSION	\
+				 | TS_VFY_POLICY	\
+				 | TS_VFY_IMPRINT	\
+				 | TS_VFY_NONCE		\
+				 | TS_VFY_SIGNER	\
+				 | TS_VFY_TSA_NAME)
+#define	TS_VFY_ALL_DATA		(TS_VFY_SIGNATURE	\
+				 | TS_VFY_VERSION	\
+				 | TS_VFY_POLICY	\
+				 | TS_VFY_DATA		\
+				 | TS_VFY_NONCE		\
+				 | TS_VFY_SIGNER	\
+				 | TS_VFY_TSA_NAME)
+
+typedef struct TS_verify_ctx
+	{
+	/* Set this to the union of TS_VFY_... flags you want to carry out. */
+	unsigned	flags;
+
+	/* Must be set only with TS_VFY_SIGNATURE. certs is optional. */
+	X509_STORE	*store;
+	STACK_OF(X509)	*certs;
+
+	/* Must be set only with TS_VFY_POLICY. */
+	ASN1_OBJECT	*policy;
+
+	/* Must be set only with TS_VFY_IMPRINT. If md_alg is NULL, 
+	   the algorithm from the response is used. */
+	X509_ALGOR	*md_alg;
+	unsigned char	*imprint;
+	unsigned	imprint_len;
+
+	/* Must be set only with TS_VFY_DATA. */
+	BIO		*data;
+
+	/* Must be set only with TS_VFY_TSA_NAME. */
+	ASN1_INTEGER	*nonce;
+
+	/* Must be set only with TS_VFY_TSA_NAME. */
+	GENERAL_NAME	*tsa_name;
+	} TS_VERIFY_CTX;
+
+int TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response);
+int TS_RESP_verify_token(TS_VERIFY_CTX *ctx, PKCS7 *token);
+
+/*
+ * Declarations related to response verification context,
+ * they are defined in ts/ts_verify_ctx.c.
+ */
+
+/* Set all fields to zero. */
+TS_VERIFY_CTX *TS_VERIFY_CTX_new(void);
+void TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx);
+void TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx);
+void TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx);
+
+/* 
+ * If ctx is NULL, it allocates and returns a new object, otherwise
+ * it returns ctx. It initialises all the members as follows:
+ * flags = TS_VFY_ALL_IMPRINT & ~(TS_VFY_TSA_NAME | TS_VFY_SIGNATURE)
+ * certs = NULL
+ * store = NULL
+ * policy = policy from the request or NULL if absent (in this case
+ *	TS_VFY_POLICY is cleared from flags as well)
+ * md_alg = MD algorithm from request
+ * imprint, imprint_len = imprint from request
+ * data = NULL
+ * nonce, nonce_len = nonce from the request or NULL if absent (in this case
+ * 	TS_VFY_NONCE is cleared from flags as well)
+ * tsa_name = NULL
+ * Important: after calling this method TS_VFY_SIGNATURE should be added!
+ */
+TS_VERIFY_CTX *TS_REQ_to_TS_VERIFY_CTX(TS_REQ *req, TS_VERIFY_CTX *ctx);
+
+/* Function declarations for TS_RESP defined in ts/ts_resp_print.c */
+
+int TS_RESP_print_bio(BIO *bio, TS_RESP *a);
+int TS_STATUS_INFO_print_bio(BIO *bio, TS_STATUS_INFO *a);
+int TS_TST_INFO_print_bio(BIO *bio, TS_TST_INFO *a);
+
+/* Common utility functions defined in ts/ts_lib.c */
+
+int TS_ASN1_INTEGER_print_bio(BIO *bio, ASN1_INTEGER *num);
+int TS_OBJ_print_bio(BIO *bio, ASN1_OBJECT *obj);
+int TS_ext_print_bio(BIO *bio, STACK_OF(X509_EXTENSION) *extensions);
+int TS_X509_ALGOR_print_bio(BIO *bio, X509_ALGOR *alg);
+int TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *msg);
+
+/* Function declarations for handling configuration options,
+   defined in ts/ts_conf.c */
+
+X509 *TS_CONF_load_cert(const char *file);
+STACK_OF(X509) *TS_CONF_load_certs(const char *file);
+EVP_PKEY *TS_CONF_load_key(const char *file, const char *pass);
+const char *TS_CONF_get_tsa_section(CONF *conf, const char *section);
+int TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
+		       TS_RESP_CTX *ctx);
+int TS_CONF_set_crypto_device(CONF *conf, const char *section,
+			      const char *device);
+int TS_CONF_set_default_engine(const char *name);
+int TS_CONF_set_signer_cert(CONF *conf, const char *section,
+			    const char *cert, TS_RESP_CTX *ctx);
+int TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
+		      TS_RESP_CTX *ctx);
+int TS_CONF_set_signer_key(CONF *conf, const char *section,
+			   const char *key, const char *pass, TS_RESP_CTX *ctx);
+int TS_CONF_set_def_policy(CONF *conf, const char *section,
+			   const char *policy, TS_RESP_CTX *ctx);
+int TS_CONF_set_policies(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int TS_CONF_set_digests(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int TS_CONF_set_clock_precision_digits(CONF *conf, const char *section,
+				       TS_RESP_CTX *ctx);
+int TS_CONF_set_ordering(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int TS_CONF_set_tsa_name(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int TS_CONF_set_ess_cert_id_chain(CONF *conf, const char *section,
+				  TS_RESP_CTX *ctx);
+
+/* -------------------------------------------------- */
+/* BEGIN ERROR CODES */
+/* The following lines are auto generated by the script mkerr.pl. Any changes
+ * made after this point may be overwritten when the script is next run.
+ */
+void ERR_load_TS_strings(void);
+
+/* Error codes for the TS functions. */
+
+/* Function codes. */
+#define TS_F_DEF_SERIAL_CB				 110
+#define TS_F_DEF_TIME_CB				 111
+#define TS_F_ESS_ADD_SIGNING_CERT			 112
+#define TS_F_ESS_CERT_ID_NEW_INIT			 113
+#define TS_F_ESS_SIGNING_CERT_NEW_INIT			 114
+#define TS_F_TS_ACCURACY_SET_MICROS			 115
+#define TS_F_TS_ACCURACY_SET_MILLIS			 116
+#define TS_F_TS_ACCURACY_SET_SECONDS			 117
+#define TS_F_TS_CHECK_IMPRINTS				 100
+#define TS_F_TS_CHECK_NONCES				 101
+#define TS_F_TS_CHECK_POLICY				 102
+#define TS_F_TS_CHECK_SIGNING_CERTS			 103
+#define TS_F_TS_CHECK_STATUS_INFO			 104
+#define TS_F_TS_COMPUTE_IMPRINT				 145
+#define TS_F_TS_CONF_SET_DEFAULT_ENGINE			 146
+#define TS_F_TS_GET_STATUS_TEXT				 105
+#define TS_F_TS_MSG_IMPRINT_SET_ALGO			 118
+#define TS_F_TS_REQ_SET_MSG_IMPRINT			 119
+#define TS_F_TS_REQ_SET_NONCE				 120
+#define TS_F_TS_REQ_SET_POLICY_ID			 121
+#define TS_F_TS_RESP_CREATE_RESPONSE			 122
+#define TS_F_TS_RESP_CREATE_TST_INFO			 123
+#define TS_F_TS_RESP_CTX_ADD_FAILURE_INFO		 124
+#define TS_F_TS_RESP_CTX_ADD_MD				 125
+#define TS_F_TS_RESP_CTX_ADD_POLICY			 126
+#define TS_F_TS_RESP_CTX_NEW				 127
+#define TS_F_TS_RESP_CTX_SET_ACCURACY			 128
+#define TS_F_TS_RESP_CTX_SET_CERTS			 129
+#define TS_F_TS_RESP_CTX_SET_DEF_POLICY			 130
+#define TS_F_TS_RESP_CTX_SET_SIGNER_CERT		 131
+#define TS_F_TS_RESP_CTX_SET_STATUS_INFO		 132
+#define TS_F_TS_RESP_GET_POLICY				 133
+#define TS_F_TS_RESP_SET_GENTIME_WITH_PRECISION		 134
+#define TS_F_TS_RESP_SET_STATUS_INFO			 135
+#define TS_F_TS_RESP_SIGN				 136
+#define TS_F_TS_RESP_VERIFY_SIGNATURE			 106
+#define TS_F_TS_RESP_VERIFY_TOKEN			 107
+#define TS_F_TS_TST_INFO_SET_ACCURACY			 137
+#define TS_F_TS_TST_INFO_SET_MSG_IMPRINT		 138
+#define TS_F_TS_TST_INFO_SET_NONCE			 139
+#define TS_F_TS_TST_INFO_SET_POLICY_ID			 140
+#define TS_F_TS_TST_INFO_SET_SERIAL			 141
+#define TS_F_TS_TST_INFO_SET_TIME			 142
+#define TS_F_TS_TST_INFO_SET_TSA			 143
+#define TS_F_TS_VERIFY					 108
+#define TS_F_TS_VERIFY_CERT				 109
+#define TS_F_TS_VERIFY_CTX_NEW				 144
+
+/* Reason codes. */
+#define TS_R_CERTIFICATE_VERIFY_ERROR			 100
+#define TS_R_COULD_NOT_SET_ENGINE			 127
+#define TS_R_COULD_NOT_SET_TIME				 115
+#define TS_R_ESS_ADD_SIGNING_CERT_ERROR			 116
+#define TS_R_ESS_SIGNING_CERTIFICATE_ERROR		 101
+#define TS_R_INVALID_NULL_POINTER			 102
+#define TS_R_INVALID_SIGNER_CERTIFICATE_PURPOSE		 117
+#define TS_R_MESSAGE_IMPRINT_MISMATCH			 103
+#define TS_R_NONCE_MISMATCH				 104
+#define TS_R_NONCE_NOT_RETURNED				 105
+#define TS_R_NO_CONTENT					 106
+#define TS_R_NO_TIME_STAMP_TOKEN			 107
+#define TS_R_PKCS7_ADD_SIGNATURE_ERROR			 118
+#define TS_R_PKCS7_ADD_SIGNED_ATTR_ERROR		 119
+#define TS_R_POLICY_MISMATCH				 108
+#define TS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE	 120
+#define TS_R_RESPONSE_SETUP_ERROR			 121
+#define TS_R_SIGNATURE_FAILURE				 109
+#define TS_R_THERE_MUST_BE_ONE_SIGNER			 110
+#define TS_R_TIME_SYSCALL_ERROR				 122
+#define TS_R_TSA_NAME_MISMATCH				 111
+#define TS_R_TSA_UNTRUSTED				 112
+#define TS_R_TST_INFO_SETUP_ERROR			 123
+#define TS_R_TS_DATASIGN				 124
+#define TS_R_UNACCEPTABLE_POLICY			 125
+#define TS_R_UNSUPPORTED_MD_ALGORITHM			 126
+#define TS_R_UNSUPPORTED_VERSION			 113
+#define TS_R_WRONG_CONTENT_TYPE				 114
+
+#ifdef  __cplusplus
+}
+#endif
+#endif
Index: openssl/crypto/ts/ts_conf.c
diff -u /dev/null openssl/crypto/ts/ts_conf.c:1.1.14.1
--- /dev/null	Tue Nov  9 22:44:02 2004
+++ openssl/crypto/ts/ts_conf.c	Mon Nov  8 16:31:13 2004
@@ -0,0 +1,498 @@
+/* crypto/ts/ts_conf.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <openssl/pem.h>
+#include <openssl/engine.h>
+#include <openssl/ts.h>
+
+/* Macro definitions for the configuration file. */
+
+#define	BASE_SECTION			"tsa"
+#define	ENV_DEFAULT_TSA			"default_tsa"
+#define	ENV_SERIAL			"serial"
+#define ENV_CRYPTO_DEVICE		"crypto_device"
+#define	ENV_SIGNER_CERT			"signer_cert"
+#define	ENV_CERTS			"certs"
+#define	ENV_SIGNER_KEY			"signer_key"
+#define	ENV_DEFAULT_POLICY		"default_policy"
+#define	ENV_OTHER_POLICIES		"other_policies"
+#define	ENV_DIGESTS			"digests"
+#define	ENV_ACCURACY			"accuracy"
+#define	ENV_ORDERING			"ordering"
+#define	ENV_TSA_NAME			"tsa_name"
+#define	ENV_ESS_CERT_ID_CHAIN		"ess_cert_id_chain"
+#define	ENV_VALUE_SECS			"secs"
+#define	ENV_VALUE_MILLISECS		"millisecs"
+#define	ENV_VALUE_MICROSECS		"microsecs"
+#define	ENV_CLOCK_PRECISION_DIGITS	"clock_precision_digits" 
+#define	ENV_VALUE_YES			"yes"
+#define	ENV_VALUE_NO			"no"
+
+/* Function definitions for certificate and key loading. */
+
+X509 *TS_CONF_load_cert(const char *file)
+	{
+	BIO *cert = NULL;
+	X509 *x = NULL;
+
+	if ((cert = BIO_new_file(file, "r")) == NULL) goto end;
+	x = PEM_read_bio_X509_AUX(cert, NULL, NULL, NULL);
+end:
+	if (x == NULL)
+		fprintf(stderr, "unable to load certificate: %s\n", file);
+	BIO_free(cert);
+	return x;
+	}
+
+STACK_OF(X509) *TS_CONF_load_certs(const char *file)
+	{
+	BIO *certs = NULL;
+	STACK_OF(X509) *othercerts = NULL;
+	STACK_OF(X509_INFO) *allcerts = NULL;
+	int i;
+
+	if (!(certs = BIO_new_file(file, "r"))) goto end;
+
+	if (!(othercerts = sk_X509_new_null())) goto end;
+	allcerts = PEM_X509_INFO_read_bio(certs, NULL, NULL, NULL);
+	for(i = 0; i < sk_X509_INFO_num(allcerts); i++)
+		{
+		X509_INFO *xi = sk_X509_INFO_value(allcerts, i);
+		if (xi->x509)
+			{
+			sk_X509_push(othercerts, xi->x509);
+			xi->x509 = NULL;
+			}
+		}
+end:
+	if (othercerts == NULL)
+		fprintf(stderr, "unable to load certificates: %s\n", file);
+	sk_X509_INFO_pop_free(allcerts, X509_INFO_free);
+	BIO_free(certs);
+	return othercerts;
+	}
+
+EVP_PKEY *TS_CONF_load_key(const char *file, const char *pass)
+	{
+	BIO *key = NULL;
+	EVP_PKEY *pkey = NULL;
+
+	if (!(key = BIO_new_file(file, "r"))) goto end;
+	pkey = PEM_read_bio_PrivateKey(key, NULL, NULL, (char *) pass);
+ end:
+	if (pkey == NULL)
+		fprintf(stderr, "unable to load private key: %s\n", file);
+	BIO_free(key);
+	return pkey;
+	}
+
+/* Function definitions for handling configuration options. */
+
+static void TS_CONF_lookup_fail(const char *name, const char *tag)
+	{
+	fprintf(stderr, "variable lookup failed for %s::%s\n", name, tag);
+	}
+
+static void TS_CONF_invalid(const char *name, const char *tag)
+	{
+	fprintf(stderr, "invalid variable value for %s::%s\n", name, tag);
+	}
+
+const char *TS_CONF_get_tsa_section(CONF *conf, const char *section)
+	{
+	if (!section)
+		{
+		section = NCONF_get_string(conf, BASE_SECTION, ENV_DEFAULT_TSA);
+		if (!section)
+			TS_CONF_lookup_fail(BASE_SECTION, ENV_DEFAULT_TSA);
+		}
+	return section;
+	}
+
+int TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
+		       TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	char *serial = NCONF_get_string(conf, (char *)section, ENV_SERIAL);
+	if (!serial)
+		{
+		TS_CONF_lookup_fail(section, ENV_SERIAL);
+		goto err;
+		}
+	TS_RESP_CTX_set_serial_cb(ctx, cb, serial);
+
+	ret = 1;
+ err:
+	return ret;
+	}
+
+int TS_CONF_set_crypto_device(CONF *conf, const char *section,
+			      const char *device)
+	{
+	int ret = 0;
+	
+	if (!device)
+		device = NCONF_get_string(conf, (char *)section,
+					  ENV_CRYPTO_DEVICE);
+
+	if (device && !TS_CONF_set_default_engine(device))
+		{
+		TS_CONF_invalid(section, ENV_CRYPTO_DEVICE);
+		goto err;
+		}
+	ret = 1;
+ err:
+	return ret;
+	}
+
+int TS_CONF_set_default_engine(const char *name)
+	{
+	ENGINE *e = NULL;
+	int ret = 0;
+
+	/* Leave the default if builtin specified. */
+	if (strcmp(name, "builtin") == 0) return 1;
+
+	if (!(e = ENGINE_by_id(name))) goto err;
+	/* Enable the use of the NCipher HSM for forked children. */
+	if (strcmp(name, "chil") == 0) 
+		ENGINE_ctrl(e, ENGINE_CTRL_CHIL_SET_FORKCHECK, 1, 0, 0);
+	/* All the operations are going to be carried out by the engine. */
+	if (!ENGINE_set_default(e, ENGINE_METHOD_ALL)) goto err;
+	ret = 1;
+ err:
+	if (!ret)
+		{
+		TSerr(TS_F_TS_CONF_SET_DEFAULT_ENGINE, 
+		      TS_R_COULD_NOT_SET_ENGINE);
+		ERR_add_error_data(2, "engine:", name);
+		}
+	if (e) ENGINE_free(e);
+	return ret;
+	}
+
+int TS_CONF_set_signer_cert(CONF *conf, const char *section,
+			    const char *cert, TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	X509 *cert_obj = NULL;
+	if (!cert) 
+		cert = NCONF_get_string(conf, (char *)section, ENV_SIGNER_CERT);
+	if (!cert)
+		{
+		TS_CONF_lookup_fail(section, ENV_SIGNER_CERT);
+		goto err;
+		}
+	if (!(cert_obj = TS_CONF_load_cert(cert)))
+		goto err;
+	if (!TS_RESP_CTX_set_signer_cert(ctx, cert_obj))
+		goto err;
+
+	ret = 1;
+ err:
+	X509_free(cert_obj);
+	return ret;
+	}
+
+int TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
+		      TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	STACK_OF(X509) *certs_obj = NULL;
+	if (!certs) 
+		certs = NCONF_get_string(conf, (char *)section, ENV_CERTS);
+	/* Certificate chain is optional. */
+	if (!certs) goto end;
+	if (!(certs_obj = TS_CONF_load_certs(certs))) goto err;
+	if (!TS_RESP_CTX_set_certs(ctx, certs_obj)) goto err;
+ end:
+	ret = 1;
+ err:
+	sk_X509_pop_free(certs_obj, X509_free);
+	return ret;
+	}
+
+int TS_CONF_set_signer_key(CONF *conf, const char *section,
+			   const char *key, const char *pass,
+			   TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	EVP_PKEY *key_obj = NULL;
+	if (!key) 
+		key = NCONF_get_string(conf, (char *)section, ENV_SIGNER_KEY);
+	if (!key)
+		{
+		TS_CONF_lookup_fail(section, ENV_SIGNER_KEY);
+		goto err;
+		}
+	if (!(key_obj = TS_CONF_load_key(key, pass))) goto err;
+	if (!TS_RESP_CTX_set_signer_key(ctx, key_obj)) goto err;
+
+	ret = 1;
+ err:
+	EVP_PKEY_free(key_obj);
+	return ret;
+	}
+
+int TS_CONF_set_def_policy(CONF *conf, const char *section,
+			   const char *policy, TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	ASN1_OBJECT *policy_obj = NULL;
+	if (!policy) 
+		policy = NCONF_get_string(conf, (char *)section, 
+					  ENV_DEFAULT_POLICY);
+	if (!policy)
+		{
+		TS_CONF_lookup_fail(section, ENV_DEFAULT_POLICY);
+		goto err;
+		}
+	if (!(policy_obj = OBJ_txt2obj(policy, 0)))
+		{
+		TS_CONF_invalid(section, ENV_DEFAULT_POLICY);
+		goto err;
+		}
+	if (!TS_RESP_CTX_set_def_policy(ctx, policy_obj))
+		goto err;
+
+	ret = 1;
+ err:
+	ASN1_OBJECT_free(policy_obj);
+	return ret;
+	}
+
+int TS_CONF_set_policies(CONF *conf, const char *section,
+			 TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	int i;
+	STACK_OF(CONF_VALUE) *list = NULL;
+	char *policies = NCONF_get_string(conf, (char *)section, 
+					  ENV_OTHER_POLICIES);
+	/* If no other policy is specified, that's fine. */
+	if (policies && !(list = X509V3_parse_list(policies)))
+		{
+		TS_CONF_invalid(section, ENV_OTHER_POLICIES);
+		goto err;
+		}
+	for (i = 0; i < sk_CONF_VALUE_num(list); ++i)
+		{
+		CONF_VALUE *val = sk_CONF_VALUE_value(list, i);
+		const char *extval = val->value ? val->value : val->name;
+		ASN1_OBJECT *objtmp;
+		if (!(objtmp = OBJ_txt2obj(extval, 0)))
+			{
+			TS_CONF_invalid(section, ENV_OTHER_POLICIES);
+			goto err;
+			}
+		if (!TS_RESP_CTX_add_policy(ctx, objtmp))
+			goto err;
+		ASN1_OBJECT_free(objtmp);
+		}
+
+	ret = 1;
+ err:
+	sk_CONF_VALUE_pop_free(list, X509V3_conf_free);
+	return ret;
+	}
+
+int TS_CONF_set_digests(CONF *conf, const char *section,
+			TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	int i;
+	STACK_OF(CONF_VALUE) *list = NULL;
+	char *digests = NCONF_get_string(conf, (char *)section, ENV_DIGESTS);
+	if (!digests)
+		{
+		TS_CONF_lookup_fail(section, ENV_DIGESTS);
+		goto err;
+		}
+	if (!(list = X509V3_parse_list(digests)))
+		{
+		TS_CONF_invalid(section, ENV_DIGESTS);
+		goto err;
+		}
+	if (sk_CONF_VALUE_num(list) == 0)
+		{
+		TS_CONF_invalid(section, ENV_DIGESTS);
+		goto err;
+		}
+	for (i = 0; i < sk_CONF_VALUE_num(list); ++i)
+		{
+		CONF_VALUE *val = sk_CONF_VALUE_value(list, i);
+		const char *extval = val->value ? val->value : val->name;
+		const EVP_MD *md;
+		if (!(md = EVP_get_digestbyname(extval)))
+			{
+			TS_CONF_invalid(section, ENV_DIGESTS);
+			goto err;
+			}
+		if (!TS_RESP_CTX_add_md(ctx, md))
+			goto err;
+		}
+
+	ret = 1;
+ err:
+	sk_CONF_VALUE_pop_free(list, X509V3_conf_free);
+	return ret;
+	}
+
+int TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	int i;
+	int secs = 0, millis = 0, micros = 0;
+	STACK_OF(CONF_VALUE) *list = NULL;
+	char *accuracy = NCONF_get_string(conf, (char *)section, ENV_ACCURACY);
+
+	if (accuracy && !(list = X509V3_parse_list(accuracy)))
+		{
+		TS_CONF_invalid(section, ENV_ACCURACY);
+		goto err;
+		}
+	for (i = 0; i < sk_CONF_VALUE_num(list); ++i)
+		{
+		CONF_VALUE *val = sk_CONF_VALUE_value(list, i);
+		if (strcmp(val->name, ENV_VALUE_SECS) == 0) 
+			{
+			if (val->value) secs = atoi(val->value);
+			}
+		else if (strcmp(val->name, ENV_VALUE_MILLISECS) == 0)
+			{
+			if (val->value) millis = atoi(val->value);
+			}
+		else if (strcmp(val->name, ENV_VALUE_MICROSECS) == 0)
+			{
+			if (val->value) micros = atoi(val->value);
+			}
+		else
+			{
+			TS_CONF_invalid(section, ENV_ACCURACY);
+			goto err;
+			}
+		}
+	if (!TS_RESP_CTX_set_accuracy(ctx, secs, millis, micros))
+		goto err;
+
+	ret = 1;
+ err:
+	sk_CONF_VALUE_pop_free(list, X509V3_conf_free);
+	return ret;
+	}
+
+int TS_CONF_set_clock_precision_digits(CONF *conf, const char *section,
+				       TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	long digits = 0;
+	
+	/* If not specified, set the default value to 0, i.e. sec  precision */
+	if (!NCONF_get_number_e(conf, section, ENV_CLOCK_PRECISION_DIGITS,
+				&digits))
+		digits = 0;
+	if (digits < 0 || digits > TS_MAX_CLOCK_PRECISION_DIGITS)
+		{
+		TS_CONF_invalid(section, ENV_CLOCK_PRECISION_DIGITS);
+		goto err;
+		}
+
+	if (!TS_RESP_CTX_set_clock_precision_digits(ctx, digits))
+		goto err;
+
+	return 1;
+ err:
+	return ret;
+	}
+
+static int TS_CONF_add_flag(CONF *conf, const char *section, const char *field,
+			    int flag, TS_RESP_CTX *ctx)
+	{
+	/* Default is false. */
+	const char *value = NCONF_get_string(conf, (char *)section,
+					     (char *)field);
+	if (value)
+		{
+		if (strcmp(value, ENV_VALUE_YES) == 0)
+			TS_RESP_CTX_add_flags(ctx, flag);
+		else if (strcmp(value, ENV_VALUE_NO) != 0)
+			{
+			TS_CONF_invalid(section, field);
+			return 0;
+			}
+		}
+
+	return 1;
+	}
+
+int TS_CONF_set_ordering(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+	{
+	return TS_CONF_add_flag(conf, section, ENV_ORDERING, TS_ORDERING, ctx);
+	}
+
+int TS_CONF_set_tsa_name(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+	{
+	return TS_CONF_add_flag(conf, section, ENV_TSA_NAME, TS_TSA_NAME, ctx);
+	}
+
+int TS_CONF_set_ess_cert_id_chain(CONF *conf, const char *section,
+				  TS_RESP_CTX *ctx)
+	{
+	return TS_CONF_add_flag(conf, section, ENV_ESS_CERT_ID_CHAIN, 
+				TS_ESS_CERT_ID_CHAIN, ctx);
+	}
Index: openssl/crypto/ts/ts_err.c
diff -u /dev/null openssl/crypto/ts/ts_err.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:02 2004
+++ openssl/crypto/ts/ts_err.c	Mon Nov  8 16:31:13 2004
@@ -0,0 +1,167 @@
+/* crypto/ts/ts_err.c */
+/* ====================================================================
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    openssl-core@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+/* NOTE: this file was auto generated by the mkerr.pl script: any changes
+ * made to it will be overwritten when the script next updates this file,
+ * only reason strings will be preserved.
+ */
+
+#include <stdio.h>
+#include <openssl/err.h>
+#include <openssl/ts.h>
+
+/* BEGIN ERROR CODES */
+#ifndef OPENSSL_NO_ERR
+static ERR_STRING_DATA TS_str_functs[]=
+	{
+{ERR_PACK(0,TS_F_DEF_SERIAL_CB,0),	"DEF_SERIAL_CB"},
+{ERR_PACK(0,TS_F_DEF_TIME_CB,0),	"DEF_TIME_CB"},
+{ERR_PACK(0,TS_F_ESS_ADD_SIGNING_CERT,0),	"ESS_ADD_SIGNING_CERT"},
+{ERR_PACK(0,TS_F_ESS_CERT_ID_NEW_INIT,0),	"ESS_CERT_ID_NEW_INIT"},
+{ERR_PACK(0,TS_F_ESS_SIGNING_CERT_NEW_INIT,0),	"ESS_SIGNING_CERT_NEW_INIT"},
+{ERR_PACK(0,TS_F_TS_ACCURACY_SET_MICROS,0),	"TS_ACCURACY_set_micros"},
+{ERR_PACK(0,TS_F_TS_ACCURACY_SET_MILLIS,0),	"TS_ACCURACY_set_millis"},
+{ERR_PACK(0,TS_F_TS_ACCURACY_SET_SECONDS,0),	"TS_ACCURACY_set_seconds"},
+{ERR_PACK(0,TS_F_TS_CHECK_IMPRINTS,0),	"TS_CHECK_IMPRINTS"},
+{ERR_PACK(0,TS_F_TS_CHECK_NONCES,0),	"TS_CHECK_NONCES"},
+{ERR_PACK(0,TS_F_TS_CHECK_POLICY,0),	"TS_CHECK_POLICY"},
+{ERR_PACK(0,TS_F_TS_CHECK_SIGNING_CERTS,0),	"TS_CHECK_SIGNING_CERTS"},
+{ERR_PACK(0,TS_F_TS_CHECK_STATUS_INFO,0),	"TS_CHECK_STATUS_INFO"},
+{ERR_PACK(0,TS_F_TS_COMPUTE_IMPRINT,0),	"TS_COMPUTE_IMPRINT"},
+{ERR_PACK(0,TS_F_TS_CONF_SET_DEFAULT_ENGINE,0),	"TS_CONF_set_default_engine"},
+{ERR_PACK(0,TS_F_TS_GET_STATUS_TEXT,0),	"TS_GET_STATUS_TEXT"},
+{ERR_PACK(0,TS_F_TS_MSG_IMPRINT_SET_ALGO,0),	"TS_MSG_IMPRINT_set_algo"},
+{ERR_PACK(0,TS_F_TS_REQ_SET_MSG_IMPRINT,0),	"TS_REQ_set_msg_imprint"},
+{ERR_PACK(0,TS_F_TS_REQ_SET_NONCE,0),	"TS_REQ_set_nonce"},
+{ERR_PACK(0,TS_F_TS_REQ_SET_POLICY_ID,0),	"TS_REQ_set_policy_id"},
+{ERR_PACK(0,TS_F_TS_RESP_CREATE_RESPONSE,0),	"TS_RESP_create_response"},
+{ERR_PACK(0,TS_F_TS_RESP_CREATE_TST_INFO,0),	"TS_RESP_CREATE_TST_INFO"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_ADD_FAILURE_INFO,0),	"TS_RESP_CTX_add_failure_info"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_ADD_MD,0),	"TS_RESP_CTX_add_md"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_ADD_POLICY,0),	"TS_RESP_CTX_add_policy"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_NEW,0),	"TS_RESP_CTX_new"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_SET_ACCURACY,0),	"TS_RESP_CTX_set_accuracy"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_SET_CERTS,0),	"TS_RESP_CTX_set_certs"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_SET_DEF_POLICY,0),	"TS_RESP_CTX_set_def_policy"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_SET_SIGNER_CERT,0),	"TS_RESP_CTX_set_signer_cert"},
+{ERR_PACK(0,TS_F_TS_RESP_CTX_SET_STATUS_INFO,0),	"TS_RESP_CTX_set_status_info"},
+{ERR_PACK(0,TS_F_TS_RESP_GET_POLICY,0),	"TS_RESP_GET_POLICY"},
+{ERR_PACK(0,TS_F_TS_RESP_SET_GENTIME_WITH_PRECISION,0),	"TS_RESP_SET_GENTIME_WITH_PRECISION"},
+{ERR_PACK(0,TS_F_TS_RESP_SET_STATUS_INFO,0),	"TS_RESP_set_status_info"},
+{ERR_PACK(0,TS_F_TS_RESP_SIGN,0),	"TS_RESP_SIGN"},
+{ERR_PACK(0,TS_F_TS_RESP_VERIFY_SIGNATURE,0),	"TS_RESP_verify_signature"},
+{ERR_PACK(0,TS_F_TS_RESP_VERIFY_TOKEN,0),	"TS_RESP_verify_token"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_ACCURACY,0),	"TS_TST_INFO_set_accuracy"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_MSG_IMPRINT,0),	"TS_TST_INFO_set_msg_imprint"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_NONCE,0),	"TS_TST_INFO_set_nonce"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_POLICY_ID,0),	"TS_TST_INFO_set_policy_id"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_SERIAL,0),	"TS_TST_INFO_set_serial"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_TIME,0),	"TS_TST_INFO_set_time"},
+{ERR_PACK(0,TS_F_TS_TST_INFO_SET_TSA,0),	"TS_TST_INFO_set_tsa"},
+{ERR_PACK(0,TS_F_TS_VERIFY,0),	"TS_VERIFY"},
+{ERR_PACK(0,TS_F_TS_VERIFY_CERT,0),	"TS_VERIFY_CERT"},
+{ERR_PACK(0,TS_F_TS_VERIFY_CTX_NEW,0),	"TS_VERIFY_CTX_new"},
+{0,NULL}
+	};
+
+static ERR_STRING_DATA TS_str_reasons[]=
+	{
+{TS_R_CERTIFICATE_VERIFY_ERROR           ,"certificate verify error"},
+{TS_R_COULD_NOT_SET_ENGINE               ,"could not set engine"},
+{TS_R_COULD_NOT_SET_TIME                 ,"could not set time"},
+{TS_R_ESS_ADD_SIGNING_CERT_ERROR         ,"ess add signing cert error"},
+{TS_R_ESS_SIGNING_CERTIFICATE_ERROR      ,"ess signing certificate error"},
+{TS_R_INVALID_NULL_POINTER               ,"invalid null pointer"},
+{TS_R_INVALID_SIGNER_CERTIFICATE_PURPOSE ,"invalid signer certificate purpose"},
+{TS_R_MESSAGE_IMPRINT_MISMATCH           ,"message imprint mismatch"},
+{TS_R_NONCE_MISMATCH                     ,"nonce mismatch"},
+{TS_R_NONCE_NOT_RETURNED                 ,"nonce not returned"},
+{TS_R_NO_CONTENT                         ,"no content"},
+{TS_R_NO_TIME_STAMP_TOKEN                ,"no time stamp token"},
+{TS_R_PKCS7_ADD_SIGNATURE_ERROR          ,"pkcs7 add signature error"},
+{TS_R_PKCS7_ADD_SIGNED_ATTR_ERROR        ,"pkcs7 add signed attr error"},
+{TS_R_POLICY_MISMATCH                    ,"policy mismatch"},
+{TS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE,"private key does not match certificate"},
+{TS_R_RESPONSE_SETUP_ERROR               ,"response setup error"},
+{TS_R_SIGNATURE_FAILURE                  ,"signature failure"},
+{TS_R_THERE_MUST_BE_ONE_SIGNER           ,"there must be one signer"},
+{TS_R_TIME_SYSCALL_ERROR                 ,"time syscall error"},
+{TS_R_TSA_NAME_MISMATCH                  ,"tsa name mismatch"},
+{TS_R_TSA_UNTRUSTED                      ,"tsa untrusted"},
+{TS_R_TST_INFO_SETUP_ERROR               ,"tst info setup error"},
+{TS_R_TS_DATASIGN                        ,"ts datasign"},
+{TS_R_UNACCEPTABLE_POLICY                ,"unacceptable policy"},
+{TS_R_UNSUPPORTED_MD_ALGORITHM           ,"unsupported md algorithm"},
+{TS_R_UNSUPPORTED_VERSION                ,"unsupported version"},
+{TS_R_WRONG_CONTENT_TYPE                 ,"wrong content type"},
+{0,NULL}
+	};
+
+#endif
+
+void ERR_load_TS_strings(void)
+	{
+	static int init=1;
+
+	if (init)
+		{
+		init=0;
+#ifndef OPENSSL_NO_ERR
+		ERR_load_strings(ERR_LIB_TS,TS_str_functs);
+		ERR_load_strings(ERR_LIB_TS,TS_str_reasons);
+#endif
+
+		}
+	}
Index: openssl/crypto/ts/ts_lib.c
diff -u /dev/null openssl/crypto/ts/ts_lib.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:02 2004
+++ openssl/crypto/ts/ts_lib.c	Mon Nov  8 16:31:13 2004
@@ -0,0 +1,145 @@
+/* crypto/ts/ts_lib.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/bn.h>
+#include <openssl/x509v3.h>
+#include "ts.h"
+
+/* Local function declarations. */
+
+/* Function definitions. */
+
+int TS_ASN1_INTEGER_print_bio(BIO *bio, ASN1_INTEGER *num)
+	{
+	BIGNUM num_bn;
+	int result = 0;
+	char *hex;
+
+	BN_init(&num_bn);
+	ASN1_INTEGER_to_BN(num, &num_bn);
+	if ((hex = BN_bn2hex(&num_bn))) 
+		{
+		result = BIO_write(bio, "0x", 2) > 0;
+		result = result && BIO_write(bio, hex, strlen(hex)) > 0;
+		OPENSSL_free(hex);
+		}
+	BN_free(&num_bn);
+
+	return result;
+	}
+
+int TS_OBJ_print_bio(BIO *bio, ASN1_OBJECT *obj)
+	{
+	char obj_txt[128];
+
+	int len = OBJ_obj2txt(obj_txt, sizeof(obj_txt), obj, 0);
+	BIO_write(bio, obj_txt, len);
+	BIO_write(bio, "\n", 1);
+
+	return 1;
+	}
+
+int TS_ext_print_bio(BIO *bio, STACK_OF(X509_EXTENSION) *extensions)
+	{
+	int i, critical, n;
+	X509_EXTENSION *ex;
+	ASN1_OBJECT *obj;
+
+	BIO_printf(bio, "Extensions:\n");
+	n = X509v3_get_ext_count(extensions);
+	for (i = 0; i < n; i++)
+		{
+		ex = X509v3_get_ext(extensions, i);
+		obj = X509_EXTENSION_get_object(ex);
+		i2a_ASN1_OBJECT(bio, obj);
+		critical = X509_EXTENSION_get_critical(ex);
+		BIO_printf(bio, ": %s\n", critical ? "critical" : "");
+		if (!X509V3_EXT_print(bio, ex, 0, 4))
+			{
+			BIO_printf(bio, "%4s", "");
+			M_ASN1_OCTET_STRING_print(bio, ex->value);
+			}
+		BIO_write(bio, "\n", 1);
+		}
+
+	return 1;
+	}
+
+int TS_X509_ALGOR_print_bio(BIO *bio, X509_ALGOR *alg)
+	{
+	int i = OBJ_obj2nid(alg->algorithm);
+	return BIO_printf(bio, "Hash Algorithm: %s\n",
+		(i == NID_undef) ? "UNKNOWN" : OBJ_nid2ln(i));
+	}
+
+int TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *a)
+	{
+	ASN1_OCTET_STRING *msg;
+
+	TS_X509_ALGOR_print_bio(bio, TS_MSG_IMPRINT_get_algo(a));
+
+	BIO_printf(bio, "Message data:\n");
+	msg = TS_MSG_IMPRINT_get_msg(a);
+	BIO_dump_indent(bio, M_ASN1_STRING_data(msg), 
+			M_ASN1_STRING_length(msg), 4);
+
+	return 1;
+	}
Index: openssl/crypto/ts/ts_req_print.c
diff -u /dev/null openssl/crypto/ts/ts_req_print.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_req_print.c	Mon Nov  8 16:31:13 2004
@@ -0,0 +1,102 @@
+/* crypto/ts/ts_req_print.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/bn.h>
+#include <openssl/x509v3.h>
+#include <openssl/ts.h>
+
+/* Function definitions. */
+
+int TS_REQ_print_bio(BIO *bio, TS_REQ *a)
+	{
+	int v;
+	ASN1_OBJECT *policy_id;
+	ASN1_INTEGER *nonce;
+
+	if (a == NULL) return 0;
+
+	v = TS_REQ_get_version(a);
+	BIO_printf(bio, "Version: %ld\n", v);
+
+	TS_MSG_IMPRINT_print_bio(bio, TS_REQ_get_msg_imprint(a));
+
+	BIO_printf(bio, "Policy OID: ");
+	policy_id = TS_REQ_get_policy_id(a);
+	if (policy_id == NULL)
+		BIO_printf(bio, "unspecified\n");
+	else	
+		TS_OBJ_print_bio(bio, policy_id);
+
+	BIO_printf(bio, "Nonce: ");
+	nonce = TS_REQ_get_nonce(a);
+	if (nonce == NULL)
+		BIO_printf(bio, "unspecified");
+	else
+		TS_ASN1_INTEGER_print_bio(bio, nonce);
+	BIO_write(bio, "\n", 1);
+
+	BIO_printf(bio, "Certificate required: %s\n", 
+		   TS_REQ_get_cert_req(a) ? "yes" : "no");
+
+	TS_ext_print_bio(bio, TS_REQ_get_exts(a));
+
+	return 1;
+	}
Index: openssl/crypto/ts/ts_req_utils.c
diff -u /dev/null openssl/crypto/ts/ts_req_utils.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_req_utils.c	Mon Nov  8 16:31:13 2004
@@ -0,0 +1,234 @@
+/* crypto/ts/ts_req_utils.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/x509v3.h>
+#include <openssl/ts.h>
+
+int TS_REQ_set_version(TS_REQ *a, long version)
+	{
+	return ASN1_INTEGER_set(a->version, version);
+	}
+
+long TS_REQ_get_version(TS_REQ *a)
+	{
+	return ASN1_INTEGER_get(a->version);
+	}
+
+int TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint)
+	{
+	TS_MSG_IMPRINT *new_msg_imprint;
+
+	if (a->msg_imprint == msg_imprint)
+		return 1;
+	new_msg_imprint = TS_MSG_IMPRINT_dup(msg_imprint);
+	if (new_msg_imprint == NULL)
+		{
+		TSerr(TS_F_TS_REQ_SET_MSG_IMPRINT, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	TS_MSG_IMPRINT_free(a->msg_imprint);
+	a->msg_imprint = new_msg_imprint;
+	return 1;
+	}
+
+TS_MSG_IMPRINT *TS_REQ_get_msg_imprint(TS_REQ *a)
+	{
+	return a->msg_imprint;
+	}
+
+int TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg)
+	{
+	X509_ALGOR *new_alg;
+
+	if (a->hash_algo == alg)
+		return 1;
+	new_alg = X509_ALGOR_dup(alg);
+	if (new_alg == NULL)
+		{
+		TSerr(TS_F_TS_MSG_IMPRINT_SET_ALGO, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	X509_ALGOR_free(a->hash_algo);
+	a->hash_algo = new_alg;
+	return 1;
+	}
+
+X509_ALGOR *TS_MSG_IMPRINT_get_algo(TS_MSG_IMPRINT *a)
+	{
+	return a->hash_algo;
+	}
+
+int TS_MSG_IMPRINT_set_msg(TS_MSG_IMPRINT *a, unsigned char *d, int len)
+	{
+	return ASN1_OCTET_STRING_set(a->hashed_msg, d, len);
+	}
+
+ASN1_OCTET_STRING *TS_MSG_IMPRINT_get_msg(TS_MSG_IMPRINT *a)
+	{
+	return a->hashed_msg;
+	}
+
+int TS_REQ_set_policy_id(TS_REQ *a, ASN1_OBJECT *policy)
+	{
+	ASN1_OBJECT *new_policy;
+
+	if (a->policy_id == policy)
+		return 1;
+	new_policy = OBJ_dup(policy);
+	if (new_policy == NULL)
+		{
+		TSerr(TS_F_TS_REQ_SET_POLICY_ID, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_OBJECT_free(a->policy_id);
+	a->policy_id = new_policy;
+	return 1;
+	}
+
+ASN1_OBJECT *TS_REQ_get_policy_id(TS_REQ *a)
+	{
+	return a->policy_id;
+	}
+
+int TS_REQ_set_nonce(TS_REQ *a, ASN1_INTEGER *nonce)
+	{
+	ASN1_INTEGER *new_nonce;
+
+	if (a->nonce == nonce)
+		return 1;
+	new_nonce = ASN1_INTEGER_dup(nonce);
+	if (new_nonce == NULL)
+		{
+		TSerr(TS_F_TS_REQ_SET_NONCE, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_INTEGER_free(a->nonce);
+	a->nonce = new_nonce;
+	return 1;
+	}
+
+ASN1_INTEGER *TS_REQ_get_nonce(TS_REQ *a)
+	{
+	return a->nonce;
+	}
+
+int TS_REQ_set_cert_req(TS_REQ *a, int cert_req)
+	{
+	a->cert_req = cert_req ? 0xFF : 0x00;
+	return 1;
+	}
+
+int TS_REQ_get_cert_req(TS_REQ *a)
+	{
+	return a->cert_req ? 1 : 0;
+	}
+
+STACK_OF(X509_EXTENSION) *TS_REQ_get_exts(TS_REQ *a)
+	{
+	return a->extensions;
+	}
+
+void TS_REQ_ext_free(TS_REQ *a)
+	{
+	if (!a) return;
+	sk_X509_EXTENSION_pop_free(a->extensions, X509_EXTENSION_free);
+	a->extensions = NULL;
+	}
+
+int TS_REQ_get_ext_count(TS_REQ *a)
+	{
+	return X509v3_get_ext_count(a->extensions);
+	}
+
+int TS_REQ_get_ext_by_NID(TS_REQ *a, int nid, int lastpos)
+	{
+	return X509v3_get_ext_by_NID(a->extensions, nid, lastpos);
+	}
+
+int TS_REQ_get_ext_by_OBJ(TS_REQ *a, ASN1_OBJECT *obj, int lastpos)
+	{
+	return X509v3_get_ext_by_OBJ(a->extensions, obj, lastpos);
+	}
+
+int TS_REQ_get_ext_by_critical(TS_REQ *a, int crit, int lastpos)
+	{
+	return X509v3_get_ext_by_critical(a->extensions, crit, lastpos);
+	}
+
+X509_EXTENSION *TS_REQ_get_ext(TS_REQ *a, int loc)
+	{
+	return X509v3_get_ext(a->extensions,loc);
+	}
+
+X509_EXTENSION *TS_REQ_delete_ext(TS_REQ *a, int loc)
+	{
+	return X509v3_delete_ext(a->extensions,loc);
+	}
+
+int TS_REQ_add_ext(TS_REQ *a, X509_EXTENSION *ex, int loc)
+	{
+	return X509v3_add_ext(&a->extensions,ex,loc) != NULL;
+	}
+
+void *TS_REQ_get_ext_d2i(TS_REQ *a, int nid, int *crit, int *idx)
+	{
+	return X509V3_get_d2i(a->extensions, nid, crit, idx);
+	}
Index: openssl/crypto/ts/ts_resp_print.c
diff -u /dev/null openssl/crypto/ts/ts_resp_print.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_resp_print.c	Mon Nov  8 16:31:14 2004
@@ -0,0 +1,287 @@
+/* crypto/ts/ts_resp_print.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/bn.h>
+#include <openssl/x509v3.h>
+#include "ts.h"
+
+struct status_map_st
+	{
+	int bit;
+	const char *text;
+	};
+
+/* Local function declarations. */
+
+static int TS_status_map_print(BIO *bio, struct status_map_st *a,
+			       ASN1_BIT_STRING *v);
+static int TS_ACCURACY_print_bio(BIO *bio, TS_ACCURACY *accuracy);
+
+/* Function definitions. */
+
+int TS_RESP_print_bio(BIO *bio, TS_RESP *a)
+	{
+	TS_TST_INFO *tst_info;
+
+	BIO_printf(bio, "Status info:\n");
+	TS_STATUS_INFO_print_bio(bio, TS_RESP_get_status_info(a));
+
+	BIO_printf(bio, "\nTST info:\n");
+	tst_info = TS_RESP_get_tst_info(a);
+	if (tst_info != NULL)
+		TS_TST_INFO_print_bio(bio, TS_RESP_get_tst_info(a));
+	else
+		BIO_printf(bio, "Not included.\n");
+		
+	return 1;
+	}
+
+int TS_STATUS_INFO_print_bio(BIO *bio, TS_STATUS_INFO *a)
+	{
+	static const char *status_map[] =
+		{
+		"Granted.",
+		"Granted with modifications.",
+		"Rejected.",
+		"Waiting.",
+		"Revocation warning.",
+		"Revoked."
+		};
+	static struct status_map_st failure_map[] =
+		{
+		{ TS_INFO_BAD_ALG,
+		"unrecognized or unsupported algorithm identifier" },
+		{ TS_INFO_BAD_REQUEST,
+		"transaction not permitted or supported" },
+		{ TS_INFO_BAD_DATA_FORMAT,
+		"the data submitted has the wrong format" },
+		{ TS_INFO_TIME_NOT_AVAILABLE,
+		"the TSA's time source is not available" },
+		{ TS_INFO_UNACCEPTED_POLICY,
+		"the requested TSA policy is not supported by the TSA" },
+		{ TS_INFO_UNACCEPTED_EXTENSION,
+		"the requested extension is not supported by the TSA" },
+		{ TS_INFO_ADD_INFO_NOT_AVAILABLE,
+		"the additional information requested could not be understood "
+		"or is not available" },
+		{ TS_INFO_SYSTEM_FAILURE,
+		"the request cannot be handled due to system failure" },
+		{ -1, NULL }
+		};
+	long status;
+	int i, lines = 0;
+
+	/* Printing status code. */
+	BIO_printf(bio, "Status: ");
+	status = ASN1_INTEGER_get(a->status);
+	if (0 <= status && status < sizeof(status_map)/sizeof(status_map[0]))
+		BIO_printf(bio, "%s\n", status_map[status]);
+	else
+		BIO_printf(bio, "out of bounds\n");
+	
+	/* Printing status description. */
+	BIO_printf(bio, "Status description: ");
+	for (i = 0; i < sk_ASN1_UTF8STRING_num(a->text); ++i)
+		{
+		if (i > 0)
+			BIO_puts(bio, "\t");
+		ASN1_STRING_print_ex(bio, sk_ASN1_UTF8STRING_value(a->text, i),
+				     0);
+		BIO_puts(bio, "\n");
+		}
+	if (i == 0)
+		BIO_printf(bio, "unspecified\n");
+
+	/* Printing failure information. */
+	BIO_printf(bio, "Failure info: ");
+	if (a->failure_info != NULL)
+		lines = TS_status_map_print(bio, failure_map,
+					    a->failure_info);
+	if (lines == 0)
+		BIO_printf(bio, "unspecified");
+	BIO_printf(bio, "\n");
+
+	return 1;
+	}
+
+static int TS_status_map_print(BIO *bio, struct status_map_st *a,
+			       ASN1_BIT_STRING *v)
+	{
+	int lines = 0;
+
+	for (; a->bit >= 0; ++a)
+		{
+		if (ASN1_BIT_STRING_get_bit(v, a->bit))
+			{
+			if (++lines > 1)
+				BIO_printf(bio, ", ");
+			BIO_printf(bio, "%s", a->text);
+			}
+		}
+
+	return lines;
+	}
+
+int TS_TST_INFO_print_bio(BIO *bio, TS_TST_INFO *a)
+	{
+	int v;
+	ASN1_OBJECT *policy_id;
+	ASN1_INTEGER *serial;
+	ASN1_GENERALIZEDTIME *time;
+	TS_ACCURACY *accuracy;
+	ASN1_INTEGER *nonce;
+	GENERAL_NAME *tsa_name;
+
+	if (a == NULL) return 0;
+
+	/* Print version. */
+	v = TS_TST_INFO_get_version(a);
+	BIO_printf(bio, "Version: %ld\n", v);
+
+	/* Print policy id. */
+	BIO_printf(bio, "Policy OID: ");
+	policy_id = TS_TST_INFO_get_policy_id(a);
+	TS_OBJ_print_bio(bio, policy_id);
+
+	/* Print message imprint. */
+	TS_MSG_IMPRINT_print_bio(bio, TS_TST_INFO_get_msg_imprint(a));
+
+	/* Print serial number. */
+	BIO_printf(bio, "Serial number: ");
+	serial = TS_TST_INFO_get_serial(a);
+	if (serial == NULL)
+		BIO_printf(bio, "unspecified");
+	else
+		TS_ASN1_INTEGER_print_bio(bio, serial);
+	BIO_write(bio, "\n", 1);
+
+	/* Print time stamp. */
+	BIO_printf(bio, "Time stamp: ");
+	time = TS_TST_INFO_get_time(a);
+	ASN1_GENERALIZEDTIME_print(bio, time);
+	BIO_write(bio, "\n", 1);
+
+	/* Print accuracy. */
+	BIO_printf(bio, "Accuracy: ");
+	accuracy = TS_TST_INFO_get_accuracy(a);
+	if (accuracy == NULL)
+		BIO_printf(bio, "unspecified");
+	else
+		TS_ACCURACY_print_bio(bio, accuracy);
+	BIO_write(bio, "\n", 1);
+
+	/* Print ordering. */
+	BIO_printf(bio, "Ordering: %s\n", 
+		   TS_TST_INFO_get_ordering(a) ? "yes" : "no");
+
+	/* Print nonce. */
+	BIO_printf(bio, "Nonce: ");
+	nonce = TS_TST_INFO_get_nonce(a);
+	if (nonce == NULL)
+		BIO_printf(bio, "unspecified");
+	else
+		TS_ASN1_INTEGER_print_bio(bio, nonce);
+	BIO_write(bio, "\n", 1);
+
+	/* Print TSA name. */
+	BIO_printf(bio, "TSA: ");
+	tsa_name = TS_TST_INFO_get_tsa(a);
+	if (tsa_name == NULL)
+		BIO_printf(bio, "unspecified");
+	else
+		{
+		STACK_OF(CONF_VALUE) *nval;
+		if ((nval = i2v_GENERAL_NAME(NULL, tsa_name, NULL)))
+			X509V3_EXT_val_prn(bio, nval, 0, 0);
+		sk_CONF_VALUE_pop_free(nval, X509V3_conf_free);
+		}
+	BIO_write(bio, "\n", 1);
+
+	/* Print extensions. */
+	TS_ext_print_bio(bio, TS_TST_INFO_get_exts(a));
+
+	return 1;
+	}
+
+static int TS_ACCURACY_print_bio(BIO *bio, TS_ACCURACY *accuracy)
+	{
+	ASN1_INTEGER *seconds = TS_ACCURACY_get_seconds(accuracy);
+	ASN1_INTEGER *millis = TS_ACCURACY_get_millis(accuracy);
+	ASN1_INTEGER *micros = TS_ACCURACY_get_micros(accuracy);
+
+	if (seconds != NULL)
+		TS_ASN1_INTEGER_print_bio(bio, seconds);
+	else
+		BIO_printf(bio, "unspecified");
+	BIO_printf(bio, " seconds, ");
+	if (millis != NULL)
+		TS_ASN1_INTEGER_print_bio(bio, millis);
+	else
+		BIO_printf(bio, "unspecified");
+	BIO_printf(bio, " millis, ");
+	if (micros != NULL)
+		TS_ASN1_INTEGER_print_bio(bio, micros);
+	else
+		BIO_printf(bio, "unspecified");
+	BIO_printf(bio, " micros");
+
+	return 1;
+	}
Index: openssl/crypto/ts/ts_resp_sign.c
diff -u /dev/null openssl/crypto/ts/ts_resp_sign.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_resp_sign.c	Mon Nov  8 16:31:14 2004
@@ -0,0 +1,1011 @@
+/* crypto/ts/ts_resp_sign.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include "cryptlib.h"
+
+#if defined(OPENSSL_SYS_UNIX)
+#include <sys/time.h>
+#endif
+
+#include <openssl/objects.h>
+#include <openssl/ts.h>
+#include <openssl/pkcs7.h>
+
+/* Private function declarations. */
+
+static ASN1_INTEGER *def_serial_cb(struct TS_resp_ctx *, void *);
+static int def_time_cb(struct TS_resp_ctx *, void *, long *sec, long *usec);
+static int def_extension_cb(struct TS_resp_ctx *, X509_EXTENSION *, void *);
+
+static void TS_RESP_CTX_init(TS_RESP_CTX *ctx);
+static void TS_RESP_CTX_cleanup(TS_RESP_CTX *ctx);
+static int TS_RESP_check_request(TS_RESP_CTX *ctx);
+static ASN1_OBJECT *TS_RESP_get_policy(TS_RESP_CTX *ctx);
+static TS_TST_INFO *TS_RESP_create_tst_info(TS_RESP_CTX *ctx, 
+					    ASN1_OBJECT *policy);
+static int TS_RESP_process_extensions(TS_RESP_CTX *ctx);
+static int TS_RESP_sign(TS_RESP_CTX *ctx);
+
+static ESS_SIGNING_CERT *ESS_SIGNING_CERT_new_init(X509 *signcert, 
+						   STACK_OF(X509) *certs);
+static ESS_CERT_ID *ESS_CERT_ID_new_init(X509 *cert, int issuer_needed);
+static int TS_TST_INFO_content_new(PKCS7 *p7);
+static int ESS_add_signing_cert(PKCS7_SIGNER_INFO *si, ESS_SIGNING_CERT *sc);
+
+static ASN1_GENERALIZEDTIME *TS_RESP_set_genTime_with_precision(
+	ASN1_GENERALIZEDTIME *, long, long, unsigned);
+
+/* Default callbacks for response generation. */
+
+static ASN1_INTEGER *def_serial_cb(struct TS_resp_ctx *ctx, void *data)
+	{
+	ASN1_INTEGER *serial = ASN1_INTEGER_new();
+	if (!serial) goto err;
+	if (!ASN1_INTEGER_set(serial, 1)) goto err;
+	return serial;
+ err:
+	TSerr(TS_F_DEF_SERIAL_CB, ERR_R_MALLOC_FAILURE);
+	TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+				    "Error during serial number generation.");
+	return NULL;
+	}
+
+#if defined(OPENSSL_SYS_UNIX)
+
+/* Use the gettimeofday function call. */
+static int def_time_cb(struct TS_resp_ctx *ctx, void *data, 
+		       long *sec, long *usec)
+	{
+	struct timeval tv;
+	if (gettimeofday(&tv, NULL) != 0) 
+		{
+		TSerr(TS_F_DEF_TIME_CB, TS_R_TIME_SYSCALL_ERROR);
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Time is not available.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_TIME_NOT_AVAILABLE);
+		return 0;
+		}
+	/* Return time to caller. */
+	*sec = tv.tv_sec;
+	*usec = tv.tv_usec;
+
+	return 1;
+	}
+
+#else
+
+/* Use the time function call that provides only seconds precision. */
+static int def_time_cb(struct TS_resp_ctx *ctx, void *data, 
+		       long *sec, long *usec)
+	{
+	time_t t;
+	if (time(&t) == (time_t) -1)
+		{
+		TSerr(TS_F_DEF_TIME_CB, TS_R_TIME_SYSCALL_ERROR);
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Time is not available.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_TIME_NOT_AVAILABLE);
+		return 0;
+		}
+	/* Return time to caller, only second precision. */
+	*sec = (long) t;
+	*usec = 0;
+
+	return 1;
+	}
+
+#endif
+
+static int def_extension_cb(struct TS_resp_ctx *ctx, X509_EXTENSION *ext,
+			    void *data)
+	{
+	/* No extensions are processed here. */
+	TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+				    "Unsupported extension.");
+	TS_RESP_CTX_add_failure_info(ctx, TS_INFO_UNACCEPTED_EXTENSION);
+	return 0;
+	}
+
+/* TS_RESP_CTX management functions. */
+
+TS_RESP_CTX *TS_RESP_CTX_new()
+	{
+	TS_RESP_CTX *ctx;
+
+	if (!(ctx = (TS_RESP_CTX *) OPENSSL_malloc(sizeof(TS_RESP_CTX))))
+		{
+		TSerr(TS_F_TS_RESP_CTX_NEW, ERR_R_MALLOC_FAILURE);
+		return NULL;
+		}
+	memset(ctx, 0, sizeof(TS_RESP_CTX));
+
+	/* Setting default callbacks. */
+	ctx->serial_cb = def_serial_cb;
+	ctx->time_cb = def_time_cb;
+	ctx->extension_cb = def_extension_cb;
+
+	return ctx;
+	}
+
+void TS_RESP_CTX_free(TS_RESP_CTX *ctx)
+	{
+	if (!ctx) return;
+
+	X509_free(ctx->signer_cert);
+	EVP_PKEY_free(ctx->signer_key);
+	sk_X509_pop_free(ctx->certs, X509_free);
+	sk_ASN1_OBJECT_pop_free(ctx->policies, ASN1_OBJECT_free);
+	ASN1_OBJECT_free(ctx->default_policy);
+	sk_EVP_MD_free(ctx->mds);	/* No EVP_MD_free method exists. */
+	ASN1_INTEGER_free(ctx->seconds);
+	ASN1_INTEGER_free(ctx->millis);
+	ASN1_INTEGER_free(ctx->micros);
+	OPENSSL_free(ctx);
+	}
+
+int TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer)
+	{
+	if (X509_check_purpose(signer, X509_PURPOSE_TIMESTAMP_SIGN, 0) != 1)
+		{
+		TSerr(TS_F_TS_RESP_CTX_SET_SIGNER_CERT, 
+		      TS_R_INVALID_SIGNER_CERTIFICATE_PURPOSE);
+		return 0;
+		}
+	if (ctx->signer_cert) X509_free(ctx->signer_cert);
+	ctx->signer_cert = signer;
+	CRYPTO_add(&ctx->signer_cert->references, +1, CRYPTO_LOCK_X509);
+	return 1;
+	}
+
+int TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key)
+	{
+	if (ctx->signer_key) EVP_PKEY_free(ctx->signer_key);
+	ctx->signer_key = key;
+	CRYPTO_add(&ctx->signer_key->references, +1, CRYPTO_LOCK_EVP_PKEY);
+
+	return 1;
+	}
+
+int TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, ASN1_OBJECT *def_policy)
+	{
+	if (ctx->default_policy) ASN1_OBJECT_free(ctx->default_policy);
+	if (!(ctx->default_policy = OBJ_dup(def_policy))) goto err;
+	return 1;
+ err:
+	TSerr(TS_F_TS_RESP_CTX_SET_DEF_POLICY, ERR_R_MALLOC_FAILURE);
+	return 0;
+	}
+
+int TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs)
+	{
+	int i;
+
+	if (ctx->certs)
+		{
+		sk_X509_pop_free(ctx->certs, X509_free);
+		ctx->certs = NULL;
+		}
+	if (!certs) return 1;
+	if (!(ctx->certs = sk_X509_dup(certs))) 
+		{
+		TSerr(TS_F_TS_RESP_CTX_SET_CERTS, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	for (i = 0; i < sk_X509_num(ctx->certs); ++i)
+		{
+		X509 *cert = sk_X509_value(ctx->certs, i);
+		CRYPTO_add(&cert->references, +1, CRYPTO_LOCK_X509);
+		}
+
+	return 1;
+	}
+
+int TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, ASN1_OBJECT *policy)
+	{
+	ASN1_OBJECT *copy = NULL;
+
+	/* Create new policy stack if necessary. */
+	if (!ctx->policies && !(ctx->policies = sk_ASN1_OBJECT_new_null())) 
+		goto err;
+	if (!(copy = OBJ_dup(policy))) goto err;
+	if (!sk_ASN1_OBJECT_push(ctx->policies, copy)) goto err;
+
+	return 1;
+ err:
+	TSerr(TS_F_TS_RESP_CTX_ADD_POLICY, ERR_R_MALLOC_FAILURE);
+	ASN1_OBJECT_free(copy);
+	return 0;
+	}
+
+int TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md)
+	{
+	/* Create new md stack if necessary. */
+	if (!ctx->mds && !(ctx->mds = sk_EVP_MD_new_null())) 
+		goto err;
+	/* Add the shared md, no copy needed. */
+	if (!sk_EVP_MD_push(ctx->mds, md)) goto err;
+
+	return 1;
+ err:
+	TSerr(TS_F_TS_RESP_CTX_ADD_MD, ERR_R_MALLOC_FAILURE);
+	return 0;
+	}
+
+#define TS_RESP_CTX_accuracy_free(ctx)		\
+	ASN1_INTEGER_free(ctx->seconds);	\
+	ctx->seconds = NULL;			\
+	ASN1_INTEGER_free(ctx->millis);		\
+	ctx->millis = NULL;			\
+	ASN1_INTEGER_free(ctx->micros);		\
+	ctx->micros = NULL;
+
+int TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx, 
+			     int secs, int millis, int micros)
+	{
+
+	TS_RESP_CTX_accuracy_free(ctx);
+	if (secs && (!(ctx->seconds = ASN1_INTEGER_new())
+		     || !ASN1_INTEGER_set(ctx->seconds, secs)))
+		goto err;
+	if (millis && (!(ctx->millis = ASN1_INTEGER_new())
+		       || !ASN1_INTEGER_set(ctx->millis, millis)))
+		goto err;
+	if (micros && (!(ctx->micros = ASN1_INTEGER_new())
+		       || !ASN1_INTEGER_set(ctx->micros, micros)))
+		goto err;
+
+	return 1;
+ err:
+	TS_RESP_CTX_accuracy_free(ctx);
+	TSerr(TS_F_TS_RESP_CTX_SET_ACCURACY, ERR_R_MALLOC_FAILURE);
+	return 0;
+	}
+
+void TS_RESP_CTX_add_flags(TS_RESP_CTX *ctx, int flags)
+	{
+	ctx->flags |= flags;
+	}
+
+void TS_RESP_CTX_set_serial_cb(TS_RESP_CTX *ctx, TS_serial_cb cb, void *data)
+	{
+	ctx->serial_cb = cb;
+	ctx->serial_cb_data = data;
+	}
+
+void TS_RESP_CTX_set_time_cb(TS_RESP_CTX *ctx, TS_time_cb cb, void *data)
+	{
+	ctx->time_cb = cb;
+	ctx->time_cb_data = data;
+	}
+
+void TS_RESP_CTX_set_extension_cb(TS_RESP_CTX *ctx, 
+				  TS_extension_cb cb, void *data)
+	{
+	ctx->extension_cb = cb;
+	ctx->extension_cb_data = data;
+	}
+
+int TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx, 
+				int status, const char *text)
+	{
+	TS_STATUS_INFO *si = NULL;
+	ASN1_UTF8STRING *utf8_text = NULL;
+	int ret = 0;
+
+	if (!(si = TS_STATUS_INFO_new())) goto err;
+	if (!ASN1_INTEGER_set(si->status, status)) goto err;
+	if (text)
+		{
+		if (!(utf8_text = ASN1_UTF8STRING_new())
+		    || !ASN1_STRING_set(utf8_text, text, strlen(text)))
+			goto err;
+		if (!si->text && !(si->text = sk_ASN1_UTF8STRING_new_null()))
+			goto err;
+		if (!sk_ASN1_UTF8STRING_push(si->text, utf8_text)) goto err;
+		utf8_text = NULL;	/* Ownership is lost. */
+		}
+	if (!TS_RESP_set_status_info(ctx->response, si)) goto err;
+	ret = 1;
+ err:
+	if (!ret)
+		TSerr(TS_F_TS_RESP_CTX_SET_STATUS_INFO, ERR_R_MALLOC_FAILURE);
+	TS_STATUS_INFO_free(si);
+	ASN1_UTF8STRING_free(utf8_text);
+	return ret;
+	}
+
+int TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx, 
+				     int status, const char *text)
+	{
+	int ret = 1;
+	TS_STATUS_INFO *si = TS_RESP_get_status_info(ctx->response);
+
+	if (ASN1_INTEGER_get(si->status) == TS_STATUS_GRANTED)
+		{
+		/* Status has not been set, set it now. */
+		ret = TS_RESP_CTX_set_status_info(ctx, status, text);
+		}
+	return ret;
+	}
+
+int TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure)
+	{
+	TS_STATUS_INFO *si = TS_RESP_get_status_info(ctx->response);
+	if (!si->failure_info && !(si->failure_info = ASN1_BIT_STRING_new()))
+		goto err;
+	if (!ASN1_BIT_STRING_set_bit(si->failure_info, failure, 1))
+		goto err;
+	return 1;
+ err:
+	TSerr(TS_F_TS_RESP_CTX_ADD_FAILURE_INFO, ERR_R_MALLOC_FAILURE);
+	return 0;
+	}
+
+TS_REQ *TS_RESP_CTX_get_request(TS_RESP_CTX *ctx)
+	{
+	return ctx->request;
+	}
+
+TS_TST_INFO *TS_RESP_CTX_get_tst_info(TS_RESP_CTX *ctx)
+	{
+	return ctx->tst_info;
+	}
+
+int TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx, unsigned precision)
+       {
+       if (precision > TS_MAX_CLOCK_PRECISION_DIGITS)
+	       return 0;
+       ctx->clock_precision_digits = precision;
+       return 1;
+       }
+
+/* Main entry method of the response generation. */
+TS_RESP *TS_RESP_create_response(TS_RESP_CTX *ctx, BIO *req_bio)
+	{
+	ASN1_OBJECT *policy;
+	TS_RESP *response;
+	int result = 0;
+
+	TS_RESP_CTX_init(ctx);
+
+	/* Creating the response object. */
+	if (!(ctx->response = TS_RESP_new())) 
+		{
+		TSerr(TS_F_TS_RESP_CREATE_RESPONSE, ERR_R_MALLOC_FAILURE);
+		goto end;
+		}
+
+	/* Parsing DER request. */
+	if (!(ctx->request = d2i_TS_REQ_bio(req_bio, NULL)))
+		{
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Bad request format or "
+					    "system error.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_BAD_DATA_FORMAT);
+		goto end;
+		}
+
+	/* Setting default status info. */
+	if (!TS_RESP_CTX_set_status_info(ctx, TS_STATUS_GRANTED, NULL))
+		goto end;
+
+	/* Checking the request format. */
+	if (!TS_RESP_check_request(ctx)) goto end;
+
+	/* Checking acceptable policies. */
+	if (!(policy = TS_RESP_get_policy(ctx))) goto end;
+
+	/* Creating the TS_TST_INFO object. */
+	if (!(ctx->tst_info = TS_RESP_create_tst_info(ctx, policy)))
+		goto end;
+
+	/* Processing extensions. */
+	if (!TS_RESP_process_extensions(ctx)) goto end;
+
+	/* Generating the signature. */
+	if (!TS_RESP_sign(ctx)) goto end;
+
+	/* Everything was successful. */
+	result = 1;
+ end:
+	if (!result)
+		{
+		TSerr(TS_F_TS_RESP_CREATE_RESPONSE, TS_R_RESPONSE_SETUP_ERROR);
+		TS_RESP_CTX_set_status_info_cond(ctx, TS_STATUS_REJECTION,
+						 "Error during response "
+						 "generation.");
+		/* Check if the status info was set. */
+		if (ctx->response
+		    && ASN1_INTEGER_get(
+			    TS_RESP_get_status_info(ctx->response)->status)
+		    == TS_STATUS_GRANTED)
+			{
+			/* Status info wasn't set, don't return a response. */
+			TS_RESP_free(ctx->response);
+			ctx->response = NULL;
+			}
+		}
+	response = ctx->response;
+	ctx->response = NULL;	/* Ownership will be returned to caller. */
+	TS_RESP_CTX_cleanup(ctx);
+	return response;
+	}
+
+/* Initializes the variable part of the context. */
+static void TS_RESP_CTX_init(TS_RESP_CTX *ctx)
+	{
+	ctx->request = NULL;
+	ctx->response = NULL;
+	ctx->tst_info = NULL;
+	}
+
+/* Cleans up the variable part of the context. */
+static void TS_RESP_CTX_cleanup(TS_RESP_CTX *ctx)
+	{
+	TS_REQ_free(ctx->request);
+	ctx->request = NULL;
+	TS_RESP_free(ctx->response);
+	ctx->response = NULL;
+	TS_TST_INFO_free(ctx->tst_info);
+	ctx->tst_info = NULL;
+	}
+
+/* Checks the format and content of the request. */
+static int TS_RESP_check_request(TS_RESP_CTX *ctx)
+	{
+	TS_REQ *request = ctx->request;
+	TS_MSG_IMPRINT *msg_imprint;
+	X509_ALGOR *md_alg;
+	int md_alg_id;
+	ASN1_OCTET_STRING *digest;
+	EVP_MD *md = NULL;
+	int i;
+
+	/* Checking request version. */
+	if (TS_REQ_get_version(request) != 1)
+		{
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Bad request version.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_BAD_REQUEST);
+		return 0;
+		}
+
+	/* Checking message digest algorithm. */
+	msg_imprint = TS_REQ_get_msg_imprint(request);
+	md_alg = TS_MSG_IMPRINT_get_algo(msg_imprint);
+	md_alg_id = OBJ_obj2nid(md_alg->algorithm);
+	for (i = 0; !md && i < sk_EVP_MD_num(ctx->mds); ++i)
+		{
+		EVP_MD *current_md = sk_EVP_MD_value(ctx->mds, i);
+		if (md_alg_id == EVP_MD_type(current_md))
+			md = current_md;
+		}
+	if (!md)
+		{
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Message digest algorithm is "
+					    "not supported.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_BAD_ALG);
+		return 0;
+		}
+
+	/* No message digest takes parameter. */
+	if (md_alg->parameter 
+	    && ASN1_TYPE_get(md_alg->parameter) != V_ASN1_NULL)
+		{
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Superfluous message digest "
+					    "parameter.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_BAD_ALG);
+		return 0;
+		}
+	/* Checking message digest size. */
+	digest = TS_MSG_IMPRINT_get_msg(msg_imprint);
+	if (digest->length != EVP_MD_size(md))
+		{
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Bad message digest.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_BAD_DATA_FORMAT);
+		return 0;
+		}
+
+	return 1;
+	}
+
+/* Returns the TSA policy based on the rqeuested and acceptable policies. */
+static ASN1_OBJECT *TS_RESP_get_policy(TS_RESP_CTX *ctx)
+	{
+	ASN1_OBJECT *requested = TS_REQ_get_policy_id(ctx->request);
+	ASN1_OBJECT *policy = NULL;
+	int i;
+
+	/* Return the default policy if none is requested or the default is
+	   requested. */
+	if (!requested || !OBJ_cmp(requested, ctx->default_policy))
+		policy = ctx->default_policy;
+
+	/* Check if the policy is acceptable. */
+	for (i = 0; !policy && i < sk_ASN1_OBJECT_num(ctx->policies); ++i)
+		{
+		ASN1_OBJECT *current = sk_ASN1_OBJECT_value(ctx->policies, i);
+		if (!OBJ_cmp(requested, current))
+			policy = current;
+		}
+	if (!policy)
+		{
+		TSerr(TS_F_TS_RESP_GET_POLICY, TS_R_UNACCEPTABLE_POLICY);
+		TS_RESP_CTX_set_status_info(ctx, TS_STATUS_REJECTION,
+					    "Requested policy is not "
+					    "supported.");
+		TS_RESP_CTX_add_failure_info(ctx, TS_INFO_UNACCEPTED_POLICY);
+		}
+	return policy;
+	}
+
+/* Creates the TS_TST_INFO object based on the settings of the context. */
+static TS_TST_INFO *TS_RESP_create_tst_info(TS_RESP_CTX *ctx,
+					    ASN1_OBJECT *policy)
+	{
+	int result = 0;
+	TS_TST_INFO *tst_info = NULL;
+	ASN1_INTEGER *serial = NULL;
+	ASN1_GENERALIZEDTIME *asn1_time = NULL;
+	long sec, usec;
+	TS_ACCURACY *accuracy = NULL;
+	ASN1_INTEGER *nonce;
+	GENERAL_NAME *tsa_name = NULL;
+
+	if (!(tst_info = TS_TST_INFO_new())) goto end;
+	if (!TS_TST_INFO_set_version(tst_info, 1)) goto end;
+	if (!TS_TST_INFO_set_policy_id(tst_info, policy)) goto end;
+	if (!TS_TST_INFO_set_msg_imprint(tst_info, ctx->request->msg_imprint))
+		goto end;
+	if (!(serial = (*ctx->serial_cb)(ctx, ctx->serial_cb_data))
+	    || !TS_TST_INFO_set_serial(tst_info, serial))
+		goto end;
+	if (!(*ctx->time_cb)(ctx, ctx->time_cb_data, &sec, &usec)
+            || !(asn1_time = TS_RESP_set_genTime_with_precision(NULL, 
+					sec, usec, 
+					ctx->clock_precision_digits))
+	    || !TS_TST_INFO_set_time(tst_info, asn1_time))
+		goto end;
+
+	/* Setting accuracy if needed. */
+	if ((ctx->seconds || ctx->millis || ctx->micros) 
+	    && !(accuracy = TS_ACCURACY_new()))
+		goto end;
+
+	if (ctx->seconds && !TS_ACCURACY_set_seconds(accuracy, ctx->seconds))
+		goto end;
+	if (ctx->millis && !TS_ACCURACY_set_millis(accuracy, ctx->millis))
+		goto end;
+	if (ctx->micros && !TS_ACCURACY_set_micros(accuracy, ctx->micros))
+		goto end;
+	if (accuracy && !TS_TST_INFO_set_accuracy(tst_info, accuracy)) 
+		goto end;
+
+	/* Setting ordering. */
+	if ((ctx->flags & TS_ORDERING) 
+	    && !TS_TST_INFO_set_ordering(tst_info, 1))
+		goto end;
+	
+	/* Setting nonce if needed. */
+	if ((nonce = TS_REQ_get_nonce(ctx->request)) != NULL
+	    && !TS_TST_INFO_set_nonce(tst_info, nonce))
+		goto end;
+
+	/* Setting TSA name to subject of signer certificate. */
+	if (ctx->flags & TS_TSA_NAME)
+		{
+		if (!(tsa_name = GENERAL_NAME_new())) goto end;
+		tsa_name->type = GEN_DIRNAME;
+		tsa_name->d.dirn = 
+			X509_NAME_dup(ctx->signer_cert->cert_info->subject);
+		if (!tsa_name->d.dirn) goto end;
+		if (!TS_TST_INFO_set_tsa(tst_info, tsa_name)) goto end;
+		}
+
+	result = 1;
+ end:
+	if (!result)
+		{
+		TS_TST_INFO_free(tst_info);
+		tst_info = NULL;
+		TSerr(TS_F_TS_RESP_CREATE_TST_INFO, TS_R_TST_INFO_SETUP_ERROR);
+		TS_RESP_CTX_set_status_info_cond(ctx, TS_STATUS_REJECTION,
+						 "Error during TSTInfo "
+						 "generation.");
+		}
+	GENERAL_NAME_free(tsa_name);
+	TS_ACCURACY_free(accuracy);
+	ASN1_GENERALIZEDTIME_free(asn1_time);
+	ASN1_INTEGER_free(serial);
+	
+	return tst_info;
+	}
+
+/* Processing the extensions of the request. */
+static int TS_RESP_process_extensions(TS_RESP_CTX *ctx)
+	{
+	STACK_OF(X509_EXTENSION) *exts = TS_REQ_get_exts(ctx->request);
+	int i;
+	int ok = 1;
+
+	for (i = 0; ok && i < sk_X509_EXTENSION_num(exts); ++i)
+		{
+		X509_EXTENSION *ext = sk_X509_EXTENSION_value(exts, i);
+		ok = (*ctx->extension_cb)(ctx, ext, ctx->extension_cb);
+		}
+
+	return ok;
+	}
+
+/* Functions for signing the TS_TST_INFO structure of the context. */
+static int TS_RESP_sign(TS_RESP_CTX *ctx)
+	{
+	int ret = 0;
+	PKCS7 *p7 = NULL;
+	PKCS7_SIGNER_INFO *si;
+	STACK_OF(X509) *certs;	/* Certificates to include in sc. */
+	ESS_SIGNING_CERT *sc = NULL;
+	ASN1_OBJECT *oid;
+	BIO *p7bio = NULL;
+	int i;
+
+	/* Check if signcert and pkey match. */
+	if (!X509_check_private_key(ctx->signer_cert, ctx->signer_key)) {
+		TSerr(TS_F_TS_RESP_SIGN, 
+		      TS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE);
+                goto err;
+	}
+
+	/* Create a new PKCS7 signed object. */
+	if (!(p7 = PKCS7_new())) {
+		TSerr(TS_F_TS_RESP_SIGN, ERR_R_MALLOC_FAILURE);
+		goto err;
+	}
+	if (!PKCS7_set_type(p7, NID_pkcs7_signed)) goto err;
+
+	/* Force SignedData version to be 3 instead of the default 1. */
+	if (!ASN1_INTEGER_set(p7->d.sign->version, 3)) goto err;
+
+	/* Add signer certificate and optional certificate chain. */
+	if (TS_REQ_get_cert_req(ctx->request))
+		{
+		PKCS7_add_certificate(p7, ctx->signer_cert);
+		if (ctx->certs)
+			{
+			for(i = 0; i < sk_X509_num(ctx->certs); ++i) 
+				{
+				X509 *cert = sk_X509_value(ctx->certs, i);
+				PKCS7_add_certificate(p7, cert);
+				}
+			}
+		}
+
+	/* Add a new signer info. */
+    	if (!(si = PKCS7_add_signature(p7, ctx->signer_cert, 
+				       ctx->signer_key, EVP_sha1())))
+		{
+		TSerr(TS_F_TS_RESP_SIGN, TS_R_PKCS7_ADD_SIGNATURE_ERROR);
+		goto err;
+		}
+
+	/* Add content type signed attribute to the signer info. */
+	oid = OBJ_nid2obj(NID_id_smime_ct_TSTInfo);
+	if (!PKCS7_add_signed_attribute(si, NID_pkcs9_contentType,
+					V_ASN1_OBJECT, oid))
+		{
+		TSerr(TS_F_TS_RESP_SIGN, TS_R_PKCS7_ADD_SIGNED_ATTR_ERROR);
+		goto err;
+		}
+
+	/* Create the ESS SigningCertificate attribute which contains 
+	   the signer certificate id and optionally the certificate chain. */
+	certs = ctx->flags & TS_ESS_CERT_ID_CHAIN ? ctx->certs : NULL;
+	if (!(sc = ESS_SIGNING_CERT_new_init(ctx->signer_cert, certs)))
+		goto err;
+
+	/* Add SigningCertificate signed attribute to the signer info. */
+	if (!ESS_add_signing_cert(si, sc))
+		{
+		TSerr(TS_F_TS_RESP_SIGN, TS_R_ESS_ADD_SIGNING_CERT_ERROR);
+		goto err;
+		}	
+
+	/* Add a new empty NID_id_smime_ct_TSTInfo encapsulated content. */
+	if (!TS_TST_INFO_content_new(p7)) goto err;
+
+	/* Add the DER encoded tst_info to the PKCS7 structure. */
+	if (!(p7bio = PKCS7_dataInit(p7, NULL))) {
+		TSerr(TS_F_TS_RESP_SIGN, ERR_R_MALLOC_FAILURE);
+		goto err;
+	}
+
+	/* Convert tst_info to DER. */
+	if (!i2d_TS_TST_INFO_bio(p7bio, ctx->tst_info))
+		{
+		TSerr(TS_F_TS_RESP_SIGN, TS_R_TS_DATASIGN);
+		goto err;
+		}
+
+	/* Create the signature and add it to the signer info. */
+        if (!PKCS7_dataFinal(p7, p7bio))
+		{
+		TSerr(TS_F_TS_RESP_SIGN, TS_R_TS_DATASIGN);
+		goto err;
+		}
+
+	/* Set new PKCS7 and TST_INFO objects. */
+	TS_RESP_set_tst_info(ctx->response, p7, ctx->tst_info);
+	p7 = NULL;		/* Ownership is lost. */
+	ctx->tst_info = NULL;	/* Ownership is lost. */
+
+	ret = 1;
+ err:
+	if (!ret)
+		TS_RESP_CTX_set_status_info_cond(ctx, TS_STATUS_REJECTION,
+						 "Error during signature "
+						 "generation.");
+	BIO_free_all(p7bio);
+	ESS_SIGNING_CERT_free(sc);
+	PKCS7_free(p7);
+	return ret;
+	}
+
+static ESS_SIGNING_CERT *ESS_SIGNING_CERT_new_init(X509 *signcert, 
+						   STACK_OF(X509) *certs)
+	{
+	ESS_CERT_ID *cid;
+	ESS_SIGNING_CERT *sc = NULL;
+	int i;
+
+	/* Creating the ESS_CERT_ID stack. */
+	if (!(sc = ESS_SIGNING_CERT_new())) goto err;
+	if (!sc->cert_ids && !(sc->cert_ids = sk_ESS_CERT_ID_new_null()))
+		goto err;
+
+	/* Adding the signing certificate id. */
+	if (!(cid = ESS_CERT_ID_new_init(signcert, 0))
+	    || !sk_ESS_CERT_ID_push(sc->cert_ids, cid))
+		goto err;
+	/* Adding the certificate chain ids. */
+	for (i = 0; i < sk_X509_num(certs); ++i)
+		{
+		X509 *cert = sk_X509_value(certs, i);
+		if (!(cid = ESS_CERT_ID_new_init(cert, 1))
+		    || !sk_ESS_CERT_ID_push(sc->cert_ids, cid))
+			goto err;
+		}
+
+	return sc;
+err:
+	ESS_SIGNING_CERT_free(sc);
+	TSerr(TS_F_ESS_SIGNING_CERT_NEW_INIT, ERR_R_MALLOC_FAILURE);
+	return NULL;
+	}
+
+static ESS_CERT_ID *ESS_CERT_ID_new_init(X509 *cert, int issuer_needed)
+	{
+	ESS_CERT_ID *cid = NULL;
+	GENERAL_NAME *name = NULL;
+	
+	/* Recompute SHA1 hash of certificate if necessary (side effect). */
+	X509_check_purpose(cert, -1, 0);
+
+	if (!(cid = ESS_CERT_ID_new())) goto err;
+	if (!ASN1_OCTET_STRING_set(cid->hash, cert->sha1_hash,
+				   sizeof(cert->sha1_hash)))
+		goto err;
+
+	/* Setting the issuer/serial if requested. */
+	if (issuer_needed)
+		{
+		/* Creating issuer/serial structure. */
+		if (!cid->issuer_serial
+		    && !(cid->issuer_serial = ESS_ISSUER_SERIAL_new()))
+			goto err;
+		/* Creating general name from the certificate issuer. */
+		if (!(name = GENERAL_NAME_new())) goto err;
+		name->type = GEN_DIRNAME;
+		if (!(name->d.dirn = X509_NAME_dup(cert->cert_info->issuer))) 
+			goto err;
+		if (!sk_GENERAL_NAME_push(cid->issuer_serial->issuer, name)) 
+			goto err;
+		name = NULL;	/* Ownership is lost. */
+		/* Setting the serial number. */
+		ASN1_INTEGER_free(cid->issuer_serial->serial);
+		if (!(cid->issuer_serial->serial = 
+		      ASN1_INTEGER_dup(cert->cert_info->serialNumber)))
+			goto err;
+		}
+
+	return cid;
+err:
+	GENERAL_NAME_free(name);
+	ESS_CERT_ID_free(cid);
+	TSerr(TS_F_ESS_CERT_ID_NEW_INIT, ERR_R_MALLOC_FAILURE);
+	return NULL;
+	}
+
+static int TS_TST_INFO_content_new(PKCS7 *p7)
+	{
+	PKCS7 *ret = NULL;
+	ASN1_OCTET_STRING *octet_string = NULL;
+
+	/* Create new encapsulated NID_id_smime_ct_TSTInfo content. */
+	if (!(ret = PKCS7_new())) goto err;
+	if (!(ret->d.other = ASN1_TYPE_new())) goto err;
+	ret->type = OBJ_nid2obj(NID_id_smime_ct_TSTInfo);
+	if (!(octet_string = ASN1_OCTET_STRING_new())) goto err;
+	ASN1_TYPE_set(ret->d.other, V_ASN1_OCTET_STRING, octet_string);
+	octet_string = NULL;
+
+	/* Add encapsulated content to signed PKCS7 structure. */
+	if (!PKCS7_set_content(p7, ret)) goto err;
+
+	return 1;
+ err:
+	ASN1_OCTET_STRING_free(octet_string);
+	PKCS7_free(ret);
+	return 0;
+	}
+
+static int ESS_add_signing_cert(PKCS7_SIGNER_INFO *si, ESS_SIGNING_CERT *sc)
+	{
+	ASN1_STRING *seq = NULL;
+	unsigned char *p, *pp = NULL;
+	int len;
+
+	len = i2d_ESS_SIGNING_CERT(sc, NULL);
+	if (!(pp = (unsigned char *) OPENSSL_malloc(len)))
+		{
+		TSerr(TS_F_ESS_ADD_SIGNING_CERT, ERR_R_MALLOC_FAILURE);
+		goto err;
+		}
+	p = pp;
+	i2d_ESS_SIGNING_CERT(sc, &p);
+	if (!(seq = ASN1_STRING_new()) || !ASN1_STRING_set(seq, pp, len))
+		{
+		TSerr(TS_F_ESS_ADD_SIGNING_CERT, ERR_R_MALLOC_FAILURE);
+		goto err;
+		}
+	OPENSSL_free(pp); pp = NULL;
+	return PKCS7_add_signed_attribute(si, 
+					  NID_id_smime_aa_signingCertificate,
+					  V_ASN1_SEQUENCE, seq);
+ err:
+	ASN1_STRING_free(seq);
+	OPENSSL_free(pp);
+
+	return 0;
+	}
+
+
+static ASN1_GENERALIZEDTIME *
+TS_RESP_set_genTime_with_precision(ASN1_GENERALIZEDTIME *asn1_time, 
+				   long sec, long usec, unsigned precision)
+	{
+	time_t time_sec = (time_t) sec;
+	struct tm *tm = NULL;	
+	char genTime_str[17 + TS_MAX_CLOCK_PRECISION_DIGITS];
+	char *p = genTime_str;
+	char *p_end = genTime_str + sizeof(genTime_str);
+
+	if (precision > TS_MAX_CLOCK_PRECISION_DIGITS)
+		goto err;
+
+	
+	if (!(tm = gmtime(&time_sec)))
+		goto err;
+
+	/* 
+	 * Put "genTime_str" in GeneralizedTime format.  We work around the 
+	 * restrictions imposed by rfc3280 (i.e. "GeneralizedTime values MUST 
+	 * NOT include fractional seconds") and OpenSSL related functions to 
+	 * meet the rfc3161 requirement: "GeneralizedTime syntax can include 
+	 * fraction-of-second details". 
+	 */                   
+	p += BIO_snprintf(p, p_end - p,
+			  "%04d%02d%02d%02d%02d%02d",
+			  tm->tm_year + 1900, tm->tm_mon + 1, tm->tm_mday, 
+			  tm->tm_hour, tm->tm_min, tm->tm_sec);
+	if (precision > 0)
+	{
+		/* Add fraction of seconds (leave space for dot and null). */
+		BIO_snprintf(p, 2 + precision, ".%ld", usec);
+		/* We cannot use the snprintf return value, 
+		   because it might have been truncated. */
+		p += strlen(p);
+
+		/* To make things a bit harder, X.690 | ISO/IEC 8825-1 provides
+		   the following restrictions for a DER-encoding, which OpenSSL
+		   (specifically ASN1_GENERALIZEDTIME_check() function) doesn't 
+		   support:
+		   "The encoding MUST terminate with a "Z" (which means "Zulu" 
+		   time). The decimal point element, if present, MUST be the 
+		   point option ".". The fractional-seconds elements, 
+		   if present, MUST omit all trailing 0's; 
+		   if the elements correspond to 0, they MUST be wholly
+		   omitted, and the decimal point element also MUST be
+		   omitted." */
+		/* Remove trailing zeros. The dot guarantees the exit
+		   condition of this loop even if all the digits are zero. */
+		while (*--p == '0')
+			/* empty */;
+		/* p points to either the dot or the last non-zero digit. */
+		if (*p != '.') ++p;
+		}
+	/* Add the trailing Z and the terminating null. */
+	*p++ = 'Z';
+	*p++ = '\0';
+
+	/* Now call OpenSSL to check and set our genTime value */
+	if (!asn1_time && !(asn1_time = M_ASN1_GENERALIZEDTIME_new()))
+		goto err;
+	if (!ASN1_GENERALIZEDTIME_set_string(asn1_time, genTime_str))
+		{
+		ASN1_GENERALIZEDTIME_free(asn1_time);
+		goto err;
+		}
+
+	return asn1_time;
+ err:
+	TSerr(TS_F_TS_RESP_SET_GENTIME_WITH_PRECISION, TS_R_COULD_NOT_SET_TIME);
+	return NULL;
+	}
Index: openssl/crypto/ts/ts_resp_utils.c
diff -u /dev/null openssl/crypto/ts/ts_resp_utils.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_resp_utils.c	Mon Nov  8 16:31:15 2004
@@ -0,0 +1,409 @@
+/* crypto/ts/ts_resp_utils.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/ts.h>
+#include <openssl/pkcs7.h>
+
+/* Function definitions. */
+
+int TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *status_info)
+	{
+	TS_STATUS_INFO *new_status_info;
+
+	if (a->status_info == status_info)
+		return 1;
+	new_status_info = TS_STATUS_INFO_dup(status_info);
+	if (new_status_info == NULL)
+		{
+		TSerr(TS_F_TS_RESP_SET_STATUS_INFO, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	TS_STATUS_INFO_free(a->status_info);
+	a->status_info = new_status_info;
+
+	return 1;
+	}
+
+TS_STATUS_INFO *TS_RESP_get_status_info(TS_RESP *a)
+	{
+	return a->status_info;
+	}
+
+/* Caller loses ownership of PKCS7 and TS_TST_INFO objects. */
+void TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info)
+	{
+	/* Set new PKCS7 and TST_INFO objects. */
+	PKCS7_free(a->token);
+	a->token = p7;
+	TS_TST_INFO_free(a->tst_info);
+	a->tst_info = tst_info;
+	}
+
+PKCS7 *TS_RESP_get_token(TS_RESP *a)
+	{
+	return a->token;
+	}
+
+TS_TST_INFO *TS_RESP_get_tst_info(TS_RESP *a)
+	{
+	return a->tst_info;
+	}
+
+int TS_TST_INFO_set_version(TS_TST_INFO *a, long version)
+	{
+	return ASN1_INTEGER_set(a->version, version);
+	}
+
+long TS_TST_INFO_get_version(TS_TST_INFO *a)
+	{
+	return ASN1_INTEGER_get(a->version);
+	}
+
+int TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy)
+	{
+	ASN1_OBJECT *new_policy;
+
+	if (a->policy_id == policy)
+		return 1;
+	new_policy = OBJ_dup(policy);
+	if (new_policy == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_POLICY_ID, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_OBJECT_free(a->policy_id);
+	a->policy_id = new_policy;
+	return 1;
+	}
+
+ASN1_OBJECT *TS_TST_INFO_get_policy_id(TS_TST_INFO *a)
+	{
+	return a->policy_id;
+	}
+
+int TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint)
+	{
+	TS_MSG_IMPRINT *new_msg_imprint;
+
+	if (a->msg_imprint == msg_imprint)
+		return 1;
+	new_msg_imprint = TS_MSG_IMPRINT_dup(msg_imprint);
+	if (new_msg_imprint == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_MSG_IMPRINT, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	TS_MSG_IMPRINT_free(a->msg_imprint);
+	a->msg_imprint = new_msg_imprint;
+	return 1;
+	}
+
+TS_MSG_IMPRINT *TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a)
+	{
+	return a->msg_imprint;
+	}
+
+int TS_TST_INFO_set_serial(TS_TST_INFO *a, ASN1_INTEGER *serial)
+	{
+	ASN1_INTEGER *new_serial;
+
+	if (a->serial == serial)
+		return 1;
+	new_serial = ASN1_INTEGER_dup(serial);
+	if (new_serial == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_SERIAL, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_INTEGER_free(a->serial);
+	a->serial = new_serial;
+	return 1;
+	}
+
+ASN1_INTEGER *TS_TST_INFO_get_serial(TS_TST_INFO *a)
+	{
+	return a->serial;
+	}
+
+int TS_TST_INFO_set_time(TS_TST_INFO *a, ASN1_GENERALIZEDTIME *time)
+	{
+	ASN1_GENERALIZEDTIME *new_time;
+
+	if (a->time == time)
+		return 1;
+	new_time = M_ASN1_GENERALIZEDTIME_dup(time);
+	if (new_time == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_TIME, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_GENERALIZEDTIME_free(a->time);
+	a->time = new_time;
+	return 1;
+	}
+
+ASN1_GENERALIZEDTIME *TS_TST_INFO_get_time(TS_TST_INFO *a)
+	{
+	return a->time;
+	}
+
+int TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy)
+	{
+	TS_ACCURACY *new_accuracy;
+
+	if (a->accuracy == accuracy)
+		return 1;
+	new_accuracy = TS_ACCURACY_dup(accuracy);
+	if (new_accuracy == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_ACCURACY, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	TS_ACCURACY_free(a->accuracy);
+	a->accuracy = new_accuracy;
+	return 1;
+	}
+
+TS_ACCURACY *TS_TST_INFO_get_accuracy(TS_TST_INFO *a)
+	{
+	return a->accuracy;
+	}
+
+int TS_ACCURACY_set_seconds(TS_ACCURACY *a, ASN1_INTEGER *seconds)
+	{
+	ASN1_INTEGER *new_seconds;
+
+	if (a->seconds == seconds)
+		return 1;
+	new_seconds = ASN1_INTEGER_dup(seconds);
+	if (new_seconds == NULL)
+		{
+		TSerr(TS_F_TS_ACCURACY_SET_SECONDS, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_INTEGER_free(a->seconds);
+	a->seconds = new_seconds;
+	return 1;
+	}
+
+ASN1_INTEGER *TS_ACCURACY_get_seconds(TS_ACCURACY *a)
+	{
+	return a->seconds;
+	}
+
+int TS_ACCURACY_set_millis(TS_ACCURACY *a, ASN1_INTEGER *millis)
+	{
+	ASN1_INTEGER *new_millis = NULL;
+
+	if (a->millis == millis)
+		return 1;
+	if (millis != NULL)
+		{
+		new_millis = ASN1_INTEGER_dup(millis);
+		if (new_millis == NULL)
+			{
+			TSerr(TS_F_TS_ACCURACY_SET_MILLIS, 
+			      ERR_R_MALLOC_FAILURE);
+			return 0;
+			}
+		}
+	ASN1_INTEGER_free(a->millis);
+	a->millis = new_millis;
+	return 1;
+	}
+
+ASN1_INTEGER *TS_ACCURACY_get_millis(TS_ACCURACY *a)
+	{
+	return a->millis;
+	}
+
+int TS_ACCURACY_set_micros(TS_ACCURACY *a, ASN1_INTEGER *micros)
+	{
+	ASN1_INTEGER *new_micros = NULL;
+
+	if (a->micros == micros)
+		return 1;
+	if (micros != NULL)
+		{
+		new_micros = ASN1_INTEGER_dup(micros);
+		if (new_micros == NULL)
+			{
+			TSerr(TS_F_TS_ACCURACY_SET_MICROS, 
+			      ERR_R_MALLOC_FAILURE);
+			return 0;
+			}
+		}
+	ASN1_INTEGER_free(a->micros);
+	a->micros = new_micros;
+	return 1;
+	}
+
+ASN1_INTEGER *TS_ACCURACY_get_micros(TS_ACCURACY *a)
+	{
+	return a->micros;
+	}
+
+int TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering)
+	{
+	a->ordering = ordering ? 0xFF : 0x00;
+	return 1;
+	}
+
+int TS_TST_INFO_get_ordering(TS_TST_INFO *a)
+	{
+	return a->ordering ? 1 : 0;
+	}
+
+int TS_TST_INFO_set_nonce(TS_TST_INFO *a, ASN1_INTEGER *nonce)
+	{
+	ASN1_INTEGER *new_nonce;
+
+	if (a->nonce == nonce)
+		return 1;
+	new_nonce = ASN1_INTEGER_dup(nonce);
+	if (new_nonce == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_NONCE, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	ASN1_INTEGER_free(a->nonce);
+	a->nonce = new_nonce;
+	return 1;
+	}
+
+ASN1_INTEGER *TS_TST_INFO_get_nonce(TS_TST_INFO *a)
+	{
+	return a->nonce;
+	}
+
+int TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa)
+	{
+	GENERAL_NAME *new_tsa;
+
+	if (a->tsa == tsa)
+		return 1;
+	new_tsa = GENERAL_NAME_dup(tsa);
+	if (new_tsa == NULL)
+		{
+		TSerr(TS_F_TS_TST_INFO_SET_TSA, ERR_R_MALLOC_FAILURE);
+		return 0;
+		}
+	GENERAL_NAME_free(a->tsa);
+	a->tsa = new_tsa;
+	return 1;
+	}
+
+GENERAL_NAME *TS_TST_INFO_get_tsa(TS_TST_INFO *a)
+	{
+	return a->tsa;
+	}
+
+STACK_OF(X509_EXTENSION) *TS_TST_INFO_get_exts(TS_TST_INFO *a)
+	{
+	return a->extensions;
+	}
+
+void TS_TST_INFO_ext_free(TS_TST_INFO *a)
+	{
+	if (!a) return;
+	sk_X509_EXTENSION_pop_free(a->extensions, X509_EXTENSION_free);
+	a->extensions = NULL;
+	}
+
+int TS_TST_INFO_get_ext_count(TS_TST_INFO *a)
+	{
+	return X509v3_get_ext_count(a->extensions);
+	}
+
+int TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos)
+	{
+	return X509v3_get_ext_by_NID(a->extensions, nid, lastpos);
+	}
+
+int TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, ASN1_OBJECT *obj, int lastpos)
+	{
+	return X509v3_get_ext_by_OBJ(a->extensions, obj, lastpos);
+	}
+
+int TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos)
+	{
+	return X509v3_get_ext_by_critical(a->extensions, crit, lastpos);
+	}
+
+X509_EXTENSION *TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc)
+	{
+	return X509v3_get_ext(a->extensions,loc);
+	}
+
+X509_EXTENSION *TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc)
+	{
+	return X509v3_delete_ext(a->extensions,loc);
+	}
+
+int TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc)
+	{
+	return X509v3_add_ext(&a->extensions,ex,loc) != NULL;
+	}
+
+void *TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx)
+	{
+	return X509V3_get_d2i(a->extensions, nid, crit, idx);
+	}
Index: openssl/crypto/ts/ts_resp_verify.c
diff -u /dev/null openssl/crypto/ts/ts_resp_verify.c:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_resp_verify.c	Mon Nov  8 16:31:15 2004
@@ -0,0 +1,722 @@
+/* crypto/ts/ts_resp_verify.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2002.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <stdio.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/ts.h>
+#include <openssl/pkcs7.h>
+
+/* Private function declarations. */
+
+static int TS_verify_cert(X509_STORE *store, STACK_OF(X509) *untrusted,
+			  X509 *signer, STACK_OF(X509) **chain);
+static int TS_check_signing_certs(PKCS7_SIGNER_INFO *si, STACK_OF(X509) *chain);
+static ESS_SIGNING_CERT *ESS_get_signing_cert(PKCS7_SIGNER_INFO *si);
+static int TS_find_cert(STACK_OF(ESS_CERT_ID) *cert_ids, X509 *cert);
+static int TS_issuer_serial_cmp(ESS_ISSUER_SERIAL *is, X509_CINF *cinfo);
+static int _TS_RESP_verify_token(TS_VERIFY_CTX *ctx, 
+				 PKCS7 *token, TS_TST_INFO *tst_info);
+static int TS_check_status_info(TS_RESP *response);
+static char *TS_get_status_text(STACK_OF(ASN1_UTF8STRING) *text);
+static int TS_check_policy(ASN1_OBJECT *req_oid, TS_TST_INFO *tst_info);
+static int TS_compute_imprint(BIO *data, TS_TST_INFO *tst_info,
+			      X509_ALGOR **md_alg, 
+			      unsigned char **imprint, unsigned *imprint_len);
+static int TS_check_imprints(X509_ALGOR *algor_a, 
+			     unsigned char *imprint_a, unsigned len_a,
+			     TS_TST_INFO *tst_info);
+static int TS_check_nonces(ASN1_INTEGER *a, TS_TST_INFO *tst_info);
+static int TS_check_signer_name(GENERAL_NAME *tsa_name, X509 *signer);
+static int TS_find_name(STACK_OF(GENERAL_NAME) *gen_names, GENERAL_NAME *name);
+
+/*
+ * Local mapping between response codes and descriptions.
+ * Don't forget to change TS_STATUS_BUF_SIZE when modifying 
+ * the elements of this array.
+ */
+static char *TS_status_text[] =
+	{ "granted",
+	  "grantedWithMods",
+	  "rejection",
+	  "waiting",
+	  "revocationWarning",
+	  "revocationNotification" };
+
+#define TS_STATUS_TEXT_SIZE	(sizeof(TS_status_text)/sizeof(*TS_status_text))
+
+/*
+ * This must be greater or equal to the sum of the strings in TS_status_text
+ * plus the number of its elements.
+ */
+#define TS_STATUS_BUF_SIZE	256
+
+static struct
+	{
+	int code;
+	char *text;
+	} TS_failure_info[] =
+		{ { TS_INFO_BAD_ALG, "badAlg" },
+		  { TS_INFO_BAD_REQUEST, "badRequest" },
+		  { TS_INFO_BAD_DATA_FORMAT, "badDataFormat" },
+		  { TS_INFO_TIME_NOT_AVAILABLE, "timeNotAvailable" },
+		  { TS_INFO_UNACCEPTED_POLICY, "unacceptedPolicy" },
+		  { TS_INFO_UNACCEPTED_EXTENSION, "unacceptedExtension" },
+		  { TS_INFO_ADD_INFO_NOT_AVAILABLE, "addInfoNotAvailable" },
+		  { TS_INFO_SYSTEM_FAILURE, "systemFailure" } };
+
+#define TS_FAILURE_INFO_SIZE	(sizeof(TS_failure_info) / \
+				sizeof(*TS_failure_info))
+
+/* Functions for verifying a signed TS_TST_INFO structure. */
+
+/*
+ * This function carries out the following tasks:
+ *	- Checks if there is one and only one signer.
+ *	- Search for the signing certificate in 'certs' and in the response.
+ *	- Check the extended key usage and key usage fields of the signer
+ *	certificate (done by the path validation).
+ *	- Build and validate the certificate path.
+ *	- Check if the certificate path meets the requirements of the
+ *	SigningCertificate ESS signed attribute.
+ *	- Verify the signature value.
+ *	- Returns the signer certificate in 'signer', if 'signer' is not NULL.
+ */
+int TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
+			     X509_STORE *store, X509 **signer_out)
+	{
+	STACK_OF(PKCS7_SIGNER_INFO) *sinfos = NULL;
+	PKCS7_SIGNER_INFO *si;
+	STACK_OF(X509) *signers = NULL;
+	X509	*signer;
+	STACK_OF(X509) *chain = NULL;
+	char	buf[4096];
+	int	i, j = 0, ret = 0;
+	BIO	*p7bio = NULL;
+
+	/* Some sanity checks first. */
+	if (!token)
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_SIGNATURE, TS_R_INVALID_NULL_POINTER);
+		goto err;
+		}
+
+	/* Check for the correct content type */
+	if(!PKCS7_type_is_signed(token))
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_SIGNATURE, TS_R_WRONG_CONTENT_TYPE);
+		goto err;
+		}
+
+	/* Check if there is one and only one signer. */
+	sinfos = PKCS7_get_signer_info(token);
+	if (!sinfos || sk_PKCS7_SIGNER_INFO_num(sinfos) != 1)
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_SIGNATURE,
+		      TS_R_THERE_MUST_BE_ONE_SIGNER);
+		goto err;
+		}
+	si = sk_PKCS7_SIGNER_INFO_value(sinfos, 0);
+
+	/* Check for no content: no data to verify signature. */
+	if (PKCS7_get_detached(token))
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_SIGNATURE, TS_R_NO_CONTENT);
+		goto err;
+		}
+	
+	/* Get hold of the signer certificate, search only internal
+	   certificates if it was requested. */
+	signers = PKCS7_get0_signers(token, certs, 0);
+	if (!signers || sk_X509_num(signers) != 1) goto err;
+	signer = sk_X509_value(signers, 0);
+
+	/* Now verify the certificate. */
+	if (!TS_verify_cert(store, certs, signer, &chain)) goto err;
+
+	/* Check if the signer certificate is consistent with the
+	   ESS extension. */
+	if (!TS_check_signing_certs(si, chain)) goto err;
+
+	/* Creating the message digest. */
+	p7bio = PKCS7_dataInit(token, NULL);
+
+	/* We now have to 'read' from p7bio to calculate digests etc. */
+	while ((i = BIO_read(p7bio,buf,sizeof(buf))) > 0);
+
+	/* Verifying the signature. */
+	j = PKCS7_signatureVerify(p7bio, token, si, signer);
+	if (j <= 0)
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_SIGNATURE, TS_R_SIGNATURE_FAILURE);
+		goto err;
+		}
+
+	/* Return the signer certificate if needed. */
+	if (signer_out)
+		{
+		*signer_out = signer;
+		CRYPTO_add(&signer->references, 1, CRYPTO_LOCK_X509);
+		}
+
+	ret = 1;
+
+ err:
+	BIO_free_all(p7bio);
+	sk_X509_pop_free(chain, X509_free);
+	sk_X509_free(signers);
+
+	return ret;
+	}
+
+/*
+ * The certificate chain is returned in chain. Caller is responsible for
+ * freeing the vector.
+ */
+static int TS_verify_cert(X509_STORE *store, STACK_OF(X509) *untrusted,
+			  X509 *signer, STACK_OF(X509) **chain)
+	{
+	X509_STORE_CTX	cert_ctx;
+	int i;
+	int ret = 1;
+
+	/* chain is an out argument. */
+	*chain = NULL;
+	X509_STORE_CTX_init(&cert_ctx, store, signer, untrusted);
+	X509_STORE_CTX_set_purpose(&cert_ctx, X509_PURPOSE_TIMESTAMP_SIGN);
+	i = X509_verify_cert(&cert_ctx);
+	if (i <= 0)
+		{
+		int j = X509_STORE_CTX_get_error(&cert_ctx);
+		TSerr(TS_F_TS_VERIFY_CERT, TS_R_CERTIFICATE_VERIFY_ERROR);
+		ERR_add_error_data(2, "Verify error:",
+				   X509_verify_cert_error_string(j));
+		ret = 0;
+		}
+	else
+		{
+		/* Get a copy of the certificate chain. */
+		*chain = X509_STORE_CTX_get1_chain(&cert_ctx);
+		}
+
+	X509_STORE_CTX_cleanup(&cert_ctx);
+
+	return ret;
+	}
+
+static int TS_check_signing_certs(PKCS7_SIGNER_INFO *si, STACK_OF(X509) *chain)
+	{
+	ESS_SIGNING_CERT *ss = ESS_get_signing_cert(si);
+	STACK_OF(ESS_CERT_ID) *cert_ids = NULL;
+	X509 *cert;
+	int i = 0;
+	int ret = 0;
+
+	if (!ss) goto err;
+	cert_ids = ss->cert_ids;
+	/* The signer certificate must be the first in cert_ids. */
+	cert = sk_X509_value(chain, 0);
+	if (TS_find_cert(cert_ids, cert) != 0) goto err;
+	
+	/* Check the other certificates of the chain if there are more
+	   than one certificate ids in cert_ids. */
+	if (sk_ESS_CERT_ID_num(cert_ids) > 1)
+		{
+		/* All the certificates of the chain must be in cert_ids. */
+		for (i = 1; i < sk_X509_num(chain); ++i)
+			{
+			cert = sk_X509_value(chain, i);
+			if (TS_find_cert(cert_ids, cert) < 0) goto err;
+			}
+		}
+	ret = 1;
+ err:
+	if (!ret)
+		TSerr(TS_F_TS_CHECK_SIGNING_CERTS, 
+		      TS_R_ESS_SIGNING_CERTIFICATE_ERROR);
+	ESS_SIGNING_CERT_free(ss);
+	return ret;
+	}
+
+static ESS_SIGNING_CERT *ESS_get_signing_cert(PKCS7_SIGNER_INFO *si)
+	{
+	ASN1_TYPE *attr;
+	unsigned char *p;
+	attr = PKCS7_get_signed_attribute(si, 
+					  NID_id_smime_aa_signingCertificate);
+	if (!attr) return NULL;
+	p = attr->value.sequence->data;
+	return d2i_ESS_SIGNING_CERT(NULL, &p, attr->value.sequence->length);
+	}
+
+/* Returns < 0 if certificate is not found, certificate index otherwise. */
+static int TS_find_cert(STACK_OF(ESS_CERT_ID) *cert_ids, X509 *cert)
+	{
+	int i;
+
+	if (!cert_ids || !cert) return -1;
+
+	/* Recompute SHA1 hash of certificate if necessary (side effect). */
+	X509_check_purpose(cert, -1, 0);
+
+	/* Look for cert in the cert_ids vector. */
+	for (i = 0; i < sk_ESS_CERT_ID_num(cert_ids); ++i)
+		{
+		ESS_CERT_ID *cid = sk_ESS_CERT_ID_value(cert_ids, i);
+
+		/* Check the SHA-1 hash first. */
+		if (cid->hash->length == sizeof(cert->sha1_hash)
+		    && !memcmp(cid->hash->data, cert->sha1_hash,
+			       sizeof(cert->sha1_hash)))
+			{
+			/* Check the issuer/serial as well if specified. */
+			ESS_ISSUER_SERIAL *is = cid->issuer_serial;
+			if (!is || !TS_issuer_serial_cmp(is, cert->cert_info))
+				return i;
+			}
+		}
+	
+	return -1;
+	}
+
+static int TS_issuer_serial_cmp(ESS_ISSUER_SERIAL *is, X509_CINF *cinfo)
+	{
+	GENERAL_NAME *issuer;
+
+	if (!is || !cinfo || sk_GENERAL_NAME_num(is->issuer) != 1) return -1;
+
+	/* Check the issuer first. It must be a directory name. */
+	issuer = sk_GENERAL_NAME_value(is->issuer, 0);
+	if (issuer->type != GEN_DIRNAME 
+	    || X509_NAME_cmp(issuer->d.dirn, cinfo->issuer))
+		return -1;
+
+	/* Check the serial number, too. */
+	if (ASN1_INTEGER_cmp(is->serial, cinfo->serialNumber))
+		return -1;
+
+	return 0;
+	}
+
+/*
+ * Verifies whether 'response' contains a valid response with regards 
+ * to the settings of the context:
+ *	- Gives an error message if the TS_TST_INFO is not present.
+ *	- Calls _TS_RESP_verify_token to verify the token content.
+ */
+int TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response)
+	{
+	PKCS7 *token = TS_RESP_get_token(response);
+	TS_TST_INFO *tst_info = TS_RESP_get_tst_info(response);
+	int ret = 0;
+
+	/* Check if we have a successful TS_TST_INFO object in place. */
+	if (!TS_check_status_info(response)) goto err;
+
+	/* Check the contents of the time stamp token. */
+	if (!_TS_RESP_verify_token(ctx, token, tst_info))
+		goto err;
+
+	ret = 1;
+ err:
+	return ret;
+	}
+
+/*
+ * Tries to extract a TS_TST_INFO structure from the PKCS7 token and
+ * calls the internal _TS_RESP_verify_token function for verifying it.
+ */
+int TS_RESP_verify_token(TS_VERIFY_CTX *ctx, PKCS7 *token)
+	{
+	TS_TST_INFO *tst_info = PKCS7_to_TS_TST_INFO(token);
+	int ret = 0;
+	if (tst_info)
+		{
+		ret = _TS_RESP_verify_token(ctx, token, tst_info);
+		TS_TST_INFO_free(tst_info);
+		}
+	return ret;
+	}
+
+/*
+ * Verifies whether the 'token' contains a valid time stamp token 
+ * with regards to the settings of the context. Only those checks are
+ * carried out that are specified in the context:
+ *	- Verifies the signature of the TS_TST_INFO.
+ *	- Checks the version number of the response.
+ *	- Check if the requested and returned policies math.
+ *	- Check if the message imprints are the same.
+ *	- Check if the nonces are the same.
+ *	- Check if the TSA name matches the signer.
+ *	- Check if the TSA name is the expected TSA.
+ */
+static int _TS_RESP_verify_token(TS_VERIFY_CTX *ctx, 
+				 PKCS7 *token, TS_TST_INFO *tst_info)
+	{
+	X509 *signer = NULL;
+	GENERAL_NAME *tsa_name = TS_TST_INFO_get_tsa(tst_info);
+	X509_ALGOR *md_alg = NULL;
+	unsigned char *imprint = NULL;
+	unsigned imprint_len = 0;
+	int ret = 0;
+
+	/* Verify the signature. */
+	if ((ctx->flags & TS_VFY_SIGNATURE)
+	    && !TS_RESP_verify_signature(token, ctx->certs, ctx->store,
+					 &signer))
+		goto err;
+	
+	/* Check version number of response. */
+	if ((ctx->flags & TS_VFY_VERSION)
+	    && TS_TST_INFO_get_version(tst_info) != 1)
+		{
+		TSerr(TS_F_TS_VERIFY, TS_R_UNSUPPORTED_VERSION);
+		goto err;
+		}
+
+	/* Check policies. */
+	if ((ctx->flags & TS_VFY_POLICY)
+	    && !TS_check_policy(ctx->policy, tst_info))
+		goto err;
+	
+	/* Check message imprints. */
+	if ((ctx->flags & TS_VFY_IMPRINT)
+	    && !TS_check_imprints(ctx->md_alg, ctx->imprint, ctx->imprint_len,
+				  tst_info)) 
+		goto err;
+
+	/* Compute and check message imprints. */
+	if ((ctx->flags & TS_VFY_DATA)
+	    && (!TS_compute_imprint(ctx->data, tst_info,
+				    &md_alg, &imprint, &imprint_len)
+	    || !TS_check_imprints(md_alg, imprint, imprint_len, tst_info)))
+		goto err;
+
+	/* Check nonces. */
+	if ((ctx->flags & TS_VFY_NONCE)
+	    && !TS_check_nonces(ctx->nonce, tst_info))
+		goto err;
+
+	/* Check whether TSA name and signer certificate match. */
+	if ((ctx->flags & TS_VFY_SIGNER)
+	    && tsa_name && !TS_check_signer_name(tsa_name, signer))
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_TOKEN, TS_R_TSA_NAME_MISMATCH);
+		goto err;
+		}
+
+	/* Check whether the TSA is the expected one. */
+	if ((ctx->flags & TS_VFY_TSA_NAME)
+	    && !TS_check_signer_name(ctx->tsa_name, signer))
+		{
+		TSerr(TS_F_TS_RESP_VERIFY_TOKEN, TS_R_TSA_UNTRUSTED);
+		goto err;
+		}
+
+	ret = 1;
+ err:
+	X509_free(signer);
+	X509_ALGOR_free(md_alg);
+	OPENSSL_free(imprint);
+	return ret;
+	}
+
+static int TS_check_status_info(TS_RESP *response)
+	{
+	TS_STATUS_INFO *info = TS_RESP_get_status_info(response);
+	int status = ASN1_INTEGER_get(info->status);
+	char *status_text = NULL;
+	char *embedded_status_text = NULL;
+	char failure_text[TS_STATUS_BUF_SIZE] = "";
+
+	/* Check if everything went fine. */
+	if (status == 0 || status == 1) return 1;
+
+	/* There was an error, get the description in status_text. */
+	if (0 <= status && status < TS_STATUS_TEXT_SIZE)
+		status_text = TS_status_text[status];
+	else
+		status_text = "unknown code";
+
+	/* Set the embedded_status_text to the returned description. */
+	if (sk_ASN1_UTF8STRING_num(info->text) > 0
+	    && !(embedded_status_text = TS_get_status_text(info->text)))
+		return 0;
+	
+	/* Filling in failure_text with the failure information. */
+	if (info->failure_info)
+		{
+		int i;
+		int first = 1;
+		for (i = 0; i < TS_FAILURE_INFO_SIZE; ++i)
+			{
+			if (ASN1_BIT_STRING_get_bit(info->failure_info,
+						    TS_failure_info[i].code))
+				{
+				if (!first)
+					strcpy(failure_text, ",");
+				else
+					first = 0;
+				strcat(failure_text, TS_failure_info[i].text);
+				}
+			}
+		}
+	if (failure_text[0] == '\0')
+		strcpy(failure_text, "unspecified");
+
+	/* Making up the error string. */
+	TSerr(TS_F_TS_CHECK_STATUS_INFO, TS_R_NO_TIME_STAMP_TOKEN);
+	ERR_add_error_data(6,
+			   "status code: ", status_text,
+			   ", status text: ", embedded_status_text ? 
+			   embedded_status_text : "unspecified",
+			   ", failure codes: ", failure_text);
+	OPENSSL_free(embedded_status_text);
+
+	return 0;
+	}
+
+static char *TS_get_status_text(STACK_OF(ASN1_UTF8STRING) *text)
+	{
+	int i;
+	unsigned length = 0;
+	char *result = NULL;
+	char *p;
+
+	/* Determine length first. */
+	for (i = 0; i < sk_ASN1_UTF8STRING_num(text); ++i)
+		{
+		ASN1_UTF8STRING *current = sk_ASN1_UTF8STRING_value(text, i);
+		length += ASN1_STRING_length(current);
+		length += 1;	/* separator character */
+		}
+	/* Allocate memory (closing '\0' included). */
+	if (!(result = OPENSSL_malloc(length)))
+		{
+		TSerr(TS_F_TS_GET_STATUS_TEXT, ERR_R_MALLOC_FAILURE);
+		return NULL;
+		}
+	/* Concatenate the descriptions. */
+	for (i = 0, p = result; i < sk_ASN1_UTF8STRING_num(text); ++i)
+		{
+		ASN1_UTF8STRING *current = sk_ASN1_UTF8STRING_value(text, i);
+		length = ASN1_STRING_length(current);
+		if (i > 0) *p++ = '/';
+		strncpy(p, ASN1_STRING_data(current), length);
+		p += length;
+		}
+	/* We do have space for this, too. */
+	*p = '\0';
+	
+	return result;
+	}
+
+static int TS_check_policy(ASN1_OBJECT *req_oid, TS_TST_INFO *tst_info)
+	{
+	ASN1_OBJECT *resp_oid = TS_TST_INFO_get_policy_id(tst_info);
+
+	if (OBJ_cmp(req_oid, resp_oid) != 0)
+		{
+		TSerr(TS_F_TS_CHECK_POLICY, TS_R_POLICY_MISMATCH);
+		return 0;
+		}
+
+	return 1;
+	}
+
+static int TS_compute_imprint(BIO *data, TS_TST_INFO *tst_info,
+			      X509_ALGOR **md_alg, 
+			      unsigned char **imprint, unsigned *imprint_len)
+	{
+	TS_MSG_IMPRINT *msg_imprint = TS_TST_INFO_get_msg_imprint(tst_info);
+	X509_ALGOR *md_alg_resp = TS_MSG_IMPRINT_get_algo(msg_imprint);
+	const EVP_MD *md;
+	EVP_MD_CTX md_ctx;
+	unsigned char buffer[4096];
+	int length;
+
+	*md_alg = NULL;
+	*imprint = NULL;
+
+	/* Return the MD algorithm of the response. */
+	if (!(*md_alg = X509_ALGOR_dup(md_alg_resp))) goto err;
+
+	/* Getting the MD object. */
+	if (!(md = EVP_get_digestbyobj((*md_alg)->algorithm)))
+		{
+		TSerr(TS_F_TS_COMPUTE_IMPRINT, TS_R_UNSUPPORTED_MD_ALGORITHM);
+		goto err;
+		}
+
+	/* Compute message digest. */
+	*imprint_len = EVP_MD_size(md);
+	if (!(*imprint = OPENSSL_malloc(*imprint_len))) 
+		{
+		TSerr(TS_F_TS_COMPUTE_IMPRINT, ERR_R_MALLOC_FAILURE);
+		goto err;
+		}
+
+	EVP_DigestInit(&md_ctx, md);
+	while ((length = BIO_read(data, buffer, sizeof(buffer))) > 0)
+		{
+		EVP_DigestUpdate(&md_ctx, buffer, length);
+		}
+	EVP_DigestFinal(&md_ctx, *imprint, NULL);
+
+	return 1;
+ err:
+	X509_ALGOR_free(*md_alg);
+	OPENSSL_free(*imprint);
+	*imprint_len = 0;
+	return 0;
+	}
+
+static int TS_check_imprints(X509_ALGOR *algor_a, 
+			     unsigned char *imprint_a, unsigned len_a,
+			     TS_TST_INFO *tst_info)
+	{
+	TS_MSG_IMPRINT *b = TS_TST_INFO_get_msg_imprint(tst_info);
+	X509_ALGOR *algor_b = TS_MSG_IMPRINT_get_algo(b);
+	int ret = 0;
+
+	/* algor_a is optional. */
+	if (algor_a)
+		{
+		/* Compare algorithm OIDs. */
+		if (OBJ_cmp(algor_a->algorithm, algor_b->algorithm)) goto err;
+
+		/* The parameter must be NULL in both. */
+		if ((algor_a->parameter 
+		     && ASN1_TYPE_get(algor_a->parameter) != V_ASN1_NULL)
+		    || (algor_b->parameter
+			&& ASN1_TYPE_get(algor_b->parameter) != V_ASN1_NULL))
+			goto err;
+		}
+
+	/* Compare octet strings. */
+	ret = len_a == (unsigned) ASN1_STRING_length(b->hashed_msg) &&
+		memcmp(imprint_a, ASN1_STRING_data(b->hashed_msg), len_a) == 0;
+ err:
+	if (!ret)
+		TSerr(TS_F_TS_CHECK_IMPRINTS, TS_R_MESSAGE_IMPRINT_MISMATCH);
+	return ret;
+	}
+
+static int TS_check_nonces(ASN1_INTEGER *a, TS_TST_INFO *tst_info)
+	{
+	ASN1_INTEGER *b = TS_TST_INFO_get_nonce(tst_info);
+
+	/* Error if nonce is missing. */
+	if (!b)
+		{
+		TSerr(TS_F_TS_CHECK_NONCES, TS_R_NONCE_NOT_RETURNED);
+		return 0;
+		}
+
+	/* No error if a nonce is returned without being requested. */
+	if (ASN1_INTEGER_cmp(a, b) != 0)
+		{
+		TSerr(TS_F_TS_CHECK_NONCES, TS_R_NONCE_MISMATCH);
+		return 0;
+		}
+
+	return 1;
+	}
+
+/* Check if the specified TSA name matches either the subject
+   or one of the subject alternative names of the TSA certificate. */
+static int TS_check_signer_name(GENERAL_NAME *tsa_name, X509 *signer)
+	{
+	STACK_OF(GENERAL_NAME) *gen_names = NULL;
+	int index = -1;
+	int found = 0;
+
+	/* Check the subject name first. */
+	if (tsa_name->type == GEN_DIRNAME 
+	    && X509_name_cmp(tsa_name->d.dirn, signer->cert_info->subject) == 0)
+		return 1;
+
+	/* Check all the alternative names. */
+	gen_names = X509_get_ext_d2i(signer, NID_subject_alt_name,
+				     NULL, &index);
+	while (gen_names != NULL
+	       && !(found = TS_find_name(gen_names, tsa_name) >= 0))
+		{
+		/* Get the next subject alternative name,
+		   although there should be no more than one. */
+		GENERAL_NAMES_free(gen_names);
+		gen_names = X509_get_ext_d2i(signer, NID_subject_alt_name,
+					     NULL, &index);
+		}
+	if (gen_names) GENERAL_NAMES_free(gen_names);
+	
+	return found;
+	}
+
+/* Returns 1 if name is in gen_names, 0 otherwise. */
+static int TS_find_name(STACK_OF(GENERAL_NAME) *gen_names, GENERAL_NAME *name)
+	{
+	int i, found;
+	for (i = 0, found = 0; !found && i < sk_GENERAL_NAME_num(gen_names);
+	     ++i)
+		{
+		GENERAL_NAME *current = sk_GENERAL_NAME_value(gen_names, i);
+		found = GENERAL_NAME_cmp(current, name) == 0;
+		}
+	return found ? i - 1 : -1;
+	}
Index: openssl/crypto/ts/ts_verify_ctx.c
diff -u /dev/null openssl/crypto/ts/ts_verify_ctx.c:1.1.8.1
--- /dev/null	Tue Nov  9 22:44:03 2004
+++ openssl/crypto/ts/ts_verify_ctx.c	Mon Nov  8 16:31:15 2004
@@ -0,0 +1,160 @@
+/* crypto/ts/ts_verify_ctx.c */
+/* Written by Zoltan Glozik (zglozik@stones.com) for the OpenSSL
+ * project 2003.
+ */
+/* ====================================================================
+ * Copyright (c) 2001 The OpenSSL Project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. All advertising materials mentioning features or use of this
+ *    software must display the following acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
+ *
+ * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
+ *    endorse or promote products derived from this software without
+ *    prior written permission. For written permission, please contact
+ *    licensing@OpenSSL.org.
+ *
+ * 5. Products derived from this software may not be called "OpenSSL"
+ *    nor may "OpenSSL" appear in their names without prior written
+ *    permission of the OpenSSL Project.
+ *
+ * 6. Redistributions of any form whatsoever must retain the following
+ *    acknowledgment:
+ *    "This product includes software developed by the OpenSSL Project
+ *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
+ * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
+ * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
+ * OF THE POSSIBILITY OF SUCH DAMAGE.
+ * ====================================================================
+ *
+ * This product includes cryptographic software written by Eric Young
+ * (eay@cryptsoft.com).  This product includes software written by Tim
+ * Hudson (tjh@cryptsoft.com).
+ *
+ */
+
+#include <assert.h>
+#include "cryptlib.h"
+#include <openssl/objects.h>
+#include <openssl/ts.h>
+
+TS_VERIFY_CTX *TS_VERIFY_CTX_new(void)
+	{
+	TS_VERIFY_CTX *ctx = 
+		(TS_VERIFY_CTX *) OPENSSL_malloc(sizeof(TS_VERIFY_CTX));
+	if (ctx)
+		memset(ctx, 0, sizeof(TS_VERIFY_CTX));
+	else
+		TSerr(TS_F_TS_VERIFY_CTX_NEW, ERR_R_MALLOC_FAILURE);
+	return ctx;
+	}
+
+void TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx)
+	{
+	assert(ctx != NULL);
+	memset(ctx, 0, sizeof(TS_VERIFY_CTX));
+	}
+
+void TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx)
+	{
+	if (!ctx) return;
+
+	TS_VERIFY_CTX_cleanup(ctx);
+	OPENSSL_free(ctx);
+	}
+
+void TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx)
+	{
+	if (!ctx) return;
+
+	X509_STORE_free(ctx->store);
+	sk_X509_pop_free(ctx->certs, X509_free);
+
+	ASN1_OBJECT_free(ctx->policy);
+
+	X509_ALGOR_free(ctx->md_alg);
+	OPENSSL_free(ctx->imprint);
+	
+	BIO_free_all(ctx->data);
+
+	ASN1_INTEGER_free(ctx->nonce);
+
+	GENERAL_NAME_free(ctx->tsa_name);
+
+	TS_VERIFY_CTX_init(ctx);
+	}
+
+TS_VERIFY_CTX *TS_REQ_to_TS_VERIFY_CTX(TS_REQ *req, TS_VERIFY_CTX *ctx)
+	{
+	TS_VERIFY_CTX *ret = ctx;
+	ASN1_OBJECT *policy;
+	TS_MSG_IMPRINT *imprint;
+	X509_ALGOR *md_alg;
+	ASN1_OCTET_STRING *msg;
+	ASN1_INTEGER *nonce;
+
+	assert(req != NULL);
+	if (ret)
+		TS_VERIFY_CTX_cleanup(ret);
+	else
+		if (!(ret = TS_VERIFY_CTX_new())) return NULL;
+
+	/* Setting flags. */
+	ret->flags = TS_VFY_ALL_IMPRINT & ~(TS_VFY_TSA_NAME | TS_VFY_SIGNATURE);
+
+	/* Setting policy. */
+	if ((policy = TS_REQ_get_policy_id(req)) != NULL)
+		{
+		if (!(ret->policy = OBJ_dup(policy))) goto err;
+		}
+	else
+		ret->flags &= ~TS_VFY_POLICY;
+
+	/* Setting md_alg, imprint and imprint_len. */
+	imprint = TS_REQ_get_msg_imprint(req);
+	md_alg = TS_MSG_IMPRINT_get_algo(imprint);
+	if (!(ret->md_alg = X509_ALGOR_dup(md_alg))) goto err;
+	msg = TS_MSG_IMPRINT_get_msg(imprint);
+	ret->imprint_len = ASN1_STRING_length(msg);
+	if (!(ret->imprint = OPENSSL_malloc(ret->imprint_len))) goto err;
+	memcpy(ret->imprint, ASN1_STRING_data(msg), ret->imprint_len);
+
+	/* Setting nonce. */
+	if ((nonce = TS_REQ_get_nonce(req)) != NULL)
+		{
+		if (!(ret->nonce = ASN1_INTEGER_dup(nonce))) goto err;
+		}
+	else
+		ret->flags &= ~TS_VFY_NONCE;
+
+	return ret;
+ err:
+	if (ctx)
+		TS_VERIFY_CTX_cleanup(ctx);
+	else
+		TS_VERIFY_CTX_free(ret);
+	return NULL;
+	}
Index: openssl/crypto/ui/ui.h
diff -u openssl/crypto/ui/ui.h:1.1.1.1 openssl/crypto/ui/ui.h:1.1.1.1.12.1
--- openssl/crypto/ui/ui.h:1.1.1.1	Fri Jan 17 22:08:06 2003
+++ openssl/crypto/ui/ui.h	Mon Nov  8 16:31:15 2004
@@ -359,26 +359,25 @@
 /* Error codes for the UI functions. */
 
 /* Function codes. */
-#define UI_F_GENERAL_ALLOCATE_BOOLEAN			 108
-#define UI_F_GENERAL_ALLOCATE_PROMPT			 109
-#define UI_F_GENERAL_ALLOCATE_STRING			 100
-#define UI_F_UI_CTRL					 111
-#define UI_F_UI_DUP_ERROR_STRING			 101
-#define UI_F_UI_DUP_INFO_STRING				 102
-#define UI_F_UI_DUP_INPUT_BOOLEAN			 110
-#define UI_F_UI_DUP_INPUT_STRING			 103
-#define UI_F_UI_DUP_VERIFY_STRING			 106
-#define UI_F_UI_GET0_RESULT				 107
-#define UI_F_UI_NEW_METHOD				 104
-#define UI_F_UI_SET_RESULT				 105
+#define UI_F_GENERAL_ALLOCATE_BOOLEAN			 100
+#define UI_F_GENERAL_ALLOCATE_PROMPT			 101
+#define UI_F_UI_CTRL					 102
+#define UI_F_UI_DUP_ERROR_STRING			 103
+#define UI_F_UI_DUP_INFO_STRING				 104
+#define UI_F_UI_DUP_INPUT_BOOLEAN			 105
+#define UI_F_UI_DUP_INPUT_STRING			 106
+#define UI_F_UI_DUP_VERIFY_STRING			 107
+#define UI_F_UI_GET0_RESULT				 108
+#define UI_F_UI_NEW_METHOD				 109
+#define UI_F_UI_SET_RESULT				 110
 
 /* Reason codes. */
-#define UI_R_COMMON_OK_AND_CANCEL_CHARACTERS		 104
-#define UI_R_INDEX_TOO_LARGE				 102
-#define UI_R_INDEX_TOO_SMALL				 103
-#define UI_R_NO_RESULT_BUFFER				 105
-#define UI_R_RESULT_TOO_LARGE				 100
-#define UI_R_RESULT_TOO_SMALL				 101
+#define UI_R_COMMON_OK_AND_CANCEL_CHARACTERS		 100
+#define UI_R_INDEX_TOO_LARGE				 101
+#define UI_R_INDEX_TOO_SMALL				 102
+#define UI_R_NO_RESULT_BUFFER				 103
+#define UI_R_RESULT_TOO_LARGE				 104
+#define UI_R_RESULT_TOO_SMALL				 105
 #define UI_R_UNKNOWN_CONTROL_COMMAND			 106
 
 #ifdef  __cplusplus
Index: openssl/crypto/ui/ui_err.c
diff -u openssl/crypto/ui/ui_err.c:1.1.1.1 openssl/crypto/ui/ui_err.c:1.1.1.1.12.1
--- openssl/crypto/ui/ui_err.c:1.1.1.1	Fri Jan 17 22:08:06 2003
+++ openssl/crypto/ui/ui_err.c	Mon Nov  8 16:31:15 2004
@@ -1,6 +1,6 @@
 /* crypto/ui/ui_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
@@ -68,7 +68,6 @@
 	{
 {ERR_PACK(0,UI_F_GENERAL_ALLOCATE_BOOLEAN,0),	"GENERAL_ALLOCATE_BOOLEAN"},
 {ERR_PACK(0,UI_F_GENERAL_ALLOCATE_PROMPT,0),	"GENERAL_ALLOCATE_PROMPT"},
-{ERR_PACK(0,UI_F_GENERAL_ALLOCATE_STRING,0),	"GENERAL_ALLOCATE_STRING"},
 {ERR_PACK(0,UI_F_UI_CTRL,0),	"UI_ctrl"},
 {ERR_PACK(0,UI_F_UI_DUP_ERROR_STRING,0),	"UI_dup_error_string"},
 {ERR_PACK(0,UI_F_UI_DUP_INFO_STRING,0),	"UI_dup_info_string"},
Index: openssl/crypto/x509/x509.h
diff -u openssl/crypto/x509/x509.h:1.1.1.4 openssl/crypto/x509/x509.h:1.1.1.4.2.1
--- openssl/crypto/x509/x509.h:1.1.1.4	Mon Nov  8 15:32:53 2004
+++ openssl/crypto/x509/x509.h	Mon Nov  8 16:31:15 2004
@@ -300,10 +300,11 @@
 #define X509_TRUST_OBJECT_SIGN	5
 #define X509_TRUST_OCSP_SIGN	6
 #define X509_TRUST_OCSP_REQUEST	7
+#define X509_TRUST_TSA		8
 
 /* Keep these up to date! */
 #define X509_TRUST_MIN		1
-#define X509_TRUST_MAX		7
+#define X509_TRUST_MAX		8
 
 
 /* trust_flags values */
@@ -1190,67 +1191,67 @@
 #define X509_F_BY_FILE_CTRL				 101
 #define X509_F_DIR_CTRL					 102
 #define X509_F_GET_CERT_BY_SUBJECT			 103
-#define X509_F_NETSCAPE_SPKI_B64_DECODE			 129
-#define X509_F_NETSCAPE_SPKI_B64_ENCODE			 130
-#define X509_F_X509V3_ADD_EXT				 104
-#define X509_F_X509_ADD_ATTR				 135
-#define X509_F_X509_ATTRIBUTE_CREATE_BY_NID		 136
-#define X509_F_X509_ATTRIBUTE_CREATE_BY_OBJ		 137
-#define X509_F_X509_ATTRIBUTE_CREATE_BY_TXT		 140
-#define X509_F_X509_ATTRIBUTE_GET0_DATA			 139
-#define X509_F_X509_ATTRIBUTE_SET1_DATA			 138
-#define X509_F_X509_CHECK_PRIVATE_KEY			 128
-#define X509_F_X509_EXTENSION_CREATE_BY_NID		 108
-#define X509_F_X509_EXTENSION_CREATE_BY_OBJ		 109
-#define X509_F_X509_GET_PUBKEY_PARAMETERS		 110
-#define X509_F_X509_LOAD_CERT_CRL_FILE			 132
-#define X509_F_X509_LOAD_CERT_FILE			 111
-#define X509_F_X509_LOAD_CRL_FILE			 112
-#define X509_F_X509_NAME_ADD_ENTRY			 113
-#define X509_F_X509_NAME_ENTRY_CREATE_BY_NID		 114
-#define X509_F_X509_NAME_ENTRY_CREATE_BY_TXT		 131
-#define X509_F_X509_NAME_ENTRY_SET_OBJECT		 115
-#define X509_F_X509_NAME_ONELINE			 116
-#define X509_F_X509_NAME_PRINT				 117
-#define X509_F_X509_PRINT_FP				 118
-#define X509_F_X509_PUBKEY_GET				 119
-#define X509_F_X509_PUBKEY_SET				 120
-#define X509_F_X509_REQ_PRINT				 121
-#define X509_F_X509_REQ_PRINT_FP			 122
-#define X509_F_X509_REQ_TO_X509				 123
-#define X509_F_X509_STORE_ADD_CERT			 124
-#define X509_F_X509_STORE_ADD_CRL			 125
-#define X509_F_X509_STORE_CTX_INIT			 143
-#define X509_F_X509_STORE_CTX_NEW			 142
-#define X509_F_X509_STORE_CTX_PURPOSE_INHERIT		 134
-#define X509_F_X509_TO_X509_REQ				 126
-#define X509_F_X509_TRUST_ADD				 133
-#define X509_F_X509_TRUST_SET				 141
-#define X509_F_X509_VERIFY_CERT				 127
+#define X509_F_NETSCAPE_SPKI_B64_DECODE			 104
+#define X509_F_NETSCAPE_SPKI_B64_ENCODE			 105
+#define X509_F_X509V3_ADD_EXT				 106
+#define X509_F_X509_ADD_ATTR				 107
+#define X509_F_X509_ATTRIBUTE_CREATE_BY_NID		 108
+#define X509_F_X509_ATTRIBUTE_CREATE_BY_OBJ		 109
+#define X509_F_X509_ATTRIBUTE_CREATE_BY_TXT		 110
+#define X509_F_X509_ATTRIBUTE_GET0_DATA			 111
+#define X509_F_X509_ATTRIBUTE_SET1_DATA			 112
+#define X509_F_X509_CHECK_PRIVATE_KEY			 113
+#define X509_F_X509_EXTENSION_CREATE_BY_NID		 114
+#define X509_F_X509_EXTENSION_CREATE_BY_OBJ		 115
+#define X509_F_X509_GET_PUBKEY_PARAMETERS		 116
+#define X509_F_X509_LOAD_CERT_CRL_FILE			 117
+#define X509_F_X509_LOAD_CERT_FILE			 118
+#define X509_F_X509_LOAD_CRL_FILE			 119
+#define X509_F_X509_NAME_ADD_ENTRY			 120
+#define X509_F_X509_NAME_ENTRY_CREATE_BY_NID		 121
+#define X509_F_X509_NAME_ENTRY_CREATE_BY_TXT		 122
+#define X509_F_X509_NAME_ENTRY_SET_OBJECT		 123
+#define X509_F_X509_NAME_ONELINE			 124
+#define X509_F_X509_NAME_PRINT				 125
+#define X509_F_X509_PRINT_FP				 126
+#define X509_F_X509_PUBKEY_GET				 127
+#define X509_F_X509_PUBKEY_SET				 128
+#define X509_F_X509_REQ_PRINT				 129
+#define X509_F_X509_REQ_PRINT_FP			 130
+#define X509_F_X509_REQ_TO_X509				 131
+#define X509_F_X509_STORE_ADD_CERT			 132
+#define X509_F_X509_STORE_ADD_CRL			 133
+#define X509_F_X509_STORE_CTX_INIT			 134
+#define X509_F_X509_STORE_CTX_NEW			 135
+#define X509_F_X509_STORE_CTX_PURPOSE_INHERIT		 136
+#define X509_F_X509_TO_X509_REQ				 137
+#define X509_F_X509_TRUST_ADD				 138
+#define X509_F_X509_TRUST_SET				 139
+#define X509_F_X509_VERIFY_CERT				 140
 
 /* Reason codes. */
 #define X509_R_BAD_X509_FILETYPE			 100
-#define X509_R_BASE64_DECODE_ERROR			 118
-#define X509_R_CANT_CHECK_DH_KEY			 114
-#define X509_R_CERT_ALREADY_IN_HASH_TABLE		 101
-#define X509_R_ERR_ASN1_LIB				 102
-#define X509_R_INVALID_DIRECTORY			 113
-#define X509_R_INVALID_FIELD_NAME			 119
-#define X509_R_INVALID_TRUST				 123
-#define X509_R_KEY_TYPE_MISMATCH			 115
-#define X509_R_KEY_VALUES_MISMATCH			 116
-#define X509_R_LOADING_CERT_DIR				 103
-#define X509_R_LOADING_DEFAULTS				 104
-#define X509_R_NO_CERT_SET_FOR_US_TO_VERIFY		 105
-#define X509_R_SHOULD_RETRY				 106
-#define X509_R_UNABLE_TO_FIND_PARAMETERS_IN_CHAIN	 107
-#define X509_R_UNABLE_TO_GET_CERTS_PUBLIC_KEY		 108
-#define X509_R_UNKNOWN_KEY_TYPE				 117
-#define X509_R_UNKNOWN_NID				 109
-#define X509_R_UNKNOWN_PURPOSE_ID			 121
-#define X509_R_UNKNOWN_TRUST_ID				 120
-#define X509_R_UNSUPPORTED_ALGORITHM			 111
-#define X509_R_WRONG_LOOKUP_TYPE			 112
+#define X509_R_BASE64_DECODE_ERROR			 101
+#define X509_R_CANT_CHECK_DH_KEY			 102
+#define X509_R_CERT_ALREADY_IN_HASH_TABLE		 103
+#define X509_R_ERR_ASN1_LIB				 104
+#define X509_R_INVALID_DIRECTORY			 105
+#define X509_R_INVALID_FIELD_NAME			 106
+#define X509_R_INVALID_TRUST				 107
+#define X509_R_KEY_TYPE_MISMATCH			 108
+#define X509_R_KEY_VALUES_MISMATCH			 109
+#define X509_R_LOADING_CERT_DIR				 110
+#define X509_R_LOADING_DEFAULTS				 111
+#define X509_R_NO_CERT_SET_FOR_US_TO_VERIFY		 112
+#define X509_R_SHOULD_RETRY				 113
+#define X509_R_UNABLE_TO_FIND_PARAMETERS_IN_CHAIN	 114
+#define X509_R_UNABLE_TO_GET_CERTS_PUBLIC_KEY		 115
+#define X509_R_UNKNOWN_KEY_TYPE				 116
+#define X509_R_UNKNOWN_NID				 117
+#define X509_R_UNKNOWN_PURPOSE_ID			 118
+#define X509_R_UNKNOWN_TRUST_ID				 119
+#define X509_R_UNSUPPORTED_ALGORITHM			 120
+#define X509_R_WRONG_LOOKUP_TYPE			 121
 #define X509_R_WRONG_TYPE				 122
 
 #ifdef  __cplusplus
Index: openssl/crypto/x509/x509_err.c
diff -u openssl/crypto/x509/x509_err.c:1.1.1.2 openssl/crypto/x509/x509_err.c:1.1.1.2.12.1
--- openssl/crypto/x509/x509_err.c:1.1.1.2	Fri Jan 17 22:08:08 2003
+++ openssl/crypto/x509/x509_err.c	Mon Nov  8 16:31:15 2004
@@ -1,6 +1,6 @@
 /* crypto/x509/x509_err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
Index: openssl/crypto/x509/x509_trs.c
diff -u openssl/crypto/x509/x509_trs.c:1.1.1.3 openssl/crypto/x509/x509_trs.c:1.1.1.3.6.1
--- openssl/crypto/x509/x509_trs.c:1.1.1.3	Wed Oct  8 11:36:03 2003
+++ openssl/crypto/x509/x509_trs.c	Mon Nov  8 16:31:15 2004
@@ -84,7 +84,8 @@
 {X509_TRUST_EMAIL, 0, trust_1oidany, "S/MIME email", NID_email_protect, NULL},
 {X509_TRUST_OBJECT_SIGN, 0, trust_1oidany, "Object Signer", NID_code_sign, NULL},
 {X509_TRUST_OCSP_SIGN, 0, trust_1oid, "OCSP responder", NID_OCSP_sign, NULL},
-{X509_TRUST_OCSP_REQUEST, 0, trust_1oid, "OCSP request", NID_ad_OCSP, NULL}
+{X509_TRUST_OCSP_REQUEST, 0, trust_1oid, "OCSP request", NID_ad_OCSP, NULL},
+{X509_TRUST_TSA, 0, trust_1oidany, "TSA server", NID_time_stamp, NULL}
 };
 
 #define X509_TRUST_COUNT	(sizeof(trstandard)/sizeof(X509_TRUST))
Index: openssl/crypto/x509v3/v3_genn.c
diff -u openssl/crypto/x509v3/v3_genn.c:1.1.1.2 openssl/crypto/x509v3/v3_genn.c:1.1.1.2.12.1
--- openssl/crypto/x509v3/v3_genn.c:1.1.1.2	Fri Jan 17 22:08:09 2003
+++ openssl/crypto/x509v3/v3_genn.c	Mon Nov  8 16:31:15 2004
@@ -99,3 +99,62 @@
 ASN1_ITEM_TEMPLATE_END(GENERAL_NAMES)
 
 IMPLEMENT_ASN1_FUNCTIONS(GENERAL_NAMES)
+
+GENERAL_NAME *GENERAL_NAME_dup(GENERAL_NAME *a)
+	{
+	return (GENERAL_NAME *) ASN1_dup((int (*)()) i2d_GENERAL_NAME,
+					 (char *(*)()) d2i_GENERAL_NAME,
+					 (char *) a);
+	}
+
+/* Returns 0 if they are equal, != 0 otherwise. */
+int GENERAL_NAME_cmp(GENERAL_NAME *a, GENERAL_NAME *b)
+	{
+	int result = -1;
+
+	if (!a || !b || a->type != b->type) return -1;
+	switch(a->type)
+		{
+	case GEN_X400:
+	case GEN_EDIPARTY:
+		result = ASN1_TYPE_cmp(a->d.other, b->d.other);
+		break;
+
+	case GEN_OTHERNAME:
+		result = OTHERNAME_cmp(a->d.otherName, b->d.otherName);
+		break;
+
+	case GEN_EMAIL:
+	case GEN_DNS:
+	case GEN_URI:
+		result = ASN1_STRING_cmp(a->d.ia5, b->d.ia5);
+		break;
+
+	case GEN_DIRNAME:
+		result = X509_NAME_cmp(a->d.dirn, b->d.dirn);
+		break;
+
+	case GEN_IPADD:
+		result = ASN1_OCTET_STRING_cmp(a->d.ip, b->d.ip);
+		break;
+	
+	case GEN_RID:
+		result = OBJ_cmp(a->d.rid, b->d.rid);
+		break;
+		}
+	return result;
+	}
+
+/* Returns 0 if they are equal, != 0 otherwise. */
+int OTHERNAME_cmp(OTHERNAME *a, OTHERNAME *b)
+	{
+	int result = -1;
+
+	if (!a || !b) return -1;
+	/* Check their type first. */
+	if ((result = OBJ_cmp(a->type_id, b->type_id)) != 0)
+		return result;
+	/* Check the value. */
+	result = ASN1_TYPE_cmp(a->value, b->value);
+	return result;
+	}
Index: openssl/crypto/x509v3/v3_purp.c
diff -u openssl/crypto/x509v3/v3_purp.c:1.1.1.4 openssl/crypto/x509v3/v3_purp.c:1.1.1.4.4.1
--- openssl/crypto/x509v3/v3_purp.c:1.1.1.4	Sat Mar 20 17:03:54 2004
+++ openssl/crypto/x509v3/v3_purp.c	Mon Nov  8 16:31:15 2004
@@ -72,6 +72,7 @@
 static int check_purpose_smime_sign(const X509_PURPOSE *xp, const X509 *x, int ca);
 static int check_purpose_smime_encrypt(const X509_PURPOSE *xp, const X509 *x, int ca);
 static int check_purpose_crl_sign(const X509_PURPOSE *xp, const X509 *x, int ca);
+static int check_purpose_timestamp_sign(const X509_PURPOSE *xp, const X509 *x, int ca);
 static int no_check(const X509_PURPOSE *xp, const X509 *x, int ca);
 static int ocsp_helper(const X509_PURPOSE *xp, const X509 *x, int ca);
 
@@ -88,6 +89,7 @@
 	{X509_PURPOSE_CRL_SIGN, X509_TRUST_COMPAT, 0, check_purpose_crl_sign, "CRL signing", "crlsign", NULL},
 	{X509_PURPOSE_ANY, X509_TRUST_DEFAULT, 0, no_check, "Any Purpose", "any", NULL},
 	{X509_PURPOSE_OCSP_HELPER, X509_TRUST_COMPAT, 0, ocsp_helper, "OCSP helper", "ocsphelper", NULL},
+	{X509_PURPOSE_TIMESTAMP_SIGN, X509_TRUST_TSA, 0, check_purpose_timestamp_sign, "Time Stamp signing", "timestampsign", NULL},
 };
 
 #define X509_PURPOSE_COUNT (sizeof(xstandard)/sizeof(X509_PURPOSE))
@@ -564,6 +566,42 @@
 		return 0;
 	}
 	/* leaf certificate is checked in OCSP_verify() */
+	return 1;
+}
+
+static int check_purpose_timestamp_sign(const X509_PURPOSE *xp, const X509 *x,
+					int ca)
+{
+	int i_ext;
+
+	/* If ca is true we must return if this is a valid CA certificate. */
+	if (ca)
+		return ca_check(x) == 1;
+
+	/* 
+	 * Check the optional key usage field:
+	 * if Key Usage is present, it must be one of digitalSignature 
+	 * and/or nonRepudiation (other values are not consistent and shall
+	 * be rejected).
+	 */
+	if ((x->ex_flags & EXFLAG_KUSAGE)
+	    && ((x->ex_kusage & ~(KU_NON_REPUDIATION | KU_DIGITAL_SIGNATURE)) ||
+		!(x->ex_kusage & (KU_NON_REPUDIATION | KU_DIGITAL_SIGNATURE))))
+		return 0;
+
+	/* Only time stamp key usage is permitted and it's required. */
+	if (!(x->ex_flags & EXFLAG_XKUSAGE) || x->ex_xkusage != XKU_TIMESTAMP)
+		return 0;
+
+	/* Extended Key Usage MUST be critical */
+	i_ext = X509_get_ext_by_NID((X509 *) x, NID_ext_key_usage, 0);
+	if (i_ext >= 0)
+		{
+		X509_EXTENSION *ext = X509_get_ext((X509 *) x, i_ext);
+		if (!X509_EXTENSION_get_critical(ext))
+			return 0;
+		}
+
 	return 1;
 }
 
Index: openssl/crypto/x509v3/v3_utl.c
diff -u openssl/crypto/x509v3/v3_utl.c:1.1.1.2 openssl/crypto/x509v3/v3_utl.c:1.1.1.2.12.1
--- openssl/crypto/x509v3/v3_utl.c:1.1.1.2	Fri Jan 17 22:08:09 2003
+++ openssl/crypto/x509v3/v3_utl.c	Mon Nov  8 16:31:16 2004
@@ -100,6 +100,19 @@
     return X509V3_add_value(name,(const char *)value,extlist);
     }
 
+/* New function for CONF_VALUE. */
+
+CONF_VALUE *X509V3_conf_new()
+	{
+	CONF_VALUE *v = (CONF_VALUE *) OPENSSL_malloc(sizeof(CONF_VALUE));
+	if (!v)
+		{
+		v->section = v->name = v->value = NULL;
+		}
+
+	return v;
+	}
+
 /* Free function for STACK_OF(CONF_VALUE) */
 
 void X509V3_conf_free(CONF_VALUE *conf)
Index: openssl/crypto/x509v3/v3err.c
diff -u openssl/crypto/x509v3/v3err.c:1.1.1.2 openssl/crypto/x509v3/v3err.c:1.1.1.2.12.1
--- openssl/crypto/x509v3/v3err.c:1.1.1.2	Fri Jan 17 22:08:09 2003
+++ openssl/crypto/x509v3/v3err.c	Mon Nov  8 16:31:16 2004
@@ -1,6 +1,6 @@
 /* crypto/x509v3/v3err.c */
 /* ====================================================================
- * Copyright (c) 1999 The OpenSSL Project.  All rights reserved.
+ * Copyright (c) 1999-2003 The OpenSSL Project.  All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
Index: openssl/crypto/x509v3/x509v3.h
diff -u openssl/crypto/x509v3/x509v3.h:1.1.1.3 openssl/crypto/x509v3/x509v3.h:1.1.1.3.10.1
--- openssl/crypto/x509v3/x509v3.h:1.1.1.3	Sat Feb 22 13:28:14 2003
+++ openssl/crypto/x509v3/x509v3.h	Mon Nov  8 16:31:16 2004
@@ -376,9 +376,10 @@
 #define X509_PURPOSE_CRL_SIGN		6
 #define X509_PURPOSE_ANY		7
 #define X509_PURPOSE_OCSP_HELPER	8
+#define X509_PURPOSE_TIMESTAMP_SIGN	9
 
 #define X509_PURPOSE_MIN		1
-#define X509_PURPOSE_MAX		8
+#define X509_PURPOSE_MAX		9
 
 /* Flags for X509V3_EXT_print() */
 
@@ -423,7 +424,10 @@
 DECLARE_ASN1_FUNCTIONS(PKEY_USAGE_PERIOD)
 
 DECLARE_ASN1_FUNCTIONS(GENERAL_NAME)
+GENERAL_NAME *GENERAL_NAME_dup(GENERAL_NAME *a);
+int GENERAL_NAME_cmp(GENERAL_NAME *a, GENERAL_NAME *b);
 
+
 STACK_OF(CONF_VALUE) *i2v_GENERAL_NAME(X509V3_EXT_METHOD *method, GENERAL_NAME *gen, STACK_OF(CONF_VALUE) *ret);
 int GENERAL_NAME_print(BIO *out, GENERAL_NAME *gen);
 
@@ -436,6 +440,7 @@
 
 DECLARE_ASN1_FUNCTIONS(OTHERNAME)
 DECLARE_ASN1_FUNCTIONS(EDIPARTYNAME)
+int OTHERNAME_cmp(OTHERNAME *a, OTHERNAME *b);
 
 char *i2s_ASN1_OCTET_STRING(X509V3_EXT_METHOD *method, ASN1_OCTET_STRING *ia5);
 ASN1_OCTET_STRING *s2i_ASN1_OCTET_STRING(X509V3_EXT_METHOD *method, X509V3_CTX *ctx, char *str);
@@ -458,6 +463,7 @@
 
 #ifdef HEADER_CONF_H
 GENERAL_NAME *v2i_GENERAL_NAME(X509V3_EXT_METHOD *method, X509V3_CTX *ctx, CONF_VALUE *cnf);
+CONF_VALUE *X509V3_conf_new();
 void X509V3_conf_free(CONF_VALUE *val);
 
 X509_EXTENSION *X509V3_EXT_nconf_nid(CONF *conf, X509V3_CTX *ctx, int ext_nid, char *value);
@@ -558,97 +564,97 @@
 /* Error codes for the X509V3 functions. */
 
 /* Function codes. */
-#define X509V3_F_COPY_EMAIL				 122
-#define X509V3_F_COPY_ISSUER				 123
-#define X509V3_F_DO_EXT_CONF				 124
-#define X509V3_F_DO_EXT_I2D				 135
-#define X509V3_F_HEX_TO_STRING				 111
-#define X509V3_F_I2S_ASN1_ENUMERATED			 121
-#define X509V3_F_I2S_ASN1_INTEGER			 120
-#define X509V3_F_I2V_AUTHORITY_INFO_ACCESS		 138
-#define X509V3_F_NOTICE_SECTION				 132
-#define X509V3_F_NREF_NOS				 133
-#define X509V3_F_POLICY_SECTION				 131
-#define X509V3_F_R2I_CERTPOL				 130
-#define X509V3_F_S2I_ASN1_IA5STRING			 100
-#define X509V3_F_S2I_ASN1_INTEGER			 108
-#define X509V3_F_S2I_ASN1_OCTET_STRING			 112
-#define X509V3_F_S2I_ASN1_SKEY_ID			 114
-#define X509V3_F_S2I_S2I_SKEY_ID			 115
-#define X509V3_F_STRING_TO_HEX				 113
-#define X509V3_F_SXNET_ADD_ASC				 125
-#define X509V3_F_SXNET_ADD_ID_INTEGER			 126
-#define X509V3_F_SXNET_ADD_ID_ULONG			 127
-#define X509V3_F_SXNET_GET_ID_ASC			 128
-#define X509V3_F_SXNET_GET_ID_ULONG			 129
-#define X509V3_F_V2I_ACCESS_DESCRIPTION			 139
-#define X509V3_F_V2I_ASN1_BIT_STRING			 101
-#define X509V3_F_V2I_AUTHORITY_KEYID			 119
-#define X509V3_F_V2I_BASIC_CONSTRAINTS			 102
-#define X509V3_F_V2I_CRLD				 134
-#define X509V3_F_V2I_EXT_KU				 103
-#define X509V3_F_V2I_GENERAL_NAME			 117
-#define X509V3_F_V2I_GENERAL_NAMES			 118
-#define X509V3_F_V3_GENERIC_EXTENSION			 116
-#define X509V3_F_X509V3_ADD_I2D				 140
-#define X509V3_F_X509V3_ADD_VALUE			 105
-#define X509V3_F_X509V3_EXT_ADD				 104
-#define X509V3_F_X509V3_EXT_ADD_ALIAS			 106
-#define X509V3_F_X509V3_EXT_CONF			 107
-#define X509V3_F_X509V3_EXT_I2D				 136
-#define X509V3_F_X509V3_GET_VALUE_BOOL			 110
-#define X509V3_F_X509V3_PARSE_LIST			 109
-#define X509V3_F_X509_PURPOSE_ADD			 137
+#define X509V3_F_COPY_EMAIL				 100
+#define X509V3_F_COPY_ISSUER				 101
+#define X509V3_F_DO_EXT_CONF				 102
+#define X509V3_F_DO_EXT_I2D				 103
+#define X509V3_F_HEX_TO_STRING				 104
+#define X509V3_F_I2S_ASN1_ENUMERATED			 105
+#define X509V3_F_I2S_ASN1_INTEGER			 106
+#define X509V3_F_I2V_AUTHORITY_INFO_ACCESS		 107
+#define X509V3_F_NOTICE_SECTION				 108
+#define X509V3_F_NREF_NOS				 109
+#define X509V3_F_POLICY_SECTION				 110
+#define X509V3_F_R2I_CERTPOL				 111
+#define X509V3_F_S2I_ASN1_IA5STRING			 112
+#define X509V3_F_S2I_ASN1_INTEGER			 113
+#define X509V3_F_S2I_ASN1_OCTET_STRING			 114
+#define X509V3_F_S2I_ASN1_SKEY_ID			 115
+#define X509V3_F_S2I_S2I_SKEY_ID			 116
+#define X509V3_F_STRING_TO_HEX				 117
+#define X509V3_F_SXNET_ADD_ASC				 118
+#define X509V3_F_SXNET_ADD_ID_INTEGER			 119
+#define X509V3_F_SXNET_ADD_ID_ULONG			 120
+#define X509V3_F_SXNET_GET_ID_ASC			 121
+#define X509V3_F_SXNET_GET_ID_ULONG			 122
+#define X509V3_F_V2I_ACCESS_DESCRIPTION			 123
+#define X509V3_F_V2I_ASN1_BIT_STRING			 124
+#define X509V3_F_V2I_AUTHORITY_KEYID			 125
+#define X509V3_F_V2I_BASIC_CONSTRAINTS			 126
+#define X509V3_F_V2I_CRLD				 127
+#define X509V3_F_V2I_EXT_KU				 128
+#define X509V3_F_V2I_GENERAL_NAME			 129
+#define X509V3_F_V2I_GENERAL_NAMES			 130
+#define X509V3_F_V3_GENERIC_EXTENSION			 131
+#define X509V3_F_X509V3_ADD_I2D				 132
+#define X509V3_F_X509V3_ADD_VALUE			 133
+#define X509V3_F_X509V3_EXT_ADD				 134
+#define X509V3_F_X509V3_EXT_ADD_ALIAS			 135
+#define X509V3_F_X509V3_EXT_CONF			 136
+#define X509V3_F_X509V3_EXT_I2D				 137
+#define X509V3_F_X509V3_GET_VALUE_BOOL			 138
+#define X509V3_F_X509V3_PARSE_LIST			 139
+#define X509V3_F_X509_PURPOSE_ADD			 140
 #define X509V3_F_X509_PURPOSE_SET			 141
 
 /* Reason codes. */
-#define X509V3_R_BAD_IP_ADDRESS				 118
-#define X509V3_R_BAD_OBJECT				 119
-#define X509V3_R_BN_DEC2BN_ERROR			 100
-#define X509V3_R_BN_TO_ASN1_INTEGER_ERROR		 101
-#define X509V3_R_DUPLICATE_ZONE_ID			 133
-#define X509V3_R_ERROR_CONVERTING_ZONE			 131
-#define X509V3_R_ERROR_CREATING_EXTENSION		 144
-#define X509V3_R_ERROR_IN_EXTENSION			 128
-#define X509V3_R_EXPECTED_A_SECTION_NAME		 137
-#define X509V3_R_EXTENSION_EXISTS			 145
-#define X509V3_R_EXTENSION_NAME_ERROR			 115
-#define X509V3_R_EXTENSION_NOT_FOUND			 102
-#define X509V3_R_EXTENSION_SETTING_NOT_SUPPORTED	 103
-#define X509V3_R_EXTENSION_VALUE_ERROR			 116
-#define X509V3_R_ILLEGAL_HEX_DIGIT			 113
-#define X509V3_R_INVALID_BOOLEAN_STRING			 104
-#define X509V3_R_INVALID_EXTENSION_STRING		 105
-#define X509V3_R_INVALID_NAME				 106
-#define X509V3_R_INVALID_NULL_ARGUMENT			 107
-#define X509V3_R_INVALID_NULL_NAME			 108
-#define X509V3_R_INVALID_NULL_VALUE			 109
-#define X509V3_R_INVALID_NUMBER				 140
-#define X509V3_R_INVALID_NUMBERS			 141
-#define X509V3_R_INVALID_OBJECT_IDENTIFIER		 110
-#define X509V3_R_INVALID_OPTION				 138
-#define X509V3_R_INVALID_POLICY_IDENTIFIER		 134
-#define X509V3_R_INVALID_PURPOSE			 146
-#define X509V3_R_INVALID_SECTION			 135
-#define X509V3_R_INVALID_SYNTAX				 143
-#define X509V3_R_ISSUER_DECODE_ERROR			 126
-#define X509V3_R_MISSING_VALUE				 124
-#define X509V3_R_NEED_ORGANIZATION_AND_NUMBERS		 142
-#define X509V3_R_NO_CONFIG_DATABASE			 136
-#define X509V3_R_NO_ISSUER_CERTIFICATE			 121
-#define X509V3_R_NO_ISSUER_DETAILS			 127
-#define X509V3_R_NO_POLICY_IDENTIFIER			 139
-#define X509V3_R_NO_PUBLIC_KEY				 114
-#define X509V3_R_NO_SUBJECT_DETAILS			 125
-#define X509V3_R_ODD_NUMBER_OF_DIGITS			 112
-#define X509V3_R_UNABLE_TO_GET_ISSUER_DETAILS		 122
-#define X509V3_R_UNABLE_TO_GET_ISSUER_KEYID		 123
-#define X509V3_R_UNKNOWN_BIT_STRING_ARGUMENT		 111
-#define X509V3_R_UNKNOWN_EXTENSION			 129
-#define X509V3_R_UNKNOWN_EXTENSION_NAME			 130
-#define X509V3_R_UNKNOWN_OPTION				 120
-#define X509V3_R_UNSUPPORTED_OPTION			 117
-#define X509V3_R_USER_TOO_LONG				 132
+#define X509V3_R_BAD_IP_ADDRESS				 100
+#define X509V3_R_BAD_OBJECT				 101
+#define X509V3_R_BN_DEC2BN_ERROR			 102
+#define X509V3_R_BN_TO_ASN1_INTEGER_ERROR		 103
+#define X509V3_R_DUPLICATE_ZONE_ID			 104
+#define X509V3_R_ERROR_CONVERTING_ZONE			 105
+#define X509V3_R_ERROR_CREATING_EXTENSION		 106
+#define X509V3_R_ERROR_IN_EXTENSION			 107
+#define X509V3_R_EXPECTED_A_SECTION_NAME		 108
+#define X509V3_R_EXTENSION_EXISTS			 109
+#define X509V3_R_EXTENSION_NAME_ERROR			 110
+#define X509V3_R_EXTENSION_NOT_FOUND			 111
+#define X509V3_R_EXTENSION_SETTING_NOT_SUPPORTED	 112
+#define X509V3_R_EXTENSION_VALUE_ERROR			 113
+#define X509V3_R_ILLEGAL_HEX_DIGIT			 114
+#define X509V3_R_INVALID_BOOLEAN_STRING			 115
+#define X509V3_R_INVALID_EXTENSION_STRING		 116
+#define X509V3_R_INVALID_NAME				 117
+#define X509V3_R_INVALID_NULL_ARGUMENT			 118
+#define X509V3_R_INVALID_NULL_NAME			 119
+#define X509V3_R_INVALID_NULL_VALUE			 120
+#define X509V3_R_INVALID_NUMBER				 121
+#define X509V3_R_INVALID_NUMBERS			 122
+#define X509V3_R_INVALID_OBJECT_IDENTIFIER		 123
+#define X509V3_R_INVALID_OPTION				 124
+#define X509V3_R_INVALID_POLICY_IDENTIFIER		 125
+#define X509V3_R_INVALID_PURPOSE			 126
+#define X509V3_R_INVALID_SECTION			 127
+#define X509V3_R_INVALID_SYNTAX				 128
+#define X509V3_R_ISSUER_DECODE_ERROR			 129
+#define X509V3_R_MISSING_VALUE				 130
+#define X509V3_R_NEED_ORGANIZATION_AND_NUMBERS		 131
+#define X509V3_R_NO_CONFIG_DATABASE			 132
+#define X509V3_R_NO_ISSUER_CERTIFICATE			 133
+#define X509V3_R_NO_ISSUER_DETAILS			 134
+#define X509V3_R_NO_POLICY_IDENTIFIER			 135
+#define X509V3_R_NO_PUBLIC_KEY				 136
+#define X509V3_R_NO_SUBJECT_DETAILS			 137
+#define X509V3_R_ODD_NUMBER_OF_DIGITS			 138
+#define X509V3_R_UNABLE_TO_GET_ISSUER_DETAILS		 139
+#define X509V3_R_UNABLE_TO_GET_ISSUER_KEYID		 140
+#define X509V3_R_UNKNOWN_BIT_STRING_ARGUMENT		 141
+#define X509V3_R_UNKNOWN_EXTENSION			 142
+#define X509V3_R_UNKNOWN_EXTENSION_NAME			 143
+#define X509V3_R_UNKNOWN_OPTION				 144
+#define X509V3_R_UNSUPPORTED_OPTION			 145
+#define X509V3_R_USER_TOO_LONG				 146
 
 #ifdef  __cplusplus
 }
Index: openssl/doc/standards.txt
diff -u openssl/doc/standards.txt:1.1.1.3 openssl/doc/standards.txt:1.1.1.3.10.1
--- openssl/doc/standards.txt:1.1.1.3	Sat Feb 22 13:28:16 2003
+++ openssl/doc/standards.txt	Mon Nov  8 16:31:16 2004
@@ -69,6 +69,10 @@
 3174 US Secure Hash Algorithm 1 (SHA1). D. Eastlake 3rd, P. Jones.
      September 2001. (Format: TXT=35525 bytes) (Status: INFORMATIONAL)
 
+3161 Internet X.509 Public Key Infrastructure, Time-Stamp Protocol (TSP)
+     C. Adams, P. Cain, D. Pinkas, R. Zuccherato. August 2001
+     (Status: PROPOSED STANDARD)
+
 3268 Advanced Encryption Standard (AES) Ciphersuites for Transport
      Layer Security (TLS). P. Chown. June 2002. (Format: TXT=13530 bytes)
      (Status: PROPOSED STANDARD)
Index: openssl/doc/apps/ts.pod
diff -u /dev/null openssl/doc/apps/ts.pod:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:07 2004
+++ openssl/doc/apps/ts.pod	Mon Nov  8 16:31:16 2004
@@ -0,0 +1,609 @@
+=pod
+
+=head1 NAME
+
+ts - Time Stamping Authority tool (client/server)
+
+=head1 SYNOPSIS
+
+B<openssl> B<ts>
+B<-query>
+[B<-rand> file:file...]
+[B<-config> configfile]
+[B<-data> file_to_hash]
+[B<-digest> digest_bytes]
+[B<-md2>|B<-md4>|B<-md5>|B<-sha>|B<-sha1>|B<-mdc2>|B<-ripemd160>]
+[B<-policy> object_id]
+[B<-no_nonce>]
+[B<-cert>]
+[B<-in> request.tsq]
+[B<-out> request.tsq]
+[B<-text>]
+
+B<openssl> B<ts>
+B<-reply>
+[B<-config> configfile]
+[B<-section> tsa_section]
+[B<-queryfile> request.tsq]
+[B<-passin> password_src]
+[B<-signer> tsa_cert.pem]
+[B<-inkey> private.pem]
+[B<-chain> certs_file.pem]
+[B<-policy> object_id]
+[B<-in> response.tsr]
+[B<-token_in>]
+[B<-out> response.tsr]
+[B<-token_out>]
+[B<-text>]
+[B<-engine> id]
+
+B<openssl> B<ts>
+B<-verify>
+[B<-data> file_to_hash]
+[B<-digest> digest_bytes]
+[B<-queryfile> request.tsq]
+[B<-in> response.tsr]
+[B<-token_in>]
+[B<-CApath> trusted_cert_path]
+[B<-CAfile> trusted_certs.pem]
+[B<-untrusted> cert_file.pem]
+
+=head1 DESCRIPTION
+
+The B<ts> command is a basic Time Stamping Authority (TSA) client and server
+application as specified in RFC 3161 (Time-Stamp Protocol, TSP). A
+TSA can be part of a PKI deployment and its role is to provide long
+term proof of the existence of a certain datum before a particular
+time. Here is a brief description of the protocol:
+
+=over 4
+
+=item 1.
+
+The TSA client computes a one-way hash value for a data file and sends
+the hash to the TSA.
+
+=item 2.
+
+The TSA attaches the current date and time to the received hash value,
+signs them and sends the time stamp token back to the client. By
+creating this token the TSA certifies the existence of the original
+data file at the time of response generation.
+
+=item 3.
+
+The TSA client receives the time stamp token and verifies the
+signature on it. It also checks if the token contains the same hash
+value that it had sent to the TSA.
+
+=back
+
+There is one DER encoded protocol data unit defined for transporting a time
+stamp request to the TSA and one for sending the time stamp response
+back to the client. The B<ts> command has three main functions:
+creating a time stamp request based on a data file,
+creating a time stamp response based on a request, verifying if a
+response corresponds to a particular request or a data file.
+
+There is no support for sending the requests/responses automatically
+over HTTP or TCP yet as suggested in RFC 3161. The users must send the
+requests either by ftp or e-mail.
+
+=head1 OPTIONS
+
+=head2 Time Stamp Request generation
+
+The B<-query> switch can be used for creating and printing a time stamp
+request with the following options:
+
+=over 4
+
+=item B<-rand> file:file...
+
+The files containing random data for seeding the random number
+generator. Multiple files can be specified, the separator is B<;> for
+MS-Windows, B<,> for VMS and B<:> for all other platforms. (Optional)
+
+=item B<-config> configfile
+
+The configuration file to use, this option overrides the
+B<OPENSSL_CONF> environment variable. Only the OID section
+of the config file is used with the B<-query> command. (Optional)
+
+=item B<-data> file_to_hash
+
+The data file for which the time stamp request needs to be
+created. stdin is the default if neither the B<-data> nor the B<-digest>
+parameter is specified. (Optional)
+
+=item B<-digest> digest_bytes
+
+It is possible to specify the message imprint explicitly without the data
+file. The imprint must be specified in a hexadecimal format, two characters
+per byte, the bytes optionally separated by colons (e.g. 1A:F6:01:... or
+1AF601...). The number of bytes must match the message digest algorithm 
+in use. (Optional)
+
+=item B<-md2>|B<-md4>|B<-md5>|B<-sha>|B<-sha1>|B<-mdc2>|B<-ripemd160>
+
+The message digest to apply to the data file. The default is SHA-1. (Optional)
+
+=item B<-policy> object_id
+
+The policy that the client expects the TSA to use for creating the
+time stamp token. Either the dotted OID notation or OID names defined
+in the config file can be used. If no policy is requested the TSA will
+use its own default policy. (Optional)
+
+=item B<-no_nonce>
+
+No nonce is specified in the request if this option is
+given. Otherwise a 64 bit long pseudo-random none is
+included in the request. It is recommended to use nonce to
+protect against replay-attacks. (Optional)
+
+=item B<-cert>
+
+The TSA is expected to include its signing certificate in the
+response. (Optional)
+
+=item B<-in> request.tsq
+
+This option specifies a previously created time stamp request in DER
+format that will be printed into the output file. Useful when you need
+to examine the content of a request in human-readable
+
+format. (Optional)
+
+=item B<-out> request.tsq
+
+Name of the output file to which the request will be written. Default
+is stdout. (Optional)
+
+=item B<-text>
+
+If this option is specified the output is human-readable text format
+instead of DER. (Optional)
+
+=back
+
+=head2 Time Stamp Response generation
+
+A time stamp response (TimeStampResp) consists of a response status
+and the time stamp token itself (ContentInfo), if the token generation was
+successful. The B<-reply> command is for creating a time stamp
+response or time stamp token based on a request and printing the
+response/token in human-readable format. If B<-token_out> is not
+specified the output is always a time stamp response (TimeStampResp),
+otherwise it is a time stamp token (ContentInfo).
+
+=over 4
+
+=item B<-config> configfile
+
+The configuration file to use, this option overrides the
+B<OPENSSL_CONF> environment variable. See B<CONFIGURATION FILE
+OPTIONS> for configurable variables. (Optional)
+
+=item B<-section> tsa_section
+
+The name of the config file section conatining the settings for the
+response generation. If not specified the default TSA section is
+used, see B<CONFIGURATION FILE OPTIONS> for details. (Optional)
+
+=item B<-queryfile> request.tsq
+
+The name of the file containing a DER encoded time stamp request. (Optional)
+
+=item B<-passin> password_src
+
+Specifies the password source for the private key of the TSA. See
+B<PASS PHRASE ARGUMENTS> in L<openssl(1)|openssl(1)>. (Optional)
+
+=item B<-signer> tsa_cert.pem
+
+The signer certificate of the TSA in PEM format. The TSA signing
+certificate must have exactly one extended key usage assigned to it:
+timeStamping. The extended key usage must also be critical, otherwise
+the certificate is going to be refused. Overrides the B<signer_cert>
+variable of the config file. (Optional)
+
+=item B<-inkey> private.pem
+
+The signer private key of the TSA in PEM format. Overrides the
+B<signer_key> config file option. (Optional)
+
+=item B<-chain> certs_file.pem
+
+The collection of certificates in PEM format that will all
+be included in the response in addition to the signer certificate if
+the B<-cert> option was used for the request. This file is supposed to
+contain the certificate chain for the signer certificate from its
+issuer upwards. The B<-reply> command does not build a certificate
+chain automatically. (Optional)
+
+=item B<-policy> object_id
+
+The default policy to use for the response unless the client
+explicitly requires a particular TSA policy. The OID can be specified
+either in dotted notation or with its name. Overrides the
+B<default_policy> config file option. (Optional)
+
+=item B<-in> response.tsr
+
+Specifies a previously created time stamp response or time stamp token
+(if B<-token_in> is also specified) in DER format that will be written
+to the output file. This option does not require a request, it is
+useful e.g. when you need to examine the content of a response or
+token or you want to extract the time stamp token from a response. If
+the input is a token and the output is a time stamp response a default
+'granted' status info is added to the token. (Optional)
+
+=item B<-token_in>
+
+This flag can be used together with the B<-in> option and indicates
+that the input is a DER encoded time stamp token (ContentInfo) instead
+of a time stamp response (TimeStampResp). (Optional)
+
+=item B<-out> response.tsr
+
+The response is written to this file. The format and content of the
+file depends on other options (see B<-text>, B<-token_out>). The default is
+stdout. (Optional)
+
+=item B<-token_out>
+
+The output is a time stamp token (ContentInfo) instead of time stamp
+response (TimeStampResp). (Optional)
+
+=item B<-text>
+
+If this option is specified the output is human-readable text format
+instead of DER. (Optional)
+
+=item B<-engine> id
+
+Specifying an engine (by it's unique B<id> string) will cause B<ts>
+to attempt to obtain a functional reference to the specified engine,
+thus initialising it if needed. The engine will then be set as the default
+for all available algorithms. Default is builtin. (Optional)
+
+=back
+
+=head2 Time Stamp Response verification
+
+The B<-verify> command is for verifying if a time stamp response or time
+stamp token is valid and matches a particular time stamp request or
+data file. The B<-verify> command does not use the configuration file.
+
+=over 4
+
+=item B<-data> file_to_hash
+
+The response or token must be verified against file_to_hash. The file
+is hashed with the message digest algorithm specified in the token. 
+The B<-digest> and B<-queryfile> options must not be specified with this one.
+(Optional)
+
+=item B<-digest> digest_bytes
+
+The response or token must be verified against the message digest specified
+with this option. The number of bytes must match the message digest algorithm
+specified in the token. The B<-data> and B<-queryfile> options must not be
+specified with this one. (Optional)
+
+=item B<-queryfile> request.tsq
+
+The original time stamp request in DER format. The B<-data> and B<-digest>
+options must not be specified with this one. (Optional)
+
+=item B<-in> response.tsr
+
+The time stamp response that needs to be verified in DER format. (Mandatory)
+
+=item B<-token_in>
+
+This flag can be used together with the B<-in> option and indicates
+that the input is a DER encoded time stamp token (ContentInfo) instead
+of a time stamp response (TimeStampResp). (Optional)
+
+=item B<-CApath> trusted_cert_path
+
+The name of the directory containing the trused CA certificates of the
+client. See the similar option of L<verify(1)|verify(1)> for additional
+details. Either this option or B<-CAfile> must be specified. (Optional)
+
+
+=item B<-CAfile> trusted_certs.pem
+
+The name of the file containing a set of trusted self-signed CA 
+certificates in PEM format. See the similar option of 
+L<verify(1)|verify(1)> for additional details. Either this option 
+or B<-CApath> must be specified.
+(Optional)
+
+=item B<-untrusted> cert_file.pem
+
+Set of additional untrusted certificates in PEM format which may be
+needed when building the certificate chain for the TSA's signing
+certificate. This file must contain the TSA signing certificate and
+all intermediate CA certificates unless the response includes them.
+(Optional)
+
+=back
+
+=head1 CONFIGURATION FILE OPTIONS
+
+The B<-query> and B<-reply> commands make use of a configuration file
+defined by the B<OPENSSL_CONF> environment variable. See L<config(5)|config(5>
+for a general description of the syntax of the config file. The
+B<-query> command uses only the symbolic OID names section
+and it can work without it. However, the B<-reply> command needs the
+config file for its operation.
+
+When there is a command line switch equivalent of a variable the
+switch always overrides the settings in the config file.
+
+=over 4
+
+=item B<tsa> section, B<default_tsa>	
+
+This is the main section and it specifies the name of another section
+that contains all the options for the B<-reply> command. This default
+section can be overriden with the B<-section> command line switch. (Optional)
+
+=item B<oid_file>
+
+See L<ca(1)|ca(1)> for description. (Optional)
+
+=item B<oid_section>
+
+See L<ca(1)|ca(1)> for description. (Optional)
+
+=item B<RANDFILE>
+
+See L<ca(1)|ca(1)> for description. (Optional)
+
+=item B<serial>
+
+The name of the file containing the hexadecimal serial number of the
+last time stamp response created. This number is incremented by 1 for
+each response. If the file does not exit at the time of response
+generation a new file is created with serial number 1. (Mandatory)
+
+=item B<crypto_device>
+
+Specifies the OpenSSL engine that will be set as the default for 
+all available algorithms. The default value is builtin, you can specify 
+any other engines supported by OpenSSL (e.g. use chil for the NCipher HSM).
+(Optional)
+
+=item B<signer_cert>
+
+TSA signing certificate in PEM format. The same as the B<-signer>
+command line option. (Optional)
+
+=item B<certs>
+
+A file containing a set of PEM encoded certificates that need to be
+included in the response. The same as the B<-chain> command line
+option. (Optional)
+
+=item B<signer_key>
+
+The private key of the TSA in PEM format. The same as the B<-inkey>
+command line option. (Optional)
+
+=item B<default_policy>
+
+The default policy to use when the request does not mandate any
+policy. The same as the B<-policy> command line option. (Optional)
+
+=item B<other_policies>
+
+Comma separated list of policies that are also acceptable by the TSA
+and used only if the request explicitly specifies one of them. (Optional)
+
+=item B<digests>
+
+The list of message digest algorithms that the TSA accepts. At least
+one algorithm must be specified. (Mandatory)
+
+=item B<accuracy>
+
+The accuracy of the time source of the TSA in seconds, milliseconds
+and microseconds. E.g. secs:1, millisecs:500, microsecs:100. If any of
+the components is missing zero is assumed for that field. (Optional)
+
+=item B<clock_precision_digits>
+
+Specifies the maximum number of digits, which represent the fraction of 
+seconds, that  need to be included in the time field. The trailing zeroes
+must be removed from the time, so there might actually be fewer digits,
+or no fraction of seconds at all. Supported only on UNIX platforms.
+The maximum value is 6, default is 0.
+(Optional)
+
+=item B<ordering>
+
+If this option is yes the responses generated by this TSA can always
+be ordered, even if the time difference between two responses is less
+than the sum of their accuracies. Default is no. (Optional)
+
+=item B<tsa_name>
+
+Set this option to yes if the subject name of the TSA must be included in
+the TSA name field of the response. Default is no. (Optional)
+
+=item B<ess_cert_id_chain>
+
+The SignedData objects created by the TSA always contain the
+certificate identifier of the signing certificate in a signed
+attribute (see RFC 2634, Enhanced Security Services). If this option
+is set to yes and either the B<certs> variable or the B<-chain> option
+is specified then the certificate identifiers of the chain will also
+be included in the SigningCertificate signed attribute. If this
+variable is set to no, only the signing certificate identifier is
+included. Default is no. (Optional)
+
+=back
+
+=head1 ENVIRONMENT VARIABLES
+
+B<OPENSSL_CONF> contains the path of the configuration file and can be
+overriden by the B<-config> command line option.
+
+=head1 EXAMPLES
+
+All the examples below presume that B<OPENSSL_CONF> is set to a proper
+configuration file, e.g. the example configuration file 
+openssl/apps/openssl.cnf will do.
+
+=head2 Time Stamp Request
+
+To create a time stamp request for design1.txt with SHA-1 
+without nonce and policy and no certificate is required in the response:
+
+  openssl ts -query -data design1.txt -no_nonce \
+	-out design1.tsq
+
+To create a similar time stamp request with specifying the message imprint
+explicitly:
+
+  openssl ts -query -digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \
+	 -no_nonce -out design1.tsq
+
+To print the content of the previous request in human readable format:
+
+  openssl ts -query -in design1.tsq -text
+
+To create a time stamp request which includes the MD-5 digest 
+of design2.txt, requests the signer certificate and nonce,
+specifies a policy id (assuming the tsa_policy1 name is defined in the
+OID section of the config file):
+
+  openssl ts -query -data design2.txt -md5 \
+	-policy tsa_policy1 -cert -out design2.tsq
+
+=head2 Time Stamp Response
+
+Before generating a response a signing certificate must be created for
+the TSA that contains the B<timeStamping> critical extended key usage extension
+without any other key usage extensions. You can add the
+'extendedKeyUsage = critical,timeStamping' line to the user certificate section
+of the config file to generate a proper certificate. See L<req(1)|req(1)>,
+L<ca(1)|ca(1)>, L<x509(1)|x509(1)> for instructions. The examples
+below assume that cacert.pem contains the certificate of the CA,
+tsacert.pem is the signing certificate issued by cacert.pem and
+tsakey.pem is the private key of the TSA.
+
+To create a time stamp response for a request:
+
+  openssl ts -reply -queryfile design1.tsq -inkey tsakey.pem \
+	-signer tsacert.pem -out design1.tsr
+
+If you want to use the settings in the config file you could just write:
+
+  openssl ts -reply -queryfile design1.tsq -out design1.tsr
+
+To print a time stamp reply to stdout in human readable format:
+
+  openssl ts -reply -in design1.tsr -text
+
+To create a time stamp token instead of time stamp response:
+
+  openssl ts -reply -queryfile design1.tsq -out design1_token.der -token_out
+
+To print a time stamp token to stdout in human readable format:
+
+  openssl ts -reply -in design1_token.der -token_in -text -token_out
+
+To extract the time stamp token from a response:
+
+  openssl ts -reply -in design1.tsr -out design1_token.der -token_out
+
+To add 'granted' status info to a time stamp token thereby creating a
+valid response:
+
+  openssl ts -reply -in design1_token.der -token_in -out design1.tsr
+
+=head2 Time Stamp Verification
+
+To verify a time stamp reply against a request:
+
+  openssl ts -verify -queryfile design1.tsq -in design1.tsr \
+	-CAfile cacert.pem -untrusted tsacert.pem
+
+To verify a time stamp reply that includes the certificate chain:
+
+  openssl ts -verify -queryfile design2.tsq -in design2.tsr \
+	-CAfile cacert.pem
+
+To verify a time stamp token against the original data file:
+  openssl ts -verify -data design2.txt -in design2.tsr \
+	-CAfile cacert.pem
+
+To verify a time stamp token against a message imprint:
+  openssl ts -verify -digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \
+	 -in design2.tsr -CAfile cacert.pem
+
+You could also look at the 'test' directory for more examples.
+
+=head1 BUGS
+
+If you find any bugs or you have suggestions please write to
+Zoltan Glozik <zglozik@opentsa.org>. Known issues:
+
+=over 4
+
+=item * No support for time stamps over SMTP, though it is quite easy
+to implement an automatic e-mail based TSA with L<procmail(1)|procmail(1)> 
+and L<perl(1)|perl(1)>. HTTP server support is provided in the form of 
+a separate apache module. HTTP client support is provided by
+L<tsget(1)|tsget(1)>. Pure TCP/IP protocol is not supported.
+
+=item * The file containing the last serial number of the TSA is not
+locked when being read or written. This is a problem if more than one
+instance of L<openssl(1)|openssl(1)> is trying to create a time stamp
+response at the same time. This is not an issue when using the apache
+server module, it does proper locking.
+
+=item * Look for the FIXME word in the source files.
+
+=item * The source code should really be reviewed by somebody else, too.
+
+=item * More testing is needed, I have done only some basic tests (see
+test/testtsa).
+
+=back
+
+=cut
+
+=head1 AUTHOR
+
+=over 4
+
+=item * This patch kit was written by Zoltan Glozik
+<zglozik@opentsa.org> for the OpenTSA project. See
+http://www.opentsa.org/.
+
+=item * This product includes software developed by the OpenSSL
+Project for use in the OpenSSL Toolkit (http://www.OpenSSL.org/).
+
+=item * This product includes cryptographic software written by Eric
+Young (eay@cryptsoft.com).
+
+=item * This product includes software written by Tim Hudson
+(tjh@cryptsoft.com).
+
+=back
+
+=cut
+
+=head1 SEE ALSO
+
+L<tsget(1)|tsget(1)>, L<openssl(1)|openssl(1)>, L<req(1)|req(1)>, 
+L<x509(1)|x509(1)>, L<ca(1)|ca(1)>, L<genrsa(1)|genrsa(1)>, 
+L<config(5)|config(5)>
+
+=cut
Index: openssl/doc/apps/tsget.pod
diff -u /dev/null openssl/doc/apps/tsget.pod:1.1.14.1
--- /dev/null	Tue Nov  9 22:44:07 2004
+++ openssl/doc/apps/tsget.pod	Mon Nov  8 16:31:16 2004
@@ -0,0 +1,200 @@
+=pod
+
+=head1 NAME
+
+tsget - Time Stamping HTTP/HTTPS client
+
+=head1 SYNOPSIS
+
+B<tsget>
+B<-h> server_url
+[B<-e> extension]
+[B<-o> output]
+[B<-v>]
+[B<-d>]
+[B<-k> private_key.pem]
+[B<-p> key_password]
+[B<-c> client_cert.pem]
+[B<-C> CA_certs.pem]
+[B<-P> CA_path]
+[B<-r> file:file...]
+[B<-g> EGD_socket]
+[request]...
+
+=head1 DESCRIPTION
+
+The B<tsget> command can be used for sending a time stamp request, as
+specified in B<RFC 3161>, to a time stamp server over HTTP or HTTPS and storing
+the time stamp response in a file. This tool cannot be used for creating the
+requests and verifying responses, you can use the OpenSSL B<ts(1)> command to
+do that. B<tsget> can send several requests to the server without closing
+the TCP connection if more than one requests are specified on the command
+line.
+
+The tool sends the following HTTP request for each time stamp request:
+
+	POST url HTTP/1.1
+	User-Agent: OpenTSA tsget.pl/<version>
+	Host: <host>:<port>
+	Pragma: no-cache
+	Content-Type: application/timestamp-query
+	Accept: application/timestamp-reply
+	Content-Length: length of body
+
+	...binary request specified by the user...
+
+B<tsget> expects a response of type application/timestamp-reply, which is
+written to a file without any interpretation.
+
+=head1 OPTIONS
+
+=over 4
+
+=item B<-h> server_url
+
+The URL of the HTTP/HTTPS server listening for time stamp requests.
+
+=item B<-e> extension
+
+If the B<-o> option is not given this argument specifies the extension of the
+output files. The base name of the output file will be the same as those of
+the input files. Default extension is '.tsr'. (Optional)
+
+=item B<-o> output
+
+This option can be specified only when just one request is sent to the
+server. The time stamp response will be written to the given output file. '-'
+means standard output. In case of multiple time stamp requests or the absence
+of this argument the names of the output files will be derived from the names
+of the input files and the default or specified extension argument. (Optional)
+
+=item B<-v>
+
+The name of the currently processed request is printed on standard
+error. (Optional)
+
+=item B<-d>
+
+Switches on verbose mode for the underlying B<curl> library. You can see
+detailed debug messages for the connection. (Optional)
+
+=item B<-k> private_key.pem
+
+(HTTPS) In case of certificate-based client authentication over HTTPS
+<private_key.pem> must contain the private key of the user. The private key
+file can optionally be protected by a passphrase. The B<-c> option must also
+be specified. (Optional)
+
+=item B<-p> key_password
+
+(HTTPS) Specifies the passphrase for the private key specified by the B<-k>
+argument. If this option is omitted and the key is passphrase protected B<tsget>
+will ask for it. (Optional)
+
+=item B<-c> client_cert.pem
+
+(HTTPS) In case of certificate-based client authentication over HTTPS
+<client_cert.pem> must contain the X.509 certificate of the user.  The B<-k>
+option must also be specified. If this option is not specified no
+certificate-based client authentication will take place. (Optional)
+
+=item B<-C> CA_certs.pem
+
+(HTTPS) The trusted CA certificate store. The certificate chain of the peer's
+certificate must include one of the CA certificates specified in this file.
+Either option B<-C> or option B<-P> must be given in case of HTTPS. (Optional)
+
+=item B<-P> CA_path
+
+(HTTPS) The path containing the trusted CA certificates to verify the peer's
+certificate. The directory must be prepared with the B<c_rehash>
+OpenSSL utility. Either option B<-C> or option B<-P> must be given in case of
+HTTPS. (Optional)
+
+=item B<-rand> file:file...
+
+The files containing random data for seeding the random number
+generator. Multiple files can be specified, the separator is B<;> for
+MS-Windows, B<,> for VMS and B<:> for all other platforms. (Optional)
+
+=item B<-g> EGD_socket
+
+The name of an EGD socket to get random data from. (Optional)
+
+=item [request]...
+
+List of files containing B<RFC 3161> DER-encoded time stamp requests. If no
+requests are specifed only one request will be sent to the server and it will be
+read from the standard input. (Optional)
+
+=back
+
+=head1 ENVIRONMENT VARIABLES
+
+The B<TSGET> environment variable can optionally contain default
+arguments. The content of this variable is added to the list of command line
+arguments.
+
+=head1 EXAMPLES
+
+The examples below presume that B<file1.tsq> and B<file2.tsq> contain valid
+time stamp requests, tsa.opentsa.org listens at port 8080 for HTTP requests
+and at port 8443 for HTTPS requests, the TSA service is available at the /tsa
+absolute path.
+
+Get a time stamp response for file1.tsq over HTTP, output is written to 
+file1.tsr:
+	
+  tsget -h http://tsa.opentsa.org:8080/tsa file1.tsq
+
+Get a time stamp response for file1.tsq and file2.tsq over HTTP showing
+progress, output is written to file1.reply and file2.reply respectively:
+	
+  tsget -h http://tsa.opentsa.org:8080/tsa -v -e .reply \
+	file1.tsq file2.tsq
+
+Create a time stamp request, write it to file3.tsq, send it to the server and
+write the response to file3.tsr:
+	
+  openssl ts -query -data file3.txt -cert | tee file3.tsq \
+	| tsget -h http://tsa.opentsa.org:8080/tsa \
+	-o file3.tsr
+
+Get a time stamp response for file1.tsq over HTTPS without client
+authentication:
+	
+  tsget -h https://tsa.opentsa.org:8443/tsa \
+	-C cacerts.pem file1.tsq
+
+Get a time stamp response for file1.tsq over HTTPS with certificate-based
+client authentication (it will ask for the passphrase if client_key.pem is
+protected):
+
+  tsget -h https://tsa.opentsa.org:8443/tsa -C cacerts.pem \
+	-k client_key.pem -c client_cert.pem file1.tsq
+
+You can shorten the previous command line if you make use of the B<TSGET>
+environment variable. The following commands do the same as the previous
+example:
+
+  TSGET='-h https://tsa.opentsa.org:8443/tsa -C cacerts.pem \
+	-k client_key.pem -c client_cert.pem'
+  export TSGET
+  tsget file1.tsq
+
+=head1 BUGS
+
+If you find any bugs or you have suggestions please write to
+info@opentsa.org.
+
+=head1 AUTHOR
+
+This tool was written by Zoltan Glozik <zglozik@stones.com> for
+the OpenTSA project. See http://www.opentsa.org/.
+
+=head1 SEE ALSO
+
+L<openssl(1)|openssl(1)>, L<ts(1)|ts(1)>, L<curl(1)|curl(1)>, 
+B<RFC 3161>
+
+=cut
Index: openssl/test/CAtsa.cnf
diff -u /dev/null openssl/test/CAtsa.cnf:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:10 2004
+++ openssl/test/CAtsa.cnf	Mon Nov  8 16:31:16 2004
@@ -0,0 +1,174 @@
+
+#
+# This config is used by the Time Stamp Authority tests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+oid_section		= new_oids
+
+[ new_oids ]
+
+# Policies used by the TSA tests.
+tsa_policy1 = 1.2.3.4.1
+tsa_policy2 = 1.2.3.4.5.6
+tsa_policy3 = 1.2.3.4.5.7
+
+#----------------------------------------------------------------------
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+[ CA_default ]
+
+dir		= ./demoCA
+certs		= $dir/certs		# Where the issued certs are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir/newcerts		# default place for new certs.
+
+certificate	= $dir/cacert.pem 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+private_key	= $dir/private/cakey.pem# The private key
+RANDFILE	= $dir/private/.rand	# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+default_days	= 365			# how long to certify for
+default_md	= sha1			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= supplied
+stateOrProvinceName	= supplied
+organizationName	= supplied
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+#----------------------------------------------------------------------
+[ req ]
+default_bits		= 1024
+default_md		= sha1
+distinguished_name	= req_distinguished_name
+encrypt_rsa_key		= no
+# attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+
+string_mask = nombstr
+
+[ req_distinguished_name ]
+countryName			= Country Name (2 letter code)
+countryName_default		= HU
+countryName_min			= 2
+countryName_max			= 2
+
+stateOrProvinceName		= State or Province Name (full name)
+stateOrProvinceName_default	= 
+
+localityName			= Locality Name (eg, city)
+
+0.organizationName		= Organization Name (eg, company)
+0.organizationName_default	= 
+
+commonName			= Common Name (eg, YOUR name)
+commonName_max			= 64
+
+[ req_attributes ]
+challengePassword		= A challenge password
+challengePassword_min		= 4
+challengePassword_max		= 20
+
+unstructuredName		= An optional company name
+
+[ tsa_cert ]
+
+# TSA server cert is not a CA cert.
+basicConstraints=CA:FALSE
+
+# The following key usage flags are needed for TSA server certificates.
+keyUsage = nonRepudiation, digitalSignature
+extendedKeyUsage = critical,timeStamping
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ non_tsa_cert ]
+
+# This is not a CA cert and not a TSA cert, either (timeStamping usage missing)
+basicConstraints=CA:FALSE
+
+# The following key usage flags are needed for TSA server certificates.
+keyUsage = nonRepudiation, digitalSignature
+# timeStamping is not supported by this certificate
+# extendedKeyUsage = critical,timeStamping
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature
+
+[ v3_ca ]
+
+# Extensions for a typical CA
+
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid:always,issuer:always
+basicConstraints = critical,CA:true
+keyUsage = cRLSign, keyCertSign
+
+#----------------------------------------------------------------------
+[ tsa ]
+
+default_tsa = tsa_config1	# the default TSA section
+
+[ tsa_config1 ]
+
+# These are used by the TSA reply generation only.
+dir		= .			# TSA root directory
+serial		= $dir/tsa_serial	# The current serial number (mandatory)
+signer_cert	= $dir/tsa_cert1.pem 	# The TSA signing certificate
+					# (optional)
+certs		= $dir/demoCA/cacert.pem# Certificate chain to include in reply
+					# (optional)
+signer_key	= $dir/tsa_key1.pem	# The TSA private key (optional)
+
+default_policy	= tsa_policy1		# Policy if request did not specify it
+					# (optional)
+other_policies	= tsa_policy2, tsa_policy3	# acceptable policies (optional)
+digests		= md5, sha1		# Acceptable message digests (mandatory)
+accuracy	= secs:1, millisecs:500, microsecs:100	# (optional)
+ordering		= yes	# Is ordering defined for timestamps?
+				# (optional, default: no)
+tsa_name		= yes	# Must the TSA name be included in the reply?
+				# (optional, default: no)
+ess_cert_id_chain	= yes	# Must the ESS cert id chain be included?
+				# (optional, default: no)
+
+[ tsa_config2 ]
+
+# This configuration uses a certificate which doesn't have timeStamping usage.
+# These are used by the TSA reply generation only.
+dir		= .			# TSA root directory
+serial		= $dir/tsa_serial	# The current serial number (mandatory)
+signer_cert	= $dir/tsa_cert2.pem 	# The TSA signing certificate
+					# (optional)
+certs		= $dir/demoCA/cacert.pem# Certificate chain to include in reply
+					# (optional)
+signer_key	= $dir/tsa_key2.pem	# The TSA private key (optional)
+
+default_policy	= tsa_policy1		# Policy if request did not specify it
+					# (optional)
+other_policies	= tsa_policy2, tsa_policy3	# acceptable policies (optional)
+digests		= md5, sha1		# Acceptable message digests (mandatory)
Index: openssl/test/Makefile
diff -u openssl/test/Makefile:1.1.1.1 openssl/test/Makefile:1.1.1.1.2.1
--- openssl/test/Makefile:1.1.1.1	Mon Nov  8 15:33:12 2004
+++ openssl/test/Makefile	Mon Nov  8 16:31:16 2004
@@ -138,7 +138,7 @@
 	test_rmd test_rc2 test_rc4 test_rc5 test_bf test_cast test_aes \
 	test_rand test_bn test_ec test_enc test_x509 test_rsa test_crl test_sid \
 	test_gen test_req test_pkcs7 test_verify test_dh test_dsa \
-	test_ss test_ca test_engine test_evp test_ssl
+	test_ss test_ca test_engine test_evp test_ssl test_tsa
 # temporarily removed
 # fips_test_aes
 
@@ -293,6 +293,13 @@
 test_aes: #$(AESTEST)
 #	@echo "test Rijndael"
 #	$(SET_SO_PATHS); ./$(AESTEST)
+
+test_tsa:
+	@if ../apps/openssl no-rsa; then \
+	  echo "skipping testtsa test -- requires RSA"; \
+	else \
+	  sh ./testtsa; \
+	fi
 
 lint:
 	lint -DLINT $(INCLUDES) $(SRC)>fluff
Index: openssl/test/testtsa
diff -u /dev/null openssl/test/testtsa:1.1.18.1
--- /dev/null	Tue Nov  9 22:44:10 2004
+++ openssl/test/testtsa	Mon Nov  8 16:31:16 2004
@@ -0,0 +1,234 @@
+#!/bin/sh
+
+#
+# A few very basic tests for the 'ts' time stamping authority command.
+#
+
+SH="/bin/sh"
+PATH=../../apps:$PATH
+export SH PATH
+
+OPENSSL_CONF="../CAtsa.cnf"
+export OPENSSL_CONF
+
+error () {
+
+    echo "ERROR DURING TSA TESTS!!!!!!!!!!!!!!!!" >&2
+    exit 1
+}
+
+setup_dir () {
+
+    rm -rf tsa 2>/dev/null
+    mkdir tsa
+    cd ./tsa
+}
+
+clean_up_dir () {
+
+    cd ..
+    rm -rf tsa
+}
+
+create_ca () {
+
+    echo "Creating a new CA for the TSA tests..."
+    /bin/rm -fr demoCA
+    $SH ../../apps/CA.sh -newca <<EOF
+
+HU
+Budapest
+Budapest
+Gov-CA Ltd.
+ca1
+EOF
+    test $? != 0 && error
+}
+
+create_tsa_cert () {
+
+    INDEX=$1
+    EXT=$2
+    openssl req -new -out tsa_req${INDEX}.pem -keyout tsa_key${INDEX}.pem <<EOF
+HU
+Budapest
+Buda
+Hun-TSA Ltd.
+tsa${INDEX}
+EOF
+    test $? != 0 && error
+
+    openssl ca -in tsa_req${INDEX}.pem -out tsa_cert${INDEX}.pem \
+	-extensions $EXT <<EOF
+y
+y
+EOF
+    test $? != 0 && error
+}
+
+print_request () {
+
+    openssl ts -query -in $1 -text
+}
+
+create_time_stamp_request1 () {
+
+    openssl ts -query -data ../testtsa -policy tsa_policy1 -cert -out req1.tsq
+    test $? != 0 && error
+}
+
+create_time_stamp_request2 () {
+
+    openssl ts -query -data ../testtsa -policy tsa_policy2 -no_nonce \
+	-out req2.tsq
+    test $? != 0 && error
+}
+
+create_time_stamp_request3 () {
+
+    openssl ts -query -data ../CAtsa.cnf -no_nonce -out req3.tsq
+    test $? != 0 && error
+}
+
+print_response () {
+
+    openssl ts -reply -in $1 -text
+    test $? != 0 && error
+}
+
+create_time_stamp_response () {
+
+    openssl ts -reply -section $3 -queryfile $1 -out $2
+    test $? != 0 && error
+}
+
+time_stamp_response_token_test () {
+
+    RESPONSE2=$2.copy.tsr
+    TOKEN_DER=$2.token.der
+    openssl ts -reply -in $2 -out $TOKEN_DER -token_out
+    test $? != 0 && error
+    openssl ts -reply -in $TOKEN_DER -token_in -out $RESPONSE2
+    test $? != 0 && error
+    cmp $RESPONSE2 $2
+    test $? != 0 && error
+    openssl ts -reply -in $2 -text -token_out
+    test $? != 0 && error
+    openssl ts -reply -in $TOKEN_DER -token_in -text -token_out
+    test $? != 0 && error
+    openssl ts -reply -queryfile $1 -text -token_out
+    test $? != 0 && error
+}
+
+verify_time_stamp_response () {
+
+    openssl ts -verify -queryfile $1 -in $2 -CAfile demoCA/cacert.pem \
+	-untrusted tsa_cert1.pem
+    test $? != 0 && error
+    openssl ts -verify -data $3 -in $2 -CAfile demoCA/cacert.pem \
+	-untrusted tsa_cert1.pem
+    test $? != 0 && error
+}
+
+verify_time_stamp_token () {
+
+    # create the token from the response first
+    openssl ts -reply -in $2 -out $2.token -token_out
+    test $? != 0 && error
+    openssl ts -verify -queryfile $1 -in $2.token -token_in \
+	-CAfile demoCA/cacert.pem -untrusted tsa_cert1.pem
+    test $? != 0 && error
+    openssl ts -verify -data $3 -in $2.token -token_in \
+	-CAfile demoCA/cacert.pem -untrusted tsa_cert1.pem
+    test $? != 0 && error
+}
+
+verify_time_stamp_response_fail () {
+
+    openssl ts -verify -queryfile $1 -in $2 -CAfile demoCA/cacert.pem \
+	-untrusted tsa_cert1.pem
+    # Checks if the verification failed, as it should have.
+    test $? == 0 && error
+}
+
+# main functions
+
+echo "Setting up TSA test directory..."
+setup_dir
+
+echo "Creating CA for TSA tests..."
+create_ca
+
+echo "Creating tsa_cert1.pem TSA server cert..."
+create_tsa_cert 1 tsa_cert
+
+echo "Creating tsa_cert2.pem non-TSA server cert..."
+create_tsa_cert 2 non_tsa_cert
+
+echo "Creating req1.req time stamp request for file testtsa..."
+create_time_stamp_request1
+
+echo "Printing req1.req..."
+print_request req1.tsq
+
+echo "Generating valid response for req1.req..."
+create_time_stamp_response req1.tsq resp1.tsr tsa_config1
+
+echo "Printing response..."
+print_response resp1.tsr
+
+echo "Verifying valid response..."
+verify_time_stamp_response req1.tsq resp1.tsr ../testtsa
+
+echo "Verifying valid token..."
+verify_time_stamp_token req1.tsq resp1.tsr ../testtsa
+
+# The tests below are commented out, because invalid signer certificates
+# can no longer be specified in the config file.
+
+# echo "Generating _invalid_ response for req1.req..."
+# create_time_stamp_response req1.tsq resp1_bad.tsr tsa_config2
+
+# echo "Printing response..."
+# print_response resp1_bad.tsr
+
+# echo "Verifying invalid response, it should fail..."
+# verify_time_stamp_response_fail req1.tsq resp1_bad.tsr
+
+echo "Creating req2.req time stamp request for file testtsa..."
+create_time_stamp_request2
+
+echo "Printing req2.req..."
+print_request req2.tsq
+
+echo "Generating valid response for req2.req..."
+create_time_stamp_response req2.tsq resp2.tsr tsa_config1
+
+echo "Checking '-token_in' and '-token_out' options with '-reply'..."
+time_stamp_response_token_test req2.tsq resp2.tsr
+
+echo "Printing response..."
+print_response resp2.tsr
+
+echo "Verifying valid response..."
+verify_time_stamp_response req2.tsq resp2.tsr ../testtsa
+
+echo "Verifying response against wrong request, it should fail..."
+verify_time_stamp_response_fail req1.tsq resp2.tsr
+
+echo "Verifying response against wrong request, it should fail..."
+verify_time_stamp_response_fail req2.tsq resp1.tsr
+
+echo "Creating req3.req time stamp request for file CAtsa.cnf..."
+create_time_stamp_request3
+
+echo "Printing req3.req..."
+print_request req3.tsq
+
+echo "Verifying response against wrong request, it should fail..."
+verify_time_stamp_response_fail req3.tsq resp1.tsr
+
+echo "Cleaning up..."
+clean_up_dir
+
+exit 0
Index: openssl/tools/c_rehash
diff -u openssl/tools/c_rehash:1.1.1.5 openssl/tools/c_rehash:1.1.1.5.2.1
--- openssl/tools/c_rehash:1.1.1.5	Mon Nov  8 15:33:13 2004
+++ openssl/tools/c_rehash	Mon Nov  8 16:31:16 2004
@@ -1,4 +1,4 @@
-#!/usr/bin/perl
+#!/usr/local/bin/perl
 
 
 # Perl c_rehash script, scan all files in a directory
Index: openssl/util/libeay.num
diff -u openssl/util/libeay.num:1.1.1.6 openssl/util/libeay.num:1.1.1.6.2.1
--- openssl/util/libeay.num:1.1.1.6	Mon Nov  8 15:33:14 2004
+++ openssl/util/libeay.num	Mon Nov  8 16:31:16 2004
@@ -1,2843 +1,2875 @@
-SSLeay                                  1	EXIST::FUNCTION:
-SSLeay_version                          2	EXIST::FUNCTION:
-ASN1_BIT_STRING_asn1_meth               3	EXIST::FUNCTION:
-ASN1_HEADER_free                        4	EXIST::FUNCTION:
-ASN1_HEADER_new                         5	EXIST::FUNCTION:
-ASN1_IA5STRING_asn1_meth                6	EXIST::FUNCTION:
-ASN1_INTEGER_get                        7	EXIST::FUNCTION:
-ASN1_INTEGER_set                        8	EXIST::FUNCTION:
-ASN1_INTEGER_to_BN                      9	EXIST::FUNCTION:
-ASN1_OBJECT_create                      10	EXIST::FUNCTION:
-ASN1_OBJECT_free                        11	EXIST::FUNCTION:
+BN_mod_exp_mont                         1	EXIST::FUNCTION:
+i2d_X509_REQ_INFO                       2	EXIST::FUNCTION:
+i2d_X509_fp                             3	EXIST::FUNCTION:FP_API
+_ossl_old_des_ecb_encrypt               4	EXIST::FUNCTION:DES
+OBJ_ln2nid                              5	EXIST::FUNCTION:
+PKCS12_item_decrypt_d2i                 6	EXIST::FUNCTION:
+i2d_X509_CRL_INFO                       7	EXIST::FUNCTION:
+TS_MSG_IMPRINT_get_algo                 8	EXIST::FUNCTION:
+BIO_debug_callback                      9	EXIST::FUNCTION:
+TS_ACCURACY_free                        10	EXIST::FUNCTION:
+BIO_printf                              11	EXIST::FUNCTION:
 ASN1_OBJECT_new                         12	EXIST::FUNCTION:
-ASN1_PRINTABLE_type                     13	EXIST::FUNCTION:
-ASN1_STRING_cmp                         14	EXIST::FUNCTION:
-ASN1_STRING_dup                         15	EXIST::FUNCTION:
-ASN1_STRING_free                        16	EXIST::FUNCTION:
-ASN1_STRING_new                         17	EXIST::FUNCTION:
-ASN1_STRING_print                       18	EXIST::FUNCTION:BIO
-ASN1_STRING_set                         19	EXIST::FUNCTION:
-ASN1_STRING_type_new                    20	EXIST::FUNCTION:
-ASN1_TYPE_free                          21	EXIST::FUNCTION:
-ASN1_TYPE_new                           22	EXIST::FUNCTION:
-ASN1_UNIVERSALSTRING_to_string          23	EXIST::FUNCTION:
-ASN1_UTCTIME_check                      24	EXIST::FUNCTION:
-ASN1_UTCTIME_print                      25	EXIST::FUNCTION:BIO
-ASN1_UTCTIME_set                        26	EXIST::FUNCTION:
-ASN1_check_infinite_end                 27	EXIST::FUNCTION:
-ASN1_d2i_bio                            28	EXIST::FUNCTION:BIO
-ASN1_d2i_fp                             29	EXIST::FUNCTION:FP_API
-ASN1_digest                             30	EXIST::FUNCTION:EVP
-ASN1_dup                                31	EXIST::FUNCTION:
-ASN1_get_object                         32	EXIST::FUNCTION:
-ASN1_i2d_bio                            33	EXIST::FUNCTION:BIO
-ASN1_i2d_fp                             34	EXIST::FUNCTION:FP_API
-ASN1_object_size                        35	EXIST::FUNCTION:
-ASN1_parse                              36	EXIST::FUNCTION:BIO
-ASN1_put_object                         37	EXIST::FUNCTION:
-ASN1_sign                               38	EXIST::FUNCTION:EVP
-ASN1_verify                             39	EXIST::FUNCTION:EVP
-BF_cbc_encrypt                          40	EXIST::FUNCTION:BF
-BF_cfb64_encrypt                        41	EXIST::FUNCTION:BF
-BF_ecb_encrypt                          42	EXIST::FUNCTION:BF
-BF_encrypt                              43	EXIST::FUNCTION:BF
-BF_ofb64_encrypt                        44	EXIST::FUNCTION:BF
-BF_options                              45	EXIST::FUNCTION:BF
-BF_set_key                              46	EXIST::FUNCTION:BF
-BIO_CONNECT_free                        47	NOEXIST::FUNCTION:
-BIO_CONNECT_new                         48	NOEXIST::FUNCTION:
-BIO_accept                              51	EXIST::FUNCTION:
-BIO_ctrl                                52	EXIST::FUNCTION:
-BIO_int_ctrl                            53	EXIST::FUNCTION:
-BIO_debug_callback                      54	EXIST::FUNCTION:
-BIO_dump                                55	EXIST::FUNCTION:
-BIO_dup_chain                           56	EXIST::FUNCTION:
-BIO_f_base64                            57	EXIST::FUNCTION:BIO
-BIO_f_buffer                            58	EXIST::FUNCTION:
-BIO_f_cipher                            59	EXIST::FUNCTION:BIO
-BIO_f_md                                60	EXIST::FUNCTION:BIO
-BIO_f_null                              61	EXIST::FUNCTION:
-BIO_f_proxy_server                      62	NOEXIST::FUNCTION:
-BIO_fd_non_fatal_error                  63	EXIST::FUNCTION:
-BIO_fd_should_retry                     64	EXIST::FUNCTION:
-BIO_find_type                           65	EXIST::FUNCTION:
-BIO_free                                66	EXIST::FUNCTION:
-BIO_free_all                            67	EXIST::FUNCTION:
-BIO_get_accept_socket                   69	EXIST::FUNCTION:
-BIO_get_filter_bio                      70	NOEXIST::FUNCTION:
-BIO_get_host_ip                         71	EXIST::FUNCTION:
-BIO_get_port                            72	EXIST::FUNCTION:
-BIO_get_retry_BIO                       73	EXIST::FUNCTION:
-BIO_get_retry_reason                    74	EXIST::FUNCTION:
-BIO_gethostbyname                       75	EXIST::FUNCTION:
-BIO_gets                                76	EXIST::FUNCTION:
-BIO_new                                 78	EXIST::FUNCTION:
-BIO_new_accept                          79	EXIST::FUNCTION:
-BIO_new_connect                         80	EXIST::FUNCTION:
-BIO_new_fd                              81	EXIST::FUNCTION:
-BIO_new_file                            82	EXIST:!WIN16:FUNCTION:FP_API
-BIO_new_fp                              83	EXIST:!WIN16:FUNCTION:FP_API
-BIO_new_socket                          84	EXIST::FUNCTION:
-BIO_pop                                 85	EXIST::FUNCTION:
-BIO_printf                              86	EXIST::FUNCTION:
-BIO_push                                87	EXIST::FUNCTION:
-BIO_puts                                88	EXIST::FUNCTION:
-BIO_read                                89	EXIST::FUNCTION:
-BIO_s_accept                            90	EXIST::FUNCTION:
-BIO_s_connect                           91	EXIST::FUNCTION:
-BIO_s_fd                                92	EXIST::FUNCTION:
-BIO_s_file                              93	EXIST:!WIN16:FUNCTION:FP_API
-BIO_s_mem                               95	EXIST::FUNCTION:
-BIO_s_null                              96	EXIST::FUNCTION:
-BIO_s_proxy_client                      97	NOEXIST::FUNCTION:
-BIO_s_socket                            98	EXIST::FUNCTION:
-BIO_set                                 100	EXIST::FUNCTION:
-BIO_set_cipher                          101	EXIST::FUNCTION:BIO
-BIO_set_tcp_ndelay                      102	EXIST::FUNCTION:
-BIO_sock_cleanup                        103	EXIST::FUNCTION:
-BIO_sock_error                          104	EXIST::FUNCTION:
-BIO_sock_init                           105	EXIST::FUNCTION:
-BIO_sock_non_fatal_error                106	EXIST::FUNCTION:
-BIO_sock_should_retry                   107	EXIST::FUNCTION:
-BIO_socket_ioctl                        108	EXIST::FUNCTION:
-BIO_write                               109	EXIST::FUNCTION:
-BN_CTX_free                             110	EXIST::FUNCTION:
-BN_CTX_new                              111	EXIST::FUNCTION:
-BN_MONT_CTX_free                        112	EXIST::FUNCTION:
-BN_MONT_CTX_new                         113	EXIST::FUNCTION:
-BN_MONT_CTX_set                         114	EXIST::FUNCTION:
-BN_add                                  115	EXIST::FUNCTION:
-BN_add_word                             116	EXIST::FUNCTION:
-BN_hex2bn                               117	EXIST::FUNCTION:
-BN_bin2bn                               118	EXIST::FUNCTION:
-BN_bn2hex                               119	EXIST::FUNCTION:
-BN_bn2bin                               120	EXIST::FUNCTION:
-BN_clear                                121	EXIST::FUNCTION:
-BN_clear_bit                            122	EXIST::FUNCTION:
-BN_clear_free                           123	EXIST::FUNCTION:
-BN_cmp                                  124	EXIST::FUNCTION:
-BN_copy                                 125	EXIST::FUNCTION:
-BN_div                                  126	EXIST::FUNCTION:
-BN_div_word                             127	EXIST::FUNCTION:
-BN_dup                                  128	EXIST::FUNCTION:
-BN_free                                 129	EXIST::FUNCTION:
-BN_from_montgomery                      130	EXIST::FUNCTION:
-BN_gcd                                  131	EXIST::FUNCTION:
-BN_generate_prime                       132	EXIST::FUNCTION:
-BN_get_word                             133	EXIST::FUNCTION:
-BN_is_bit_set                           134	EXIST::FUNCTION:
-BN_is_prime                             135	EXIST::FUNCTION:
-BN_lshift                               136	EXIST::FUNCTION:
-BN_lshift1                              137	EXIST::FUNCTION:
-BN_mask_bits                            138	EXIST::FUNCTION:
-BN_mod                                  139	NOEXIST::FUNCTION:
-BN_mod_exp                              140	EXIST::FUNCTION:
-BN_mod_exp_mont                         141	EXIST::FUNCTION:
-BN_mod_exp_simple                       143	EXIST::FUNCTION:
-BN_mod_inverse                          144	EXIST::FUNCTION:
-BN_mod_mul                              145	EXIST::FUNCTION:
-BN_mod_mul_montgomery                   146	EXIST::FUNCTION:
-BN_mod_word                             148	EXIST::FUNCTION:
-BN_mul                                  149	EXIST::FUNCTION:
-BN_new                                  150	EXIST::FUNCTION:
-BN_num_bits                             151	EXIST::FUNCTION:
-BN_num_bits_word                        152	EXIST::FUNCTION:
-BN_options                              153	EXIST::FUNCTION:
-BN_print                                154	EXIST::FUNCTION:
-BN_print_fp                             155	EXIST::FUNCTION:FP_API
-BN_rand                                 156	EXIST::FUNCTION:
-BN_reciprocal                           157	EXIST::FUNCTION:
-BN_rshift                               158	EXIST::FUNCTION:
-BN_rshift1                              159	EXIST::FUNCTION:
-BN_set_bit                              160	EXIST::FUNCTION:
-BN_set_word                             161	EXIST::FUNCTION:
-BN_sqr                                  162	EXIST::FUNCTION:
-BN_sub                                  163	EXIST::FUNCTION:
-BN_to_ASN1_INTEGER                      164	EXIST::FUNCTION:
-BN_ucmp                                 165	EXIST::FUNCTION:
-BN_value_one                            166	EXIST::FUNCTION:
-BUF_MEM_free                            167	EXIST::FUNCTION:
-BUF_MEM_grow                            168	EXIST::FUNCTION:
-BUF_MEM_new                             169	EXIST::FUNCTION:
-BUF_strdup                              170	EXIST::FUNCTION:
-CONF_free                               171	EXIST::FUNCTION:
-CONF_get_number                         172	EXIST::FUNCTION:
-CONF_get_section                        173	EXIST::FUNCTION:
-CONF_get_string                         174	EXIST::FUNCTION:
-CONF_load                               175	EXIST::FUNCTION:
-CRYPTO_add_lock                         176	EXIST::FUNCTION:
-CRYPTO_dbg_free                         177	EXIST::FUNCTION:
-CRYPTO_dbg_malloc                       178	EXIST::FUNCTION:
-CRYPTO_dbg_realloc                      179	EXIST::FUNCTION:
-CRYPTO_dbg_remalloc                     180	NOEXIST::FUNCTION:
-CRYPTO_free                             181	EXIST::FUNCTION:
-CRYPTO_get_add_lock_callback            182	EXIST::FUNCTION:
-CRYPTO_get_id_callback                  183	EXIST::FUNCTION:
-CRYPTO_get_lock_name                    184	EXIST::FUNCTION:
-CRYPTO_get_locking_callback             185	EXIST::FUNCTION:
-CRYPTO_get_mem_functions                186	EXIST::FUNCTION:
-CRYPTO_lock                             187	EXIST::FUNCTION:
-CRYPTO_malloc                           188	EXIST::FUNCTION:
-CRYPTO_mem_ctrl                         189	EXIST::FUNCTION:
-CRYPTO_mem_leaks                        190	EXIST::FUNCTION:
-CRYPTO_mem_leaks_cb                     191	EXIST::FUNCTION:
-CRYPTO_mem_leaks_fp                     192	EXIST::FUNCTION:FP_API
-CRYPTO_realloc                          193	EXIST::FUNCTION:
-CRYPTO_remalloc                         194	EXIST::FUNCTION:
-CRYPTO_set_add_lock_callback            195	EXIST::FUNCTION:
-CRYPTO_set_id_callback                  196	EXIST::FUNCTION:
-CRYPTO_set_locking_callback             197	EXIST::FUNCTION:
-CRYPTO_set_mem_functions                198	EXIST::FUNCTION:
-CRYPTO_thread_id                        199	EXIST::FUNCTION:
-DH_check                                200	EXIST::FUNCTION:DH
-DH_compute_key                          201	EXIST::FUNCTION:DH
-DH_free                                 202	EXIST::FUNCTION:DH
-DH_generate_key                         203	EXIST::FUNCTION:DH
-DH_generate_parameters                  204	EXIST::FUNCTION:DH
-DH_new                                  205	EXIST::FUNCTION:DH
-DH_size                                 206	EXIST::FUNCTION:DH
-DHparams_print                          207	EXIST::FUNCTION:BIO,DH
-DHparams_print_fp                       208	EXIST::FUNCTION:DH,FP_API
-DSA_free                                209	EXIST::FUNCTION:DSA
-DSA_generate_key                        210	EXIST::FUNCTION:DSA
-DSA_generate_parameters                 211	EXIST::FUNCTION:DSA
-DSA_is_prime                            212	NOEXIST::FUNCTION:
-DSA_new                                 213	EXIST::FUNCTION:DSA
-DSA_print                               214	EXIST::FUNCTION:BIO,DSA
-DSA_print_fp                            215	EXIST::FUNCTION:DSA,FP_API
-DSA_sign                                216	EXIST::FUNCTION:DSA
-DSA_sign_setup                          217	EXIST::FUNCTION:DSA
-DSA_size                                218	EXIST::FUNCTION:DSA
-DSA_verify                              219	EXIST::FUNCTION:DSA
-DSAparams_print                         220	EXIST::FUNCTION:BIO,DSA
-DSAparams_print_fp                      221	EXIST::FUNCTION:DSA,FP_API
-ERR_clear_error                         222	EXIST::FUNCTION:
-ERR_error_string                        223	EXIST::FUNCTION:
-ERR_free_strings                        224	EXIST::FUNCTION:
-ERR_func_error_string                   225	EXIST::FUNCTION:
-ERR_get_err_state_table                 226	EXIST::FUNCTION:LHASH
-ERR_get_error                           227	EXIST::FUNCTION:
-ERR_get_error_line                      228	EXIST::FUNCTION:
-ERR_get_state                           229	EXIST::FUNCTION:
-ERR_get_string_table                    230	EXIST::FUNCTION:LHASH
-ERR_lib_error_string                    231	EXIST::FUNCTION:
-ERR_load_ASN1_strings                   232	EXIST::FUNCTION:
-ERR_load_BIO_strings                    233	EXIST::FUNCTION:
-ERR_load_BN_strings                     234	EXIST::FUNCTION:
-ERR_load_BUF_strings                    235	EXIST::FUNCTION:
-ERR_load_CONF_strings                   236	EXIST::FUNCTION:
-ERR_load_DH_strings                     237	EXIST::FUNCTION:DH
-ERR_load_DSA_strings                    238	EXIST::FUNCTION:DSA
-ERR_load_ERR_strings                    239	EXIST::FUNCTION:
-ERR_load_EVP_strings                    240	EXIST::FUNCTION:
-ERR_load_OBJ_strings                    241	EXIST::FUNCTION:
-ERR_load_PEM_strings                    242	EXIST::FUNCTION:
-ERR_load_PROXY_strings                  243	NOEXIST::FUNCTION:
-ERR_load_RSA_strings                    244	EXIST::FUNCTION:RSA
-ERR_load_X509_strings                   245	EXIST::FUNCTION:
-ERR_load_crypto_strings                 246	EXIST::FUNCTION:
-ERR_load_strings                        247	EXIST::FUNCTION:
-ERR_peek_error                          248	EXIST::FUNCTION:
-ERR_peek_error_line                     249	EXIST::FUNCTION:
-ERR_print_errors                        250	EXIST::FUNCTION:BIO
-ERR_print_errors_fp                     251	EXIST::FUNCTION:FP_API
-ERR_put_error                           252	EXIST::FUNCTION:
-ERR_reason_error_string                 253	EXIST::FUNCTION:
-ERR_remove_state                        254	EXIST::FUNCTION:
-EVP_BytesToKey                          255	EXIST::FUNCTION:
-EVP_CIPHER_CTX_cleanup                  256	EXIST::FUNCTION:
-EVP_CipherFinal                         257	EXIST::FUNCTION:
-EVP_CipherInit                          258	EXIST::FUNCTION:
-EVP_CipherUpdate                        259	EXIST::FUNCTION:
-EVP_DecodeBlock                         260	EXIST::FUNCTION:
-EVP_DecodeFinal                         261	EXIST::FUNCTION:
-EVP_DecodeInit                          262	EXIST::FUNCTION:
-EVP_DecodeUpdate                        263	EXIST::FUNCTION:
-EVP_DecryptFinal                        264	EXIST::FUNCTION:
-EVP_DecryptInit                         265	EXIST::FUNCTION:
-EVP_DecryptUpdate                       266	EXIST::FUNCTION:
-EVP_DigestFinal                         267	EXIST::FUNCTION:
-EVP_DigestInit                          268	EXIST::FUNCTION:
-EVP_DigestUpdate                        269	EXIST::FUNCTION:
-EVP_EncodeBlock                         270	EXIST::FUNCTION:
-EVP_EncodeFinal                         271	EXIST::FUNCTION:
-EVP_EncodeInit                          272	EXIST::FUNCTION:
-EVP_EncodeUpdate                        273	EXIST::FUNCTION:
-EVP_EncryptFinal                        274	EXIST::FUNCTION:
-EVP_EncryptInit                         275	EXIST::FUNCTION:
-EVP_EncryptUpdate                       276	EXIST::FUNCTION:
-EVP_OpenFinal                           277	EXIST::FUNCTION:RSA
-EVP_OpenInit                            278	EXIST::FUNCTION:RSA
-EVP_PKEY_assign                         279	EXIST::FUNCTION:
-EVP_PKEY_copy_parameters                280	EXIST::FUNCTION:
-EVP_PKEY_free                           281	EXIST::FUNCTION:
-EVP_PKEY_missing_parameters             282	EXIST::FUNCTION:
-EVP_PKEY_new                            283	EXIST::FUNCTION:
-EVP_PKEY_save_parameters                284	EXIST::FUNCTION:
-EVP_PKEY_size                           285	EXIST::FUNCTION:
-EVP_PKEY_type                           286	EXIST::FUNCTION:
-EVP_SealFinal                           287	EXIST::FUNCTION:RSA
-EVP_SealInit                            288	EXIST::FUNCTION:RSA
-EVP_SignFinal                           289	EXIST::FUNCTION:
-EVP_VerifyFinal                         290	EXIST::FUNCTION:
-EVP_add_alias                           291	NOEXIST::FUNCTION:
-EVP_add_cipher                          292	EXIST::FUNCTION:
-EVP_add_digest                          293	EXIST::FUNCTION:
-EVP_bf_cbc                              294	EXIST::FUNCTION:BF
-EVP_bf_cfb64                            295	EXIST::FUNCTION:BF
-EVP_bf_ecb                              296	EXIST::FUNCTION:BF
-EVP_bf_ofb                              297	EXIST::FUNCTION:BF
-EVP_cleanup                             298	EXIST::FUNCTION:
-EVP_des_cbc                             299	EXIST::FUNCTION:DES
-EVP_des_cfb64                           300	EXIST::FUNCTION:DES
-EVP_des_ecb                             301	EXIST::FUNCTION:DES
-EVP_des_ede                             302	EXIST::FUNCTION:DES
-EVP_des_ede3                            303	EXIST::FUNCTION:DES
-EVP_des_ede3_cbc                        304	EXIST::FUNCTION:DES
-EVP_des_ede3_cfb64                      305	EXIST::FUNCTION:DES
-EVP_des_ede3_ofb                        306	EXIST::FUNCTION:DES
-EVP_des_ede_cbc                         307	EXIST::FUNCTION:DES
-EVP_des_ede_cfb64                       308	EXIST::FUNCTION:DES
-EVP_des_ede_ofb                         309	EXIST::FUNCTION:DES
-EVP_des_ofb                             310	EXIST::FUNCTION:DES
-EVP_desx_cbc                            311	EXIST::FUNCTION:DES
-EVP_dss                                 312	EXIST::FUNCTION:DSA,SHA
-EVP_dss1                                313	EXIST::FUNCTION:DSA,SHA
-EVP_enc_null                            314	EXIST::FUNCTION:
-EVP_get_cipherbyname                    315	EXIST::FUNCTION:
-EVP_get_digestbyname                    316	EXIST::FUNCTION:
-EVP_get_pw_prompt                       317	EXIST::FUNCTION:
-EVP_idea_cbc                            318	EXIST::FUNCTION:IDEA
-EVP_idea_cfb64                          319	EXIST::FUNCTION:IDEA
-EVP_idea_ecb                            320	EXIST::FUNCTION:IDEA
-EVP_idea_ofb                            321	EXIST::FUNCTION:IDEA
-EVP_md2                                 322	EXIST::FUNCTION:MD2
-EVP_md5                                 323	EXIST::FUNCTION:MD5
-EVP_md_null                             324	EXIST::FUNCTION:
-EVP_rc2_cbc                             325	EXIST::FUNCTION:RC2
-EVP_rc2_cfb64                           326	EXIST::FUNCTION:RC2
-EVP_rc2_ecb                             327	EXIST::FUNCTION:RC2
-EVP_rc2_ofb                             328	EXIST::FUNCTION:RC2
-EVP_rc4                                 329	EXIST::FUNCTION:RC4
-EVP_read_pw_string                      330	EXIST::FUNCTION:
-EVP_set_pw_prompt                       331	EXIST::FUNCTION:
-EVP_sha                                 332	EXIST::FUNCTION:SHA
-EVP_sha1                                333	EXIST::FUNCTION:SHA
-MD2                                     334	EXIST::FUNCTION:MD2
-MD2_Final                               335	EXIST::FUNCTION:MD2
-MD2_Init                                336	EXIST::FUNCTION:MD2
-MD2_Update                              337	EXIST::FUNCTION:MD2
-MD2_options                             338	EXIST::FUNCTION:MD2
-MD5                                     339	EXIST::FUNCTION:MD5
-MD5_Final                               340	EXIST::FUNCTION:MD5
-MD5_Init                                341	EXIST::FUNCTION:MD5
-MD5_Update                              342	EXIST::FUNCTION:MD5
-MDC2                                    343	EXIST::FUNCTION:MDC2
-MDC2_Final                              344	EXIST::FUNCTION:MDC2
-MDC2_Init                               345	EXIST::FUNCTION:MDC2
-MDC2_Update                             346	EXIST::FUNCTION:MDC2
-NETSCAPE_SPKAC_free                     347	EXIST::FUNCTION:
-NETSCAPE_SPKAC_new                      348	EXIST::FUNCTION:
-NETSCAPE_SPKI_free                      349	EXIST::FUNCTION:
-NETSCAPE_SPKI_new                       350	EXIST::FUNCTION:
-NETSCAPE_SPKI_sign                      351	EXIST::FUNCTION:EVP
-NETSCAPE_SPKI_verify                    352	EXIST::FUNCTION:EVP
-OBJ_add_object                          353	EXIST::FUNCTION:
-OBJ_bsearch                             354	EXIST::FUNCTION:
-OBJ_cleanup                             355	EXIST::FUNCTION:
-OBJ_cmp                                 356	EXIST::FUNCTION:
-OBJ_create                              357	EXIST::FUNCTION:
-OBJ_dup                                 358	EXIST::FUNCTION:
-OBJ_ln2nid                              359	EXIST::FUNCTION:
-OBJ_new_nid                             360	EXIST::FUNCTION:
-OBJ_nid2ln                              361	EXIST::FUNCTION:
-OBJ_nid2obj                             362	EXIST::FUNCTION:
-OBJ_nid2sn                              363	EXIST::FUNCTION:
-OBJ_obj2nid                             364	EXIST::FUNCTION:
-OBJ_sn2nid                              365	EXIST::FUNCTION:
-OBJ_txt2nid                             366	EXIST::FUNCTION:
-PEM_ASN1_read                           367	EXIST:!WIN16:FUNCTION:
-PEM_ASN1_read_bio                       368	EXIST::FUNCTION:BIO
-PEM_ASN1_write                          369	EXIST:!WIN16:FUNCTION:
-PEM_ASN1_write_bio                      370	EXIST::FUNCTION:BIO
-PEM_SealFinal                           371	EXIST::FUNCTION:RSA
-PEM_SealInit                            372	EXIST::FUNCTION:RSA
-PEM_SealUpdate                          373	EXIST::FUNCTION:RSA
-PEM_SignFinal                           374	EXIST::FUNCTION:
-PEM_SignInit                            375	EXIST::FUNCTION:
-PEM_SignUpdate                          376	EXIST::FUNCTION:
-PEM_X509_INFO_read                      377	EXIST:!WIN16:FUNCTION:
-PEM_X509_INFO_read_bio                  378	EXIST::FUNCTION:BIO
-PEM_X509_INFO_write_bio                 379	EXIST::FUNCTION:BIO
-PEM_dek_info                            380	EXIST::FUNCTION:
-PEM_do_header                           381	EXIST::FUNCTION:
-PEM_get_EVP_CIPHER_INFO                 382	EXIST::FUNCTION:
-PEM_proc_type                           383	EXIST::FUNCTION:
-PEM_read                                384	EXIST:!WIN16:FUNCTION:
-PEM_read_DHparams                       385	EXIST:!WIN16:FUNCTION:DH
-PEM_read_DSAPrivateKey                  386	EXIST:!WIN16:FUNCTION:DSA
-PEM_read_DSAparams                      387	EXIST:!WIN16:FUNCTION:DSA
-PEM_read_PKCS7                          388	EXIST:!WIN16:FUNCTION:
-PEM_read_PrivateKey                     389	EXIST:!WIN16:FUNCTION:
-PEM_read_RSAPrivateKey                  390	EXIST:!WIN16:FUNCTION:RSA
-PEM_read_X509                           391	EXIST:!WIN16:FUNCTION:
-PEM_read_X509_CRL                       392	EXIST:!WIN16:FUNCTION:
-PEM_read_X509_REQ                       393	EXIST:!WIN16:FUNCTION:
-PEM_read_bio                            394	EXIST::FUNCTION:BIO
-PEM_read_bio_DHparams                   395	EXIST::FUNCTION:DH
-PEM_read_bio_DSAPrivateKey              396	EXIST::FUNCTION:DSA
-PEM_read_bio_DSAparams                  397	EXIST::FUNCTION:DSA
-PEM_read_bio_PKCS7                      398	EXIST::FUNCTION:
-PEM_read_bio_PrivateKey                 399	EXIST::FUNCTION:
-PEM_read_bio_RSAPrivateKey              400	EXIST::FUNCTION:RSA
-PEM_read_bio_X509                       401	EXIST::FUNCTION:
-PEM_read_bio_X509_CRL                   402	EXIST::FUNCTION:
-PEM_read_bio_X509_REQ                   403	EXIST::FUNCTION:
-PEM_write                               404	EXIST:!WIN16:FUNCTION:
-PEM_write_DHparams                      405	EXIST:!WIN16:FUNCTION:DH
-PEM_write_DSAPrivateKey                 406	EXIST:!WIN16:FUNCTION:DSA
-PEM_write_DSAparams                     407	EXIST:!WIN16:FUNCTION:DSA
-PEM_write_PKCS7                         408	EXIST:!WIN16:FUNCTION:
-PEM_write_PrivateKey                    409	EXIST:!WIN16:FUNCTION:
-PEM_write_RSAPrivateKey                 410	EXIST:!WIN16:FUNCTION:RSA
-PEM_write_X509                          411	EXIST:!WIN16:FUNCTION:
-PEM_write_X509_CRL                      412	EXIST:!WIN16:FUNCTION:
-PEM_write_X509_REQ                      413	EXIST:!WIN16:FUNCTION:
-PEM_write_bio                           414	EXIST::FUNCTION:BIO
-PEM_write_bio_DHparams                  415	EXIST::FUNCTION:DH
-PEM_write_bio_DSAPrivateKey             416	EXIST::FUNCTION:DSA
-PEM_write_bio_DSAparams                 417	EXIST::FUNCTION:DSA
-PEM_write_bio_PKCS7                     418	EXIST::FUNCTION:
-PEM_write_bio_PrivateKey                419	EXIST::FUNCTION:
-PEM_write_bio_RSAPrivateKey             420	EXIST::FUNCTION:RSA
-PEM_write_bio_X509                      421	EXIST::FUNCTION:
-PEM_write_bio_X509_CRL                  422	EXIST::FUNCTION:
-PEM_write_bio_X509_REQ                  423	EXIST::FUNCTION:
-PKCS7_DIGEST_free                       424	EXIST::FUNCTION:
-PKCS7_DIGEST_new                        425	EXIST::FUNCTION:
-PKCS7_ENCRYPT_free                      426	EXIST::FUNCTION:
-PKCS7_ENCRYPT_new                       427	EXIST::FUNCTION:
-PKCS7_ENC_CONTENT_free                  428	EXIST::FUNCTION:
-PKCS7_ENC_CONTENT_new                   429	EXIST::FUNCTION:
-PKCS7_ENVELOPE_free                     430	EXIST::FUNCTION:
-PKCS7_ENVELOPE_new                      431	EXIST::FUNCTION:
-PKCS7_ISSUER_AND_SERIAL_digest          432	EXIST::FUNCTION:
-PKCS7_ISSUER_AND_SERIAL_free            433	EXIST::FUNCTION:
-PKCS7_ISSUER_AND_SERIAL_new             434	EXIST::FUNCTION:
-PKCS7_RECIP_INFO_free                   435	EXIST::FUNCTION:
-PKCS7_RECIP_INFO_new                    436	EXIST::FUNCTION:
-PKCS7_SIGNED_free                       437	EXIST::FUNCTION:
-PKCS7_SIGNED_new                        438	EXIST::FUNCTION:
-PKCS7_SIGNER_INFO_free                  439	EXIST::FUNCTION:
-PKCS7_SIGNER_INFO_new                   440	EXIST::FUNCTION:
-PKCS7_SIGN_ENVELOPE_free                441	EXIST::FUNCTION:
-PKCS7_SIGN_ENVELOPE_new                 442	EXIST::FUNCTION:
-PKCS7_dup                               443	EXIST::FUNCTION:
-PKCS7_free                              444	EXIST::FUNCTION:
-PKCS7_new                               445	EXIST::FUNCTION:
-PROXY_ENTRY_add_noproxy                 446	NOEXIST::FUNCTION:
-PROXY_ENTRY_clear_noproxy               447	NOEXIST::FUNCTION:
-PROXY_ENTRY_free                        448	NOEXIST::FUNCTION:
-PROXY_ENTRY_get_noproxy                 449	NOEXIST::FUNCTION:
-PROXY_ENTRY_new                         450	NOEXIST::FUNCTION:
-PROXY_ENTRY_set_server                  451	NOEXIST::FUNCTION:
-PROXY_add_noproxy                       452	NOEXIST::FUNCTION:
-PROXY_add_server                        453	NOEXIST::FUNCTION:
-PROXY_check_by_host                     454	NOEXIST::FUNCTION:
-PROXY_check_url                         455	NOEXIST::FUNCTION:
-PROXY_clear_noproxy                     456	NOEXIST::FUNCTION:
-PROXY_free                              457	NOEXIST::FUNCTION:
-PROXY_get_noproxy                       458	NOEXIST::FUNCTION:
-PROXY_get_proxies                       459	NOEXIST::FUNCTION:
-PROXY_get_proxy_entry                   460	NOEXIST::FUNCTION:
-PROXY_load_conf                         461	NOEXIST::FUNCTION:
-PROXY_new                               462	NOEXIST::FUNCTION:
-PROXY_print                             463	NOEXIST::FUNCTION:
-RAND_bytes                              464	EXIST::FUNCTION:
-RAND_cleanup                            465	EXIST::FUNCTION:
-RAND_file_name                          466	EXIST::FUNCTION:
-RAND_load_file                          467	EXIST::FUNCTION:
-RAND_screen                             468	EXIST:WIN32:FUNCTION:
-RAND_seed                               469	EXIST::FUNCTION:
-RAND_write_file                         470	EXIST::FUNCTION:
-RC2_cbc_encrypt                         471	EXIST::FUNCTION:RC2
-RC2_cfb64_encrypt                       472	EXIST::FUNCTION:RC2
-RC2_ecb_encrypt                         473	EXIST::FUNCTION:RC2
-RC2_encrypt                             474	EXIST::FUNCTION:RC2
-RC2_ofb64_encrypt                       475	EXIST::FUNCTION:RC2
-RC2_set_key                             476	EXIST::FUNCTION:RC2
-RC4                                     477	EXIST::FUNCTION:RC4
-RC4_options                             478	EXIST::FUNCTION:RC4
-RC4_set_key                             479	EXIST::FUNCTION:RC4
-RSAPrivateKey_asn1_meth                 480	EXIST::FUNCTION:RSA
-RSAPrivateKey_dup                       481	EXIST::FUNCTION:RSA
-RSAPublicKey_dup                        482	EXIST::FUNCTION:RSA
-RSA_PKCS1_SSLeay                        483	EXIST::FUNCTION:RSA
-RSA_free                                484	EXIST::FUNCTION:RSA
-RSA_generate_key                        485	EXIST::FUNCTION:RSA
-RSA_new                                 486	EXIST::FUNCTION:RSA
-RSA_new_method                          487	EXIST::FUNCTION:RSA
-RSA_print                               488	EXIST::FUNCTION:BIO,RSA
-RSA_print_fp                            489	EXIST::FUNCTION:FP_API,RSA
-RSA_private_decrypt                     490	EXIST::FUNCTION:RSA
-RSA_private_encrypt                     491	EXIST::FUNCTION:RSA
-RSA_public_decrypt                      492	EXIST::FUNCTION:RSA
-RSA_public_encrypt                      493	EXIST::FUNCTION:RSA
-RSA_set_default_method                  494	EXIST::FUNCTION:RSA
-RSA_sign                                495	EXIST::FUNCTION:RSA
-RSA_sign_ASN1_OCTET_STRING              496	EXIST::FUNCTION:RSA
-RSA_size                                497	EXIST::FUNCTION:RSA
-RSA_verify                              498	EXIST::FUNCTION:RSA
-RSA_verify_ASN1_OCTET_STRING            499	EXIST::FUNCTION:RSA
-SHA                                     500	EXIST::FUNCTION:SHA,SHA0
-SHA1                                    501	EXIST::FUNCTION:SHA,SHA1
-SHA1_Final                              502	EXIST::FUNCTION:SHA,SHA1
-SHA1_Init                               503	EXIST::FUNCTION:SHA,SHA1
-SHA1_Update                             504	EXIST::FUNCTION:SHA,SHA1
-SHA_Final                               505	EXIST::FUNCTION:SHA,SHA0
-SHA_Init                                506	EXIST::FUNCTION:SHA,SHA0
-SHA_Update                              507	EXIST::FUNCTION:SHA,SHA0
-OpenSSL_add_all_algorithms              508	NOEXIST::FUNCTION:
-OpenSSL_add_all_ciphers                 509	EXIST::FUNCTION:
-OpenSSL_add_all_digests                 510	EXIST::FUNCTION:
-TXT_DB_create_index                     511	EXIST::FUNCTION:
-TXT_DB_free                             512	EXIST::FUNCTION:
-TXT_DB_get_by_index                     513	EXIST::FUNCTION:
-TXT_DB_insert                           514	EXIST::FUNCTION:
-TXT_DB_read                             515	EXIST::FUNCTION:BIO
-TXT_DB_write                            516	EXIST::FUNCTION:BIO
-X509_ALGOR_free                         517	EXIST::FUNCTION:
-X509_ALGOR_new                          518	EXIST::FUNCTION:
-X509_ATTRIBUTE_free                     519	EXIST::FUNCTION:
-X509_ATTRIBUTE_new                      520	EXIST::FUNCTION:
-X509_CINF_free                          521	EXIST::FUNCTION:
-X509_CINF_new                           522	EXIST::FUNCTION:
-X509_CRL_INFO_free                      523	EXIST::FUNCTION:
-X509_CRL_INFO_new                       524	EXIST::FUNCTION:
-X509_CRL_add_ext                        525	EXIST::FUNCTION:
-X509_CRL_cmp                            526	EXIST::FUNCTION:
-X509_CRL_delete_ext                     527	EXIST::FUNCTION:
-X509_CRL_dup                            528	EXIST::FUNCTION:
-X509_CRL_free                           529	EXIST::FUNCTION:
-X509_CRL_get_ext                        530	EXIST::FUNCTION:
-X509_CRL_get_ext_by_NID                 531	EXIST::FUNCTION:
-X509_CRL_get_ext_by_OBJ                 532	EXIST::FUNCTION:
-X509_CRL_get_ext_by_critical            533	EXIST::FUNCTION:
-X509_CRL_get_ext_count                  534	EXIST::FUNCTION:
-X509_CRL_new                            535	EXIST::FUNCTION:
-X509_CRL_sign                           536	EXIST::FUNCTION:EVP
-X509_CRL_verify                         537	EXIST::FUNCTION:EVP
-X509_EXTENSION_create_by_NID            538	EXIST::FUNCTION:
-X509_EXTENSION_create_by_OBJ            539	EXIST::FUNCTION:
-X509_EXTENSION_dup                      540	EXIST::FUNCTION:
-X509_EXTENSION_free                     541	EXIST::FUNCTION:
-X509_EXTENSION_get_critical             542	EXIST::FUNCTION:
-X509_EXTENSION_get_data                 543	EXIST::FUNCTION:
-X509_EXTENSION_get_object               544	EXIST::FUNCTION:
-X509_EXTENSION_new                      545	EXIST::FUNCTION:
-X509_EXTENSION_set_critical             546	EXIST::FUNCTION:
-X509_EXTENSION_set_data                 547	EXIST::FUNCTION:
-X509_EXTENSION_set_object               548	EXIST::FUNCTION:
-X509_INFO_free                          549	EXIST::FUNCTION:EVP
-X509_INFO_new                           550	EXIST::FUNCTION:EVP
-X509_LOOKUP_by_alias                    551	EXIST::FUNCTION:
-X509_LOOKUP_by_fingerprint              552	EXIST::FUNCTION:
-X509_LOOKUP_by_issuer_serial            553	EXIST::FUNCTION:
-X509_LOOKUP_by_subject                  554	EXIST::FUNCTION:
-X509_LOOKUP_ctrl                        555	EXIST::FUNCTION:
-X509_LOOKUP_file                        556	EXIST::FUNCTION:
-X509_LOOKUP_free                        557	EXIST::FUNCTION:
-X509_LOOKUP_hash_dir                    558	EXIST::FUNCTION:
-X509_LOOKUP_init                        559	EXIST::FUNCTION:
-X509_LOOKUP_new                         560	EXIST::FUNCTION:
-X509_LOOKUP_shutdown                    561	EXIST::FUNCTION:
-X509_NAME_ENTRY_create_by_NID           562	EXIST::FUNCTION:
-X509_NAME_ENTRY_create_by_OBJ           563	EXIST::FUNCTION:
-X509_NAME_ENTRY_dup                     564	EXIST::FUNCTION:
-X509_NAME_ENTRY_free                    565	EXIST::FUNCTION:
-X509_NAME_ENTRY_get_data                566	EXIST::FUNCTION:
-X509_NAME_ENTRY_get_object              567	EXIST::FUNCTION:
-X509_NAME_ENTRY_new                     568	EXIST::FUNCTION:
-X509_NAME_ENTRY_set_data                569	EXIST::FUNCTION:
-X509_NAME_ENTRY_set_object              570	EXIST::FUNCTION:
-X509_NAME_add_entry                     571	EXIST::FUNCTION:
-X509_NAME_cmp                           572	EXIST::FUNCTION:
-X509_NAME_delete_entry                  573	EXIST::FUNCTION:
-X509_NAME_digest                        574	EXIST::FUNCTION:EVP
-X509_NAME_dup                           575	EXIST::FUNCTION:
-X509_NAME_entry_count                   576	EXIST::FUNCTION:
-X509_NAME_free                          577	EXIST::FUNCTION:
-X509_NAME_get_entry                     578	EXIST::FUNCTION:
-X509_NAME_get_index_by_NID              579	EXIST::FUNCTION:
-X509_NAME_get_index_by_OBJ              580	EXIST::FUNCTION:
-X509_NAME_get_text_by_NID               581	EXIST::FUNCTION:
-X509_NAME_get_text_by_OBJ               582	EXIST::FUNCTION:
-X509_NAME_hash                          583	EXIST::FUNCTION:
-X509_NAME_new                           584	EXIST::FUNCTION:
-X509_NAME_oneline                       585	EXIST::FUNCTION:EVP
-X509_NAME_print                         586	EXIST::FUNCTION:BIO
-X509_NAME_set                           587	EXIST::FUNCTION:
-X509_OBJECT_free_contents               588	EXIST::FUNCTION:
-X509_OBJECT_retrieve_by_subject         589	EXIST::FUNCTION:
-X509_OBJECT_up_ref_count                590	EXIST::FUNCTION:
-X509_PKEY_free                          591	EXIST::FUNCTION:
-X509_PKEY_new                           592	EXIST::FUNCTION:
-X509_PUBKEY_free                        593	EXIST::FUNCTION:
-X509_PUBKEY_get                         594	EXIST::FUNCTION:
-X509_PUBKEY_new                         595	EXIST::FUNCTION:
-X509_PUBKEY_set                         596	EXIST::FUNCTION:
-X509_REQ_INFO_free                      597	EXIST::FUNCTION:
-X509_REQ_INFO_new                       598	EXIST::FUNCTION:
-X509_REQ_dup                            599	EXIST::FUNCTION:
-X509_REQ_free                           600	EXIST::FUNCTION:
-X509_REQ_get_pubkey                     601	EXIST::FUNCTION:
-X509_REQ_new                            602	EXIST::FUNCTION:
-X509_REQ_print                          603	EXIST::FUNCTION:BIO
-X509_REQ_print_fp                       604	EXIST::FUNCTION:FP_API
-X509_REQ_set_pubkey                     605	EXIST::FUNCTION:
-X509_REQ_set_subject_name               606	EXIST::FUNCTION:
-X509_REQ_set_version                    607	EXIST::FUNCTION:
-X509_REQ_sign                           608	EXIST::FUNCTION:EVP
-X509_REQ_to_X509                        609	EXIST::FUNCTION:
-X509_REQ_verify                         610	EXIST::FUNCTION:EVP
-X509_REVOKED_add_ext                    611	EXIST::FUNCTION:
-X509_REVOKED_delete_ext                 612	EXIST::FUNCTION:
-X509_REVOKED_free                       613	EXIST::FUNCTION:
-X509_REVOKED_get_ext                    614	EXIST::FUNCTION:
-X509_REVOKED_get_ext_by_NID             615	EXIST::FUNCTION:
-X509_REVOKED_get_ext_by_OBJ             616	EXIST::FUNCTION:
-X509_REVOKED_get_ext_by_critical        617	EXIST:!VMS:FUNCTION:
-X509_REVOKED_get_ext_by_critic          617	EXIST:VMS:FUNCTION:
-X509_REVOKED_get_ext_count              618	EXIST::FUNCTION:
-X509_REVOKED_new                        619	EXIST::FUNCTION:
-X509_SIG_free                           620	EXIST::FUNCTION:
-X509_SIG_new                            621	EXIST::FUNCTION:
-X509_STORE_CTX_cleanup                  622	EXIST::FUNCTION:
-X509_STORE_CTX_init                     623	EXIST::FUNCTION:
-X509_STORE_add_cert                     624	EXIST::FUNCTION:
-X509_STORE_add_lookup                   625	EXIST::FUNCTION:
-X509_STORE_free                         626	EXIST::FUNCTION:
-X509_STORE_get_by_subject               627	EXIST::FUNCTION:
-X509_STORE_load_locations               628	EXIST::FUNCTION:STDIO
-X509_STORE_new                          629	EXIST::FUNCTION:
-X509_STORE_set_default_paths            630	EXIST::FUNCTION:STDIO
-X509_VAL_free                           631	EXIST::FUNCTION:
-X509_VAL_new                            632	EXIST::FUNCTION:
-X509_add_ext                            633	EXIST::FUNCTION:
-X509_asn1_meth                          634	EXIST::FUNCTION:
-X509_certificate_type                   635	EXIST::FUNCTION:
-X509_check_private_key                  636	EXIST::FUNCTION:
-X509_cmp_current_time                   637	EXIST::FUNCTION:
-X509_delete_ext                         638	EXIST::FUNCTION:
-X509_digest                             639	EXIST::FUNCTION:EVP
-X509_dup                                640	EXIST::FUNCTION:
-X509_free                               641	EXIST::FUNCTION:
-X509_get_default_cert_area              642	EXIST::FUNCTION:
-X509_get_default_cert_dir               643	EXIST::FUNCTION:
-X509_get_default_cert_dir_env           644	EXIST::FUNCTION:
-X509_get_default_cert_file              645	EXIST::FUNCTION:
-X509_get_default_cert_file_env          646	EXIST::FUNCTION:
-X509_get_default_private_dir            647	EXIST::FUNCTION:
-X509_get_ext                            648	EXIST::FUNCTION:
-X509_get_ext_by_NID                     649	EXIST::FUNCTION:
-X509_get_ext_by_OBJ                     650	EXIST::FUNCTION:
-X509_get_ext_by_critical                651	EXIST::FUNCTION:
-X509_get_ext_count                      652	EXIST::FUNCTION:
-X509_get_issuer_name                    653	EXIST::FUNCTION:
-X509_get_pubkey                         654	EXIST::FUNCTION:
-X509_get_pubkey_parameters              655	EXIST::FUNCTION:
-X509_get_serialNumber                   656	EXIST::FUNCTION:
-X509_get_subject_name                   657	EXIST::FUNCTION:
-X509_gmtime_adj                         658	EXIST::FUNCTION:
-X509_issuer_and_serial_cmp              659	EXIST::FUNCTION:
-X509_issuer_and_serial_hash             660	EXIST::FUNCTION:
-X509_issuer_name_cmp                    661	EXIST::FUNCTION:
-X509_issuer_name_hash                   662	EXIST::FUNCTION:
-X509_load_cert_file                     663	EXIST::FUNCTION:STDIO
-X509_new                                664	EXIST::FUNCTION:
-X509_print                              665	EXIST::FUNCTION:BIO
-X509_print_fp                           666	EXIST::FUNCTION:FP_API
-X509_set_issuer_name                    667	EXIST::FUNCTION:
-X509_set_notAfter                       668	EXIST::FUNCTION:
-X509_set_notBefore                      669	EXIST::FUNCTION:
-X509_set_pubkey                         670	EXIST::FUNCTION:
-X509_set_serialNumber                   671	EXIST::FUNCTION:
-X509_set_subject_name                   672	EXIST::FUNCTION:
-X509_set_version                        673	EXIST::FUNCTION:
-X509_sign                               674	EXIST::FUNCTION:EVP
-X509_subject_name_cmp                   675	EXIST::FUNCTION:
-X509_subject_name_hash                  676	EXIST::FUNCTION:
-X509_to_X509_REQ                        677	EXIST::FUNCTION:
-X509_verify                             678	EXIST::FUNCTION:EVP
-X509_verify_cert                        679	EXIST::FUNCTION:
-X509_verify_cert_error_string           680	EXIST::FUNCTION:
-X509v3_add_ext                          681	EXIST::FUNCTION:
-X509v3_add_extension                    682	NOEXIST::FUNCTION:
-X509v3_add_netscape_extensions          683	NOEXIST::FUNCTION:
-X509v3_add_standard_extensions          684	NOEXIST::FUNCTION:
-X509v3_cleanup_extensions               685	NOEXIST::FUNCTION:
-X509v3_data_type_by_NID                 686	NOEXIST::FUNCTION:
-X509v3_data_type_by_OBJ                 687	NOEXIST::FUNCTION:
-X509v3_delete_ext                       688	EXIST::FUNCTION:
-X509v3_get_ext                          689	EXIST::FUNCTION:
-X509v3_get_ext_by_NID                   690	EXIST::FUNCTION:
-X509v3_get_ext_by_OBJ                   691	EXIST::FUNCTION:
-X509v3_get_ext_by_critical              692	EXIST::FUNCTION:
-X509v3_get_ext_count                    693	EXIST::FUNCTION:
-X509v3_pack_string                      694	NOEXIST::FUNCTION:
-X509v3_pack_type_by_NID                 695	NOEXIST::FUNCTION:
-X509v3_pack_type_by_OBJ                 696	NOEXIST::FUNCTION:
-X509v3_unpack_string                    697	NOEXIST::FUNCTION:
-_des_crypt                              698	NOEXIST::FUNCTION:
-a2d_ASN1_OBJECT                         699	EXIST::FUNCTION:
-a2i_ASN1_INTEGER                        700	EXIST::FUNCTION:BIO
-a2i_ASN1_STRING                         701	EXIST::FUNCTION:BIO
-asn1_Finish                             702	EXIST::FUNCTION:
-asn1_GetSequence                        703	EXIST::FUNCTION:
-bn_div_words                            704	EXIST::FUNCTION:
-bn_expand2                              705	EXIST::FUNCTION:
-bn_mul_add_words                        706	EXIST::FUNCTION:
-bn_mul_words                            707	EXIST::FUNCTION:
-BN_uadd                                 708	EXIST::FUNCTION:
-BN_usub                                 709	EXIST::FUNCTION:
-bn_sqr_words                            710	EXIST::FUNCTION:
-_ossl_old_crypt                         711	EXIST:!NeXT,!PERL5:FUNCTION:DES
-d2i_ASN1_BIT_STRING                     712	EXIST::FUNCTION:
-d2i_ASN1_BOOLEAN                        713	EXIST::FUNCTION:
-d2i_ASN1_HEADER                         714	EXIST::FUNCTION:
-d2i_ASN1_IA5STRING                      715	EXIST::FUNCTION:
-d2i_ASN1_INTEGER                        716	EXIST::FUNCTION:
-d2i_ASN1_OBJECT                         717	EXIST::FUNCTION:
-d2i_ASN1_OCTET_STRING                   718	EXIST::FUNCTION:
-d2i_ASN1_PRINTABLE                      719	EXIST::FUNCTION:
-d2i_ASN1_PRINTABLESTRING                720	EXIST::FUNCTION:
-d2i_ASN1_SET                            721	EXIST::FUNCTION:
-d2i_ASN1_T61STRING                      722	EXIST::FUNCTION:
-d2i_ASN1_TYPE                           723	EXIST::FUNCTION:
-d2i_ASN1_UTCTIME                        724	EXIST::FUNCTION:
-d2i_ASN1_bytes                          725	EXIST::FUNCTION:
-d2i_ASN1_type_bytes                     726	EXIST::FUNCTION:
-d2i_DHparams                            727	EXIST::FUNCTION:DH
-d2i_DSAPrivateKey                       728	EXIST::FUNCTION:DSA
-d2i_DSAPrivateKey_bio                   729	EXIST::FUNCTION:BIO,DSA
-d2i_DSAPrivateKey_fp                    730	EXIST::FUNCTION:DSA,FP_API
-d2i_DSAPublicKey                        731	EXIST::FUNCTION:DSA
-d2i_DSAparams                           732	EXIST::FUNCTION:DSA
-d2i_NETSCAPE_SPKAC                      733	EXIST::FUNCTION:
-d2i_NETSCAPE_SPKI                       734	EXIST::FUNCTION:
-d2i_Netscape_RSA                        735	EXIST::FUNCTION:RSA
-d2i_PKCS7                               736	EXIST::FUNCTION:
-d2i_PKCS7_DIGEST                        737	EXIST::FUNCTION:
-d2i_PKCS7_ENCRYPT                       738	EXIST::FUNCTION:
-d2i_PKCS7_ENC_CONTENT                   739	EXIST::FUNCTION:
-d2i_PKCS7_ENVELOPE                      740	EXIST::FUNCTION:
-d2i_PKCS7_ISSUER_AND_SERIAL             741	EXIST::FUNCTION:
-d2i_PKCS7_RECIP_INFO                    742	EXIST::FUNCTION:
-d2i_PKCS7_SIGNED                        743	EXIST::FUNCTION:
-d2i_PKCS7_SIGNER_INFO                   744	EXIST::FUNCTION:
-d2i_PKCS7_SIGN_ENVELOPE                 745	EXIST::FUNCTION:
-d2i_PKCS7_bio                           746	EXIST::FUNCTION:
-d2i_PKCS7_fp                            747	EXIST::FUNCTION:FP_API
-d2i_PrivateKey                          748	EXIST::FUNCTION:
-d2i_PublicKey                           749	EXIST::FUNCTION:
-d2i_RSAPrivateKey                       750	EXIST::FUNCTION:RSA
-d2i_RSAPrivateKey_bio                   751	EXIST::FUNCTION:BIO,RSA
-d2i_RSAPrivateKey_fp                    752	EXIST::FUNCTION:FP_API,RSA
-d2i_RSAPublicKey                        753	EXIST::FUNCTION:RSA
-d2i_X509                                754	EXIST::FUNCTION:
-d2i_X509_ALGOR                          755	EXIST::FUNCTION:
-d2i_X509_ATTRIBUTE                      756	EXIST::FUNCTION:
-d2i_X509_CINF                           757	EXIST::FUNCTION:
-d2i_X509_CRL                            758	EXIST::FUNCTION:
-d2i_X509_CRL_INFO                       759	EXIST::FUNCTION:
-d2i_X509_CRL_bio                        760	EXIST::FUNCTION:BIO
-d2i_X509_CRL_fp                         761	EXIST::FUNCTION:FP_API
-d2i_X509_EXTENSION                      762	EXIST::FUNCTION:
-d2i_X509_NAME                           763	EXIST::FUNCTION:
-d2i_X509_NAME_ENTRY                     764	EXIST::FUNCTION:
-d2i_X509_PKEY                           765	EXIST::FUNCTION:
-d2i_X509_PUBKEY                         766	EXIST::FUNCTION:
-d2i_X509_REQ                            767	EXIST::FUNCTION:
-d2i_X509_REQ_INFO                       768	EXIST::FUNCTION:
-d2i_X509_REQ_bio                        769	EXIST::FUNCTION:BIO
-d2i_X509_REQ_fp                         770	EXIST::FUNCTION:FP_API
-d2i_X509_REVOKED                        771	EXIST::FUNCTION:
-d2i_X509_SIG                            772	EXIST::FUNCTION:
-d2i_X509_VAL                            773	EXIST::FUNCTION:
-d2i_X509_bio                            774	EXIST::FUNCTION:BIO
-d2i_X509_fp                             775	EXIST::FUNCTION:FP_API
-DES_cbc_cksum                           777	EXIST::FUNCTION:DES
-DES_cbc_encrypt                         778	EXIST::FUNCTION:DES
-DES_cblock_print_file                   779	NOEXIST::FUNCTION:
-DES_cfb64_encrypt                       780	EXIST::FUNCTION:DES
-DES_cfb_encrypt                         781	EXIST::FUNCTION:DES
-DES_decrypt3                            782	EXIST::FUNCTION:DES
-DES_ecb3_encrypt                        783	EXIST::FUNCTION:DES
-DES_ecb_encrypt                         784	EXIST::FUNCTION:DES
-DES_ede3_cbc_encrypt                    785	EXIST::FUNCTION:DES
-DES_ede3_cfb64_encrypt                  786	EXIST::FUNCTION:DES
-DES_ede3_ofb64_encrypt                  787	EXIST::FUNCTION:DES
-DES_enc_read                            788	EXIST::FUNCTION:DES
-DES_enc_write                           789	EXIST::FUNCTION:DES
-DES_encrypt1                            790	EXIST::FUNCTION:DES
-DES_encrypt2                            791	EXIST::FUNCTION:DES
-DES_encrypt3                            792	EXIST::FUNCTION:DES
-DES_fcrypt                              793	EXIST::FUNCTION:DES
-DES_is_weak_key                         794	EXIST::FUNCTION:DES
-DES_key_sched                           795	EXIST::FUNCTION:DES
-DES_ncbc_encrypt                        796	EXIST::FUNCTION:DES
-DES_ofb64_encrypt                       797	EXIST::FUNCTION:DES
-DES_ofb_encrypt                         798	EXIST::FUNCTION:DES
-DES_options                             799	EXIST::FUNCTION:DES
-DES_pcbc_encrypt                        800	EXIST::FUNCTION:DES
-DES_quad_cksum                          801	EXIST::FUNCTION:DES
-DES_random_key                          802	EXIST::FUNCTION:DES
-_ossl_old_des_random_seed               803	EXIST::FUNCTION:DES
-_ossl_old_des_read_2passwords           804	EXIST::FUNCTION:DES
-_ossl_old_des_read_password             805	EXIST::FUNCTION:DES
-_ossl_old_des_read_pw                   806	EXIST::FUNCTION:
-_ossl_old_des_read_pw_string            807	EXIST::FUNCTION:
-DES_set_key                             808	EXIST::FUNCTION:DES
-DES_set_odd_parity                      809	EXIST::FUNCTION:DES
-DES_string_to_2keys                     810	EXIST::FUNCTION:DES
-DES_string_to_key                       811	EXIST::FUNCTION:DES
-DES_xcbc_encrypt                        812	EXIST::FUNCTION:DES
-DES_xwhite_in2out                       813	EXIST::FUNCTION:DES
-fcrypt_body                             814	NOEXIST::FUNCTION:
-i2a_ASN1_INTEGER                        815	EXIST::FUNCTION:BIO
-i2a_ASN1_OBJECT                         816	EXIST::FUNCTION:BIO
-i2a_ASN1_STRING                         817	EXIST::FUNCTION:BIO
-i2d_ASN1_BIT_STRING                     818	EXIST::FUNCTION:
-i2d_ASN1_BOOLEAN                        819	EXIST::FUNCTION:
-i2d_ASN1_HEADER                         820	EXIST::FUNCTION:
-i2d_ASN1_IA5STRING                      821	EXIST::FUNCTION:
-i2d_ASN1_INTEGER                        822	EXIST::FUNCTION:
-i2d_ASN1_OBJECT                         823	EXIST::FUNCTION:
-i2d_ASN1_OCTET_STRING                   824	EXIST::FUNCTION:
-i2d_ASN1_PRINTABLE                      825	EXIST::FUNCTION:
-i2d_ASN1_SET                            826	EXIST::FUNCTION:
-i2d_ASN1_TYPE                           827	EXIST::FUNCTION:
-i2d_ASN1_UTCTIME                        828	EXIST::FUNCTION:
-i2d_ASN1_bytes                          829	EXIST::FUNCTION:
-i2d_DHparams                            830	EXIST::FUNCTION:DH
-i2d_DSAPrivateKey                       831	EXIST::FUNCTION:DSA
-i2d_DSAPrivateKey_bio                   832	EXIST::FUNCTION:BIO,DSA
-i2d_DSAPrivateKey_fp                    833	EXIST::FUNCTION:DSA,FP_API
-i2d_DSAPublicKey                        834	EXIST::FUNCTION:DSA
-i2d_DSAparams                           835	EXIST::FUNCTION:DSA
-i2d_NETSCAPE_SPKAC                      836	EXIST::FUNCTION:
-i2d_NETSCAPE_SPKI                       837	EXIST::FUNCTION:
-i2d_Netscape_RSA                        838	EXIST::FUNCTION:RSA
-i2d_PKCS7                               839	EXIST::FUNCTION:
-i2d_PKCS7_DIGEST                        840	EXIST::FUNCTION:
-i2d_PKCS7_ENCRYPT                       841	EXIST::FUNCTION:
-i2d_PKCS7_ENC_CONTENT                   842	EXIST::FUNCTION:
-i2d_PKCS7_ENVELOPE                      843	EXIST::FUNCTION:
-i2d_PKCS7_ISSUER_AND_SERIAL             844	EXIST::FUNCTION:
-i2d_PKCS7_RECIP_INFO                    845	EXIST::FUNCTION:
-i2d_PKCS7_SIGNED                        846	EXIST::FUNCTION:
-i2d_PKCS7_SIGNER_INFO                   847	EXIST::FUNCTION:
-i2d_PKCS7_SIGN_ENVELOPE                 848	EXIST::FUNCTION:
-i2d_PKCS7_bio                           849	EXIST::FUNCTION:
-i2d_PKCS7_fp                            850	EXIST::FUNCTION:FP_API
-i2d_PrivateKey                          851	EXIST::FUNCTION:
-i2d_PublicKey                           852	EXIST::FUNCTION:
-i2d_RSAPrivateKey                       853	EXIST::FUNCTION:RSA
-i2d_RSAPrivateKey_bio                   854	EXIST::FUNCTION:BIO,RSA
-i2d_RSAPrivateKey_fp                    855	EXIST::FUNCTION:FP_API,RSA
-i2d_RSAPublicKey                        856	EXIST::FUNCTION:RSA
-i2d_X509                                857	EXIST::FUNCTION:
-i2d_X509_ALGOR                          858	EXIST::FUNCTION:
-i2d_X509_ATTRIBUTE                      859	EXIST::FUNCTION:
-i2d_X509_CINF                           860	EXIST::FUNCTION:
-i2d_X509_CRL                            861	EXIST::FUNCTION:
-i2d_X509_CRL_INFO                       862	EXIST::FUNCTION:
-i2d_X509_CRL_bio                        863	EXIST::FUNCTION:BIO
-i2d_X509_CRL_fp                         864	EXIST::FUNCTION:FP_API
-i2d_X509_EXTENSION                      865	EXIST::FUNCTION:
-i2d_X509_NAME                           866	EXIST::FUNCTION:
-i2d_X509_NAME_ENTRY                     867	EXIST::FUNCTION:
-i2d_X509_PKEY                           868	EXIST::FUNCTION:
-i2d_X509_PUBKEY                         869	EXIST::FUNCTION:
-i2d_X509_REQ                            870	EXIST::FUNCTION:
-i2d_X509_REQ_INFO                       871	EXIST::FUNCTION:
-i2d_X509_REQ_bio                        872	EXIST::FUNCTION:BIO
-i2d_X509_REQ_fp                         873	EXIST::FUNCTION:FP_API
-i2d_X509_REVOKED                        874	EXIST::FUNCTION:
-i2d_X509_SIG                            875	EXIST::FUNCTION:
-i2d_X509_VAL                            876	EXIST::FUNCTION:
-i2d_X509_bio                            877	EXIST::FUNCTION:BIO
-i2d_X509_fp                             878	EXIST::FUNCTION:FP_API
-idea_cbc_encrypt                        879	EXIST::FUNCTION:IDEA
-idea_cfb64_encrypt                      880	EXIST::FUNCTION:IDEA
-idea_ecb_encrypt                        881	EXIST::FUNCTION:IDEA
-idea_encrypt                            882	EXIST::FUNCTION:IDEA
-idea_ofb64_encrypt                      883	EXIST::FUNCTION:IDEA
-idea_options                            884	EXIST::FUNCTION:IDEA
-idea_set_decrypt_key                    885	EXIST::FUNCTION:IDEA
-idea_set_encrypt_key                    886	EXIST::FUNCTION:IDEA
-lh_delete                               887	EXIST::FUNCTION:
-lh_doall                                888	EXIST::FUNCTION:
-lh_doall_arg                            889	EXIST::FUNCTION:
-lh_free                                 890	EXIST::FUNCTION:
-lh_insert                               891	EXIST::FUNCTION:
-lh_new                                  892	EXIST::FUNCTION:
-lh_node_stats                           893	EXIST::FUNCTION:FP_API
-lh_node_stats_bio                       894	EXIST::FUNCTION:BIO
-lh_node_usage_stats                     895	EXIST::FUNCTION:FP_API
-lh_node_usage_stats_bio                 896	EXIST::FUNCTION:BIO
-lh_retrieve                             897	EXIST::FUNCTION:
-lh_stats                                898	EXIST::FUNCTION:FP_API
-lh_stats_bio                            899	EXIST::FUNCTION:BIO
-lh_strhash                              900	EXIST::FUNCTION:
-sk_delete                               901	EXIST::FUNCTION:
-sk_delete_ptr                           902	EXIST::FUNCTION:
-sk_dup                                  903	EXIST::FUNCTION:
-sk_find                                 904	EXIST::FUNCTION:
-sk_free                                 905	EXIST::FUNCTION:
-sk_insert                               906	EXIST::FUNCTION:
-sk_new                                  907	EXIST::FUNCTION:
-sk_pop                                  908	EXIST::FUNCTION:
-sk_pop_free                             909	EXIST::FUNCTION:
-sk_push                                 910	EXIST::FUNCTION:
-sk_set_cmp_func                         911	EXIST::FUNCTION:
-sk_shift                                912	EXIST::FUNCTION:
-sk_unshift                              913	EXIST::FUNCTION:
-sk_zero                                 914	EXIST::FUNCTION:
-BIO_f_nbio_test                         915	EXIST::FUNCTION:
-ASN1_TYPE_get                           916	EXIST::FUNCTION:
-ASN1_TYPE_set                           917	EXIST::FUNCTION:
-PKCS7_content_free                      918	NOEXIST::FUNCTION:
-ERR_load_PKCS7_strings                  919	EXIST::FUNCTION:
-X509_find_by_issuer_and_serial          920	EXIST::FUNCTION:
-X509_find_by_subject                    921	EXIST::FUNCTION:
-PKCS7_ctrl                              927	EXIST::FUNCTION:
-PKCS7_set_type                          928	EXIST::FUNCTION:
-PKCS7_set_content                       929	EXIST::FUNCTION:
-PKCS7_SIGNER_INFO_set                   930	EXIST::FUNCTION:
-PKCS7_add_signer                        931	EXIST::FUNCTION:
-PKCS7_add_certificate                   932	EXIST::FUNCTION:
-PKCS7_add_crl                           933	EXIST::FUNCTION:
-PKCS7_content_new                       934	EXIST::FUNCTION:
-PKCS7_dataSign                          935	NOEXIST::FUNCTION:
-PKCS7_dataVerify                        936	EXIST::FUNCTION:
-PKCS7_dataInit                          937	EXIST::FUNCTION:
-PKCS7_add_signature                     938	EXIST::FUNCTION:
-PKCS7_cert_from_signer_info             939	EXIST::FUNCTION:
-PKCS7_get_signer_info                   940	EXIST::FUNCTION:
-EVP_delete_alias                        941	NOEXIST::FUNCTION:
-EVP_mdc2                                942	EXIST::FUNCTION:MDC2
-PEM_read_bio_RSAPublicKey               943	EXIST::FUNCTION:RSA
-PEM_write_bio_RSAPublicKey              944	EXIST::FUNCTION:RSA
-d2i_RSAPublicKey_bio                    945	EXIST::FUNCTION:BIO,RSA
-i2d_RSAPublicKey_bio                    946	EXIST::FUNCTION:BIO,RSA
-PEM_read_RSAPublicKey                   947	EXIST:!WIN16:FUNCTION:RSA
-PEM_write_RSAPublicKey                  949	EXIST:!WIN16:FUNCTION:RSA
-d2i_RSAPublicKey_fp                     952	EXIST::FUNCTION:FP_API,RSA
-i2d_RSAPublicKey_fp                     954	EXIST::FUNCTION:FP_API,RSA
-BIO_copy_next_retry                     955	EXIST::FUNCTION:
-RSA_flags                               956	EXIST::FUNCTION:RSA
-X509_STORE_add_crl                      957	EXIST::FUNCTION:
-X509_load_crl_file                      958	EXIST::FUNCTION:STDIO
-EVP_rc2_40_cbc                          959	EXIST::FUNCTION:RC2
-EVP_rc4_40                              960	EXIST::FUNCTION:RC4
-EVP_CIPHER_CTX_init                     961	EXIST::FUNCTION:
-HMAC                                    962	EXIST::FUNCTION:HMAC
-HMAC_Init                               963	EXIST::FUNCTION:HMAC
-HMAC_Update                             964	EXIST::FUNCTION:HMAC
-HMAC_Final                              965	EXIST::FUNCTION:HMAC
-ERR_get_next_error_library              966	EXIST::FUNCTION:
-EVP_PKEY_cmp_parameters                 967	EXIST::FUNCTION:
-HMAC_cleanup                            968	NOEXIST::FUNCTION:
-BIO_ptr_ctrl                            969	EXIST::FUNCTION:
-BIO_new_file_internal                   970	EXIST:WIN16:FUNCTION:FP_API
-BIO_new_fp_internal                     971	EXIST:WIN16:FUNCTION:FP_API
-BIO_s_file_internal                     972	EXIST:WIN16:FUNCTION:FP_API
-BN_BLINDING_convert                     973	EXIST::FUNCTION:
-BN_BLINDING_invert                      974	EXIST::FUNCTION:
-BN_BLINDING_update                      975	EXIST::FUNCTION:
-RSA_blinding_on                         977	EXIST::FUNCTION:RSA
-RSA_blinding_off                        978	EXIST::FUNCTION:RSA
-i2t_ASN1_OBJECT                         979	EXIST::FUNCTION:
-BN_BLINDING_new                         980	EXIST::FUNCTION:
-BN_BLINDING_free                        981	EXIST::FUNCTION:
-EVP_cast5_cbc                           983	EXIST::FUNCTION:CAST
-EVP_cast5_cfb64                         984	EXIST::FUNCTION:CAST
-EVP_cast5_ecb                           985	EXIST::FUNCTION:CAST
-EVP_cast5_ofb                           986	EXIST::FUNCTION:CAST
-BF_decrypt                              987	EXIST::FUNCTION:BF
-CAST_set_key                            988	EXIST::FUNCTION:CAST
-CAST_encrypt                            989	EXIST::FUNCTION:CAST
-CAST_decrypt                            990	EXIST::FUNCTION:CAST
-CAST_ecb_encrypt                        991	EXIST::FUNCTION:CAST
-CAST_cbc_encrypt                        992	EXIST::FUNCTION:CAST
-CAST_cfb64_encrypt                      993	EXIST::FUNCTION:CAST
-CAST_ofb64_encrypt                      994	EXIST::FUNCTION:CAST
-RC2_decrypt                             995	EXIST::FUNCTION:RC2
-OBJ_create_objects                      997	EXIST::FUNCTION:
-BN_exp                                  998	EXIST::FUNCTION:
-BN_mul_word                             999	EXIST::FUNCTION:
-BN_sub_word                             1000	EXIST::FUNCTION:
-BN_dec2bn                               1001	EXIST::FUNCTION:
-BN_bn2dec                               1002	EXIST::FUNCTION:
-BIO_ghbn_ctrl                           1003	NOEXIST::FUNCTION:
-CRYPTO_free_ex_data                     1004	EXIST::FUNCTION:
-CRYPTO_get_ex_data                      1005	EXIST::FUNCTION:
-CRYPTO_set_ex_data                      1007	EXIST::FUNCTION:
-ERR_load_CRYPTO_strings                 1009	EXIST:!OS2,!VMS,!WIN16:FUNCTION:
-ERR_load_CRYPTOlib_strings              1009	EXIST:OS2,VMS,WIN16:FUNCTION:
-EVP_PKEY_bits                           1010	EXIST::FUNCTION:
-MD5_Transform                           1011	EXIST::FUNCTION:MD5
-SHA1_Transform                          1012	EXIST::FUNCTION:SHA,SHA1
-SHA_Transform                           1013	EXIST::FUNCTION:SHA,SHA0
-X509_STORE_CTX_get_chain                1014	EXIST::FUNCTION:
-X509_STORE_CTX_get_current_cert         1015	EXIST::FUNCTION:
-X509_STORE_CTX_get_error                1016	EXIST::FUNCTION:
-X509_STORE_CTX_get_error_depth          1017	EXIST::FUNCTION:
-X509_STORE_CTX_get_ex_data              1018	EXIST::FUNCTION:
-X509_STORE_CTX_set_cert                 1020	EXIST::FUNCTION:
-X509_STORE_CTX_set_chain                1021	EXIST::FUNCTION:
-X509_STORE_CTX_set_error                1022	EXIST::FUNCTION:
-X509_STORE_CTX_set_ex_data              1023	EXIST::FUNCTION:
-CRYPTO_dup_ex_data                      1025	EXIST::FUNCTION:
-CRYPTO_get_new_lockid                   1026	EXIST::FUNCTION:
-CRYPTO_new_ex_data                      1027	EXIST::FUNCTION:
-RSA_set_ex_data                         1028	EXIST::FUNCTION:RSA
-RSA_get_ex_data                         1029	EXIST::FUNCTION:RSA
-RSA_get_ex_new_index                    1030	EXIST::FUNCTION:RSA
-RSA_padding_add_PKCS1_type_1            1031	EXIST::FUNCTION:RSA
-RSA_padding_add_PKCS1_type_2            1032	EXIST::FUNCTION:RSA
-RSA_padding_add_SSLv23                  1033	EXIST::FUNCTION:RSA
-RSA_padding_add_none                    1034	EXIST::FUNCTION:RSA
-RSA_padding_check_PKCS1_type_1          1035	EXIST::FUNCTION:RSA
-RSA_padding_check_PKCS1_type_2          1036	EXIST::FUNCTION:RSA
-RSA_padding_check_SSLv23                1037	EXIST::FUNCTION:RSA
-RSA_padding_check_none                  1038	EXIST::FUNCTION:RSA
-bn_add_words                            1039	EXIST::FUNCTION:
-d2i_Netscape_RSA_2                      1040	NOEXIST::FUNCTION:
-CRYPTO_get_ex_new_index                 1041	EXIST::FUNCTION:
-RIPEMD160_Init                          1042	EXIST::FUNCTION:RIPEMD
-RIPEMD160_Update                        1043	EXIST::FUNCTION:RIPEMD
-RIPEMD160_Final                         1044	EXIST::FUNCTION:RIPEMD
-RIPEMD160                               1045	EXIST::FUNCTION:RIPEMD
-RIPEMD160_Transform                     1046	EXIST::FUNCTION:RIPEMD
-RC5_32_set_key                          1047	EXIST::FUNCTION:RC5
-RC5_32_ecb_encrypt                      1048	EXIST::FUNCTION:RC5
-RC5_32_encrypt                          1049	EXIST::FUNCTION:RC5
-RC5_32_decrypt                          1050	EXIST::FUNCTION:RC5
-RC5_32_cbc_encrypt                      1051	EXIST::FUNCTION:RC5
-RC5_32_cfb64_encrypt                    1052	EXIST::FUNCTION:RC5
-RC5_32_ofb64_encrypt                    1053	EXIST::FUNCTION:RC5
-BN_bn2mpi                               1058	EXIST::FUNCTION:
-BN_mpi2bn                               1059	EXIST::FUNCTION:
-ASN1_BIT_STRING_get_bit                 1060	EXIST::FUNCTION:
-ASN1_BIT_STRING_set_bit                 1061	EXIST::FUNCTION:
-BIO_get_ex_data                         1062	EXIST::FUNCTION:
-BIO_get_ex_new_index                    1063	EXIST::FUNCTION:
-BIO_set_ex_data                         1064	EXIST::FUNCTION:
-X509v3_get_key_usage                    1066	NOEXIST::FUNCTION:
-X509v3_set_key_usage                    1067	NOEXIST::FUNCTION:
-a2i_X509v3_key_usage                    1068	NOEXIST::FUNCTION:
-i2a_X509v3_key_usage                    1069	NOEXIST::FUNCTION:
-EVP_PKEY_decrypt                        1070	EXIST::FUNCTION:
-EVP_PKEY_encrypt                        1071	EXIST::FUNCTION:
-PKCS7_RECIP_INFO_set                    1072	EXIST::FUNCTION:
-PKCS7_add_recipient                     1073	EXIST::FUNCTION:
-PKCS7_add_recipient_info                1074	EXIST::FUNCTION:
-PKCS7_set_cipher                        1075	EXIST::FUNCTION:
-ASN1_TYPE_get_int_octetstring           1076	EXIST::FUNCTION:
-ASN1_TYPE_get_octetstring               1077	EXIST::FUNCTION:
-ASN1_TYPE_set_int_octetstring           1078	EXIST::FUNCTION:
-ASN1_TYPE_set_octetstring               1079	EXIST::FUNCTION:
-ASN1_UTCTIME_set_string                 1080	EXIST::FUNCTION:
-ERR_add_error_data                      1081	EXIST::FUNCTION:BIO
-ERR_set_error_data                      1082	EXIST::FUNCTION:
-EVP_CIPHER_asn1_to_param                1083	EXIST::FUNCTION:
-EVP_CIPHER_param_to_asn1                1084	EXIST::FUNCTION:
-EVP_CIPHER_get_asn1_iv                  1085	EXIST::FUNCTION:
-EVP_CIPHER_set_asn1_iv                  1086	EXIST::FUNCTION:
-EVP_rc5_32_12_16_cbc                    1087	EXIST::FUNCTION:RC5
-EVP_rc5_32_12_16_cfb64                  1088	EXIST::FUNCTION:RC5
-EVP_rc5_32_12_16_ecb                    1089	EXIST::FUNCTION:RC5
-EVP_rc5_32_12_16_ofb                    1090	EXIST::FUNCTION:RC5
-asn1_add_error                          1091	EXIST::FUNCTION:
-d2i_ASN1_BMPSTRING                      1092	EXIST::FUNCTION:
-i2d_ASN1_BMPSTRING                      1093	EXIST::FUNCTION:
-BIO_f_ber                               1094	NOEXIST::FUNCTION:
-BN_init                                 1095	EXIST::FUNCTION:
-COMP_CTX_new                            1096	EXIST::FUNCTION:
-COMP_CTX_free                           1097	EXIST::FUNCTION:
-COMP_CTX_compress_block                 1098	NOEXIST::FUNCTION:
-COMP_CTX_expand_block                   1099	NOEXIST::FUNCTION:
-X509_STORE_CTX_get_ex_new_index         1100	EXIST::FUNCTION:
-OBJ_NAME_add                            1101	EXIST::FUNCTION:
-BIO_socket_nbio                         1102	EXIST::FUNCTION:
-EVP_rc2_64_cbc                          1103	EXIST::FUNCTION:RC2
-OBJ_NAME_cleanup                        1104	EXIST::FUNCTION:
-OBJ_NAME_get                            1105	EXIST::FUNCTION:
-OBJ_NAME_init                           1106	EXIST::FUNCTION:
-OBJ_NAME_new_index                      1107	EXIST::FUNCTION:
-OBJ_NAME_remove                         1108	EXIST::FUNCTION:
-BN_MONT_CTX_copy                        1109	EXIST::FUNCTION:
-BIO_new_socks4a_connect                 1110	NOEXIST::FUNCTION:
-BIO_s_socks4a_connect                   1111	NOEXIST::FUNCTION:
-PROXY_set_connect_mode                  1112	NOEXIST::FUNCTION:
-RAND_SSLeay                             1113	EXIST::FUNCTION:
-RAND_set_rand_method                    1114	EXIST::FUNCTION:
-RSA_memory_lock                         1115	EXIST::FUNCTION:RSA
-bn_sub_words                            1116	EXIST::FUNCTION:
-bn_mul_normal                           1117	NOEXIST::FUNCTION:
-bn_mul_comba8                           1118	NOEXIST::FUNCTION:
-bn_mul_comba4                           1119	NOEXIST::FUNCTION:
-bn_sqr_normal                           1120	NOEXIST::FUNCTION:
-bn_sqr_comba8                           1121	NOEXIST::FUNCTION:
-bn_sqr_comba4                           1122	NOEXIST::FUNCTION:
-bn_cmp_words                            1123	NOEXIST::FUNCTION:
-bn_mul_recursive                        1124	NOEXIST::FUNCTION:
-bn_mul_part_recursive                   1125	NOEXIST::FUNCTION:
-bn_sqr_recursive                        1126	NOEXIST::FUNCTION:
-bn_mul_low_normal                       1127	NOEXIST::FUNCTION:
-BN_RECP_CTX_init                        1128	EXIST::FUNCTION:
-BN_RECP_CTX_new                         1129	EXIST::FUNCTION:
-BN_RECP_CTX_free                        1130	EXIST::FUNCTION:
-BN_RECP_CTX_set                         1131	EXIST::FUNCTION:
-BN_mod_mul_reciprocal                   1132	EXIST::FUNCTION:
-BN_mod_exp_recp                         1133	EXIST::FUNCTION:
-BN_div_recp                             1134	EXIST::FUNCTION:
-BN_CTX_init                             1135	EXIST::FUNCTION:
-BN_MONT_CTX_init                        1136	EXIST::FUNCTION:
-RAND_get_rand_method                    1137	EXIST::FUNCTION:
-PKCS7_add_attribute                     1138	EXIST::FUNCTION:
-PKCS7_add_signed_attribute              1139	EXIST::FUNCTION:
-PKCS7_digest_from_attributes            1140	EXIST::FUNCTION:
-PKCS7_get_attribute                     1141	EXIST::FUNCTION:
-PKCS7_get_issuer_and_serial             1142	EXIST::FUNCTION:
-PKCS7_get_signed_attribute              1143	EXIST::FUNCTION:
-COMP_compress_block                     1144	EXIST::FUNCTION:
-COMP_expand_block                       1145	EXIST::FUNCTION:
-COMP_rle                                1146	EXIST::FUNCTION:
-COMP_zlib                               1147	EXIST::FUNCTION:
-ms_time_diff                            1148	EXIST::FUNCTION:
-ms_time_new                             1149	EXIST::FUNCTION:
-ms_time_free                            1150	EXIST::FUNCTION:
-ms_time_cmp                             1151	EXIST::FUNCTION:
-ms_time_get                             1152	EXIST::FUNCTION:
-PKCS7_set_attributes                    1153	EXIST::FUNCTION:
-PKCS7_set_signed_attributes             1154	EXIST::FUNCTION:
-X509_ATTRIBUTE_create                   1155	EXIST::FUNCTION:
-X509_ATTRIBUTE_dup                      1156	EXIST::FUNCTION:
-ASN1_GENERALIZEDTIME_check              1157	EXIST::FUNCTION:
-ASN1_GENERALIZEDTIME_print              1158	EXIST::FUNCTION:BIO
-ASN1_GENERALIZEDTIME_set                1159	EXIST::FUNCTION:
-ASN1_GENERALIZEDTIME_set_string         1160	EXIST::FUNCTION:
-ASN1_TIME_print                         1161	EXIST::FUNCTION:BIO
-BASIC_CONSTRAINTS_free                  1162	EXIST::FUNCTION:
-BASIC_CONSTRAINTS_new                   1163	EXIST::FUNCTION:
-ERR_load_X509V3_strings                 1164	EXIST::FUNCTION:
-NETSCAPE_CERT_SEQUENCE_free             1165	EXIST::FUNCTION:
-NETSCAPE_CERT_SEQUENCE_new              1166	EXIST::FUNCTION:
-OBJ_txt2obj                             1167	EXIST::FUNCTION:
-PEM_read_NETSCAPE_CERT_SEQUENCE         1168	EXIST:!VMS,!WIN16:FUNCTION:
-PEM_read_NS_CERT_SEQ                    1168	EXIST:VMS:FUNCTION:
-PEM_read_bio_NETSCAPE_CERT_SEQUENCE     1169	EXIST:!VMS:FUNCTION:
-PEM_read_bio_NS_CERT_SEQ                1169	EXIST:VMS:FUNCTION:
-PEM_write_NETSCAPE_CERT_SEQUENCE        1170	EXIST:!VMS,!WIN16:FUNCTION:
-PEM_write_NS_CERT_SEQ                   1170	EXIST:VMS:FUNCTION:
-PEM_write_bio_NETSCAPE_CERT_SEQUENCE    1171	EXIST:!VMS:FUNCTION:
-PEM_write_bio_NS_CERT_SEQ               1171	EXIST:VMS:FUNCTION:
-X509V3_EXT_add                          1172	EXIST::FUNCTION:
-X509V3_EXT_add_alias                    1173	EXIST::FUNCTION:
-X509V3_EXT_add_conf                     1174	EXIST::FUNCTION:
-X509V3_EXT_cleanup                      1175	EXIST::FUNCTION:
-X509V3_EXT_conf                         1176	EXIST::FUNCTION:
-X509V3_EXT_conf_nid                     1177	EXIST::FUNCTION:
-X509V3_EXT_get                          1178	EXIST::FUNCTION:
-X509V3_EXT_get_nid                      1179	EXIST::FUNCTION:
-X509V3_EXT_print                        1180	EXIST::FUNCTION:
-X509V3_EXT_print_fp                     1181	EXIST::FUNCTION:
-X509V3_add_standard_extensions          1182	EXIST::FUNCTION:
-X509V3_add_value                        1183	EXIST::FUNCTION:
-X509V3_add_value_bool                   1184	EXIST::FUNCTION:
-X509V3_add_value_int                    1185	EXIST::FUNCTION:
-X509V3_conf_free                        1186	EXIST::FUNCTION:
-X509V3_get_value_bool                   1187	EXIST::FUNCTION:
-X509V3_get_value_int                    1188	EXIST::FUNCTION:
-X509V3_parse_list                       1189	EXIST::FUNCTION:
-d2i_ASN1_GENERALIZEDTIME                1190	EXIST::FUNCTION:
-d2i_ASN1_TIME                           1191	EXIST::FUNCTION:
-d2i_BASIC_CONSTRAINTS                   1192	EXIST::FUNCTION:
-d2i_NETSCAPE_CERT_SEQUENCE              1193	EXIST::FUNCTION:
-d2i_ext_ku                              1194	NOEXIST::FUNCTION:
-ext_ku_free                             1195	NOEXIST::FUNCTION:
-ext_ku_new                              1196	NOEXIST::FUNCTION:
-i2d_ASN1_GENERALIZEDTIME                1197	EXIST::FUNCTION:
-i2d_ASN1_TIME                           1198	EXIST::FUNCTION:
-i2d_BASIC_CONSTRAINTS                   1199	EXIST::FUNCTION:
-i2d_NETSCAPE_CERT_SEQUENCE              1200	EXIST::FUNCTION:
-i2d_ext_ku                              1201	NOEXIST::FUNCTION:
-EVP_MD_CTX_copy                         1202	EXIST::FUNCTION:
-i2d_ASN1_ENUMERATED                     1203	EXIST::FUNCTION:
-d2i_ASN1_ENUMERATED                     1204	EXIST::FUNCTION:
-ASN1_ENUMERATED_set                     1205	EXIST::FUNCTION:
-ASN1_ENUMERATED_get                     1206	EXIST::FUNCTION:
-BN_to_ASN1_ENUMERATED                   1207	EXIST::FUNCTION:
-ASN1_ENUMERATED_to_BN                   1208	EXIST::FUNCTION:
-i2a_ASN1_ENUMERATED                     1209	EXIST::FUNCTION:BIO
-a2i_ASN1_ENUMERATED                     1210	EXIST::FUNCTION:BIO
-i2d_GENERAL_NAME                        1211	EXIST::FUNCTION:
-d2i_GENERAL_NAME                        1212	EXIST::FUNCTION:
-GENERAL_NAME_new                        1213	EXIST::FUNCTION:
-GENERAL_NAME_free                       1214	EXIST::FUNCTION:
-GENERAL_NAMES_new                       1215	EXIST::FUNCTION:
-GENERAL_NAMES_free                      1216	EXIST::FUNCTION:
-d2i_GENERAL_NAMES                       1217	EXIST::FUNCTION:
-i2d_GENERAL_NAMES                       1218	EXIST::FUNCTION:
-i2v_GENERAL_NAMES                       1219	EXIST::FUNCTION:
-i2s_ASN1_OCTET_STRING                   1220	EXIST::FUNCTION:
-s2i_ASN1_OCTET_STRING                   1221	EXIST::FUNCTION:
-X509V3_EXT_check_conf                   1222	NOEXIST::FUNCTION:
-hex_to_string                           1223	EXIST::FUNCTION:
-string_to_hex                           1224	EXIST::FUNCTION:
-DES_ede3_cbcm_encrypt                   1225	EXIST::FUNCTION:DES
-RSA_padding_add_PKCS1_OAEP              1226	EXIST::FUNCTION:RSA
-RSA_padding_check_PKCS1_OAEP            1227	EXIST::FUNCTION:RSA
-X509_CRL_print_fp                       1228	EXIST::FUNCTION:FP_API
-X509_CRL_print                          1229	EXIST::FUNCTION:BIO
-i2v_GENERAL_NAME                        1230	EXIST::FUNCTION:
-v2i_GENERAL_NAME                        1231	EXIST::FUNCTION:
-i2d_PKEY_USAGE_PERIOD                   1232	EXIST::FUNCTION:
-d2i_PKEY_USAGE_PERIOD                   1233	EXIST::FUNCTION:
-PKEY_USAGE_PERIOD_new                   1234	EXIST::FUNCTION:
-PKEY_USAGE_PERIOD_free                  1235	EXIST::FUNCTION:
-v2i_GENERAL_NAMES                       1236	EXIST::FUNCTION:
-i2s_ASN1_INTEGER                        1237	EXIST::FUNCTION:
-X509V3_EXT_d2i                          1238	EXIST::FUNCTION:
-name_cmp                                1239	EXIST::FUNCTION:
-str_dup                                 1240	NOEXIST::FUNCTION:
-i2s_ASN1_ENUMERATED                     1241	EXIST::FUNCTION:
-i2s_ASN1_ENUMERATED_TABLE               1242	EXIST::FUNCTION:
-BIO_s_log                               1243	EXIST:!OS2,!WIN16,!WIN32,!macintosh:FUNCTION:
-BIO_f_reliable                          1244	EXIST::FUNCTION:BIO
-PKCS7_dataFinal                         1245	EXIST::FUNCTION:
-PKCS7_dataDecode                        1246	EXIST::FUNCTION:
-X509V3_EXT_CRL_add_conf                 1247	EXIST::FUNCTION:
-BN_set_params                           1248	EXIST::FUNCTION:
-BN_get_params                           1249	EXIST::FUNCTION:
-BIO_get_ex_num                          1250	NOEXIST::FUNCTION:
-BIO_set_ex_free_func                    1251	NOEXIST::FUNCTION:
-EVP_ripemd160                           1252	EXIST::FUNCTION:RIPEMD
-ASN1_TIME_set                           1253	EXIST::FUNCTION:
-i2d_AUTHORITY_KEYID                     1254	EXIST::FUNCTION:
-d2i_AUTHORITY_KEYID                     1255	EXIST::FUNCTION:
-AUTHORITY_KEYID_new                     1256	EXIST::FUNCTION:
-AUTHORITY_KEYID_free                    1257	EXIST::FUNCTION:
-ASN1_seq_unpack                         1258	EXIST::FUNCTION:
-ASN1_seq_pack                           1259	EXIST::FUNCTION:
-ASN1_unpack_string                      1260	EXIST::FUNCTION:
-ASN1_pack_string                        1261	EXIST::FUNCTION:
-PKCS12_pack_safebag                     1262	NOEXIST::FUNCTION:
-PKCS12_MAKE_KEYBAG                      1263	EXIST::FUNCTION:
-PKCS8_encrypt                           1264	EXIST::FUNCTION:
-PKCS12_MAKE_SHKEYBAG                    1265	EXIST::FUNCTION:
-PKCS12_pack_p7data                      1266	EXIST::FUNCTION:
-PKCS12_pack_p7encdata                   1267	EXIST::FUNCTION:
-PKCS12_add_localkeyid                   1268	EXIST::FUNCTION:
-PKCS12_add_friendlyname_asc             1269	EXIST::FUNCTION:
-PKCS12_add_friendlyname_uni             1270	EXIST::FUNCTION:
-PKCS12_get_friendlyname                 1271	EXIST::FUNCTION:
-PKCS12_pbe_crypt                        1272	EXIST::FUNCTION:
-PKCS12_decrypt_d2i                      1273	NOEXIST::FUNCTION:
-PKCS12_i2d_encrypt                      1274	NOEXIST::FUNCTION:
-PKCS12_init                             1275	EXIST::FUNCTION:
-PKCS12_key_gen_asc                      1276	EXIST::FUNCTION:
-PKCS12_key_gen_uni                      1277	EXIST::FUNCTION:
-PKCS12_gen_mac                          1278	EXIST::FUNCTION:
-PKCS12_verify_mac                       1279	EXIST::FUNCTION:
-PKCS12_set_mac                          1280	EXIST::FUNCTION:
-PKCS12_setup_mac                        1281	EXIST::FUNCTION:
-asc2uni                                 1282	EXIST::FUNCTION:
-uni2asc                                 1283	EXIST::FUNCTION:
-i2d_PKCS12_BAGS                         1284	EXIST::FUNCTION:
-PKCS12_BAGS_new                         1285	EXIST::FUNCTION:
-d2i_PKCS12_BAGS                         1286	EXIST::FUNCTION:
-PKCS12_BAGS_free                        1287	EXIST::FUNCTION:
-i2d_PKCS12                              1288	EXIST::FUNCTION:
-d2i_PKCS12                              1289	EXIST::FUNCTION:
-PKCS12_new                              1290	EXIST::FUNCTION:
-PKCS12_free                             1291	EXIST::FUNCTION:
-i2d_PKCS12_MAC_DATA                     1292	EXIST::FUNCTION:
-PKCS12_MAC_DATA_new                     1293	EXIST::FUNCTION:
-d2i_PKCS12_MAC_DATA                     1294	EXIST::FUNCTION:
-PKCS12_MAC_DATA_free                    1295	EXIST::FUNCTION:
-i2d_PKCS12_SAFEBAG                      1296	EXIST::FUNCTION:
-PKCS12_SAFEBAG_new                      1297	EXIST::FUNCTION:
-d2i_PKCS12_SAFEBAG                      1298	EXIST::FUNCTION:
-PKCS12_SAFEBAG_free                     1299	EXIST::FUNCTION:
-ERR_load_PKCS12_strings                 1300	EXIST::FUNCTION:
-PKCS12_PBE_add                          1301	EXIST::FUNCTION:
-PKCS8_add_keyusage                      1302	EXIST::FUNCTION:
-PKCS12_get_attr_gen                     1303	EXIST::FUNCTION:
-PKCS12_parse                            1304	EXIST::FUNCTION:
-PKCS12_create                           1305	EXIST::FUNCTION:
-i2d_PKCS12_bio                          1306	EXIST::FUNCTION:
-i2d_PKCS12_fp                           1307	EXIST::FUNCTION:
-d2i_PKCS12_bio                          1308	EXIST::FUNCTION:
-d2i_PKCS12_fp                           1309	EXIST::FUNCTION:
-i2d_PBEPARAM                            1310	EXIST::FUNCTION:
-PBEPARAM_new                            1311	EXIST::FUNCTION:
-d2i_PBEPARAM                            1312	EXIST::FUNCTION:
-PBEPARAM_free                           1313	EXIST::FUNCTION:
-i2d_PKCS8_PRIV_KEY_INFO                 1314	EXIST::FUNCTION:
-PKCS8_PRIV_KEY_INFO_new                 1315	EXIST::FUNCTION:
-d2i_PKCS8_PRIV_KEY_INFO                 1316	EXIST::FUNCTION:
-PKCS8_PRIV_KEY_INFO_free                1317	EXIST::FUNCTION:
-EVP_PKCS82PKEY                          1318	EXIST::FUNCTION:
-EVP_PKEY2PKCS8                          1319	EXIST::FUNCTION:
-PKCS8_set_broken                        1320	EXIST::FUNCTION:
-EVP_PBE_ALGOR_CipherInit                1321	NOEXIST::FUNCTION:
-EVP_PBE_alg_add                         1322	EXIST::FUNCTION:
-PKCS5_pbe_set                           1323	EXIST::FUNCTION:
-EVP_PBE_cleanup                         1324	EXIST::FUNCTION:
-i2d_SXNET                               1325	EXIST::FUNCTION:
-d2i_SXNET                               1326	EXIST::FUNCTION:
-SXNET_new                               1327	EXIST::FUNCTION:
-SXNET_free                              1328	EXIST::FUNCTION:
-i2d_SXNETID                             1329	EXIST::FUNCTION:
-d2i_SXNETID                             1330	EXIST::FUNCTION:
-SXNETID_new                             1331	EXIST::FUNCTION:
-SXNETID_free                            1332	EXIST::FUNCTION:
-DSA_SIG_new                             1333	EXIST::FUNCTION:DSA
-DSA_SIG_free                            1334	EXIST::FUNCTION:DSA
-DSA_do_sign                             1335	EXIST::FUNCTION:DSA
-DSA_do_verify                           1336	EXIST::FUNCTION:DSA
-d2i_DSA_SIG                             1337	EXIST::FUNCTION:DSA
-i2d_DSA_SIG                             1338	EXIST::FUNCTION:DSA
-i2d_ASN1_VISIBLESTRING                  1339	EXIST::FUNCTION:
-d2i_ASN1_VISIBLESTRING                  1340	EXIST::FUNCTION:
-i2d_ASN1_UTF8STRING                     1341	EXIST::FUNCTION:
-d2i_ASN1_UTF8STRING                     1342	EXIST::FUNCTION:
-i2d_DIRECTORYSTRING                     1343	EXIST::FUNCTION:
-d2i_DIRECTORYSTRING                     1344	EXIST::FUNCTION:
-i2d_DISPLAYTEXT                         1345	EXIST::FUNCTION:
-d2i_DISPLAYTEXT                         1346	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509                    1379	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509                    1380	NOEXIST::FUNCTION:
-i2d_PBKDF2PARAM                         1397	EXIST::FUNCTION:
-PBKDF2PARAM_new                         1398	EXIST::FUNCTION:
-d2i_PBKDF2PARAM                         1399	EXIST::FUNCTION:
-PBKDF2PARAM_free                        1400	EXIST::FUNCTION:
-i2d_PBE2PARAM                           1401	EXIST::FUNCTION:
-PBE2PARAM_new                           1402	EXIST::FUNCTION:
-d2i_PBE2PARAM                           1403	EXIST::FUNCTION:
-PBE2PARAM_free                          1404	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_GENERAL_NAME            1421	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_GENERAL_NAME            1422	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_SXNETID                 1439	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_SXNETID                 1440	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_POLICYQUALINFO          1457	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_POLICYQUALINFO          1458	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_POLICYINFO              1475	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_POLICYINFO              1476	NOEXIST::FUNCTION:
-SXNET_add_id_asc                        1477	EXIST::FUNCTION:
-SXNET_add_id_ulong                      1478	EXIST::FUNCTION:
-SXNET_add_id_INTEGER                    1479	EXIST::FUNCTION:
-SXNET_get_id_asc                        1480	EXIST::FUNCTION:
-SXNET_get_id_ulong                      1481	EXIST::FUNCTION:
-SXNET_get_id_INTEGER                    1482	EXIST::FUNCTION:
-X509V3_set_conf_lhash                   1483	EXIST::FUNCTION:
-i2d_CERTIFICATEPOLICIES                 1484	EXIST::FUNCTION:
-CERTIFICATEPOLICIES_new                 1485	EXIST::FUNCTION:
-CERTIFICATEPOLICIES_free                1486	EXIST::FUNCTION:
-d2i_CERTIFICATEPOLICIES                 1487	EXIST::FUNCTION:
-i2d_POLICYINFO                          1488	EXIST::FUNCTION:
-POLICYINFO_new                          1489	EXIST::FUNCTION:
-d2i_POLICYINFO                          1490	EXIST::FUNCTION:
-POLICYINFO_free                         1491	EXIST::FUNCTION:
-i2d_POLICYQUALINFO                      1492	EXIST::FUNCTION:
-POLICYQUALINFO_new                      1493	EXIST::FUNCTION:
-d2i_POLICYQUALINFO                      1494	EXIST::FUNCTION:
-POLICYQUALINFO_free                     1495	EXIST::FUNCTION:
-i2d_USERNOTICE                          1496	EXIST::FUNCTION:
-USERNOTICE_new                          1497	EXIST::FUNCTION:
-d2i_USERNOTICE                          1498	EXIST::FUNCTION:
-USERNOTICE_free                         1499	EXIST::FUNCTION:
-i2d_NOTICEREF                           1500	EXIST::FUNCTION:
-NOTICEREF_new                           1501	EXIST::FUNCTION:
-d2i_NOTICEREF                           1502	EXIST::FUNCTION:
-NOTICEREF_free                          1503	EXIST::FUNCTION:
-X509V3_get_string                       1504	EXIST::FUNCTION:
-X509V3_get_section                      1505	EXIST::FUNCTION:
-X509V3_string_free                      1506	EXIST::FUNCTION:
-X509V3_section_free                     1507	EXIST::FUNCTION:
-X509V3_set_ctx                          1508	EXIST::FUNCTION:
-s2i_ASN1_INTEGER                        1509	EXIST::FUNCTION:
-CRYPTO_set_locked_mem_functions         1510	EXIST::FUNCTION:
-CRYPTO_get_locked_mem_functions         1511	EXIST::FUNCTION:
-CRYPTO_malloc_locked                    1512	EXIST::FUNCTION:
-CRYPTO_free_locked                      1513	EXIST::FUNCTION:
-BN_mod_exp2_mont                        1514	EXIST::FUNCTION:
-ERR_get_error_line_data                 1515	EXIST::FUNCTION:
-ERR_peek_error_line_data                1516	EXIST::FUNCTION:
-PKCS12_PBE_keyivgen                     1517	EXIST::FUNCTION:
-X509_ALGOR_dup                          1518	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_DIST_POINT              1535	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_DIST_POINT              1536	NOEXIST::FUNCTION:
-i2d_CRL_DIST_POINTS                     1537	EXIST::FUNCTION:
-CRL_DIST_POINTS_new                     1538	EXIST::FUNCTION:
-CRL_DIST_POINTS_free                    1539	EXIST::FUNCTION:
-d2i_CRL_DIST_POINTS                     1540	EXIST::FUNCTION:
-i2d_DIST_POINT                          1541	EXIST::FUNCTION:
-DIST_POINT_new                          1542	EXIST::FUNCTION:
-d2i_DIST_POINT                          1543	EXIST::FUNCTION:
-DIST_POINT_free                         1544	EXIST::FUNCTION:
-i2d_DIST_POINT_NAME                     1545	EXIST::FUNCTION:
-DIST_POINT_NAME_new                     1546	EXIST::FUNCTION:
-DIST_POINT_NAME_free                    1547	EXIST::FUNCTION:
-d2i_DIST_POINT_NAME                     1548	EXIST::FUNCTION:
-X509V3_add_value_uchar                  1549	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509_ATTRIBUTE          1555	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_ASN1_TYPE               1560	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509_EXTENSION          1567	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509_NAME_ENTRY         1574	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_ASN1_TYPE               1589	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509_ATTRIBUTE          1615	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509_EXTENSION          1624	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509_NAME_ENTRY         1633	NOEXIST::FUNCTION:
-X509V3_EXT_i2d                          1646	EXIST::FUNCTION:
-X509V3_EXT_val_prn                      1647	EXIST::FUNCTION:
-X509V3_EXT_add_list                     1648	EXIST::FUNCTION:
-EVP_CIPHER_type                         1649	EXIST::FUNCTION:
-EVP_PBE_CipherInit                      1650	EXIST::FUNCTION:
-X509V3_add_value_bool_nf                1651	EXIST::FUNCTION:
-d2i_ASN1_UINTEGER                       1652	EXIST::FUNCTION:
-sk_value                                1653	EXIST::FUNCTION:
-sk_num                                  1654	EXIST::FUNCTION:
-sk_set                                  1655	EXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509_REVOKED            1661	NOEXIST::FUNCTION:
-sk_sort                                 1671	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509_REVOKED            1674	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509_ALGOR              1682	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_X509_CRL                1685	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509_ALGOR              1696	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_X509_CRL                1702	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_PKCS7_SIGNER_INFO       1723	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_PKCS7_RECIP_INFO        1738	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_PKCS7_SIGNER_INFO       1748	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_PKCS7_RECIP_INFO        1753	NOEXIST::FUNCTION:
-PKCS5_PBE_add                           1775	EXIST::FUNCTION:
-PEM_write_bio_PKCS8                     1776	EXIST::FUNCTION:
-i2d_PKCS8_fp                            1777	EXIST::FUNCTION:FP_API
-PEM_read_bio_PKCS8_PRIV_KEY_INFO        1778	EXIST:!VMS:FUNCTION:
-PEM_read_bio_P8_PRIV_KEY_INFO           1778	EXIST:VMS:FUNCTION:
-d2i_PKCS8_bio                           1779	EXIST::FUNCTION:BIO
-d2i_PKCS8_PRIV_KEY_INFO_fp              1780	EXIST::FUNCTION:FP_API
-PEM_write_bio_PKCS8_PRIV_KEY_INFO       1781	EXIST:!VMS:FUNCTION:
-PEM_write_bio_P8_PRIV_KEY_INFO          1781	EXIST:VMS:FUNCTION:
-PEM_read_PKCS8                          1782	EXIST:!WIN16:FUNCTION:
-d2i_PKCS8_PRIV_KEY_INFO_bio             1783	EXIST::FUNCTION:BIO
-d2i_PKCS8_fp                            1784	EXIST::FUNCTION:FP_API
-PEM_write_PKCS8                         1785	EXIST:!WIN16:FUNCTION:
-PEM_read_PKCS8_PRIV_KEY_INFO            1786	EXIST:!VMS,!WIN16:FUNCTION:
-PEM_read_P8_PRIV_KEY_INFO               1786	EXIST:VMS:FUNCTION:
-PEM_read_bio_PKCS8                      1787	EXIST::FUNCTION:
-PEM_write_PKCS8_PRIV_KEY_INFO           1788	EXIST:!VMS,!WIN16:FUNCTION:
-PEM_write_P8_PRIV_KEY_INFO              1788	EXIST:VMS:FUNCTION:
-PKCS5_PBE_keyivgen                      1789	EXIST::FUNCTION:
-i2d_PKCS8_bio                           1790	EXIST::FUNCTION:BIO
-i2d_PKCS8_PRIV_KEY_INFO_fp              1791	EXIST::FUNCTION:FP_API
-i2d_PKCS8_PRIV_KEY_INFO_bio             1792	EXIST::FUNCTION:BIO
-BIO_s_bio                               1793	EXIST::FUNCTION:
-PKCS5_pbe2_set                          1794	EXIST::FUNCTION:
-PKCS5_PBKDF2_HMAC_SHA1                  1795	EXIST::FUNCTION:
-PKCS5_v2_PBE_keyivgen                   1796	EXIST::FUNCTION:
-PEM_write_bio_PKCS8PrivateKey           1797	EXIST::FUNCTION:
-PEM_write_PKCS8PrivateKey               1798	EXIST::FUNCTION:
-BIO_ctrl_get_read_request               1799	EXIST::FUNCTION:
-BIO_ctrl_pending                        1800	EXIST::FUNCTION:
-BIO_ctrl_wpending                       1801	EXIST::FUNCTION:
-BIO_new_bio_pair                        1802	EXIST::FUNCTION:
-BIO_ctrl_get_write_guarantee            1803	EXIST::FUNCTION:
-CRYPTO_num_locks                        1804	EXIST::FUNCTION:
-CONF_load_bio                           1805	EXIST::FUNCTION:
-CONF_load_fp                            1806	EXIST::FUNCTION:FP_API
-i2d_ASN1_SET_OF_ASN1_OBJECT             1837	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_ASN1_OBJECT             1844	NOEXIST::FUNCTION:
-PKCS7_signatureVerify                   1845	EXIST::FUNCTION:
-RSA_set_method                          1846	EXIST::FUNCTION:RSA
-RSA_get_method                          1847	EXIST::FUNCTION:RSA
-RSA_get_default_method                  1848	EXIST::FUNCTION:RSA
-RSA_check_key                           1869	EXIST::FUNCTION:RSA
-OBJ_obj2txt                             1870	EXIST::FUNCTION:
-DSA_dup_DH                              1871	EXIST::FUNCTION:DH,DSA
-X509_REQ_get_extensions                 1872	EXIST::FUNCTION:
-X509_REQ_set_extension_nids             1873	EXIST::FUNCTION:
-BIO_nwrite                              1874	EXIST::FUNCTION:
-X509_REQ_extension_nid                  1875	EXIST::FUNCTION:
-BIO_nread                               1876	EXIST::FUNCTION:
-X509_REQ_get_extension_nids             1877	EXIST::FUNCTION:
-BIO_nwrite0                             1878	EXIST::FUNCTION:
-X509_REQ_add_extensions_nid             1879	EXIST::FUNCTION:
-BIO_nread0                              1880	EXIST::FUNCTION:
-X509_REQ_add_extensions                 1881	EXIST::FUNCTION:
-BIO_new_mem_buf                         1882	EXIST::FUNCTION:
-DH_set_ex_data                          1883	EXIST::FUNCTION:DH
-DH_set_method                           1884	EXIST::FUNCTION:DH
-DSA_OpenSSL                             1885	EXIST::FUNCTION:DSA
-DH_get_ex_data                          1886	EXIST::FUNCTION:DH
-DH_get_ex_new_index                     1887	EXIST::FUNCTION:DH
-DSA_new_method                          1888	EXIST::FUNCTION:DSA
-DH_new_method                           1889	EXIST::FUNCTION:DH
-DH_OpenSSL                              1890	EXIST::FUNCTION:DH
-DSA_get_ex_new_index                    1891	EXIST::FUNCTION:DSA
-DH_get_default_method                   1892	EXIST::FUNCTION:DH
-DSA_set_ex_data                         1893	EXIST::FUNCTION:DSA
-DH_set_default_method                   1894	EXIST::FUNCTION:DH
-DSA_get_ex_data                         1895	EXIST::FUNCTION:DSA
-X509V3_EXT_REQ_add_conf                 1896	EXIST::FUNCTION:
-NETSCAPE_SPKI_print                     1897	EXIST::FUNCTION:EVP
-NETSCAPE_SPKI_set_pubkey                1898	EXIST::FUNCTION:EVP
-NETSCAPE_SPKI_b64_encode                1899	EXIST::FUNCTION:EVP
-NETSCAPE_SPKI_get_pubkey                1900	EXIST::FUNCTION:EVP
-NETSCAPE_SPKI_b64_decode                1901	EXIST::FUNCTION:EVP
-UTF8_putc                               1902	EXIST::FUNCTION:
-UTF8_getc                               1903	EXIST::FUNCTION:
-RSA_null_method                         1904	EXIST::FUNCTION:RSA
-ASN1_tag2str                            1905	EXIST::FUNCTION:
-BIO_ctrl_reset_read_request             1906	EXIST::FUNCTION:
-DISPLAYTEXT_new                         1907	EXIST::FUNCTION:
-ASN1_GENERALIZEDTIME_free               1908	EXIST::FUNCTION:
-X509_REVOKED_get_ext_d2i                1909	EXIST::FUNCTION:
-X509_set_ex_data                        1910	EXIST::FUNCTION:
-X509_reject_set_bit_asc                 1911	NOEXIST::FUNCTION:
-X509_NAME_add_entry_by_txt              1912	EXIST::FUNCTION:
-X509_NAME_add_entry_by_NID              1914	EXIST::FUNCTION:
-X509_PURPOSE_get0                       1915	EXIST::FUNCTION:
-PEM_read_X509_AUX                       1917	EXIST:!WIN16:FUNCTION:
-d2i_AUTHORITY_INFO_ACCESS               1918	EXIST::FUNCTION:
-PEM_write_PUBKEY                        1921	EXIST:!WIN16:FUNCTION:
-ACCESS_DESCRIPTION_new                  1925	EXIST::FUNCTION:
-X509_CERT_AUX_free                      1926	EXIST::FUNCTION:
-d2i_ACCESS_DESCRIPTION                  1927	EXIST::FUNCTION:
-X509_trust_clear                        1928	EXIST::FUNCTION:
-X509_TRUST_add                          1931	EXIST::FUNCTION:
-ASN1_VISIBLESTRING_new                  1932	EXIST::FUNCTION:
-X509_alias_set1                         1933	EXIST::FUNCTION:
-ASN1_PRINTABLESTRING_free               1934	EXIST::FUNCTION:
-EVP_PKEY_get1_DSA                       1935	EXIST::FUNCTION:DSA
-ASN1_BMPSTRING_new                      1936	EXIST::FUNCTION:
-ASN1_mbstring_copy                      1937	EXIST::FUNCTION:
-ASN1_UTF8STRING_new                     1938	EXIST::FUNCTION:
-DSA_get_default_method                  1941	EXIST::FUNCTION:DSA
-i2d_ASN1_SET_OF_ACCESS_DESCRIPTION      1945	NOEXIST::FUNCTION:
-ASN1_T61STRING_free                     1946	EXIST::FUNCTION:
-DSA_set_method                          1949	EXIST::FUNCTION:DSA
-X509_get_ex_data                        1950	EXIST::FUNCTION:
-ASN1_STRING_type                        1951	EXIST::FUNCTION:
-X509_PURPOSE_get_by_sname               1952	EXIST::FUNCTION:
-ASN1_TIME_free                          1954	EXIST::FUNCTION:
-ASN1_OCTET_STRING_cmp                   1955	EXIST::FUNCTION:
-ASN1_BIT_STRING_new                     1957	EXIST::FUNCTION:
-X509_get_ext_d2i                        1958	EXIST::FUNCTION:
-PEM_read_bio_X509_AUX                   1959	EXIST::FUNCTION:
-ASN1_STRING_set_default_mask_asc        1960	EXIST:!VMS:FUNCTION:
-ASN1_STRING_set_def_mask_asc            1960	EXIST:VMS:FUNCTION:
-PEM_write_bio_RSA_PUBKEY                1961	EXIST::FUNCTION:RSA
-ASN1_INTEGER_cmp                        1963	EXIST::FUNCTION:
-d2i_RSA_PUBKEY_fp                       1964	EXIST::FUNCTION:FP_API,RSA
-X509_trust_set_bit_asc                  1967	NOEXIST::FUNCTION:
-PEM_write_bio_DSA_PUBKEY                1968	EXIST::FUNCTION:DSA
-X509_STORE_CTX_free                     1969	EXIST::FUNCTION:
-EVP_PKEY_set1_DSA                       1970	EXIST::FUNCTION:DSA
-i2d_DSA_PUBKEY_fp                       1971	EXIST::FUNCTION:DSA,FP_API
-X509_load_cert_crl_file                 1972	EXIST::FUNCTION:STDIO
-ASN1_TIME_new                           1973	EXIST::FUNCTION:
-i2d_RSA_PUBKEY                          1974	EXIST::FUNCTION:RSA
-X509_STORE_CTX_purpose_inherit          1976	EXIST::FUNCTION:
-PEM_read_RSA_PUBKEY                     1977	EXIST:!WIN16:FUNCTION:RSA
-d2i_X509_AUX                            1980	EXIST::FUNCTION:
-i2d_DSA_PUBKEY                          1981	EXIST::FUNCTION:DSA
-X509_CERT_AUX_print                     1982	EXIST::FUNCTION:BIO
-PEM_read_DSA_PUBKEY                     1984	EXIST:!WIN16:FUNCTION:DSA
-i2d_RSA_PUBKEY_bio                      1985	EXIST::FUNCTION:BIO,RSA
-ASN1_BIT_STRING_num_asc                 1986	EXIST::FUNCTION:
-i2d_PUBKEY                              1987	EXIST::FUNCTION:
-ASN1_UTCTIME_free                       1988	EXIST::FUNCTION:
-DSA_set_default_method                  1989	EXIST::FUNCTION:DSA
-X509_PURPOSE_get_by_id                  1990	EXIST::FUNCTION:
-ACCESS_DESCRIPTION_free                 1994	EXIST::FUNCTION:
-PEM_read_bio_PUBKEY                     1995	EXIST::FUNCTION:
-ASN1_STRING_set_by_NID                  1996	EXIST::FUNCTION:
-X509_PURPOSE_get_id                     1997	EXIST::FUNCTION:
-DISPLAYTEXT_free                        1998	EXIST::FUNCTION:
-OTHERNAME_new                           1999	EXIST::FUNCTION:
-X509_CERT_AUX_new                       2001	EXIST::FUNCTION:
-X509_TRUST_cleanup                      2007	EXIST::FUNCTION:
-X509_NAME_add_entry_by_OBJ              2008	EXIST::FUNCTION:
-X509_CRL_get_ext_d2i                    2009	EXIST::FUNCTION:
-X509_PURPOSE_get0_name                  2011	EXIST::FUNCTION:
-PEM_read_PUBKEY                         2012	EXIST:!WIN16:FUNCTION:
-i2d_DSA_PUBKEY_bio                      2014	EXIST::FUNCTION:BIO,DSA
-i2d_OTHERNAME                           2015	EXIST::FUNCTION:
-ASN1_OCTET_STRING_free                  2016	EXIST::FUNCTION:
-ASN1_BIT_STRING_set_asc                 2017	EXIST::FUNCTION:
-X509_get_ex_new_index                   2019	EXIST::FUNCTION:
-ASN1_STRING_TABLE_cleanup               2020	EXIST::FUNCTION:
-X509_TRUST_get_by_id                    2021	EXIST::FUNCTION:
-X509_PURPOSE_get_trust                  2022	EXIST::FUNCTION:
-ASN1_STRING_length                      2023	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_ACCESS_DESCRIPTION      2024	NOEXIST::FUNCTION:
-ASN1_PRINTABLESTRING_new                2025	EXIST::FUNCTION:
-X509V3_get_d2i                          2026	EXIST::FUNCTION:
-ASN1_ENUMERATED_free                    2027	EXIST::FUNCTION:
-i2d_X509_CERT_AUX                       2028	EXIST::FUNCTION:
-X509_STORE_CTX_set_trust                2030	EXIST::FUNCTION:
-ASN1_STRING_set_default_mask            2032	EXIST::FUNCTION:
-X509_STORE_CTX_new                      2033	EXIST::FUNCTION:
-EVP_PKEY_get1_RSA                       2034	EXIST::FUNCTION:RSA
-DIRECTORYSTRING_free                    2038	EXIST::FUNCTION:
-PEM_write_X509_AUX                      2039	EXIST:!WIN16:FUNCTION:
-ASN1_OCTET_STRING_set                   2040	EXIST::FUNCTION:
-d2i_DSA_PUBKEY_fp                       2041	EXIST::FUNCTION:DSA,FP_API
-d2i_RSA_PUBKEY                          2044	EXIST::FUNCTION:RSA
-X509_TRUST_get0_name                    2046	EXIST::FUNCTION:
-X509_TRUST_get0                         2047	EXIST::FUNCTION:
-AUTHORITY_INFO_ACCESS_free              2048	EXIST::FUNCTION:
-ASN1_IA5STRING_new                      2049	EXIST::FUNCTION:
-d2i_DSA_PUBKEY                          2050	EXIST::FUNCTION:DSA
-X509_check_purpose                      2051	EXIST::FUNCTION:
-ASN1_ENUMERATED_new                     2052	EXIST::FUNCTION:
-d2i_RSA_PUBKEY_bio                      2053	EXIST::FUNCTION:BIO,RSA
-d2i_PUBKEY                              2054	EXIST::FUNCTION:
-X509_TRUST_get_trust                    2055	EXIST::FUNCTION:
-X509_TRUST_get_flags                    2056	EXIST::FUNCTION:
-ASN1_BMPSTRING_free                     2057	EXIST::FUNCTION:
-ASN1_T61STRING_new                      2058	EXIST::FUNCTION:
-ASN1_UTCTIME_new                        2060	EXIST::FUNCTION:
-i2d_AUTHORITY_INFO_ACCESS               2062	EXIST::FUNCTION:
-EVP_PKEY_set1_RSA                       2063	EXIST::FUNCTION:RSA
-X509_STORE_CTX_set_purpose              2064	EXIST::FUNCTION:
-ASN1_IA5STRING_free                     2065	EXIST::FUNCTION:
-PEM_write_bio_X509_AUX                  2066	EXIST::FUNCTION:
-X509_PURPOSE_get_count                  2067	EXIST::FUNCTION:
-CRYPTO_add_info                         2068	NOEXIST::FUNCTION:
-X509_NAME_ENTRY_create_by_txt           2071	EXIST::FUNCTION:
-ASN1_STRING_get_default_mask            2072	EXIST::FUNCTION:
-X509_alias_get0                         2074	EXIST::FUNCTION:
-ASN1_STRING_data                        2075	EXIST::FUNCTION:
-i2d_ACCESS_DESCRIPTION                  2077	EXIST::FUNCTION:
-X509_trust_set_bit                      2078	NOEXIST::FUNCTION:
-ASN1_BIT_STRING_free                    2080	EXIST::FUNCTION:
-PEM_read_bio_RSA_PUBKEY                 2081	EXIST::FUNCTION:RSA
-X509_add1_reject_object                 2082	EXIST::FUNCTION:
-X509_check_trust                        2083	EXIST::FUNCTION:
-PEM_read_bio_DSA_PUBKEY                 2088	EXIST::FUNCTION:DSA
-X509_PURPOSE_add                        2090	EXIST::FUNCTION:
-ASN1_STRING_TABLE_get                   2091	EXIST::FUNCTION:
-ASN1_UTF8STRING_free                    2092	EXIST::FUNCTION:
-d2i_DSA_PUBKEY_bio                      2093	EXIST::FUNCTION:BIO,DSA
-PEM_write_RSA_PUBKEY                    2095	EXIST:!WIN16:FUNCTION:RSA
-d2i_OTHERNAME                           2096	EXIST::FUNCTION:
-X509_reject_set_bit                     2098	NOEXIST::FUNCTION:
-PEM_write_DSA_PUBKEY                    2101	EXIST:!WIN16:FUNCTION:DSA
-X509_PURPOSE_get0_sname                 2105	EXIST::FUNCTION:
-EVP_PKEY_set1_DH                        2107	EXIST::FUNCTION:DH
-ASN1_OCTET_STRING_dup                   2108	EXIST::FUNCTION:
-ASN1_BIT_STRING_set                     2109	EXIST::FUNCTION:
-X509_TRUST_get_count                    2110	EXIST::FUNCTION:
-ASN1_INTEGER_free                       2111	EXIST::FUNCTION:
-OTHERNAME_free                          2112	EXIST::FUNCTION:
-i2d_RSA_PUBKEY_fp                       2113	EXIST::FUNCTION:FP_API,RSA
-ASN1_INTEGER_dup                        2114	EXIST::FUNCTION:
-d2i_X509_CERT_AUX                       2115	EXIST::FUNCTION:
-PEM_write_bio_PUBKEY                    2117	EXIST::FUNCTION:
-ASN1_VISIBLESTRING_free                 2118	EXIST::FUNCTION:
-X509_PURPOSE_cleanup                    2119	EXIST::FUNCTION:
-ASN1_mbstring_ncopy                     2123	EXIST::FUNCTION:
-ASN1_GENERALIZEDTIME_new                2126	EXIST::FUNCTION:
-EVP_PKEY_get1_DH                        2128	EXIST::FUNCTION:DH
-ASN1_OCTET_STRING_new                   2130	EXIST::FUNCTION:
-ASN1_INTEGER_new                        2131	EXIST::FUNCTION:
-i2d_X509_AUX                            2132	EXIST::FUNCTION:
-ASN1_BIT_STRING_name_print              2134	EXIST::FUNCTION:BIO
-X509_cmp                                2135	EXIST::FUNCTION:
-ASN1_STRING_length_set                  2136	EXIST::FUNCTION:
-DIRECTORYSTRING_new                     2137	EXIST::FUNCTION:
-X509_add1_trust_object                  2140	EXIST::FUNCTION:
-PKCS12_newpass                          2141	EXIST::FUNCTION:
-SMIME_write_PKCS7                       2142	EXIST::FUNCTION:
-SMIME_read_PKCS7                        2143	EXIST::FUNCTION:
-DES_set_key_checked                     2144	EXIST::FUNCTION:DES
-PKCS7_verify                            2145	EXIST::FUNCTION:
-PKCS7_encrypt                           2146	EXIST::FUNCTION:
-DES_set_key_unchecked                   2147	EXIST::FUNCTION:DES
-SMIME_crlf_copy                         2148	EXIST::FUNCTION:
-i2d_ASN1_PRINTABLESTRING                2149	EXIST::FUNCTION:
-PKCS7_get0_signers                      2150	EXIST::FUNCTION:
-PKCS7_decrypt                           2151	EXIST::FUNCTION:
-SMIME_text                              2152	EXIST::FUNCTION:
-PKCS7_simple_smimecap                   2153	EXIST::FUNCTION:
-PKCS7_get_smimecap                      2154	EXIST::FUNCTION:
-PKCS7_sign                              2155	EXIST::FUNCTION:
-PKCS7_add_attrib_smimecap               2156	EXIST::FUNCTION:
-CRYPTO_dbg_set_options                  2157	EXIST::FUNCTION:
-CRYPTO_remove_all_info                  2158	EXIST::FUNCTION:
-CRYPTO_get_mem_debug_functions          2159	EXIST::FUNCTION:
-CRYPTO_is_mem_check_on                  2160	EXIST::FUNCTION:
-CRYPTO_set_mem_debug_functions          2161	EXIST::FUNCTION:
-CRYPTO_pop_info                         2162	EXIST::FUNCTION:
-CRYPTO_push_info_                       2163	EXIST::FUNCTION:
-CRYPTO_set_mem_debug_options            2164	EXIST::FUNCTION:
-PEM_write_PKCS8PrivateKey_nid           2165	EXIST::FUNCTION:
-PEM_write_bio_PKCS8PrivateKey_nid       2166	EXIST:!VMS:FUNCTION:
-PEM_write_bio_PKCS8PrivKey_nid          2166	EXIST:VMS:FUNCTION:
-d2i_PKCS8PrivateKey_bio                 2167	EXIST::FUNCTION:
-ASN1_NULL_free                          2168	EXIST::FUNCTION:
-d2i_ASN1_NULL                           2169	EXIST::FUNCTION:
-ASN1_NULL_new                           2170	EXIST::FUNCTION:
-i2d_PKCS8PrivateKey_bio                 2171	EXIST::FUNCTION:
-i2d_PKCS8PrivateKey_fp                  2172	EXIST::FUNCTION:
-i2d_ASN1_NULL                           2173	EXIST::FUNCTION:
-i2d_PKCS8PrivateKey_nid_fp              2174	EXIST::FUNCTION:
-d2i_PKCS8PrivateKey_fp                  2175	EXIST::FUNCTION:
-i2d_PKCS8PrivateKey_nid_bio             2176	EXIST::FUNCTION:
-i2d_PKCS8PrivateKeyInfo_fp              2177	EXIST::FUNCTION:FP_API
-i2d_PKCS8PrivateKeyInfo_bio             2178	EXIST::FUNCTION:BIO
-PEM_cb                                  2179	NOEXIST::FUNCTION:
-i2d_PrivateKey_fp                       2180	EXIST::FUNCTION:FP_API
-d2i_PrivateKey_bio                      2181	EXIST::FUNCTION:BIO
-d2i_PrivateKey_fp                       2182	EXIST::FUNCTION:FP_API
-i2d_PrivateKey_bio                      2183	EXIST::FUNCTION:BIO
-X509_reject_clear                       2184	EXIST::FUNCTION:
-X509_TRUST_set_default                  2185	EXIST::FUNCTION:
-d2i_AutoPrivateKey                      2186	EXIST::FUNCTION:
-X509_ATTRIBUTE_get0_type                2187	EXIST::FUNCTION:
-X509_ATTRIBUTE_set1_data                2188	EXIST::FUNCTION:
-X509at_get_attr                         2189	EXIST::FUNCTION:
-X509at_get_attr_count                   2190	EXIST::FUNCTION:
-X509_ATTRIBUTE_create_by_NID            2191	EXIST::FUNCTION:
-X509_ATTRIBUTE_set1_object              2192	EXIST::FUNCTION:
-X509_ATTRIBUTE_count                    2193	EXIST::FUNCTION:
-X509_ATTRIBUTE_create_by_OBJ            2194	EXIST::FUNCTION:
-X509_ATTRIBUTE_get0_object              2195	EXIST::FUNCTION:
-X509at_get_attr_by_NID                  2196	EXIST::FUNCTION:
-X509at_add1_attr                        2197	EXIST::FUNCTION:
-X509_ATTRIBUTE_get0_data                2198	EXIST::FUNCTION:
-X509at_delete_attr                      2199	EXIST::FUNCTION:
-X509at_get_attr_by_OBJ                  2200	EXIST::FUNCTION:
-RAND_add                                2201	EXIST::FUNCTION:
-BIO_number_written                      2202	EXIST::FUNCTION:
-BIO_number_read                         2203	EXIST::FUNCTION:
-X509_STORE_CTX_get1_chain               2204	EXIST::FUNCTION:
-ERR_load_RAND_strings                   2205	EXIST::FUNCTION:
-RAND_pseudo_bytes                       2206	EXIST::FUNCTION:
-X509_REQ_get_attr_by_NID                2207	EXIST::FUNCTION:
-X509_REQ_get_attr                       2208	EXIST::FUNCTION:
-X509_REQ_add1_attr_by_NID               2209	EXIST::FUNCTION:
-X509_REQ_get_attr_by_OBJ                2210	EXIST::FUNCTION:
-X509at_add1_attr_by_NID                 2211	EXIST::FUNCTION:
-X509_REQ_add1_attr_by_OBJ               2212	EXIST::FUNCTION:
-X509_REQ_get_attr_count                 2213	EXIST::FUNCTION:
-X509_REQ_add1_attr                      2214	EXIST::FUNCTION:
-X509_REQ_delete_attr                    2215	EXIST::FUNCTION:
-X509at_add1_attr_by_OBJ                 2216	EXIST::FUNCTION:
-X509_REQ_add1_attr_by_txt               2217	EXIST::FUNCTION:
-X509_ATTRIBUTE_create_by_txt            2218	EXIST::FUNCTION:
-X509at_add1_attr_by_txt                 2219	EXIST::FUNCTION:
-BN_pseudo_rand                          2239	EXIST::FUNCTION:
-BN_is_prime_fasttest                    2240	EXIST::FUNCTION:
-BN_CTX_end                              2241	EXIST::FUNCTION:
-BN_CTX_start                            2242	EXIST::FUNCTION:
-BN_CTX_get                              2243	EXIST::FUNCTION:
-EVP_PKEY2PKCS8_broken                   2244	EXIST::FUNCTION:
-ASN1_STRING_TABLE_add                   2245	EXIST::FUNCTION:
-CRYPTO_dbg_get_options                  2246	EXIST::FUNCTION:
-AUTHORITY_INFO_ACCESS_new               2247	EXIST::FUNCTION:
-CRYPTO_get_mem_debug_options            2248	EXIST::FUNCTION:
-DES_crypt                               2249	EXIST::FUNCTION:DES
-PEM_write_bio_X509_REQ_NEW              2250	EXIST::FUNCTION:
-PEM_write_X509_REQ_NEW                  2251	EXIST:!WIN16:FUNCTION:
-BIO_callback_ctrl                       2252	EXIST::FUNCTION:
-RAND_egd                                2253	EXIST::FUNCTION:
-RAND_status                             2254	EXIST::FUNCTION:
-bn_dump1                                2255	NOEXIST::FUNCTION:
-DES_check_key_parity                    2256	EXIST::FUNCTION:DES
-lh_num_items                            2257	EXIST::FUNCTION:
-RAND_event                              2258	EXIST:WIN32:FUNCTION:
-DSO_new                                 2259	EXIST::FUNCTION:
-DSO_new_method                          2260	EXIST::FUNCTION:
-DSO_free                                2261	EXIST::FUNCTION:
-DSO_flags                               2262	EXIST::FUNCTION:
-DSO_up                                  2263	NOEXIST::FUNCTION:
-DSO_set_default_method                  2264	EXIST::FUNCTION:
-DSO_get_default_method                  2265	EXIST::FUNCTION:
-DSO_get_method                          2266	EXIST::FUNCTION:
-DSO_set_method                          2267	EXIST::FUNCTION:
-DSO_load                                2268	EXIST::FUNCTION:
-DSO_bind_var                            2269	EXIST::FUNCTION:
-DSO_METHOD_null                         2270	EXIST::FUNCTION:
-DSO_METHOD_openssl                      2271	EXIST::FUNCTION:
-DSO_METHOD_dlfcn                        2272	EXIST::FUNCTION:
-DSO_METHOD_win32                        2273	EXIST::FUNCTION:
-ERR_load_DSO_strings                    2274	EXIST::FUNCTION:
-DSO_METHOD_dl                           2275	EXIST::FUNCTION:
-NCONF_load                              2276	EXIST::FUNCTION:
-NCONF_load_fp                           2278	EXIST::FUNCTION:FP_API
-NCONF_new                               2279	EXIST::FUNCTION:
-NCONF_get_string                        2280	EXIST::FUNCTION:
-NCONF_free                              2281	EXIST::FUNCTION:
-NCONF_get_number                        2282	NOEXIST::FUNCTION:
-CONF_dump_fp                            2283	EXIST::FUNCTION:
-NCONF_load_bio                          2284	EXIST::FUNCTION:
-NCONF_dump_fp                           2285	EXIST::FUNCTION:
-NCONF_get_section                       2286	EXIST::FUNCTION:
-NCONF_dump_bio                          2287	EXIST::FUNCTION:
-CONF_dump_bio                           2288	EXIST::FUNCTION:
-NCONF_free_data                         2289	EXIST::FUNCTION:
-CONF_set_default_method                 2290	EXIST::FUNCTION:
-ERR_error_string_n                      2291	EXIST::FUNCTION:
-BIO_snprintf                            2292	EXIST::FUNCTION:
-DSO_ctrl                                2293	EXIST::FUNCTION:
-i2d_ASN1_SET_OF_ASN1_INTEGER            2317	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_PKCS12_SAFEBAG          2320	NOEXIST::FUNCTION:
-i2d_ASN1_SET_OF_PKCS7                   2328	NOEXIST::FUNCTION:
-BIO_vfree                               2334	EXIST::FUNCTION:
-d2i_ASN1_SET_OF_ASN1_INTEGER            2339	NOEXIST::FUNCTION:
-d2i_ASN1_SET_OF_PKCS12_SAFEBAG          2341	NOEXIST::FUNCTION:
-ASN1_UTCTIME_get                        2350	NOEXIST::FUNCTION:
-X509_REQ_digest                         2362	EXIST::FUNCTION:EVP
-X509_CRL_digest                         2391	EXIST::FUNCTION:EVP
-d2i_ASN1_SET_OF_PKCS7                   2397	NOEXIST::FUNCTION:
-EVP_CIPHER_CTX_set_key_length           2399	EXIST::FUNCTION:
-EVP_CIPHER_CTX_ctrl                     2400	EXIST::FUNCTION:
-BN_mod_exp_mont_word                    2401	EXIST::FUNCTION:
-RAND_egd_bytes                          2402	EXIST::FUNCTION:
-X509_REQ_get1_email                     2403	EXIST::FUNCTION:
-X509_get1_email                         2404	EXIST::FUNCTION:
-X509_email_free                         2405	EXIST::FUNCTION:
-i2d_RSA_NET                             2406	EXIST::FUNCTION:RSA
-d2i_RSA_NET_2                           2407	NOEXIST::FUNCTION:
-d2i_RSA_NET                             2408	EXIST::FUNCTION:RSA
-DSO_bind_func                           2409	EXIST::FUNCTION:
-CRYPTO_get_new_dynlockid                2410	EXIST::FUNCTION:
-sk_new_null                             2411	EXIST::FUNCTION:
-CRYPTO_set_dynlock_destroy_callback     2412	EXIST:!VMS:FUNCTION:
-CRYPTO_set_dynlock_destroy_cb           2412	EXIST:VMS:FUNCTION:
-CRYPTO_destroy_dynlockid                2413	EXIST::FUNCTION:
-CRYPTO_set_dynlock_size                 2414	NOEXIST::FUNCTION:
-CRYPTO_set_dynlock_create_callback      2415	EXIST:!VMS:FUNCTION:
-CRYPTO_set_dynlock_create_cb            2415	EXIST:VMS:FUNCTION:
-CRYPTO_set_dynlock_lock_callback        2416	EXIST:!VMS:FUNCTION:
-CRYPTO_set_dynlock_lock_cb              2416	EXIST:VMS:FUNCTION:
-CRYPTO_get_dynlock_lock_callback        2417	EXIST:!VMS:FUNCTION:
-CRYPTO_get_dynlock_lock_cb              2417	EXIST:VMS:FUNCTION:
-CRYPTO_get_dynlock_destroy_callback     2418	EXIST:!VMS:FUNCTION:
-CRYPTO_get_dynlock_destroy_cb           2418	EXIST:VMS:FUNCTION:
-CRYPTO_get_dynlock_value                2419	EXIST::FUNCTION:
-CRYPTO_get_dynlock_create_callback      2420	EXIST:!VMS:FUNCTION:
-CRYPTO_get_dynlock_create_cb            2420	EXIST:VMS:FUNCTION:
-c2i_ASN1_BIT_STRING                     2421	EXIST::FUNCTION:
-i2c_ASN1_BIT_STRING                     2422	EXIST::FUNCTION:
-RAND_poll                               2423	EXIST::FUNCTION:
-c2i_ASN1_INTEGER                        2424	EXIST::FUNCTION:
-i2c_ASN1_INTEGER                        2425	EXIST::FUNCTION:
-BIO_dump_indent                         2426	EXIST::FUNCTION:
-ASN1_parse_dump                         2427	EXIST::FUNCTION:BIO
-c2i_ASN1_OBJECT                         2428	EXIST::FUNCTION:
-X509_NAME_print_ex_fp                   2429	EXIST::FUNCTION:FP_API
-ASN1_STRING_print_ex_fp                 2430	EXIST::FUNCTION:FP_API
-X509_NAME_print_ex                      2431	EXIST::FUNCTION:BIO
-ASN1_STRING_print_ex                    2432	EXIST::FUNCTION:BIO
-MD4                                     2433	EXIST::FUNCTION:MD4
-MD4_Transform                           2434	EXIST::FUNCTION:MD4
-MD4_Final                               2435	EXIST::FUNCTION:MD4
-MD4_Update                              2436	EXIST::FUNCTION:MD4
-MD4_Init                                2437	EXIST::FUNCTION:MD4
-EVP_md4                                 2438	EXIST::FUNCTION:MD4
-i2d_PUBKEY_bio                          2439	EXIST::FUNCTION:BIO
-i2d_PUBKEY_fp                           2440	EXIST::FUNCTION:FP_API
-d2i_PUBKEY_bio                          2441	EXIST::FUNCTION:BIO
-ASN1_STRING_to_UTF8                     2442	EXIST::FUNCTION:
-BIO_vprintf                             2443	EXIST::FUNCTION:
-BIO_vsnprintf                           2444	EXIST::FUNCTION:
-d2i_PUBKEY_fp                           2445	EXIST::FUNCTION:FP_API
-X509_cmp_time                           2446	EXIST::FUNCTION:
-X509_STORE_CTX_set_time                 2447	EXIST::FUNCTION:
-X509_STORE_CTX_get1_issuer              2448	EXIST::FUNCTION:
-X509_OBJECT_retrieve_match              2449	EXIST::FUNCTION:
-X509_OBJECT_idx_by_subject              2450	EXIST::FUNCTION:
-X509_STORE_CTX_set_flags                2451	EXIST::FUNCTION:
-X509_STORE_CTX_trusted_stack            2452	EXIST::FUNCTION:
-X509_time_adj                           2453	EXIST::FUNCTION:
-X509_check_issued                       2454	EXIST::FUNCTION:
-ASN1_UTCTIME_cmp_time_t                 2455	EXIST::FUNCTION:
-DES_set_weak_key_flag                   2456	NOEXIST::FUNCTION:
-DES_check_key                           2457	NOEXIST::FUNCTION:
-DES_rw_mode                             2458	NOEXIST::FUNCTION:
-RSA_PKCS1_RSAref                        2459	NOEXIST::FUNCTION:
-X509_keyid_set1                         2460	EXIST::FUNCTION:
-BIO_next                                2461	EXIST::FUNCTION:
-DSO_METHOD_vms                          2462	EXIST::FUNCTION:
-BIO_f_linebuffer                        2463	EXIST:VMS:FUNCTION:
-BN_bntest_rand                          2464	EXIST::FUNCTION:
-OPENSSL_issetugid                       2465	EXIST::FUNCTION:
-BN_rand_range                           2466	EXIST::FUNCTION:
-ERR_load_ENGINE_strings                 2467	EXIST::FUNCTION:ENGINE
-ENGINE_set_DSA                          2468	EXIST::FUNCTION:ENGINE
-ENGINE_get_finish_function              2469	EXIST::FUNCTION:ENGINE
-ENGINE_get_default_RSA                  2470	EXIST::FUNCTION:ENGINE
-ENGINE_get_BN_mod_exp                   2471	NOEXIST::FUNCTION:
-DSA_get_default_openssl_method          2472	NOEXIST::FUNCTION:
-ENGINE_set_DH                           2473	EXIST::FUNCTION:ENGINE
-ENGINE_set_def_BN_mod_exp_crt           2474	NOEXIST::FUNCTION:
-ENGINE_set_default_BN_mod_exp_crt       2474	NOEXIST::FUNCTION:
-ENGINE_init                             2475	EXIST::FUNCTION:ENGINE
-DH_get_default_openssl_method           2476	NOEXIST::FUNCTION:
-RSA_set_default_openssl_method          2477	NOEXIST::FUNCTION:
-ENGINE_finish                           2478	EXIST::FUNCTION:ENGINE
-ENGINE_load_public_key                  2479	EXIST::FUNCTION:ENGINE
-ENGINE_get_DH                           2480	EXIST::FUNCTION:ENGINE
-ENGINE_ctrl                             2481	EXIST::FUNCTION:ENGINE
-ENGINE_get_init_function                2482	EXIST::FUNCTION:ENGINE
-ENGINE_set_init_function                2483	EXIST::FUNCTION:ENGINE
-ENGINE_set_default_DSA                  2484	EXIST::FUNCTION:ENGINE
-ENGINE_get_name                         2485	EXIST::FUNCTION:ENGINE
-ENGINE_get_last                         2486	EXIST::FUNCTION:ENGINE
-ENGINE_get_prev                         2487	EXIST::FUNCTION:ENGINE
-ENGINE_get_default_DH                   2488	EXIST::FUNCTION:ENGINE
-ENGINE_get_RSA                          2489	EXIST::FUNCTION:ENGINE
-ENGINE_set_default                      2490	EXIST::FUNCTION:ENGINE
-ENGINE_get_RAND                         2491	EXIST::FUNCTION:ENGINE
-ENGINE_get_first                        2492	EXIST::FUNCTION:ENGINE
-ENGINE_by_id                            2493	EXIST::FUNCTION:ENGINE
-ENGINE_set_finish_function              2494	EXIST::FUNCTION:ENGINE
-ENGINE_get_def_BN_mod_exp_crt           2495	NOEXIST::FUNCTION:
-ENGINE_get_default_BN_mod_exp_crt       2495	NOEXIST::FUNCTION:
-RSA_get_default_openssl_method          2496	NOEXIST::FUNCTION:
-ENGINE_set_RSA                          2497	EXIST::FUNCTION:ENGINE
-ENGINE_load_private_key                 2498	EXIST::FUNCTION:ENGINE
-ENGINE_set_default_RAND                 2499	EXIST::FUNCTION:ENGINE
-ENGINE_set_BN_mod_exp                   2500	NOEXIST::FUNCTION:
-ENGINE_remove                           2501	EXIST::FUNCTION:ENGINE
-ENGINE_free                             2502	EXIST::FUNCTION:ENGINE
-ENGINE_get_BN_mod_exp_crt               2503	NOEXIST::FUNCTION:
-ENGINE_get_next                         2504	EXIST::FUNCTION:ENGINE
-ENGINE_set_name                         2505	EXIST::FUNCTION:ENGINE
-ENGINE_get_default_DSA                  2506	EXIST::FUNCTION:ENGINE
-ENGINE_set_default_BN_mod_exp           2507	NOEXIST::FUNCTION:
-ENGINE_set_default_RSA                  2508	EXIST::FUNCTION:ENGINE
-ENGINE_get_default_RAND                 2509	EXIST::FUNCTION:ENGINE
-ENGINE_get_default_BN_mod_exp           2510	NOEXIST::FUNCTION:
-ENGINE_set_RAND                         2511	EXIST::FUNCTION:ENGINE
-ENGINE_set_id                           2512	EXIST::FUNCTION:ENGINE
-ENGINE_set_BN_mod_exp_crt               2513	NOEXIST::FUNCTION:
-ENGINE_set_default_DH                   2514	EXIST::FUNCTION:ENGINE
-ENGINE_new                              2515	EXIST::FUNCTION:ENGINE
-ENGINE_get_id                           2516	EXIST::FUNCTION:ENGINE
-DSA_set_default_openssl_method          2517	NOEXIST::FUNCTION:
-ENGINE_add                              2518	EXIST::FUNCTION:ENGINE
-DH_set_default_openssl_method           2519	NOEXIST::FUNCTION:
-ENGINE_get_DSA                          2520	EXIST::FUNCTION:ENGINE
-ENGINE_get_ctrl_function                2521	EXIST::FUNCTION:ENGINE
-ENGINE_set_ctrl_function                2522	EXIST::FUNCTION:ENGINE
-BN_pseudo_rand_range                    2523	EXIST::FUNCTION:
-X509_STORE_CTX_set_verify_cb            2524	EXIST::FUNCTION:
-ERR_load_COMP_strings                   2525	EXIST::FUNCTION:
-PKCS12_item_decrypt_d2i                 2526	EXIST::FUNCTION:
-ASN1_UTF8STRING_it                      2527	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_UTF8STRING_it                      2527	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_unregister_ciphers               2528	EXIST::FUNCTION:ENGINE
-ENGINE_get_ciphers                      2529	EXIST::FUNCTION:ENGINE
-d2i_OCSP_BASICRESP                      2530	EXIST::FUNCTION:
-KRB5_CHECKSUM_it                        2531	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_CHECKSUM_it                        2531	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EC_POINT_add                            2532	EXIST::FUNCTION:EC
-ASN1_item_ex_i2d                        2533	EXIST::FUNCTION:
-OCSP_CERTID_it                          2534	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_CERTID_it                          2534	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_OCSP_RESPBYTES                      2535	EXIST::FUNCTION:
-X509V3_add1_i2d                         2536	EXIST::FUNCTION:
-PKCS7_ENVELOPE_it                       2537	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_ENVELOPE_it                       2537	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_add_input_boolean                    2538	EXIST::FUNCTION:
-ENGINE_unregister_RSA                   2539	EXIST::FUNCTION:ENGINE
-X509V3_EXT_nconf                        2540	EXIST::FUNCTION:
-ASN1_GENERALSTRING_free                 2541	EXIST::FUNCTION:
-d2i_OCSP_CERTSTATUS                     2542	EXIST::FUNCTION:
-X509_REVOKED_set_serialNumber           2543	EXIST::FUNCTION:
-X509_print_ex                           2544	EXIST::FUNCTION:BIO
-OCSP_ONEREQ_get1_ext_d2i                2545	EXIST::FUNCTION:
-ENGINE_register_all_RAND                2546	EXIST::FUNCTION:ENGINE
-ENGINE_load_dynamic                     2547	EXIST::FUNCTION:ENGINE
-PBKDF2PARAM_it                          2548	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PBKDF2PARAM_it                          2548	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EXTENDED_KEY_USAGE_new                  2549	EXIST::FUNCTION:
-EC_GROUP_clear_free                     2550	EXIST::FUNCTION:EC
-OCSP_sendreq_bio                        2551	EXIST::FUNCTION:
-ASN1_item_digest                        2552	EXIST::FUNCTION:EVP
-OCSP_BASICRESP_delete_ext               2553	EXIST::FUNCTION:
-OCSP_SIGNATURE_it                       2554	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_SIGNATURE_it                       2554	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_CRL_it                             2555	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_CRL_it                             2555	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_BASICRESP_add_ext                  2556	EXIST::FUNCTION:
-KRB5_ENCKEY_it                          2557	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_ENCKEY_it                          2557	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_method_set_closer                    2558	EXIST::FUNCTION:
-X509_STORE_set_purpose                  2559	EXIST::FUNCTION:
-i2d_ASN1_GENERALSTRING                  2560	EXIST::FUNCTION:
-OCSP_response_status                    2561	EXIST::FUNCTION:
-i2d_OCSP_SERVICELOC                     2562	EXIST::FUNCTION:
-ENGINE_get_digest_engine                2563	EXIST::FUNCTION:ENGINE
-EC_GROUP_set_curve_GFp                  2564	EXIST::FUNCTION:EC
-OCSP_REQUEST_get_ext_by_OBJ             2565	EXIST::FUNCTION:
-_ossl_old_des_random_key                2566	EXIST::FUNCTION:DES
-ASN1_T61STRING_it                       2567	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_T61STRING_it                       2567	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EC_GROUP_method_of                      2568	EXIST::FUNCTION:EC
-i2d_KRB5_APREQ                          2569	EXIST::FUNCTION:
-_ossl_old_des_encrypt                   2570	EXIST::FUNCTION:DES
-ASN1_PRINTABLE_new                      2571	EXIST::FUNCTION:
-HMAC_Init_ex                            2572	EXIST::FUNCTION:HMAC
-d2i_KRB5_AUTHENT                        2573	EXIST::FUNCTION:
-OCSP_archive_cutoff_new                 2574	EXIST::FUNCTION:
-EC_POINT_set_Jprojective_coordinates_GFp 2575	EXIST:!VMS:FUNCTION:EC
-EC_POINT_set_Jproj_coords_GFp           2575	EXIST:VMS:FUNCTION:EC
-_ossl_old_des_is_weak_key               2576	EXIST::FUNCTION:DES
-OCSP_BASICRESP_get_ext_by_OBJ           2577	EXIST::FUNCTION:
-EC_POINT_oct2point                      2578	EXIST::FUNCTION:EC
-OCSP_SINGLERESP_get_ext_count           2579	EXIST::FUNCTION:
-UI_ctrl                                 2580	EXIST::FUNCTION:
-_shadow_DES_rw_mode                     2581	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:DES
-_shadow_DES_rw_mode                     2581	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:DES
-asn1_do_adb                             2582	EXIST::FUNCTION:
-ASN1_template_i2d                       2583	EXIST::FUNCTION:
-ENGINE_register_DH                      2584	EXIST::FUNCTION:ENGINE
-UI_construct_prompt                     2585	EXIST::FUNCTION:
-X509_STORE_set_trust                    2586	EXIST::FUNCTION:
-UI_dup_input_string                     2587	EXIST::FUNCTION:
-d2i_KRB5_APREQ                          2588	EXIST::FUNCTION:
-EVP_MD_CTX_copy_ex                      2589	EXIST::FUNCTION:
-OCSP_request_is_signed                  2590	EXIST::FUNCTION:
-i2d_OCSP_REQINFO                        2591	EXIST::FUNCTION:
-KRB5_ENCKEY_free                        2592	EXIST::FUNCTION:
-OCSP_resp_get0                          2593	EXIST::FUNCTION:
-GENERAL_NAME_it                         2594	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-GENERAL_NAME_it                         2594	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_GENERALIZEDTIME_it                 2595	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_GENERALIZEDTIME_it                 2595	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_STORE_set_flags                    2596	EXIST::FUNCTION:
-EC_POINT_set_compressed_coordinates_GFp 2597	EXIST:!VMS:FUNCTION:EC
-EC_POINT_set_compr_coords_GFp           2597	EXIST:VMS:FUNCTION:EC
-OCSP_response_status_str                2598	EXIST::FUNCTION:
-d2i_OCSP_REVOKEDINFO                    2599	EXIST::FUNCTION:
-OCSP_basic_add1_cert                    2600	EXIST::FUNCTION:
-ERR_get_implementation                  2601	EXIST::FUNCTION:
-EVP_CipherFinal_ex                      2602	EXIST::FUNCTION:
-OCSP_CERTSTATUS_new                     2603	EXIST::FUNCTION:
-CRYPTO_cleanup_all_ex_data              2604	EXIST::FUNCTION:
-OCSP_resp_find                          2605	EXIST::FUNCTION:
-BN_nnmod                                2606	EXIST::FUNCTION:
-X509_CRL_sort                           2607	EXIST::FUNCTION:
-X509_REVOKED_set_revocationDate         2608	EXIST::FUNCTION:
-ENGINE_register_RAND                    2609	EXIST::FUNCTION:ENGINE
-OCSP_SERVICELOC_new                     2610	EXIST::FUNCTION:
-EC_POINT_set_affine_coordinates_GFp     2611	EXIST:!VMS:FUNCTION:EC
-EC_POINT_set_affine_coords_GFp          2611	EXIST:VMS:FUNCTION:EC
-_ossl_old_des_options                   2612	EXIST::FUNCTION:DES
-SXNET_it                                2613	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-SXNET_it                                2613	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_dup_input_boolean                    2614	EXIST::FUNCTION:
-PKCS12_add_CSPName_asc                  2615	EXIST::FUNCTION:
-EC_POINT_is_at_infinity                 2616	EXIST::FUNCTION:EC
-ENGINE_load_cryptodev                   2617	EXIST::FUNCTION:ENGINE
-DSO_convert_filename                    2618	EXIST::FUNCTION:
-POLICYQUALINFO_it                       2619	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-POLICYQUALINFO_it                       2619	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_register_ciphers                 2620	EXIST::FUNCTION:ENGINE
-BN_mod_lshift_quick                     2621	EXIST::FUNCTION:
-DSO_set_filename                        2622	EXIST::FUNCTION:
-ASN1_item_free                          2623	EXIST::FUNCTION:
-KRB5_TKTBODY_free                       2624	EXIST::FUNCTION:
-AUTHORITY_KEYID_it                      2625	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-AUTHORITY_KEYID_it                      2625	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-KRB5_APREQBODY_new                      2626	EXIST::FUNCTION:
-X509V3_EXT_REQ_add_nconf                2627	EXIST::FUNCTION:
-ENGINE_ctrl_cmd_string                  2628	EXIST::FUNCTION:ENGINE
-i2d_OCSP_RESPDATA                       2629	EXIST::FUNCTION:
-EVP_MD_CTX_init                         2630	EXIST::FUNCTION:
-EXTENDED_KEY_USAGE_free                 2631	EXIST::FUNCTION:
-PKCS7_ATTR_SIGN_it                      2632	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_ATTR_SIGN_it                      2632	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_add_error_string                     2633	EXIST::FUNCTION:
-KRB5_CHECKSUM_free                      2634	EXIST::FUNCTION:
-OCSP_REQUEST_get_ext                    2635	EXIST::FUNCTION:
-ENGINE_load_ubsec                       2636	EXIST::FUNCTION:ENGINE
-ENGINE_register_all_digests             2637	EXIST::FUNCTION:ENGINE
-PKEY_USAGE_PERIOD_it                    2638	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKEY_USAGE_PERIOD_it                    2638	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PKCS12_unpack_authsafes                 2639	EXIST::FUNCTION:
-ASN1_item_unpack                        2640	EXIST::FUNCTION:
-NETSCAPE_SPKAC_it                       2641	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-NETSCAPE_SPKAC_it                       2641	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_REVOKED_it                         2642	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_REVOKED_it                         2642	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_STRING_encode                      2643	EXIST::FUNCTION:
-EVP_aes_128_ecb                         2644	EXIST::FUNCTION:AES
-KRB5_AUTHENT_free                       2645	EXIST::FUNCTION:
-OCSP_BASICRESP_get_ext_by_critical      2646	EXIST:!VMS:FUNCTION:
-OCSP_BASICRESP_get_ext_by_crit          2646	EXIST:VMS:FUNCTION:
-OCSP_cert_status_str                    2647	EXIST::FUNCTION:
-d2i_OCSP_REQUEST                        2648	EXIST::FUNCTION:
-UI_dup_info_string                      2649	EXIST::FUNCTION:
-_ossl_old_des_xwhite_in2out             2650	EXIST::FUNCTION:DES
-PKCS12_it                               2651	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS12_it                               2651	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_SINGLERESP_get_ext_by_critical     2652	EXIST:!VMS:FUNCTION:
-OCSP_SINGLERESP_get_ext_by_crit         2652	EXIST:VMS:FUNCTION:
-OCSP_CERTSTATUS_free                    2653	EXIST::FUNCTION:
-_ossl_old_des_crypt                     2654	EXIST::FUNCTION:DES
-ASN1_item_i2d                           2655	EXIST::FUNCTION:
-EVP_DecryptFinal_ex                     2656	EXIST::FUNCTION:
-ENGINE_load_openssl                     2657	EXIST::FUNCTION:ENGINE
-ENGINE_get_cmd_defns                    2658	EXIST::FUNCTION:ENGINE
-ENGINE_set_load_privkey_function        2659	EXIST:!VMS:FUNCTION:ENGINE
-ENGINE_set_load_privkey_fn              2659	EXIST:VMS:FUNCTION:ENGINE
-EVP_EncryptFinal_ex                     2660	EXIST::FUNCTION:
-ENGINE_set_default_digests              2661	EXIST::FUNCTION:ENGINE
-X509_get0_pubkey_bitstr                 2662	EXIST::FUNCTION:
-asn1_ex_i2c                             2663	EXIST::FUNCTION:
-ENGINE_register_RSA                     2664	EXIST::FUNCTION:ENGINE
-ENGINE_unregister_DSA                   2665	EXIST::FUNCTION:ENGINE
-_ossl_old_des_key_sched                 2666	EXIST::FUNCTION:DES
-X509_EXTENSION_it                       2667	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_EXTENSION_it                       2667	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-i2d_KRB5_AUTHENT                        2668	EXIST::FUNCTION:
-SXNETID_it                              2669	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-SXNETID_it                              2669	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_OCSP_SINGLERESP                     2670	EXIST::FUNCTION:
-EDIPARTYNAME_new                        2671	EXIST::FUNCTION:
-PKCS12_certbag2x509                     2672	EXIST::FUNCTION:
-_ossl_old_des_ofb64_encrypt             2673	EXIST::FUNCTION:DES
-d2i_EXTENDED_KEY_USAGE                  2674	EXIST::FUNCTION:
-ERR_print_errors_cb                     2675	EXIST::FUNCTION:
-ENGINE_set_ciphers                      2676	EXIST::FUNCTION:ENGINE
-d2i_KRB5_APREQBODY                      2677	EXIST::FUNCTION:
-UI_method_get_flusher                   2678	EXIST::FUNCTION:
-X509_PUBKEY_it                          2679	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_PUBKEY_it                          2679	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-_ossl_old_des_enc_read                  2680	EXIST::FUNCTION:DES
-PKCS7_ENCRYPT_it                        2681	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_ENCRYPT_it                        2681	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-i2d_OCSP_RESPONSE                       2682	EXIST::FUNCTION:
-EC_GROUP_get_cofactor                   2683	EXIST::FUNCTION:EC
-PKCS12_unpack_p7data                    2684	EXIST::FUNCTION:
-d2i_KRB5_AUTHDATA                       2685	EXIST::FUNCTION:
-OCSP_copy_nonce                         2686	EXIST::FUNCTION:
-KRB5_AUTHDATA_new                       2687	EXIST::FUNCTION:
-OCSP_RESPDATA_new                       2688	EXIST::FUNCTION:
-EC_GFp_mont_method                      2689	EXIST::FUNCTION:EC
-OCSP_REVOKEDINFO_free                   2690	EXIST::FUNCTION:
-UI_get_ex_data                          2691	EXIST::FUNCTION:
-KRB5_APREQBODY_free                     2692	EXIST::FUNCTION:
-EC_GROUP_get0_generator                 2693	EXIST::FUNCTION:EC
-UI_get_default_method                   2694	EXIST::FUNCTION:
-X509V3_set_nconf                        2695	EXIST::FUNCTION:
-PKCS12_item_i2d_encrypt                 2696	EXIST::FUNCTION:
-X509_add1_ext_i2d                       2697	EXIST::FUNCTION:
-PKCS7_SIGNER_INFO_it                    2698	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_SIGNER_INFO_it                    2698	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-KRB5_PRINCNAME_new                      2699	EXIST::FUNCTION:
-PKCS12_SAFEBAG_it                       2700	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS12_SAFEBAG_it                       2700	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EC_GROUP_get_order                      2701	EXIST::FUNCTION:EC
-d2i_OCSP_RESPID                         2702	EXIST::FUNCTION:
-OCSP_request_verify                     2703	EXIST::FUNCTION:
-NCONF_get_number_e                      2704	EXIST::FUNCTION:
-_ossl_old_des_decrypt3                  2705	EXIST::FUNCTION:DES
-X509_signature_print                    2706	EXIST::FUNCTION:EVP
-OCSP_SINGLERESP_free                    2707	EXIST::FUNCTION:
-ENGINE_load_builtin_engines             2708	EXIST::FUNCTION:ENGINE
-i2d_OCSP_ONEREQ                         2709	EXIST::FUNCTION:
-OCSP_REQUEST_add_ext                    2710	EXIST::FUNCTION:
-OCSP_RESPBYTES_new                      2711	EXIST::FUNCTION:
-EVP_MD_CTX_create                       2712	EXIST::FUNCTION:
-OCSP_resp_find_status                   2713	EXIST::FUNCTION:
-X509_ALGOR_it                           2714	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_ALGOR_it                           2714	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_TIME_it                            2715	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_TIME_it                            2715	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_request_set1_name                  2716	EXIST::FUNCTION:
-OCSP_ONEREQ_get_ext_count               2717	EXIST::FUNCTION:
-UI_get0_result                          2718	EXIST::FUNCTION:
-PKCS12_AUTHSAFES_it                     2719	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS12_AUTHSAFES_it                     2719	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EVP_aes_256_ecb                         2720	EXIST::FUNCTION:AES
-PKCS12_pack_authsafes                   2721	EXIST::FUNCTION:
-ASN1_IA5STRING_it                       2722	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_IA5STRING_it                       2722	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_get_input_flags                      2723	EXIST::FUNCTION:
-EC_GROUP_set_generator                  2724	EXIST::FUNCTION:EC
-_ossl_old_des_string_to_2keys           2725	EXIST::FUNCTION:DES
-OCSP_CERTID_free                        2726	EXIST::FUNCTION:
-X509_CERT_AUX_it                        2727	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_CERT_AUX_it                        2727	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-CERTIFICATEPOLICIES_it                  2728	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-CERTIFICATEPOLICIES_it                  2728	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-_ossl_old_des_ede3_cbc_encrypt          2729	EXIST::FUNCTION:DES
-RAND_set_rand_engine                    2730	EXIST::FUNCTION:ENGINE
-DSO_get_loaded_filename                 2731	EXIST::FUNCTION:
-X509_ATTRIBUTE_it                       2732	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_ATTRIBUTE_it                       2732	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_ONEREQ_get_ext_by_NID              2733	EXIST::FUNCTION:
-PKCS12_decrypt_skey                     2734	EXIST::FUNCTION:
-KRB5_AUTHENT_it                         2735	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_AUTHENT_it                         2735	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_dup_error_string                     2736	EXIST::FUNCTION:
-RSAPublicKey_it                         2737	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:RSA
-RSAPublicKey_it                         2737	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:RSA
-i2d_OCSP_REQUEST                        2738	EXIST::FUNCTION:
-PKCS12_x509crl2certbag                  2739	EXIST::FUNCTION:
-OCSP_SERVICELOC_it                      2740	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_SERVICELOC_it                      2740	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_item_sign                          2741	EXIST::FUNCTION:EVP
-X509_CRL_set_issuer_name                2742	EXIST::FUNCTION:
-OBJ_NAME_do_all_sorted                  2743	EXIST::FUNCTION:
-i2d_OCSP_BASICRESP                      2744	EXIST::FUNCTION:
-i2d_OCSP_RESPBYTES                      2745	EXIST::FUNCTION:
-PKCS12_unpack_p7encdata                 2746	EXIST::FUNCTION:
-HMAC_CTX_init                           2747	EXIST::FUNCTION:HMAC
-ENGINE_get_digest                       2748	EXIST::FUNCTION:ENGINE
-OCSP_RESPONSE_print                     2749	EXIST::FUNCTION:
-KRB5_TKTBODY_it                         2750	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_TKTBODY_it                         2750	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ACCESS_DESCRIPTION_it                   2751	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ACCESS_DESCRIPTION_it                   2751	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PKCS7_ISSUER_AND_SERIAL_it              2752	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_ISSUER_AND_SERIAL_it              2752	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PBE2PARAM_it                            2753	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PBE2PARAM_it                            2753	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PKCS12_certbag2x509crl                  2754	EXIST::FUNCTION:
-PKCS7_SIGNED_it                         2755	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_SIGNED_it                         2755	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_get_cipher                       2756	EXIST::FUNCTION:ENGINE
-i2d_OCSP_CRLID                          2757	EXIST::FUNCTION:
-OCSP_SINGLERESP_new                     2758	EXIST::FUNCTION:
-ENGINE_cmd_is_executable                2759	EXIST::FUNCTION:ENGINE
-RSA_up_ref                              2760	EXIST::FUNCTION:RSA
-ASN1_GENERALSTRING_it                   2761	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_GENERALSTRING_it                   2761	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_register_DSA                     2762	EXIST::FUNCTION:ENGINE
-X509V3_EXT_add_nconf_sk                 2763	EXIST::FUNCTION:
-ENGINE_set_load_pubkey_function         2764	EXIST::FUNCTION:ENGINE
-PKCS8_decrypt                           2765	EXIST::FUNCTION:
-PEM_bytes_read_bio                      2766	EXIST::FUNCTION:BIO
-DIRECTORYSTRING_it                      2767	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-DIRECTORYSTRING_it                      2767	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_OCSP_CRLID                          2768	EXIST::FUNCTION:
-EC_POINT_is_on_curve                    2769	EXIST::FUNCTION:EC
-CRYPTO_set_locked_mem_ex_functions      2770	EXIST:!VMS:FUNCTION:
-CRYPTO_set_locked_mem_ex_funcs          2770	EXIST:VMS:FUNCTION:
-d2i_KRB5_CHECKSUM                       2771	EXIST::FUNCTION:
-ASN1_item_dup                           2772	EXIST::FUNCTION:
-X509_it                                 2773	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_it                                 2773	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-BN_mod_add                              2774	EXIST::FUNCTION:
-KRB5_AUTHDATA_free                      2775	EXIST::FUNCTION:
-_ossl_old_des_cbc_cksum                 2776	EXIST::FUNCTION:DES
-ASN1_item_verify                        2777	EXIST::FUNCTION:EVP
-CRYPTO_set_mem_ex_functions             2778	EXIST::FUNCTION:
-EC_POINT_get_Jprojective_coordinates_GFp 2779	EXIST:!VMS:FUNCTION:EC
-EC_POINT_get_Jproj_coords_GFp           2779	EXIST:VMS:FUNCTION:EC
-ZLONG_it                                2780	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ZLONG_it                                2780	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-CRYPTO_get_locked_mem_ex_functions      2781	EXIST:!VMS:FUNCTION:
-CRYPTO_get_locked_mem_ex_funcs          2781	EXIST:VMS:FUNCTION:
-ASN1_TIME_check                         2782	EXIST::FUNCTION:
-UI_get0_user_data                       2783	EXIST::FUNCTION:
-HMAC_CTX_cleanup                        2784	EXIST::FUNCTION:HMAC
-DSA_up_ref                              2785	EXIST::FUNCTION:DSA
-_ossl_old_des_ede3_cfb64_encrypt        2786	EXIST:!VMS:FUNCTION:DES
-_ossl_odes_ede3_cfb64_encrypt           2786	EXIST:VMS:FUNCTION:DES
-ASN1_BMPSTRING_it                       2787	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_BMPSTRING_it                       2787	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_tag2bit                            2788	EXIST::FUNCTION:
-UI_method_set_flusher                   2789	EXIST::FUNCTION:
-X509_ocspid_print                       2790	EXIST::FUNCTION:BIO
-KRB5_ENCDATA_it                         2791	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_ENCDATA_it                         2791	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_get_load_pubkey_function         2792	EXIST::FUNCTION:ENGINE
-UI_add_user_data                        2793	EXIST::FUNCTION:
-OCSP_REQUEST_delete_ext                 2794	EXIST::FUNCTION:
-UI_get_method                           2795	EXIST::FUNCTION:
-OCSP_ONEREQ_free                        2796	EXIST::FUNCTION:
-ASN1_PRINTABLESTRING_it                 2797	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_PRINTABLESTRING_it                 2797	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_CRL_set_nextUpdate                 2798	EXIST::FUNCTION:
-OCSP_REQUEST_it                         2799	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_REQUEST_it                         2799	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_BASICRESP_it                       2800	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_BASICRESP_it                       2800	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-AES_ecb_encrypt                         2801	EXIST::FUNCTION:AES
-BN_mod_sqr                              2802	EXIST::FUNCTION:
-NETSCAPE_CERT_SEQUENCE_it               2803	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-NETSCAPE_CERT_SEQUENCE_it               2803	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-GENERAL_NAMES_it                        2804	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-GENERAL_NAMES_it                        2804	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-AUTHORITY_INFO_ACCESS_it                2805	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-AUTHORITY_INFO_ACCESS_it                2805	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_FBOOLEAN_it                        2806	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_FBOOLEAN_it                        2806	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_set_ex_data                          2807	EXIST::FUNCTION:
-_ossl_old_des_string_to_key             2808	EXIST::FUNCTION:DES
-ENGINE_register_all_RSA                 2809	EXIST::FUNCTION:ENGINE
-d2i_KRB5_PRINCNAME                      2810	EXIST::FUNCTION:
-OCSP_RESPBYTES_it                       2811	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_RESPBYTES_it                       2811	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_CINF_it                            2812	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_CINF_it                            2812	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_unregister_digests               2813	EXIST::FUNCTION:ENGINE
-d2i_EDIPARTYNAME                        2814	EXIST::FUNCTION:
-d2i_OCSP_SERVICELOC                     2815	EXIST::FUNCTION:
-ENGINE_get_digests                      2816	EXIST::FUNCTION:ENGINE
-_ossl_old_des_set_odd_parity            2817	EXIST::FUNCTION:DES
-OCSP_RESPDATA_free                      2818	EXIST::FUNCTION:
-d2i_KRB5_TICKET                         2819	EXIST::FUNCTION:
-OTHERNAME_it                            2820	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OTHERNAME_it                            2820	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EVP_MD_CTX_cleanup                      2821	EXIST::FUNCTION:
-d2i_ASN1_GENERALSTRING                  2822	EXIST::FUNCTION:
-X509_CRL_set_version                    2823	EXIST::FUNCTION:
-BN_mod_sub                              2824	EXIST::FUNCTION:
-OCSP_SINGLERESP_get_ext_by_NID          2825	EXIST::FUNCTION:
-ENGINE_get_ex_new_index                 2826	EXIST::FUNCTION:ENGINE
-OCSP_REQUEST_free                       2827	EXIST::FUNCTION:
-OCSP_REQUEST_add1_ext_i2d               2828	EXIST::FUNCTION:
-X509_VAL_it                             2829	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_VAL_it                             2829	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EC_POINTs_make_affine                   2830	EXIST::FUNCTION:EC
-EC_POINT_mul                            2831	EXIST::FUNCTION:EC
-X509V3_EXT_add_nconf                    2832	EXIST::FUNCTION:
-X509_TRUST_set                          2833	EXIST::FUNCTION:
-X509_CRL_add1_ext_i2d                   2834	EXIST::FUNCTION:
-_ossl_old_des_fcrypt                    2835	EXIST::FUNCTION:DES
-DISPLAYTEXT_it                          2836	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-DISPLAYTEXT_it                          2836	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_CRL_set_lastUpdate                 2837	EXIST::FUNCTION:
-OCSP_BASICRESP_free                     2838	EXIST::FUNCTION:
-OCSP_BASICRESP_add1_ext_i2d             2839	EXIST::FUNCTION:
-d2i_KRB5_AUTHENTBODY                    2840	EXIST::FUNCTION:
-CRYPTO_set_ex_data_implementation       2841	EXIST:!VMS:FUNCTION:
-CRYPTO_set_ex_data_impl                 2841	EXIST:VMS:FUNCTION:
-KRB5_ENCDATA_new                        2842	EXIST::FUNCTION:
-DSO_up_ref                              2843	EXIST::FUNCTION:
-OCSP_crl_reason_str                     2844	EXIST::FUNCTION:
-UI_get0_result_string                   2845	EXIST::FUNCTION:
-ASN1_GENERALSTRING_new                  2846	EXIST::FUNCTION:
-X509_SIG_it                             2847	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_SIG_it                             2847	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ERR_set_implementation                  2848	EXIST::FUNCTION:
-ERR_load_EC_strings                     2849	EXIST::FUNCTION:EC
-UI_get0_action_string                   2850	EXIST::FUNCTION:
-OCSP_ONEREQ_get_ext                     2851	EXIST::FUNCTION:
-EC_POINT_method_of                      2852	EXIST::FUNCTION:EC
-i2d_KRB5_APREQBODY                      2853	EXIST::FUNCTION:
-_ossl_old_des_ecb3_encrypt              2854	EXIST::FUNCTION:DES
-CRYPTO_get_mem_ex_functions             2855	EXIST::FUNCTION:
-ENGINE_get_ex_data                      2856	EXIST::FUNCTION:ENGINE
-UI_destroy_method                       2857	EXIST::FUNCTION:
-ASN1_item_i2d_bio                       2858	EXIST::FUNCTION:BIO
-OCSP_ONEREQ_get_ext_by_OBJ              2859	EXIST::FUNCTION:
-ASN1_primitive_new                      2860	EXIST::FUNCTION:
-ASN1_PRINTABLE_it                       2861	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_PRINTABLE_it                       2861	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EVP_aes_192_ecb                         2862	EXIST::FUNCTION:AES
-OCSP_SIGNATURE_new                      2863	EXIST::FUNCTION:
-LONG_it                                 2864	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-LONG_it                                 2864	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_VISIBLESTRING_it                   2865	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_VISIBLESTRING_it                   2865	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_SINGLERESP_add1_ext_i2d            2866	EXIST::FUNCTION:
-d2i_OCSP_CERTID                         2867	EXIST::FUNCTION:
-ASN1_item_d2i_fp                        2868	EXIST::FUNCTION:FP_API
-CRL_DIST_POINTS_it                      2869	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-CRL_DIST_POINTS_it                      2869	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-GENERAL_NAME_print                      2870	EXIST::FUNCTION:
-OCSP_SINGLERESP_delete_ext              2871	EXIST::FUNCTION:
-PKCS12_SAFEBAGS_it                      2872	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS12_SAFEBAGS_it                      2872	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_OCSP_SIGNATURE                      2873	EXIST::FUNCTION:
-OCSP_request_add1_nonce                 2874	EXIST::FUNCTION:
-ENGINE_set_cmd_defns                    2875	EXIST::FUNCTION:ENGINE
-OCSP_SERVICELOC_free                    2876	EXIST::FUNCTION:
-EC_GROUP_free                           2877	EXIST::FUNCTION:EC
-ASN1_BIT_STRING_it                      2878	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_BIT_STRING_it                      2878	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_REQ_it                             2879	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_REQ_it                             2879	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-_ossl_old_des_cbc_encrypt               2880	EXIST::FUNCTION:DES
-ERR_unload_strings                      2881	EXIST::FUNCTION:
-PKCS7_SIGN_ENVELOPE_it                  2882	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_SIGN_ENVELOPE_it                  2882	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EDIPARTYNAME_free                       2883	EXIST::FUNCTION:
-OCSP_REQINFO_free                       2884	EXIST::FUNCTION:
-EC_GROUP_new_curve_GFp                  2885	EXIST::FUNCTION:EC
-OCSP_REQUEST_get1_ext_d2i               2886	EXIST::FUNCTION:
-PKCS12_item_pack_safebag                2887	EXIST::FUNCTION:
-asn1_ex_c2i                             2888	EXIST::FUNCTION:
-ENGINE_register_digests                 2889	EXIST::FUNCTION:ENGINE
-i2d_OCSP_REVOKEDINFO                    2890	EXIST::FUNCTION:
-asn1_enc_restore                        2891	EXIST::FUNCTION:
-UI_free                                 2892	EXIST::FUNCTION:
-UI_new_method                           2893	EXIST::FUNCTION:
-EVP_EncryptInit_ex                      2894	EXIST::FUNCTION:
-X509_pubkey_digest                      2895	EXIST::FUNCTION:EVP
-EC_POINT_invert                         2896	EXIST::FUNCTION:EC
-OCSP_basic_sign                         2897	EXIST::FUNCTION:
-i2d_OCSP_RESPID                         2898	EXIST::FUNCTION:
-OCSP_check_nonce                        2899	EXIST::FUNCTION:
-ENGINE_ctrl_cmd                         2900	EXIST::FUNCTION:ENGINE
-d2i_KRB5_ENCKEY                         2901	EXIST::FUNCTION:
-OCSP_parse_url                          2902	EXIST::FUNCTION:
-OCSP_SINGLERESP_get_ext                 2903	EXIST::FUNCTION:
-OCSP_CRLID_free                         2904	EXIST::FUNCTION:
-OCSP_BASICRESP_get1_ext_d2i             2905	EXIST::FUNCTION:
-RSAPrivateKey_it                        2906	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:RSA
-RSAPrivateKey_it                        2906	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:RSA
-ENGINE_register_all_DH                  2907	EXIST::FUNCTION:ENGINE
-i2d_EDIPARTYNAME                        2908	EXIST::FUNCTION:
-EC_POINT_get_affine_coordinates_GFp     2909	EXIST:!VMS:FUNCTION:EC
-EC_POINT_get_affine_coords_GFp          2909	EXIST:VMS:FUNCTION:EC
-OCSP_CRLID_new                          2910	EXIST::FUNCTION:
-ENGINE_get_flags                        2911	EXIST::FUNCTION:ENGINE
-OCSP_ONEREQ_it                          2912	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_ONEREQ_it                          2912	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_process                              2913	EXIST::FUNCTION:
-ASN1_INTEGER_it                         2914	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_INTEGER_it                         2914	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EVP_CipherInit_ex                       2915	EXIST::FUNCTION:
-UI_get_string_type                      2916	EXIST::FUNCTION:
-ENGINE_unregister_DH                    2917	EXIST::FUNCTION:ENGINE
-ENGINE_register_all_DSA                 2918	EXIST::FUNCTION:ENGINE
-OCSP_ONEREQ_get_ext_by_critical         2919	EXIST::FUNCTION:
-bn_dup_expand                           2920	EXIST::FUNCTION:
-OCSP_cert_id_new                        2921	EXIST::FUNCTION:
-BASIC_CONSTRAINTS_it                    2922	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-BASIC_CONSTRAINTS_it                    2922	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-BN_mod_add_quick                        2923	EXIST::FUNCTION:
-EC_POINT_new                            2924	EXIST::FUNCTION:EC
-EVP_MD_CTX_destroy                      2925	EXIST::FUNCTION:
-OCSP_RESPBYTES_free                     2926	EXIST::FUNCTION:
-EVP_aes_128_cbc                         2927	EXIST::FUNCTION:AES
-OCSP_SINGLERESP_get1_ext_d2i            2928	EXIST::FUNCTION:
-EC_POINT_free                           2929	EXIST::FUNCTION:EC
-DH_up_ref                               2930	EXIST::FUNCTION:DH
-X509_NAME_ENTRY_it                      2931	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_NAME_ENTRY_it                      2931	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_get_ex_new_index                     2932	EXIST::FUNCTION:
-BN_mod_sub_quick                        2933	EXIST::FUNCTION:
-OCSP_ONEREQ_add_ext                     2934	EXIST::FUNCTION:
-OCSP_request_sign                       2935	EXIST::FUNCTION:
-EVP_DigestFinal_ex                      2936	EXIST::FUNCTION:
-ENGINE_set_digests                      2937	EXIST::FUNCTION:ENGINE
-OCSP_id_issuer_cmp                      2938	EXIST::FUNCTION:
-OBJ_NAME_do_all                         2939	EXIST::FUNCTION:
-EC_POINTs_mul                           2940	EXIST::FUNCTION:EC
-ENGINE_register_complete                2941	EXIST::FUNCTION:ENGINE
-X509V3_EXT_nconf_nid                    2942	EXIST::FUNCTION:
-ASN1_SEQUENCE_it                        2943	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_SEQUENCE_it                        2943	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_set_default_method                   2944	EXIST::FUNCTION:
-RAND_query_egd_bytes                    2945	EXIST::FUNCTION:
-UI_method_get_writer                    2946	EXIST::FUNCTION:
-UI_OpenSSL                              2947	EXIST::FUNCTION:
-PEM_def_callback                        2948	EXIST::FUNCTION:
-ENGINE_cleanup                          2949	EXIST::FUNCTION:ENGINE
-DIST_POINT_it                           2950	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-DIST_POINT_it                           2950	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_SINGLERESP_it                      2951	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_SINGLERESP_it                      2951	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_KRB5_TKTBODY                        2952	EXIST::FUNCTION:
-EC_POINT_cmp                            2953	EXIST::FUNCTION:EC
-OCSP_REVOKEDINFO_new                    2954	EXIST::FUNCTION:
-i2d_OCSP_CERTSTATUS                     2955	EXIST::FUNCTION:
-OCSP_basic_add1_nonce                   2956	EXIST::FUNCTION:
-ASN1_item_ex_d2i                        2957	EXIST::FUNCTION:
-BN_mod_lshift1_quick                    2958	EXIST::FUNCTION:
-UI_set_method                           2959	EXIST::FUNCTION:
-OCSP_id_get0_info                       2960	EXIST::FUNCTION:
-BN_mod_sqrt                             2961	EXIST::FUNCTION:
-EC_GROUP_copy                           2962	EXIST::FUNCTION:EC
-KRB5_ENCDATA_free                       2963	EXIST::FUNCTION:
-_ossl_old_des_cfb_encrypt               2964	EXIST::FUNCTION:DES
-OCSP_SINGLERESP_get_ext_by_OBJ          2965	EXIST::FUNCTION:
-OCSP_cert_to_id                         2966	EXIST::FUNCTION:
-OCSP_RESPID_new                         2967	EXIST::FUNCTION:
-OCSP_RESPDATA_it                        2968	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_RESPDATA_it                        2968	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_OCSP_RESPDATA                       2969	EXIST::FUNCTION:
-ENGINE_register_all_complete            2970	EXIST::FUNCTION:ENGINE
-OCSP_check_validity                     2971	EXIST::FUNCTION:
-PKCS12_BAGS_it                          2972	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS12_BAGS_it                          2972	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_url_svcloc_new                     2973	EXIST::FUNCTION:
-ASN1_template_free                      2974	EXIST::FUNCTION:
-OCSP_SINGLERESP_add_ext                 2975	EXIST::FUNCTION:
-KRB5_AUTHENTBODY_it                     2976	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_AUTHENTBODY_it                     2976	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509_supported_extension                2977	EXIST::FUNCTION:
-i2d_KRB5_AUTHDATA                       2978	EXIST::FUNCTION:
-UI_method_get_opener                    2979	EXIST::FUNCTION:
-ENGINE_set_ex_data                      2980	EXIST::FUNCTION:ENGINE
-OCSP_REQUEST_print                      2981	EXIST::FUNCTION:
-CBIGNUM_it                              2982	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-CBIGNUM_it                              2982	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-KRB5_TICKET_new                         2983	EXIST::FUNCTION:
-KRB5_APREQ_new                          2984	EXIST::FUNCTION:
-EC_GROUP_get_curve_GFp                  2985	EXIST::FUNCTION:EC
-KRB5_ENCKEY_new                         2986	EXIST::FUNCTION:
-ASN1_template_d2i                       2987	EXIST::FUNCTION:
-_ossl_old_des_quad_cksum                2988	EXIST::FUNCTION:DES
-OCSP_single_get0_status                 2989	EXIST::FUNCTION:
-BN_swap                                 2990	EXIST::FUNCTION:
-POLICYINFO_it                           2991	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-POLICYINFO_it                           2991	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_set_destroy_function             2992	EXIST::FUNCTION:ENGINE
-asn1_enc_free                           2993	EXIST::FUNCTION:
-OCSP_RESPID_it                          2994	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_RESPID_it                          2994	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EC_GROUP_new                            2995	EXIST::FUNCTION:EC
-EVP_aes_256_cbc                         2996	EXIST::FUNCTION:AES
-i2d_KRB5_PRINCNAME                      2997	EXIST::FUNCTION:
-_ossl_old_des_encrypt2                  2998	EXIST::FUNCTION:DES
-_ossl_old_des_encrypt3                  2999	EXIST::FUNCTION:DES
-PKCS8_PRIV_KEY_INFO_it                  3000	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS8_PRIV_KEY_INFO_it                  3000	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_REQINFO_it                         3001	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_REQINFO_it                         3001	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PBEPARAM_it                             3002	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PBEPARAM_it                             3002	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-KRB5_AUTHENTBODY_new                    3003	EXIST::FUNCTION:
-X509_CRL_add0_revoked                   3004	EXIST::FUNCTION:
-EDIPARTYNAME_it                         3005	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-EDIPARTYNAME_it                         3005	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-NETSCAPE_SPKI_it                        3006	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-NETSCAPE_SPKI_it                        3006	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_get0_test_string                     3007	EXIST::FUNCTION:
-ENGINE_get_cipher_engine                3008	EXIST::FUNCTION:ENGINE
-ENGINE_register_all_ciphers             3009	EXIST::FUNCTION:ENGINE
-EC_POINT_copy                           3010	EXIST::FUNCTION:EC
-BN_kronecker                            3011	EXIST::FUNCTION:
-_ossl_old_des_ede3_ofb64_encrypt        3012	EXIST:!VMS:FUNCTION:DES
-_ossl_odes_ede3_ofb64_encrypt           3012	EXIST:VMS:FUNCTION:DES
-UI_method_get_reader                    3013	EXIST::FUNCTION:
-OCSP_BASICRESP_get_ext_count            3014	EXIST::FUNCTION:
-ASN1_ENUMERATED_it                      3015	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_ENUMERATED_it                      3015	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_set_result                           3016	EXIST::FUNCTION:
-i2d_KRB5_TICKET                         3017	EXIST::FUNCTION:
-X509_print_ex_fp                        3018	EXIST::FUNCTION:FP_API
-EVP_CIPHER_CTX_set_padding              3019	EXIST::FUNCTION:
-d2i_OCSP_RESPONSE                       3020	EXIST::FUNCTION:
-ASN1_UTCTIME_it                         3021	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_UTCTIME_it                         3021	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-_ossl_old_des_enc_write                 3022	EXIST::FUNCTION:DES
-OCSP_RESPONSE_new                       3023	EXIST::FUNCTION:
-AES_set_encrypt_key                     3024	EXIST::FUNCTION:AES
-OCSP_resp_count                         3025	EXIST::FUNCTION:
-KRB5_CHECKSUM_new                       3026	EXIST::FUNCTION:
-ENGINE_load_cswift                      3027	EXIST::FUNCTION:ENGINE
-OCSP_onereq_get0_id                     3028	EXIST::FUNCTION:
-ENGINE_set_default_ciphers              3029	EXIST::FUNCTION:ENGINE
-NOTICEREF_it                            3030	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-NOTICEREF_it                            3030	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509V3_EXT_CRL_add_nconf                3031	EXIST::FUNCTION:
-OCSP_REVOKEDINFO_it                     3032	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_REVOKEDINFO_it                     3032	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-AES_encrypt                             3033	EXIST::FUNCTION:AES
-OCSP_REQUEST_new                        3034	EXIST::FUNCTION:
-ASN1_ANY_it                             3035	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_ANY_it                             3035	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-CRYPTO_ex_data_new_class                3036	EXIST::FUNCTION:
-_ossl_old_des_ncbc_encrypt              3037	EXIST::FUNCTION:DES
-i2d_KRB5_TKTBODY                        3038	EXIST::FUNCTION:
-EC_POINT_clear_free                     3039	EXIST::FUNCTION:EC
-AES_decrypt                             3040	EXIST::FUNCTION:AES
-asn1_enc_init                           3041	EXIST::FUNCTION:
-UI_get_result_maxsize                   3042	EXIST::FUNCTION:
-OCSP_CERTID_new                         3043	EXIST::FUNCTION:
-ENGINE_unregister_RAND                  3044	EXIST::FUNCTION:ENGINE
-UI_method_get_closer                    3045	EXIST::FUNCTION:
-d2i_KRB5_ENCDATA                        3046	EXIST::FUNCTION:
-OCSP_request_onereq_count               3047	EXIST::FUNCTION:
-OCSP_basic_verify                       3048	EXIST::FUNCTION:
-KRB5_AUTHENTBODY_free                   3049	EXIST::FUNCTION:
-ASN1_item_d2i                           3050	EXIST::FUNCTION:
-ASN1_primitive_free                     3051	EXIST::FUNCTION:
-i2d_EXTENDED_KEY_USAGE                  3052	EXIST::FUNCTION:
-i2d_OCSP_SIGNATURE                      3053	EXIST::FUNCTION:
-asn1_enc_save                           3054	EXIST::FUNCTION:
-ENGINE_load_nuron                       3055	EXIST::FUNCTION:ENGINE
-_ossl_old_des_pcbc_encrypt              3056	EXIST::FUNCTION:DES
-PKCS12_MAC_DATA_it                      3057	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS12_MAC_DATA_it                      3057	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_accept_responses_new               3058	EXIST::FUNCTION:
-asn1_do_lock                            3059	EXIST::FUNCTION:
-PKCS7_ATTR_VERIFY_it                    3060	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_ATTR_VERIFY_it                    3060	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-KRB5_APREQBODY_it                       3061	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_APREQBODY_it                       3061	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-i2d_OCSP_SINGLERESP                     3062	EXIST::FUNCTION:
-ASN1_item_ex_new                        3063	EXIST::FUNCTION:
-UI_add_verify_string                    3064	EXIST::FUNCTION:
-_ossl_old_des_set_key                   3065	EXIST::FUNCTION:DES
-KRB5_PRINCNAME_it                       3066	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_PRINCNAME_it                       3066	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EVP_DecryptInit_ex                      3067	EXIST::FUNCTION:
-i2d_OCSP_CERTID                         3068	EXIST::FUNCTION:
-ASN1_item_d2i_bio                       3069	EXIST::FUNCTION:BIO
-EC_POINT_dbl                            3070	EXIST::FUNCTION:EC
-asn1_get_choice_selector                3071	EXIST::FUNCTION:
-i2d_KRB5_CHECKSUM                       3072	EXIST::FUNCTION:
-ENGINE_set_table_flags                  3073	EXIST::FUNCTION:ENGINE
-AES_options                             3074	EXIST::FUNCTION:AES
-ENGINE_load_chil                        3075	EXIST::FUNCTION:ENGINE
-OCSP_id_cmp                             3076	EXIST::FUNCTION:
-OCSP_BASICRESP_new                      3077	EXIST::FUNCTION:
-OCSP_REQUEST_get_ext_by_NID             3078	EXIST::FUNCTION:
-KRB5_APREQ_it                           3079	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_APREQ_it                           3079	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_get_destroy_function             3080	EXIST::FUNCTION:ENGINE
-CONF_set_nconf                          3081	EXIST::FUNCTION:
-ASN1_PRINTABLE_free                     3082	EXIST::FUNCTION:
-OCSP_BASICRESP_get_ext_by_NID           3083	EXIST::FUNCTION:
-DIST_POINT_NAME_it                      3084	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-DIST_POINT_NAME_it                      3084	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-X509V3_extensions_print                 3085	EXIST::FUNCTION:
-_ossl_old_des_cfb64_encrypt             3086	EXIST::FUNCTION:DES
-X509_REVOKED_add1_ext_i2d               3087	EXIST::FUNCTION:
-_ossl_old_des_ofb_encrypt               3088	EXIST::FUNCTION:DES
-KRB5_TKTBODY_new                        3089	EXIST::FUNCTION:
-ASN1_OCTET_STRING_it                    3090	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_OCTET_STRING_it                    3090	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ERR_load_UI_strings                     3091	EXIST::FUNCTION:
-i2d_KRB5_ENCKEY                         3092	EXIST::FUNCTION:
-ASN1_template_new                       3093	EXIST::FUNCTION:
-OCSP_SIGNATURE_free                     3094	EXIST::FUNCTION:
-ASN1_item_i2d_fp                        3095	EXIST::FUNCTION:FP_API
-KRB5_PRINCNAME_free                     3096	EXIST::FUNCTION:
-PKCS7_RECIP_INFO_it                     3097	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_RECIP_INFO_it                     3097	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EXTENDED_KEY_USAGE_it                   3098	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-EXTENDED_KEY_USAGE_it                   3098	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EC_GFp_simple_method                    3099	EXIST::FUNCTION:EC
-EC_GROUP_precompute_mult                3100	EXIST::FUNCTION:EC
-OCSP_request_onereq_get0                3101	EXIST::FUNCTION:
-UI_method_set_writer                    3102	EXIST::FUNCTION:
-KRB5_AUTHENT_new                        3103	EXIST::FUNCTION:
-X509_CRL_INFO_it                        3104	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_CRL_INFO_it                        3104	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-DSO_set_name_converter                  3105	EXIST::FUNCTION:
-AES_set_decrypt_key                     3106	EXIST::FUNCTION:AES
-PKCS7_DIGEST_it                         3107	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_DIGEST_it                         3107	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PKCS12_x5092certbag                     3108	EXIST::FUNCTION:
-EVP_DigestInit_ex                       3109	EXIST::FUNCTION:
-i2a_ACCESS_DESCRIPTION                  3110	EXIST::FUNCTION:
-OCSP_RESPONSE_it                        3111	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_RESPONSE_it                        3111	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-PKCS7_ENC_CONTENT_it                    3112	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_ENC_CONTENT_it                    3112	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_request_add0_id                    3113	EXIST::FUNCTION:
-EC_POINT_make_affine                    3114	EXIST::FUNCTION:EC
-DSO_get_filename                        3115	EXIST::FUNCTION:
-OCSP_CERTSTATUS_it                      3116	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_CERTSTATUS_it                      3116	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_request_add1_cert                  3117	EXIST::FUNCTION:
-UI_get0_output_string                   3118	EXIST::FUNCTION:
-UI_dup_verify_string                    3119	EXIST::FUNCTION:
-BN_mod_lshift                           3120	EXIST::FUNCTION:
-KRB5_AUTHDATA_it                        3121	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_AUTHDATA_it                        3121	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-asn1_set_choice_selector                3122	EXIST::FUNCTION:
-OCSP_basic_add1_status                  3123	EXIST::FUNCTION:
-OCSP_RESPID_free                        3124	EXIST::FUNCTION:
-asn1_get_field_ptr                      3125	EXIST::FUNCTION:
-UI_add_input_string                     3126	EXIST::FUNCTION:
-OCSP_CRLID_it                           3127	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-OCSP_CRLID_it                           3127	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-i2d_KRB5_AUTHENTBODY                    3128	EXIST::FUNCTION:
-OCSP_REQUEST_get_ext_count              3129	EXIST::FUNCTION:
-ENGINE_load_atalla                      3130	EXIST::FUNCTION:ENGINE
-X509_NAME_it                            3131	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_NAME_it                            3131	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-USERNOTICE_it                           3132	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-USERNOTICE_it                           3132	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_REQINFO_new                        3133	EXIST::FUNCTION:
-OCSP_BASICRESP_get_ext                  3134	EXIST::FUNCTION:
-CRYPTO_get_ex_data_implementation       3135	EXIST:!VMS:FUNCTION:
-CRYPTO_get_ex_data_impl                 3135	EXIST:VMS:FUNCTION:
-ASN1_item_pack                          3136	EXIST::FUNCTION:
-i2d_KRB5_ENCDATA                        3137	EXIST::FUNCTION:
-X509_PURPOSE_set                        3138	EXIST::FUNCTION:
-X509_REQ_INFO_it                        3139	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-X509_REQ_INFO_it                        3139	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-UI_method_set_opener                    3140	EXIST::FUNCTION:
-ASN1_item_ex_free                       3141	EXIST::FUNCTION:
-ASN1_BOOLEAN_it                         3142	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_BOOLEAN_it                         3142	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ENGINE_get_table_flags                  3143	EXIST::FUNCTION:ENGINE
-UI_create_method                        3144	EXIST::FUNCTION:
-OCSP_ONEREQ_add1_ext_i2d                3145	EXIST::FUNCTION:
-_shadow_DES_check_key                   3146	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:DES
-_shadow_DES_check_key                   3146	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:DES
-d2i_OCSP_REQINFO                        3147	EXIST::FUNCTION:
-UI_add_info_string                      3148	EXIST::FUNCTION:
-UI_get_result_minsize                   3149	EXIST::FUNCTION:
-ASN1_NULL_it                            3150	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_NULL_it                            3150	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-BN_mod_lshift1                          3151	EXIST::FUNCTION:
-d2i_OCSP_ONEREQ                         3152	EXIST::FUNCTION:
-OCSP_ONEREQ_new                         3153	EXIST::FUNCTION:
-KRB5_TICKET_it                          3154	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-KRB5_TICKET_it                          3154	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-EVP_aes_192_cbc                         3155	EXIST::FUNCTION:AES
-KRB5_TICKET_free                        3156	EXIST::FUNCTION:
-UI_new                                  3157	EXIST::FUNCTION:
-OCSP_response_create                    3158	EXIST::FUNCTION:
-_ossl_old_des_xcbc_encrypt              3159	EXIST::FUNCTION:DES
-PKCS7_it                                3160	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-PKCS7_it                                3160	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_REQUEST_get_ext_by_critical        3161	EXIST:!VMS:FUNCTION:
-OCSP_REQUEST_get_ext_by_crit            3161	EXIST:VMS:FUNCTION:
-ENGINE_set_flags                        3162	EXIST::FUNCTION:ENGINE
-_ossl_old_des_ecb_encrypt               3163	EXIST::FUNCTION:DES
-OCSP_response_get1_basic                3164	EXIST::FUNCTION:
-EVP_Digest                              3165	EXIST::FUNCTION:
-OCSP_ONEREQ_delete_ext                  3166	EXIST::FUNCTION:
-ASN1_TBOOLEAN_it                        3167	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_TBOOLEAN_it                        3167	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-ASN1_item_new                           3168	EXIST::FUNCTION:
-ASN1_TIME_to_generalizedtime            3169	EXIST::FUNCTION:
-BIGNUM_it                               3170	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-BIGNUM_it                               3170	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-AES_cbc_encrypt                         3171	EXIST::FUNCTION:AES
-ENGINE_get_load_privkey_function        3172	EXIST:!VMS:FUNCTION:ENGINE
-ENGINE_get_load_privkey_fn              3172	EXIST:VMS:FUNCTION:ENGINE
-OCSP_RESPONSE_free                      3173	EXIST::FUNCTION:
-UI_method_set_reader                    3174	EXIST::FUNCTION:
-i2d_ASN1_T61STRING                      3175	EXIST::FUNCTION:
-EC_POINT_set_to_infinity                3176	EXIST::FUNCTION:EC
-ERR_load_OCSP_strings                   3177	EXIST::FUNCTION:
-EC_POINT_point2oct                      3178	EXIST::FUNCTION:EC
-KRB5_APREQ_free                         3179	EXIST::FUNCTION:
-ASN1_OBJECT_it                          3180	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_OBJECT_it                          3180	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-OCSP_crlID_new                          3181	EXIST:!OS2,!VMS,!WIN16:FUNCTION:
-OCSP_crlID2_new                         3181	EXIST:OS2,VMS,WIN16:FUNCTION:
-CONF_modules_load_file                  3182	EXIST::FUNCTION:
-CONF_imodule_set_usr_data               3183	EXIST::FUNCTION:
-ENGINE_set_default_string               3184	EXIST::FUNCTION:ENGINE
-CONF_module_get_usr_data                3185	EXIST::FUNCTION:
-ASN1_add_oid_module                     3186	EXIST::FUNCTION:
-CONF_modules_finish                     3187	EXIST::FUNCTION:
-OPENSSL_config                          3188	EXIST::FUNCTION:
-CONF_modules_unload                     3189	EXIST::FUNCTION:
-CONF_imodule_get_value                  3190	EXIST::FUNCTION:
-CONF_module_set_usr_data                3191	EXIST::FUNCTION:
-CONF_parse_list                         3192	EXIST::FUNCTION:
-CONF_module_add                         3193	EXIST::FUNCTION:
-CONF_get1_default_config_file           3194	EXIST::FUNCTION:
-CONF_imodule_get_flags                  3195	EXIST::FUNCTION:
-CONF_imodule_get_module                 3196	EXIST::FUNCTION:
-CONF_modules_load                       3197	EXIST::FUNCTION:
-CONF_imodule_get_name                   3198	EXIST::FUNCTION:
-ERR_peek_top_error                      3199	NOEXIST::FUNCTION:
-CONF_imodule_get_usr_data               3200	EXIST::FUNCTION:
-CONF_imodule_set_flags                  3201	EXIST::FUNCTION:
-ENGINE_add_conf_module                  3202	EXIST::FUNCTION:ENGINE
-ERR_peek_last_error_line                3203	EXIST::FUNCTION:
-ERR_peek_last_error_line_data           3204	EXIST::FUNCTION:
-ERR_peek_last_error                     3205	EXIST::FUNCTION:
-DES_read_2passwords                     3206	EXIST::FUNCTION:DES
-DES_read_password                       3207	EXIST::FUNCTION:DES
-UI_UTIL_read_pw                         3208	EXIST::FUNCTION:
-UI_UTIL_read_pw_string                  3209	EXIST::FUNCTION:
-ENGINE_load_aep                         3210	EXIST::FUNCTION:ENGINE
-ENGINE_load_sureware                    3211	EXIST::FUNCTION:ENGINE
-OPENSSL_add_all_algorithms_noconf       3212	EXIST:!VMS:FUNCTION:
-OPENSSL_add_all_algo_noconf             3212	EXIST:VMS:FUNCTION:
-OPENSSL_add_all_algorithms_conf         3213	EXIST:!VMS:FUNCTION:
-OPENSSL_add_all_algo_conf               3213	EXIST:VMS:FUNCTION:
-OPENSSL_load_builtin_modules            3214	EXIST::FUNCTION:
-AES_ofb128_encrypt                      3215	EXIST::FUNCTION:AES
-AES_ctr128_encrypt                      3216	EXIST::FUNCTION:AES
-AES_cfb128_encrypt                      3217	EXIST::FUNCTION:AES
-ENGINE_load_4758cca                     3218	EXIST::FUNCTION:ENGINE
-_ossl_096_des_random_seed               3219	EXIST::FUNCTION:DES
-EVP_aes_256_ofb                         3220	EXIST::FUNCTION:AES
-EVP_aes_192_ofb                         3221	EXIST::FUNCTION:AES
-EVP_aes_128_cfb128                      3222	EXIST::FUNCTION:AES
-EVP_aes_256_cfb128                      3223	EXIST::FUNCTION:AES
-EVP_aes_128_ofb                         3224	EXIST::FUNCTION:AES
-EVP_aes_192_cfb128                      3225	EXIST::FUNCTION:AES
-CONF_modules_free                       3226	EXIST::FUNCTION:
-NCONF_default                           3227	EXIST::FUNCTION:
-OPENSSL_no_config                       3228	EXIST::FUNCTION:
-NCONF_WIN32                             3229	EXIST::FUNCTION:
-ASN1_UNIVERSALSTRING_new                3230	EXIST::FUNCTION:
-EVP_des_ede_ecb                         3231	EXIST::FUNCTION:DES
-i2d_ASN1_UNIVERSALSTRING                3232	EXIST::FUNCTION:
-ASN1_UNIVERSALSTRING_free               3233	EXIST::FUNCTION:
-ASN1_UNIVERSALSTRING_it                 3234	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
-ASN1_UNIVERSALSTRING_it                 3234	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
-d2i_ASN1_UNIVERSALSTRING                3235	EXIST::FUNCTION:
-EVP_des_ede3_ecb                        3236	EXIST::FUNCTION:DES
-X509_REQ_print_ex                       3237	EXIST::FUNCTION:BIO
-ENGINE_up_ref                           3238	EXIST::FUNCTION:ENGINE
-BUF_MEM_grow_clean                      3239	EXIST::FUNCTION:
-CRYPTO_realloc_clean                    3240	EXIST::FUNCTION:
-BUF_strlcat                             3241	EXIST::FUNCTION:
-BIO_indent                              3242	EXIST::FUNCTION:
-BUF_strlcpy                             3243	EXIST::FUNCTION:
-OpenSSLDie                              3244	EXIST::FUNCTION:
-OPENSSL_cleanse                         3245	EXIST::FUNCTION:
-ENGINE_setup_bsd_cryptodev              3246	EXIST:__FreeBSD__:FUNCTION:ENGINE
-ERR_release_err_state_table             3247	EXIST::FUNCTION:LHASH
-EVP_aes_128_cfb8                        3248	EXIST::FUNCTION:AES
-FIPS_corrupt_rsa                        3249	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_selftest_des                       3250	EXIST:OPENSSL_FIPS:FUNCTION:
-EVP_aes_128_cfb1                        3251	EXIST::FUNCTION:AES
-EVP_aes_192_cfb8                        3252	EXIST::FUNCTION:AES
-FIPS_mode_set                           3253	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_selftest_dsa                       3254	EXIST:OPENSSL_FIPS:FUNCTION:
-EVP_aes_256_cfb8                        3255	EXIST::FUNCTION:AES
-FIPS_allow_md5                          3256	EXIST:OPENSSL_FIPS:FUNCTION:
-DES_ede3_cfb_encrypt                    3257	EXIST::FUNCTION:DES
-EVP_des_ede3_cfb8                       3258	EXIST::FUNCTION:DES
-FIPS_rand_seeded                        3259	EXIST:OPENSSL_FIPS:FUNCTION:
-AES_cfbr_encrypt_block                  3260	EXIST::FUNCTION:AES
-AES_cfb8_encrypt                        3261	EXIST::FUNCTION:AES
-FIPS_rand_seed                          3262	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_corrupt_des                        3263	EXIST:OPENSSL_FIPS:FUNCTION:
-EVP_aes_192_cfb1                        3264	EXIST::FUNCTION:AES
-FIPS_selftest_aes                       3265	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_set_prng_key                       3266	EXIST:OPENSSL_FIPS:FUNCTION:
-EVP_des_cfb8                            3267	EXIST::FUNCTION:DES
-FIPS_corrupt_dsa                        3268	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_test_mode                          3269	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_rand_method                        3270	EXIST:OPENSSL_FIPS:FUNCTION:
-EVP_aes_256_cfb1                        3271	EXIST::FUNCTION:AES
-ERR_load_FIPS_strings                   3272	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_corrupt_aes                        3273	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_selftest_sha1                      3274	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_selftest_rsa                       3275	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_corrupt_sha1                       3276	EXIST:OPENSSL_FIPS:FUNCTION:
-EVP_des_cfb1                            3277	EXIST::FUNCTION:DES
-FIPS_dsa_check                          3278	EXIST:OPENSSL_FIPS:FUNCTION:
-AES_cfb1_encrypt                        3279	EXIST::FUNCTION:AES
-EVP_des_ede3_cfb1                       3280	EXIST::FUNCTION:DES
-FIPS_rand_check                         3281	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_md5_allowed                        3282	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_mode                               3283	EXIST:OPENSSL_FIPS:FUNCTION:
-FIPS_selftest_failed                    3284	EXIST:OPENSSL_FIPS:FUNCTION:
-sk_is_sorted                            3285	EXIST::FUNCTION:
+TS_TST_INFO_get_tsa                     13	EXIST::FUNCTION:
+PKCS7_RECIP_INFO_free                   14	EXIST::FUNCTION:
+i2d_X509_PKEY                           15	EXIST::FUNCTION:
+i2d_ESS_ISSUER_SERIAL                   16	EXIST::FUNCTION:
+d2i_X509_fp                             17	EXIST::FUNCTION:FP_API
+BN_lshift                               18	EXIST::FUNCTION:
+d2i_PKCS7_fp                            19	EXIST::FUNCTION:FP_API
+ERR_load_RAND_strings                   20	EXIST::FUNCTION:
+i2d_X509_REQ_fp                         21	EXIST::FUNCTION:FP_API
+DSO_new_method                          22	EXIST::FUNCTION:
+BIO_get_ex_new_index                    23	EXIST::FUNCTION:
+ASN1_UTF8STRING_it                      24	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_UTF8STRING_it                      24	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+OBJ_cleanup                             25	EXIST::FUNCTION:
+i2d_BASIC_CONSTRAINTS                   26	EXIST::FUNCTION:
+hex_to_string                           27	EXIST::FUNCTION:
+PKCS7_ISSUER_AND_SERIAL_new             28	EXIST::FUNCTION:
+ENGINE_unregister_ciphers               29	EXIST::FUNCTION:ENGINE
+RAND_event                              30	EXIST:WIN32:FUNCTION:
+SMIME_read_PKCS7                        31	EXIST::FUNCTION:
+OPENSSL_cleanse                         32	EXIST::FUNCTION:
+OBJ_nid2obj                             33	EXIST::FUNCTION:
+ENGINE_get_ciphers                      34	EXIST::FUNCTION:ENGINE
+d2i_OCSP_BASICRESP                      35	EXIST::FUNCTION:
+ERR_print_errors                        36	EXIST::FUNCTION:BIO
+KRB5_CHECKSUM_it                        37	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_CHECKSUM_it                        37	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EC_POINT_add                            38	EXIST::FUNCTION:EC
+ASN1_item_ex_i2d                        39	EXIST::FUNCTION:
+OBJ_dup                                 40	EXIST::FUNCTION:
+TS_REQ_new                              41	EXIST::FUNCTION:
+OCSP_CERTID_it                          42	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_CERTID_it                          42	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_OCSP_RESPBYTES                      43	EXIST::FUNCTION:
+X509V3_add1_i2d                         44	EXIST::FUNCTION:
+EVP_md2                                 45	EXIST::FUNCTION:MD2
+X509_EXTENSION_set_critical             46	EXIST::FUNCTION:
+PKCS7_ENVELOPE_it                       47	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_ENVELOPE_it                       47	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_OCTET_STRING_free                  48	EXIST::FUNCTION:
+UI_add_input_boolean                    49	EXIST::FUNCTION:
+PEM_write_X509_CRL                      50	EXIST:!WIN16:FUNCTION:
+EVP_md4                                 51	EXIST::FUNCTION:MD4
+RSA_public_encrypt                      52	EXIST::FUNCTION:RSA
+EVP_md5                                 53	EXIST::FUNCTION:MD5
+ERR_add_error_data                      54	EXIST::FUNCTION:BIO
+ENGINE_unregister_RSA                   55	EXIST::FUNCTION:ENGINE
+ERR_load_RSA_strings                    56	EXIST::FUNCTION:RSA
+X509V3_EXT_nconf                        57	EXIST::FUNCTION:
+NETSCAPE_SPKI_sign                      58	EXIST::FUNCTION:EVP
+BN_add                                  59	EXIST::FUNCTION:
+ASN1_GENERALIZEDTIME_free               60	EXIST::FUNCTION:
+PEM_read_bio_DSA_PUBKEY                 61	EXIST::FUNCTION:DSA
+X509_REVOKED_free                       62	EXIST::FUNCTION:
+d2i_X509_ATTRIBUTE                      63	EXIST::FUNCTION:
+EVP_DigestFinal                         64	EXIST::FUNCTION:
+DES_ofb_encrypt                         65	EXIST::FUNCTION:DES
+d2i_X509_ALGOR                          66	EXIST::FUNCTION:
+CRYPTO_mem_leaks                        67	EXIST::FUNCTION:
+AUTHORITY_INFO_ACCESS_new               68	EXIST::FUNCTION:
+ASN1_GENERALSTRING_free                 69	EXIST::FUNCTION:
+d2i_OCSP_CERTSTATUS                     70	EXIST::FUNCTION:
+ENGINE_by_id                            71	EXIST::FUNCTION:ENGINE
+BIO_new_fp_internal                     72	EXIST:WIN16:FUNCTION:FP_API
+d2i_AUTHORITY_KEYID                     73	EXIST::FUNCTION:
+X509_REVOKED_set_serialNumber           74	EXIST::FUNCTION:
+PEM_write_X509_REQ                      75	EXIST:!WIN16:FUNCTION:
+X509_print_ex                           76	EXIST::FUNCTION:BIO
+i2d_X509                                77	EXIST::FUNCTION:
+PBE2PARAM_free                          78	EXIST::FUNCTION:
+ASN1_TYPE_get                           79	EXIST::FUNCTION:
+PKCS7_get0_signers                      80	EXIST::FUNCTION:
+PKCS5_pbe2_set                          81	EXIST::FUNCTION:
+d2i_PKCS8PrivateKey_bio                 82	EXIST::FUNCTION:
+RC2_ecb_encrypt                         83	EXIST::FUNCTION:RC2
+TS_ASN1_INTEGER_print_bio               84	EXIST::FUNCTION:
+BN_RECP_CTX_init                        85	EXIST::FUNCTION:
+i2d_X509_CRL_bio                        86	EXIST::FUNCTION:BIO
+i2d_TS_RESP                             87	EXIST::FUNCTION:
+OCSP_ONEREQ_get1_ext_d2i                88	EXIST::FUNCTION:
+ENGINE_register_all_RAND                89	EXIST::FUNCTION:ENGINE
+ENGINE_load_dynamic                     90	EXIST::FUNCTION:ENGINE
+X509_PURPOSE_get_count                  91	EXIST::FUNCTION:
+PBE2PARAM_new                           92	EXIST::FUNCTION:
+X509v3_get_ext_count                    93	EXIST::FUNCTION:
+PBKDF2PARAM_it                          94	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PBKDF2PARAM_it                          94	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_EncodeFinal                         95	EXIST::FUNCTION:
+X509_TRUST_get_by_id                    96	EXIST::FUNCTION:
+X509_print_fp                           97	EXIST::FUNCTION:FP_API
+PKCS12_MAC_DATA_new                     98	EXIST::FUNCTION:
+X509V3_add_value                        99	EXIST::FUNCTION:
+X509_REQ_set_pubkey                     100	EXIST::FUNCTION:
+MD4_Init                                101	EXIST::FUNCTION:MD4
+UTF8_getc                               102	EXIST::FUNCTION:
+ASN1_STRING_print_ex_fp                 103	EXIST::FUNCTION:FP_API
+BIO_new_bio_pair                        104	EXIST::FUNCTION:
+EXTENDED_KEY_USAGE_new                  105	EXIST::FUNCTION:
+_ossl_old_des_pcbc_encrypt              106	EXIST::FUNCTION:DES
+X509V3_get_value_int                    107	EXIST::FUNCTION:
+RSA_public_decrypt                      108	EXIST::FUNCTION:RSA
+d2i_TS_RESP                             109	EXIST::FUNCTION:
+i2d_ASN1_HEADER                         110	EXIST::FUNCTION:
+d2i_AutoPrivateKey                      111	EXIST::FUNCTION:
+EVP_aes_256_ofb                         112	EXIST::FUNCTION:AES
+EC_GROUP_clear_free                     113	EXIST::FUNCTION:EC
+EVP_bf_ofb                              114	EXIST::FUNCTION:BF
+OCSP_sendreq_bio                        115	EXIST::FUNCTION:
+RSA_sign                                116	EXIST::FUNCTION:RSA
+X509_NAME_print_ex                      117	EXIST::FUNCTION:BIO
+X509_CRL_print_fp                       118	EXIST::FUNCTION:FP_API
+ASN1_item_digest                        119	EXIST::FUNCTION:EVP
+OCSP_BASICRESP_delete_ext               120	EXIST::FUNCTION:
+EVP_PKEY_get1_DSA                       121	EXIST::FUNCTION:DSA
+OCSP_SIGNATURE_it                       122	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_SIGNATURE_it                       122	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509V3_get_value_bool                   123	EXIST::FUNCTION:
+d2i_NETSCAPE_CERT_SEQUENCE              124	EXIST::FUNCTION:
+TS_ACCURACY_get_millis                  125	EXIST::FUNCTION:
+TS_TST_INFO_delete_ext                  126	EXIST::FUNCTION:
+X509_CRL_it                             127	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_CRL_it                             127	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+OCSP_BASICRESP_add_ext                  128	EXIST::FUNCTION:
+KRB5_ENCKEY_it                          129	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_ENCKEY_it                          129	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+UI_method_set_closer                    130	EXIST::FUNCTION:
+ERR_get_error                           131	EXIST::FUNCTION:
+X509_STORE_set_purpose                  132	EXIST::FUNCTION:
+i2d_ASN1_GENERALSTRING                  133	EXIST::FUNCTION:
+BN_mod_exp_mont_word                    134	EXIST::FUNCTION:
+OCSP_response_status                    135	EXIST::FUNCTION:
+_ossl_old_des_enc_read                  136	EXIST::FUNCTION:DES
+i2d_OCSP_SERVICELOC                     137	EXIST::FUNCTION:
+X509_PURPOSE_get_by_sname               138	EXIST::FUNCTION:
+TS_CONF_set_def_policy                  139	EXIST::FUNCTION:
+X509_add1_reject_object                 140	EXIST::FUNCTION:
+TS_TST_INFO_set_msg_imprint             141	EXIST::FUNCTION:
+d2i_CERTIFICATEPOLICIES                 142	EXIST::FUNCTION:
+ENGINE_get_digest_engine                143	EXIST::FUNCTION:ENGINE
+EC_GROUP_set_curve_GFp                  144	EXIST::FUNCTION:EC
+OCSP_REQUEST_get_ext_by_OBJ             145	EXIST::FUNCTION:
+X509_STORE_CTX_set_time                 146	EXIST::FUNCTION:
+X509_NAME_set                           147	EXIST::FUNCTION:
+ASN1_BIT_STRING_set                     148	EXIST::FUNCTION:
+i2d_PUBKEY_bio                          149	EXIST::FUNCTION:BIO
+PKCS7_encrypt                           150	EXIST::FUNCTION:
+ASN1_T61STRING_it                       151	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_T61STRING_it                       151	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EC_GROUP_method_of                      152	EXIST::FUNCTION:EC
+i2d_X509_CERT_AUX                       153	EXIST::FUNCTION:
+i2d_KRB5_APREQ                          154	EXIST::FUNCTION:
+PEM_read_bio_NETSCAPE_CERT_SEQUENCE     155	EXIST:!VMS:FUNCTION:
+PEM_read_bio_NS_CERT_SEQ                155	EXIST:VMS:FUNCTION:
+sk_free                                 156	EXIST::FUNCTION:
+RC4                                     157	EXIST::FUNCTION:RC4
+d2i_TS_ACCURACY                         158	EXIST::FUNCTION:
+BN_clear_free                           159	EXIST::FUNCTION:
+ASN1_PRINTABLE_new                      160	EXIST::FUNCTION:
+d2i_PKCS8_fp                            161	EXIST::FUNCTION:FP_API
+HMAC_Init_ex                            162	EXIST::FUNCTION:HMAC
+FIPS_rand_check                         163	EXIST:OPENSSL_FIPS:FUNCTION:
+d2i_KRB5_AUTHENT                        164	EXIST::FUNCTION:
+d2i_ASN1_BOOLEAN                        165	EXIST::FUNCTION:
+CONF_load_fp                            166	EXIST::FUNCTION:FP_API
+TS_TST_INFO_add_ext                     167	EXIST::FUNCTION:
+GENERAL_NAMES_free                      168	EXIST::FUNCTION:
+OCSP_archive_cutoff_new                 169	EXIST::FUNCTION:
+EC_POINT_set_Jprojective_coordinates_GFp 170	EXIST:!VMS:FUNCTION:EC
+EC_POINT_set_Jproj_coords_GFp           170	EXIST:VMS:FUNCTION:EC
+BN_bn2hex                               171	EXIST::FUNCTION:
+PKCS5_PBE_add                           172	EXIST::FUNCTION:
+d2i_DSAparams                           173	EXIST::FUNCTION:DSA
+d2i_ASN1_BMPSTRING                      174	EXIST::FUNCTION:
+PKCS7_ENVELOPE_free                     175	EXIST::FUNCTION:
+ASN1_parse_dump                         176	EXIST::FUNCTION:BIO
+DSA_OpenSSL                             177	EXIST::FUNCTION:DSA
+OCSP_BASICRESP_get_ext_by_OBJ           178	EXIST::FUNCTION:
+EC_POINT_oct2point                      179	EXIST::FUNCTION:EC
+OCSP_SINGLERESP_get_ext_count           180	EXIST::FUNCTION:
+UI_ctrl                                 181	EXIST::FUNCTION:
+CRYPTO_set_mem_functions                182	EXIST::FUNCTION:
+_shadow_DES_rw_mode                     183	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:DES
+_shadow_DES_rw_mode                     183	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:DES
+d2i_RSA_PUBKEY_fp                       184	EXIST::FUNCTION:FP_API,RSA
+PKCS12_newpass                          185	EXIST::FUNCTION:
+BF_cbc_encrypt                          186	EXIST::FUNCTION:BF
+X509_delete_ext                         187	EXIST::FUNCTION:
+X509_PURPOSE_get_trust                  188	EXIST::FUNCTION:
+ESS_CERT_ID_new                         189	EXIST::FUNCTION:
+PKCS7_SIGNER_INFO_new                   190	EXIST::FUNCTION:
+EVP_des_ede3_ecb                        191	EXIST::FUNCTION:DES
+PKCS12_MAC_DATA_free                    192	EXIST::FUNCTION:
+BN_sqr                                  193	EXIST::FUNCTION:
+ENGINE_set_default_RAND                 194	EXIST::FUNCTION:ENGINE
+NETSCAPE_SPKI_get_pubkey                195	EXIST::FUNCTION:EVP
+PKCS7_decrypt                           196	EXIST::FUNCTION:
+TS_TST_INFO_get_serial                  197	EXIST::FUNCTION:
+EVP_des_ede3                            198	EXIST::FUNCTION:DES
+X509_NAME_dup                           199	EXIST::FUNCTION:
+asn1_do_adb                             200	EXIST::FUNCTION:
+ASN1_template_i2d                       201	EXIST::FUNCTION:
+ENGINE_register_DH                      202	EXIST::FUNCTION:ENGINE
+UI_construct_prompt                     203	EXIST::FUNCTION:
+BIO_dump_indent                         204	EXIST::FUNCTION:
+d2i_X509_bio                            205	EXIST::FUNCTION:BIO
+asn1_Finish                             206	EXIST::FUNCTION:
+X509_STORE_set_trust                    207	EXIST::FUNCTION:
+USERNOTICE_free                         208	EXIST::FUNCTION:
+X509_STORE_CTX_get_chain                209	EXIST::FUNCTION:
+BIO_new_mem_buf                         210	EXIST::FUNCTION:
+GENERAL_NAME_new                        211	EXIST::FUNCTION:
+d2i_PUBKEY_bio                          212	EXIST::FUNCTION:BIO
+UI_dup_input_string                     213	EXIST::FUNCTION:
+X509_set_pubkey                         214	EXIST::FUNCTION:
+TS_MSG_IMPRINT_dup                      215	EXIST::FUNCTION:
+X509_check_trust                        216	EXIST::FUNCTION:
+BN_hex2bn                               217	EXIST::FUNCTION:
+RC2_set_key                             218	EXIST::FUNCTION:RC2
+d2i_KRB5_APREQ                          219	EXIST::FUNCTION:
+BIO_new_connect                         220	EXIST::FUNCTION:
+EVP_PKEY_bits                           221	EXIST::FUNCTION:
+EVP_MD_CTX_copy_ex                      222	EXIST::FUNCTION:
+OBJ_NAME_remove                         223	EXIST::FUNCTION:
+PKCS7_add_recipient_info                224	EXIST::FUNCTION:
+d2i_PKCS12                              225	EXIST::FUNCTION:
+i2d_TS_REQ_bio                          226	EXIST::FUNCTION:
+TS_RESP_CTX_set_time_cb                 227	EXIST::FUNCTION:
+FIPS_corrupt_sha1                       228	EXIST:OPENSSL_FIPS:FUNCTION:
+ENGINE_get_id                           229	EXIST::FUNCTION:ENGINE
+OCSP_request_is_signed                  230	EXIST::FUNCTION:
+BIO_pop                                 231	EXIST::FUNCTION:
+d2i_X509_NAME                           232	EXIST::FUNCTION:
+EVP_CIPHER_type                         233	EXIST::FUNCTION:
+BIO_s_file_internal                     234	EXIST:WIN16:FUNCTION:FP_API
+X509_get_subject_name                   235	EXIST::FUNCTION:
+i2d_OCSP_REQINFO                        236	EXIST::FUNCTION:
+PKCS12_add_friendlyname_asc             237	EXIST::FUNCTION:
+TS_RESP_dup                             238	EXIST::FUNCTION:
+ENGINE_set_RSA                          239	EXIST::FUNCTION:ENGINE
+PKEY_USAGE_PERIOD_new                   240	EXIST::FUNCTION:
+X509_CRL_get_ext_by_OBJ                 241	EXIST::FUNCTION:
+d2i_PKCS7_bio                           242	EXIST::FUNCTION:
+TS_TST_INFO_set_nonce                   243	EXIST::FUNCTION:
+KRB5_ENCKEY_free                        244	EXIST::FUNCTION:
+CONF_modules_load_file                  245	EXIST::FUNCTION:
+OCSP_resp_get0                          246	EXIST::FUNCTION:
+DH_generate_key                         247	EXIST::FUNCTION:DH
+GENERAL_NAME_it                         248	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+GENERAL_NAME_it                         248	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PKCS7_dataVerify                        249	EXIST::FUNCTION:
+ASN1_GENERALIZEDTIME_it                 250	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_GENERALIZEDTIME_it                 250	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_PKCS12_BAGS                         251	EXIST::FUNCTION:
+_ossl_old_des_decrypt3                  252	EXIST::FUNCTION:DES
+BIO_ctrl_get_write_guarantee            253	EXIST::FUNCTION:
+ASN1_INTEGER_new                        254	EXIST::FUNCTION:
+X509_STORE_set_flags                    255	EXIST::FUNCTION:
+EVP_get_digestbyname                    256	EXIST::FUNCTION:
+EC_POINT_set_compressed_coordinates_GFp 257	EXIST:!VMS:FUNCTION:EC
+EC_POINT_set_compr_coords_GFp           257	EXIST:VMS:FUNCTION:EC
+ERR_load_ASN1_strings                   258	EXIST::FUNCTION:
+OCSP_response_status_str                259	EXIST::FUNCTION:
+d2i_SXNET                               260	EXIST::FUNCTION:
+ASN1_GENERALIZEDTIME_new                261	EXIST::FUNCTION:
+X509at_get_attr_by_OBJ                  262	EXIST::FUNCTION:
+d2i_OCSP_REVOKEDINFO                    263	EXIST::FUNCTION:
+X509_REQ_dup                            264	EXIST::FUNCTION:
+i2d_TS_REQ                              265	EXIST::FUNCTION:
+DIRECTORYSTRING_free                    266	EXIST::FUNCTION:
+OCSP_basic_add1_cert                    267	EXIST::FUNCTION:
+X509_STORE_CTX_get_ex_new_index         268	EXIST::FUNCTION:
+ENGINE_get_RSA                          269	EXIST::FUNCTION:ENGINE
+CONF_imodule_set_usr_data               270	EXIST::FUNCTION:
+TS_TST_INFO_get_policy_id               271	EXIST::FUNCTION:
+ERR_get_implementation                  272	EXIST::FUNCTION:
+DH_check                                273	EXIST::FUNCTION:DH
+EVP_CipherFinal_ex                      274	EXIST::FUNCTION:
+bn_sqr_words                            275	EXIST::FUNCTION:
+i2d_TS_TST_INFO_bio                     276	EXIST::FUNCTION:
+X509_check_private_key                  277	EXIST::FUNCTION:
+OPENSSL_add_all_algorithms_noconf       278	EXIST:!VMS:FUNCTION:
+OPENSSL_add_all_algo_noconf             278	EXIST:VMS:FUNCTION:
+X509_NAME_ENTRY_create_by_NID           279	EXIST::FUNCTION:
+ERR_get_err_state_table                 280	EXIST::FUNCTION:LHASH
+DIST_POINT_NAME_new                     281	EXIST::FUNCTION:
+OCSP_CERTSTATUS_new                     282	EXIST::FUNCTION:
+ASN1_STRING_set                         283	EXIST::FUNCTION:
+BN_sub                                  284	EXIST::FUNCTION:
+X509_get_default_private_dir            285	EXIST::FUNCTION:
+_ossl_old_des_is_weak_key               286	EXIST::FUNCTION:DES
+CRYPTO_add_lock                         287	EXIST::FUNCTION:
+d2i_TS_REQ_bio                          288	EXIST::FUNCTION:
+CRYPTO_cleanup_all_ex_data              289	EXIST::FUNCTION:
+OCSP_resp_find                          290	EXIST::FUNCTION:
+BN_nnmod                                291	EXIST::FUNCTION:
+DSA_get_ex_new_index                    292	EXIST::FUNCTION:DSA
+d2i_TS_REQ_fp                           293	EXIST::FUNCTION:
+EVP_BytesToKey                          294	EXIST::FUNCTION:
+ERR_load_PEM_strings                    295	EXIST::FUNCTION:
+RAND_screen                             296	EXIST:WIN32:FUNCTION:
+X509_EXTENSION_set_data                 297	EXIST::FUNCTION:
+SSLeay                                  298	EXIST::FUNCTION:
+DSA_size                                299	EXIST::FUNCTION:DSA
+BIO_indent                              300	EXIST::FUNCTION:
+PKCS7_content_new                       301	EXIST::FUNCTION:
+TS_RESP_get_tst_info                    302	EXIST::FUNCTION:
+X509_CRL_sort                           303	EXIST::FUNCTION:
+PKCS7_add_signer                        304	EXIST::FUNCTION:
+X509_REVOKED_set_revocationDate         305	EXIST::FUNCTION:
+ENGINE_register_RAND                    306	EXIST::FUNCTION:ENGINE
+ASN1_VISIBLESTRING_new                  307	EXIST::FUNCTION:
+RSA_flags                               308	EXIST::FUNCTION:RSA
+BASIC_CONSTRAINTS_free                  309	EXIST::FUNCTION:
+d2i_PKCS7_SIGNED                        310	EXIST::FUNCTION:
+OCSP_SERVICELOC_new                     311	EXIST::FUNCTION:
+X509_NAME_print_ex_fp                   312	EXIST::FUNCTION:FP_API
+EC_POINT_set_affine_coordinates_GFp     313	EXIST:!VMS:FUNCTION:EC
+EC_POINT_set_affine_coords_GFp          313	EXIST:VMS:FUNCTION:EC
+EVP_PBE_alg_add                         314	EXIST::FUNCTION:
+d2i_ASN1_PRINTABLESTRING                315	EXIST::FUNCTION:
+bn_expand2                              316	EXIST::FUNCTION:
+SXNET_it                                317	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+SXNET_it                                317	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+_ossl_old_des_encrypt                   318	EXIST::FUNCTION:DES
+X509_TRUST_set_default                  319	EXIST::FUNCTION:
+ENGINE_ctrl                             320	EXIST::FUNCTION:ENGINE
+RSAPrivateKey_dup                       321	EXIST::FUNCTION:RSA
+X509_ATTRIBUTE_dup                      322	EXIST::FUNCTION:
+UI_dup_input_boolean                    323	EXIST::FUNCTION:
+X509_STORE_free                         324	EXIST::FUNCTION:
+DSA_get_default_method                  325	EXIST::FUNCTION:DSA
+d2i_DSAPrivateKey_fp                    326	EXIST::FUNCTION:DSA,FP_API
+DH_new_method                           327	EXIST::FUNCTION:DH
+TS_RESP_CTX_set_signer_key              328	EXIST::FUNCTION:
+i2d_PKCS7_DIGEST                        329	EXIST::FUNCTION:
+ASN1_STRING_dup                         330	EXIST::FUNCTION:
+PKCS5_PBKDF2_HMAC_SHA1                  331	EXIST::FUNCTION:
+HMAC                                    332	EXIST::FUNCTION:HMAC
+EVP_des_ede_cfb64                       333	EXIST::FUNCTION:DES
+DSO_set_method                          334	EXIST::FUNCTION:
+CRYPTO_dbg_realloc                      335	EXIST::FUNCTION:
+lh_stats                                336	EXIST::FUNCTION:FP_API
+CONF_get_section                        337	EXIST::FUNCTION:
+CRYPTO_is_mem_check_on                  338	EXIST::FUNCTION:
+PEM_dek_info                            339	EXIST::FUNCTION:
+i2d_ASN1_VISIBLESTRING                  340	EXIST::FUNCTION:
+PKCS12_add_CSPName_asc                  341	EXIST::FUNCTION:
+BN_set_params                           342	EXIST::FUNCTION:
+RC5_32_encrypt                          343	EXIST::FUNCTION:RC5
+lh_doall                                344	EXIST::FUNCTION:
+PKCS7_sign                              345	EXIST::FUNCTION:
+TS_CONF_load_cert                       346	EXIST::FUNCTION:
+EC_POINT_is_at_infinity                 347	EXIST::FUNCTION:EC
+i2d_X509_REQ_bio                        348	EXIST::FUNCTION:BIO
+GENERAL_NAME_cmp                        349	EXIST::FUNCTION:
+X509_certificate_type                   350	EXIST::FUNCTION:
+X509_REVOKED_get_ext_by_critical        351	EXIST:!VMS:FUNCTION:
+X509_REVOKED_get_ext_by_critic          351	EXIST:VMS:FUNCTION:
+ERR_load_PKCS12_strings                 352	EXIST::FUNCTION:
+i2d_CRL_DIST_POINTS                     353	EXIST::FUNCTION:
+PEM_write_PKCS8PrivateKey               354	EXIST::FUNCTION:
+DSA_set_ex_data                         355	EXIST::FUNCTION:DSA
+PEM_write_bio_PKCS8_PRIV_KEY_INFO       356	EXIST:!VMS:FUNCTION:
+PEM_write_bio_P8_PRIV_KEY_INFO          356	EXIST:VMS:FUNCTION:
+DSO_convert_filename                    357	EXIST::FUNCTION:
+DISPLAYTEXT_free                        358	EXIST::FUNCTION:
+EVP_DigestUpdate                        359	EXIST::FUNCTION:
+POLICYQUALINFO_it                       360	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+POLICYQUALINFO_it                       360	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ENGINE_register_ciphers                 361	EXIST::FUNCTION:ENGINE
+BN_mod_lshift_quick                     362	EXIST::FUNCTION:
+DSO_set_filename                        363	EXIST::FUNCTION:
+idea_set_encrypt_key                    364	EXIST::FUNCTION:IDEA
+X509_STORE_CTX_set_ex_data              365	EXIST::FUNCTION:
+X509_STORE_CTX_new                      366	EXIST::FUNCTION:
+ASN1_item_free                          367	EXIST::FUNCTION:
+i2d_PKCS7_ENC_CONTENT                   368	EXIST::FUNCTION:
+KRB5_TKTBODY_free                       369	EXIST::FUNCTION:
+AUTHORITY_KEYID_it                      370	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+AUTHORITY_KEYID_it                      370	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ERR_put_error                           371	EXIST::FUNCTION:
+X509_REQ_INFO_new                       372	EXIST::FUNCTION:
+KRB5_APREQBODY_new                      373	EXIST::FUNCTION:
+X509V3_EXT_REQ_add_nconf                374	EXIST::FUNCTION:
+PKCS7_cert_from_signer_info             375	EXIST::FUNCTION:
+ENGINE_ctrl_cmd_string                  376	EXIST::FUNCTION:ENGINE
+i2d_POLICYQUALINFO                      377	EXIST::FUNCTION:
+X509_CINF_free                          378	EXIST::FUNCTION:
+i2d_OCSP_RESPDATA                       379	EXIST::FUNCTION:
+ENGINE_set_default_string               380	EXIST::FUNCTION:ENGINE
+X509_NAME_get_text_by_OBJ               381	EXIST::FUNCTION:
+ASN1_IA5STRING_new                      382	EXIST::FUNCTION:
+OBJ_obj2txt                             383	EXIST::FUNCTION:
+d2i_PrivateKey_fp                       384	EXIST::FUNCTION:FP_API
+EVP_MD_CTX_init                         385	EXIST::FUNCTION:
+i2d_TS_STATUS_INFO                      386	EXIST::FUNCTION:
+RC5_32_decrypt                          387	EXIST::FUNCTION:RC5
+EXTENDED_KEY_USAGE_free                 388	EXIST::FUNCTION:
+DES_ecb_encrypt                         389	EXIST::FUNCTION:DES
+PKCS12_create                           390	EXIST::FUNCTION:
+ASN1_INTEGER_cmp                        391	EXIST::FUNCTION:
+PKCS7_ATTR_SIGN_it                      392	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_ATTR_SIGN_it                      392	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_REQ_print_bio                        393	EXIST::FUNCTION:
+RSA_padding_check_PKCS1_type_1          394	EXIST::FUNCTION:RSA
+RSA_padding_check_PKCS1_type_2          395	EXIST::FUNCTION:RSA
+UI_add_error_string                     396	EXIST::FUNCTION:
+ENGINE_set_ctrl_function                397	EXIST::FUNCTION:ENGINE
+d2i_TS_TST_INFO_fp                      398	EXIST::FUNCTION:
+EVP_rc2_ofb                             399	EXIST::FUNCTION:RC2
+X509_REQ_to_X509                        400	EXIST::FUNCTION:
+PEM_write_DHparams                      401	EXIST:!WIN16:FUNCTION:DH
+DSA_do_sign                             402	EXIST::FUNCTION:DSA
+DES_ede3_cfb64_encrypt                  403	EXIST::FUNCTION:DES
+ASN1_UTCTIME_new                        404	EXIST::FUNCTION:
+KRB5_CHECKSUM_free                      405	EXIST::FUNCTION:
+OCSP_REQUEST_get_ext                    406	EXIST::FUNCTION:
+ERR_release_err_state_table             407	EXIST::FUNCTION:LHASH
+X509_PURPOSE_cleanup                    408	EXIST::FUNCTION:
+X509_REQ_set_extension_nids             409	EXIST::FUNCTION:
+ENGINE_load_ubsec                       410	EXIST::FUNCTION:ENGINE
+sk_delete_ptr                           411	EXIST::FUNCTION:
+ENGINE_register_all_digests             412	EXIST::FUNCTION:ENGINE
+ASN1_tag2str                            413	EXIST::FUNCTION:
+PKCS12_verify_mac                       414	EXIST::FUNCTION:
+ERR_load_X509V3_strings                 415	EXIST::FUNCTION:
+PKEY_USAGE_PERIOD_it                    416	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKEY_USAGE_PERIOD_it                    416	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_RESP_CTX_add_policy                  417	EXIST::FUNCTION:
+EVP_EncodeBlock                         418	EXIST::FUNCTION:
+PKCS12_unpack_authsafes                 419	EXIST::FUNCTION:
+DES_ecb3_encrypt                        420	EXIST::FUNCTION:DES
+BIO_nread                               421	EXIST::FUNCTION:
+BN_RECP_CTX_new                         422	EXIST::FUNCTION:
+X509_PUBKEY_new                         423	EXIST::FUNCTION:
+ASN1_item_unpack                        424	EXIST::FUNCTION:
+DES_key_sched                           425	EXIST::FUNCTION:DES
+TS_ACCURACY_new                         426	EXIST::FUNCTION:
+MD5_Init                                427	EXIST::FUNCTION:MD5
+NETSCAPE_SPKAC_it                       428	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+NETSCAPE_SPKAC_it                       428	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_REVOKED_it                         429	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_REVOKED_it                         429	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+CRYPTO_set_id_callback                  430	EXIST::FUNCTION:
+ASN1_STRING_encode                      431	EXIST::FUNCTION:
+EVP_aes_128_ecb                         432	EXIST::FUNCTION:AES
+KRB5_AUTHENT_free                       433	EXIST::FUNCTION:
+i2d_DSA_PUBKEY_bio                      434	EXIST::FUNCTION:BIO,DSA
+ASN1_i2d_bio                            435	EXIST::FUNCTION:BIO
+OPENSSL_add_all_algorithms_conf         436	EXIST:!VMS:FUNCTION:
+OPENSSL_add_all_algo_conf               436	EXIST:VMS:FUNCTION:
+RSA_set_ex_data                         437	EXIST::FUNCTION:RSA
+i2d_RSA_PUBKEY_bio                      438	EXIST::FUNCTION:BIO,RSA
+OBJ_NAME_new_index                      439	EXIST::FUNCTION:
+CONF_modules_free                       440	EXIST::FUNCTION:
+CAST_cfb64_encrypt                      441	EXIST::FUNCTION:CAST
+NCONF_default                           442	EXIST::FUNCTION:
+CONF_module_get_usr_data                443	EXIST::FUNCTION:
+OCSP_BASICRESP_get_ext_by_critical      444	EXIST:!VMS:FUNCTION:
+OCSP_BASICRESP_get_ext_by_crit          444	EXIST:VMS:FUNCTION:
+BN_BLINDING_new                         445	EXIST::FUNCTION:
+OCSP_cert_status_str                    446	EXIST::FUNCTION:
+TS_TST_INFO_get_msg_imprint             447	EXIST::FUNCTION:
+d2i_OCSP_REQUEST                        448	EXIST::FUNCTION:
+BN_value_one                            449	EXIST::FUNCTION:
+DIST_POINT_NAME_free                    450	EXIST::FUNCTION:
+EVP_DecodeFinal                         451	EXIST::FUNCTION:
+TS_STATUS_INFO_dup                      452	EXIST::FUNCTION:
+UI_dup_info_string                      453	EXIST::FUNCTION:
+PEM_read_DSAparams                      454	EXIST:!WIN16:FUNCTION:DSA
+_ossl_old_des_options                   455	EXIST::FUNCTION:DES
+i2d_PKCS7_ENCRYPT                       456	EXIST::FUNCTION:
+PEM_write_DSAPrivateKey                 457	EXIST:!WIN16:FUNCTION:DSA
+DH_set_ex_data                          458	EXIST::FUNCTION:DH
+EVP_SealInit                            459	EXIST::FUNCTION:RSA
+RSA_padding_add_PKCS1_OAEP              460	EXIST::FUNCTION:RSA
+DSA_do_verify                           461	EXIST::FUNCTION:DSA
+i2d_PKCS7_ENVELOPE                      462	EXIST::FUNCTION:
+X509_STORE_CTX_free                     463	EXIST::FUNCTION:
+BIO_int_ctrl                            464	EXIST::FUNCTION:
+OPENSSL_issetugid                       465	EXIST::FUNCTION:
+PKCS12_it                               466	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS12_it                               466	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_md_null                             467	EXIST::FUNCTION:
+CAST_cbc_encrypt                        468	EXIST::FUNCTION:CAST
+PKCS8_PRIV_KEY_INFO_free                469	EXIST::FUNCTION:
+EVP_PKEY_cmp_parameters                 470	EXIST::FUNCTION:
+i2d_X509_EXTENSION                      471	EXIST::FUNCTION:
+PKCS7_ENCRYPT_new                       472	EXIST::FUNCTION:
+TS_REQ_get_exts                         473	EXIST::FUNCTION:
+X509_issuer_and_serial_cmp              474	EXIST::FUNCTION:
+ASN1_INTEGER_get                        475	EXIST::FUNCTION:
+OCSP_SINGLERESP_get_ext_by_critical     476	EXIST:!VMS:FUNCTION:
+OCSP_SINGLERESP_get_ext_by_crit         476	EXIST:VMS:FUNCTION:
+X509_CERT_AUX_print                     477	EXIST::FUNCTION:BIO
+PEM_read_bio_DSAparams                  478	EXIST::FUNCTION:DSA
+PKCS12_SAFEBAG_new                      479	EXIST::FUNCTION:
+PKCS7_signatureVerify                   480	EXIST::FUNCTION:
+TS_REQ_set_cert_req                     481	EXIST::FUNCTION:
+BIO_s_log                               482	EXIST:!OS2,!WIN16,!WIN32,!macintosh:FUNCTION:
+OCSP_CERTSTATUS_free                    483	EXIST::FUNCTION:
+i2d_PrivateKey                          484	EXIST::FUNCTION:
+TS_TST_INFO_get_ordering                485	EXIST::FUNCTION:
+DIST_POINT_free                         486	EXIST::FUNCTION:
+ASN1_item_i2d                           487	EXIST::FUNCTION:
+PEM_read_bio                            488	EXIST::FUNCTION:BIO
+i2d_TS_TST_INFO                         489	EXIST::FUNCTION:
+EVP_DecryptFinal_ex                     490	EXIST::FUNCTION:
+BIO_get_accept_socket                   491	EXIST::FUNCTION:
+TXT_DB_write                            492	EXIST::FUNCTION:BIO
+ENGINE_load_openssl                     493	EXIST::FUNCTION:ENGINE
+ENGINE_get_cmd_defns                    494	EXIST::FUNCTION:ENGINE
+ASN1_OBJECT_free                        495	EXIST::FUNCTION:
+ENGINE_set_load_privkey_function        496	EXIST:!VMS:FUNCTION:ENGINE
+ENGINE_set_load_privkey_fn              496	EXIST:VMS:FUNCTION:ENGINE
+RSA_new                                 497	EXIST::FUNCTION:RSA
+EVP_EncryptFinal_ex                     498	EXIST::FUNCTION:
+X509_STORE_CTX_get1_issuer              499	EXIST::FUNCTION:
+PKCS7_set_cipher                        500	EXIST::FUNCTION:
+PKCS5_PBE_keyivgen                      501	EXIST::FUNCTION:
+X509_STORE_CTX_get_current_cert         502	EXIST::FUNCTION:
+X509_REQ_get_attr_by_OBJ                503	EXIST::FUNCTION:
+X509_CRL_delete_ext                     504	EXIST::FUNCTION:
+X509_NAME_get_entry                     505	EXIST::FUNCTION:
+ASN1_mbstring_copy                      506	EXIST::FUNCTION:
+ENGINE_set_default_digests              507	EXIST::FUNCTION:ENGINE
+X509_get0_pubkey_bitstr                 508	EXIST::FUNCTION:
+X509_set_notAfter                       509	EXIST::FUNCTION:
+EVP_idea_cbc                            510	EXIST::FUNCTION:IDEA
+ENGINE_get_first                        511	EXIST::FUNCTION:ENGINE
+asn1_ex_i2c                             512	EXIST::FUNCTION:
+EVP_MD_CTX_copy                         513	EXIST::FUNCTION:
+ENGINE_register_RSA                     514	EXIST::FUNCTION:ENGINE
+ESS_CERT_ID_free                        515	EXIST::FUNCTION:
+ENGINE_unregister_DSA                   516	EXIST::FUNCTION:ENGINE
+RAND_file_name                          517	EXIST::FUNCTION:
+X509V3_EXT_print_fp                     518	EXIST::FUNCTION:
+PKCS7_add_recipient                     519	EXIST::FUNCTION:
+X509_OBJECT_retrieve_match              520	EXIST::FUNCTION:
+d2i_ASN1_NULL                           521	EXIST::FUNCTION:
+_ossl_old_des_xcbc_encrypt              522	EXIST::FUNCTION:DES
+BN_BLINDING_invert                      523	EXIST::FUNCTION:
+TS_TST_INFO_set_time                    524	EXIST::FUNCTION:
+name_cmp                                525	EXIST::FUNCTION:
+PEM_write_PrivateKey                    526	EXIST:!WIN16:FUNCTION:
+d2i_ASN1_type_bytes                     527	EXIST::FUNCTION:
+RAND_SSLeay                             528	EXIST::FUNCTION:
+X509_STORE_CTX_set_cert                 529	EXIST::FUNCTION:
+i2d_PKCS8_PRIV_KEY_INFO_bio             530	EXIST::FUNCTION:BIO
+d2i_ASN1_TIME                           531	EXIST::FUNCTION:
+DSA_generate_parameters                 532	EXIST::FUNCTION:DSA
+PKCS7_SIGNER_INFO_free                  533	EXIST::FUNCTION:
+X509_REQ_get1_email                     534	EXIST::FUNCTION:
+X509_PURPOSE_get0                       535	EXIST::FUNCTION:
+ENGINE_set_DH                           536	EXIST::FUNCTION:ENGINE
+DH_size                                 537	EXIST::FUNCTION:DH
+X509_EXTENSION_it                       538	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_EXTENSION_it                       538	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509V3_EXT_d2i                          539	EXIST::FUNCTION:
+RAND_seed                               540	EXIST::FUNCTION:
+TS_MSG_IMPRINT_print_bio                541	EXIST::FUNCTION:
+ASN1_STRING_TABLE_get                   542	EXIST::FUNCTION:
+X509_REQ_free                           543	EXIST::FUNCTION:
+i2d_KRB5_AUTHENT                        544	EXIST::FUNCTION:
+i2d_ASN1_BOOLEAN                        545	EXIST::FUNCTION:
+X509_CRL_free                           546	EXIST::FUNCTION:
+ERR_load_X509_strings                   547	EXIST::FUNCTION:
+RSA_size                                548	EXIST::FUNCTION:RSA
+ASN1_UNIVERSALSTRING_to_string          549	EXIST::FUNCTION:
+d2i_DISPLAYTEXT                         550	EXIST::FUNCTION:
+CONF_set_default_method                 551	EXIST::FUNCTION:
+i2d_X509_CRL                            552	EXIST::FUNCTION:
+OBJ_NAME_cleanup                        553	EXIST::FUNCTION:
+i2d_X509_NAME_ENTRY                     554	EXIST::FUNCTION:
+d2i_PrivateKey                          555	EXIST::FUNCTION:
+X509_NAME_ENTRY_new                     556	EXIST::FUNCTION:
+X509V3_add_standard_extensions          557	EXIST::FUNCTION:
+ENGINE_get_RAND                         558	EXIST::FUNCTION:ENGINE
+CRYPTO_dbg_get_options                  559	EXIST::FUNCTION:
+SXNETID_it                              560	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+SXNETID_it                              560	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_get_default_cert_dir_env           561	EXIST::FUNCTION:
+d2i_OCSP_SINGLERESP                     562	EXIST::FUNCTION:
+EDIPARTYNAME_new                        563	EXIST::FUNCTION:
+d2i_TS_MSG_IMPRINT_bio                  564	EXIST::FUNCTION:
+i2d_X509_REQ                            565	EXIST::FUNCTION:
+X509_CRL_digest                         566	EXIST::FUNCTION:EVP
+ASN1_INTEGER_to_BN                      567	EXIST::FUNCTION:
+PKCS12_certbag2x509                     568	EXIST::FUNCTION:
+BN_bin2bn                               569	EXIST::FUNCTION:
+X509_STORE_load_locations               570	EXIST::FUNCTION:STDIO
+CRYPTO_get_dynlock_destroy_callback     571	EXIST:!VMS:FUNCTION:
+CRYPTO_get_dynlock_destroy_cb           571	EXIST:VMS:FUNCTION:
+PEM_read_RSAPrivateKey                  572	EXIST:!WIN16:FUNCTION:RSA
+i2d_PKCS7_SIGNER_INFO                   573	EXIST::FUNCTION:
+TS_CONF_set_tsa_name                    574	EXIST::FUNCTION:
+d2i_EXTENDED_KEY_USAGE                  575	EXIST::FUNCTION:
+ERR_print_errors_cb                     576	EXIST::FUNCTION:
+ENGINE_set_ciphers                      577	EXIST::FUNCTION:ENGINE
+ERR_load_FIPS_strings                   578	EXIST:OPENSSL_FIPS:FUNCTION:
+ASN1_sign                               579	EXIST::FUNCTION:EVP
+PEM_SealInit                            580	EXIST::FUNCTION:RSA
+NETSCAPE_SPKI_new                       581	EXIST::FUNCTION:
+CONF_free                               582	EXIST::FUNCTION:
+X509_REVOKED_get_ext_count              583	EXIST::FUNCTION:
+d2i_KRB5_APREQBODY                      584	EXIST::FUNCTION:
+UI_method_get_flusher                   585	EXIST::FUNCTION:
+_ossl_old_des_set_odd_parity            586	EXIST::FUNCTION:DES
+i2d_DSAparams                           587	EXIST::FUNCTION:DSA
+X509_PUBKEY_it                          588	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_PUBKEY_it                          588	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_TRUST_get_count                    589	EXIST::FUNCTION:
+PKCS7_ENCRYPT_it                        590	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_ENCRYPT_it                        590	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+i2d_ESS_CERT_ID                         591	EXIST::FUNCTION:
+ASN1_add_oid_module                     592	EXIST::FUNCTION:
+BN_mod_mul_reciprocal                   593	EXIST::FUNCTION:
+BUF_strlcat                             594	EXIST::FUNCTION:
+TS_RESP_create_response                 595	EXIST::FUNCTION:
+X509_verify_cert                        596	EXIST::FUNCTION:
+FIPS_rand_seeded                        597	EXIST:OPENSSL_FIPS:FUNCTION:
+TS_REQ_get_ext_by_critical              598	EXIST::FUNCTION:
+sk_new                                  599	EXIST::FUNCTION:
+BN_lshift1                              600	EXIST::FUNCTION:
+BIO_s_socket                            601	EXIST::FUNCTION:
+i2d_OCSP_RESPONSE                       602	EXIST::FUNCTION:
+d2i_X509_CRL_fp                         603	EXIST::FUNCTION:FP_API
+BN_mod_exp_simple                       604	EXIST::FUNCTION:
+EC_GROUP_get_cofactor                   605	EXIST::FUNCTION:EC
+EVP_des_ofb                             606	EXIST::FUNCTION:DES
+NETSCAPE_SPKAC_free                     607	EXIST::FUNCTION:
+TS_RESP_CTX_set_extension_cb            608	EXIST::FUNCTION:
+TS_TST_INFO_get_accuracy                609	EXIST::FUNCTION:
+SXNET_add_id_INTEGER                    610	EXIST::FUNCTION:
+MD5_Final                               611	EXIST::FUNCTION:MD5
+BIO_get_ex_data                         612	EXIST::FUNCTION:
+X509_LOOKUP_shutdown                    613	EXIST::FUNCTION:
+X509at_delete_attr                      614	EXIST::FUNCTION:
+PEM_get_EVP_CIPHER_INFO                 615	EXIST::FUNCTION:
+OBJ_create                              616	EXIST::FUNCTION:
+c2i_ASN1_BIT_STRING                     617	EXIST::FUNCTION:
+X509_REQ_INFO_free                      618	EXIST::FUNCTION:
+PKCS12_unpack_p7data                    619	EXIST::FUNCTION:
+d2i_KRB5_AUTHDATA                       620	EXIST::FUNCTION:
+CRYPTO_malloc                           621	EXIST::FUNCTION:
+X509_NAME_ENTRY_set_object              622	EXIST::FUNCTION:
+DH_set_method                           623	EXIST::FUNCTION:DH
+TXT_DB_create_index                     624	EXIST::FUNCTION:
+OCSP_copy_nonce                         625	EXIST::FUNCTION:
+KRB5_AUTHDATA_new                       626	EXIST::FUNCTION:
+i2d_PKCS8_PRIV_KEY_INFO_fp              627	EXIST::FUNCTION:FP_API
+ENGINE_set_name                         628	EXIST::FUNCTION:ENGINE
+TS_TST_INFO_ext_free                    629	EXIST::FUNCTION:
+DES_cfb64_encrypt                       630	EXIST::FUNCTION:DES
+BN_CTX_start                            631	EXIST::FUNCTION:
+OCSP_RESPDATA_new                       632	EXIST::FUNCTION:
+a2d_ASN1_OBJECT                         633	EXIST::FUNCTION:
+i2d_GENERAL_NAMES                       634	EXIST::FUNCTION:
+X509_get1_email                         635	EXIST::FUNCTION:
+X509_REQ_get_attr_count                 636	EXIST::FUNCTION:
+ERR_load_BUF_strings                    637	EXIST::FUNCTION:
+CRYPTO_dup_ex_data                      638	EXIST::FUNCTION:
+PKCS12_set_mac                          639	EXIST::FUNCTION:
+CRYPTO_get_add_lock_callback            640	EXIST::FUNCTION:
+PKCS12_key_gen_uni                      641	EXIST::FUNCTION:
+ASN1_TYPE_set_octetstring               642	EXIST::FUNCTION:
+RIPEMD160_Final                         643	EXIST::FUNCTION:RIPEMD
+EC_GFp_mont_method                      644	EXIST::FUNCTION:EC
+X509_REQ_add1_attr                      645	EXIST::FUNCTION:
+OCSP_REVOKEDINFO_free                   646	EXIST::FUNCTION:
+i2d_X509_NAME                           647	EXIST::FUNCTION:
+X509_PUBKEY_get                         648	EXIST::FUNCTION:
+RSA_sign_ASN1_OCTET_STRING              649	EXIST::FUNCTION:RSA
+d2i_PrivateKey_bio                      650	EXIST::FUNCTION:BIO
+DES_is_weak_key                         651	EXIST::FUNCTION:DES
+d2i_ESS_ISSUER_SERIAL                   652	EXIST::FUNCTION:
+UI_get_ex_data                          653	EXIST::FUNCTION:
+PEM_read_bio_X509                       654	EXIST::FUNCTION:
+ERR_print_errors_fp                     655	EXIST::FUNCTION:FP_API
+KRB5_APREQBODY_free                     656	EXIST::FUNCTION:
+EC_GROUP_get0_generator                 657	EXIST::FUNCTION:EC
+UI_get_default_method                   658	EXIST::FUNCTION:
+X509V3_set_nconf                        659	EXIST::FUNCTION:
+PKCS12_item_i2d_encrypt                 660	EXIST::FUNCTION:
+i2d_PKCS7_bio                           661	EXIST::FUNCTION:
+X509_email_free                         662	EXIST::FUNCTION:
+BN_BLINDING_convert                     663	EXIST::FUNCTION:
+BIO_number_read                         664	EXIST::FUNCTION:
+X509V3_EXT_add_list                     665	EXIST::FUNCTION:
+ERR_peek_last_error_line                666	EXIST::FUNCTION:
+BIO_find_type                           667	EXIST::FUNCTION:
+PEM_read_bio_DSAPrivateKey              668	EXIST::FUNCTION:DSA
+X509_add1_ext_i2d                       669	EXIST::FUNCTION:
+RSA_padding_check_PKCS1_OAEP            670	EXIST::FUNCTION:RSA
+i2d_DSAPrivateKey                       671	EXIST::FUNCTION:DSA
+i2s_ASN1_ENUMERATED_TABLE               672	EXIST::FUNCTION:
+i2s_ASN1_OCTET_STRING                   673	EXIST::FUNCTION:
+d2i_BASIC_CONSTRAINTS                   674	EXIST::FUNCTION:
+_ossl_old_des_cfb64_encrypt             675	EXIST::FUNCTION:DES
+ASN1_TYPE_free                          676	EXIST::FUNCTION:
+PKCS7_SIGNER_INFO_it                    677	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_SIGNER_INFO_it                    677	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_SignFinal                           678	EXIST::FUNCTION:
+KRB5_PRINCNAME_new                      679	EXIST::FUNCTION:
+CRYPTO_set_mem_debug_options            680	EXIST::FUNCTION:
+X509_cmp_current_time                   681	EXIST::FUNCTION:
+ASN1_STRING_length                      682	EXIST::FUNCTION:
+X509_EXTENSION_create_by_NID            683	EXIST::FUNCTION:
+CRL_DIST_POINTS_new                     684	EXIST::FUNCTION:
+PKCS12_SAFEBAG_it                       685	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS12_SAFEBAG_it                       685	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_DIRECTORYSTRING                     686	EXIST::FUNCTION:
+i2d_PKCS7_SIGNED                        687	EXIST::FUNCTION:
+d2i_OTHERNAME                           688	EXIST::FUNCTION:
+CRYPTO_realloc                          689	EXIST::FUNCTION:
+TXT_DB_insert                           690	EXIST::FUNCTION:
+CONF_modules_finish                     691	EXIST::FUNCTION:
+ERR_get_error_line                      692	EXIST::FUNCTION:
+ENGINE_set_DSA                          693	EXIST::FUNCTION:ENGINE
+X509_OBJECT_idx_by_subject              694	EXIST::FUNCTION:
+X509_TRUST_get_trust                    695	EXIST::FUNCTION:
+EC_GROUP_get_order                      696	EXIST::FUNCTION:EC
+d2i_OCSP_RESPID                         697	EXIST::FUNCTION:
+X509_ATTRIBUTE_create_by_txt            698	EXIST::FUNCTION:
+X509_NAME_add_entry_by_txt              699	EXIST::FUNCTION:
+asc2uni                                 700	EXIST::FUNCTION:
+EVP_rc2_40_cbc                          701	EXIST::FUNCTION:RC2
+PEM_X509_INFO_read                      702	EXIST:!WIN16:FUNCTION:
+X509_LOOKUP_by_issuer_serial            703	EXIST::FUNCTION:
+OCSP_request_verify                     704	EXIST::FUNCTION:
+X509_REQ_print                          705	EXIST::FUNCTION:BIO
+DIST_POINT_new                          706	EXIST::FUNCTION:
+BIO_new_accept                          707	EXIST::FUNCTION:
+TS_RESP_CTX_set_status_info             708	EXIST::FUNCTION:
+NETSCAPE_SPKAC_new                      709	EXIST::FUNCTION:
+PEM_write_PKCS8PrivateKey_nid           710	EXIST::FUNCTION:
+X509_STORE_CTX_init                     711	EXIST::FUNCTION:
+i2d_TS_REQ_fp                           712	EXIST::FUNCTION:
+PKCS7_SIGNED_new                        713	EXIST::FUNCTION:
+DES_ede3_cbcm_encrypt                   714	EXIST::FUNCTION:DES
+NCONF_load                              715	EXIST::FUNCTION:
+NCONF_get_number_e                      716	EXIST::FUNCTION:
+X509_signature_print                    717	EXIST::FUNCTION:EVP
+d2i_X509_PUBKEY                         718	EXIST::FUNCTION:
+BIO_push                                719	EXIST::FUNCTION:
+PBKDF2PARAM_new                         720	EXIST::FUNCTION:
+ENGINE_get_DSA                          721	EXIST::FUNCTION:ENGINE
+X509_new                                722	EXIST::FUNCTION:
+X509V3_EXT_print                        723	EXIST::FUNCTION:
+CRYPTO_get_new_dynlockid                724	EXIST::FUNCTION:
+OCSP_SINGLERESP_free                    725	EXIST::FUNCTION:
+TS_TST_INFO_new                         726	EXIST::FUNCTION:
+BIO_s_fd                                727	EXIST::FUNCTION:
+idea_set_decrypt_key                    728	EXIST::FUNCTION:IDEA
+ENGINE_load_builtin_engines             729	EXIST::FUNCTION:ENGINE
+X509_STORE_CTX_set_purpose              730	EXIST::FUNCTION:
+i2d_OCSP_ONEREQ                         731	EXIST::FUNCTION:
+a2i_ASN1_STRING                         732	EXIST::FUNCTION:BIO
+RSA_check_key                           733	EXIST::FUNCTION:RSA
+sk_value                                734	EXIST::FUNCTION:
+ERR_func_error_string                   735	EXIST::FUNCTION:
+d2i_TS_MSG_IMPRINT                      736	EXIST::FUNCTION:
+OCSP_REQUEST_add_ext                    737	EXIST::FUNCTION:
+OCSP_RESPBYTES_new                      738	EXIST::FUNCTION:
+CRYPTO_get_mem_functions                739	EXIST::FUNCTION:
+EVP_PKCS82PKEY                          740	EXIST::FUNCTION:
+i2d_RSAPrivateKey_bio                   741	EXIST::FUNCTION:BIO,RSA
+i2d_X509_VAL                            742	EXIST::FUNCTION:
+X509V3_EXT_CRL_add_conf                 743	EXIST::FUNCTION:
+X509_REQ_add1_attr_by_txt               744	EXIST::FUNCTION:
+X509V3_EXT_cleanup                      745	EXIST::FUNCTION:
+X509_TRUST_get_flags                    746	EXIST::FUNCTION:
+PEM_X509_INFO_read_bio                  747	EXIST::FUNCTION:BIO
+i2d_SXNETID                             748	EXIST::FUNCTION:
+X509_CRL_get_ext_d2i                    749	EXIST::FUNCTION:
+X509_REQ_verify                         750	EXIST::FUNCTION:EVP
+PKCS7_SIGNED_free                       751	EXIST::FUNCTION:
+EVP_MD_CTX_create                       752	EXIST::FUNCTION:
+OCSP_resp_find_status                   753	EXIST::FUNCTION:
+X509_ALGOR_it                           754	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_ALGOR_it                           754	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_TIME_it                            755	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_TIME_it                            755	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BIO_puts                                756	EXIST::FUNCTION:
+X509_get_ex_data                        757	EXIST::FUNCTION:
+BN_set_bit                              758	EXIST::FUNCTION:
+DH_get_default_method                   759	EXIST::FUNCTION:DH
+PKCS7_dup                               760	EXIST::FUNCTION:
+PEM_write_bio_PKCS8PrivateKey           761	EXIST::FUNCTION:
+DH_generate_parameters                  762	EXIST::FUNCTION:DH
+OCSP_request_set1_name                  763	EXIST::FUNCTION:
+CRYPTO_remalloc                         764	EXIST::FUNCTION:
+SHA1                                    765	EXIST::FUNCTION:SHA,SHA1
+CRYPTO_get_id_callback                  766	EXIST::FUNCTION:
+OCSP_ONEREQ_get_ext_count               767	EXIST::FUNCTION:
+X509_STORE_add_cert                     768	EXIST::FUNCTION:
+UI_get0_result                          769	EXIST::FUNCTION:
+PKCS12_AUTHSAFES_it                     770	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS12_AUTHSAFES_it                     770	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+CRYPTO_get_dynlock_value                771	EXIST::FUNCTION:
+i2d_PBKDF2PARAM                         772	EXIST::FUNCTION:
+d2i_SXNETID                             773	EXIST::FUNCTION:
+X509_PKEY_free                          774	EXIST::FUNCTION:
+PEM_write_bio_X509_CRL                  775	EXIST::FUNCTION:
+ENGINE_get_prev                         776	EXIST::FUNCTION:ENGINE
+EVP_aes_256_ecb                         777	EXIST::FUNCTION:AES
+PKCS12_pack_authsafes                   778	EXIST::FUNCTION:
+EVP_bf_ecb                              779	EXIST::FUNCTION:BF
+ASN1_IA5STRING_it                       780	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_IA5STRING_it                       780	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_CONF_set_clock_precision_digits      781	EXIST::FUNCTION:
+EVP_des_ede_cbc                         782	EXIST::FUNCTION:DES
+i2d_TS_MSG_IMPRINT_fp                   783	EXIST::FUNCTION:
+X509_REVOKED_new                        784	EXIST::FUNCTION:
+X509_CRL_get_ext                        785	EXIST::FUNCTION:
+X509_NAME_delete_entry                  786	EXIST::FUNCTION:
+X509_NAME_entry_count                   787	EXIST::FUNCTION:
+RAND_add                                788	EXIST::FUNCTION:
+d2i_ESS_SIGNING_CERT                    789	EXIST::FUNCTION:
+PEM_write_bio_X509_REQ                  790	EXIST::FUNCTION:
+UI_get_input_flags                      791	EXIST::FUNCTION:
+X509_CINF_new                           792	EXIST::FUNCTION:
+i2d_RSA_PUBKEY                          793	EXIST::FUNCTION:RSA
+EVP_aes_192_ofb                         794	EXIST::FUNCTION:AES
+_ossl_old_des_quad_cksum                795	EXIST::FUNCTION:DES
+EC_GROUP_set_generator                  796	EXIST::FUNCTION:EC
+EVP_DecodeBlock                         797	EXIST::FUNCTION:
+TS_VERIFY_CTX_cleanup                   798	EXIST::FUNCTION:
+TS_TST_INFO_print_bio                   799	EXIST::FUNCTION:
+OCSP_CERTID_free                        800	EXIST::FUNCTION:
+X509_CERT_AUX_it                        801	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_CERT_AUX_it                        801	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+DES_read_2passwords                     802	EXIST::FUNCTION:DES
+CONF_get_number                         803	EXIST::FUNCTION:
+ENGINE_up_ref                           804	EXIST::FUNCTION:ENGINE
+CERTIFICATEPOLICIES_it                  805	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+CERTIFICATEPOLICIES_it                  805	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_HEADER_free                        806	EXIST::FUNCTION:
+RAND_set_rand_engine                    807	EXIST::FUNCTION:ENGINE
+X509_CRL_print                          808	EXIST::FUNCTION:BIO
+X509_subject_name_cmp                   809	EXIST::FUNCTION:
+BN_exp                                  810	EXIST::FUNCTION:
+RSA_padding_check_none                  811	EXIST::FUNCTION:RSA
+EVP_PKEY_type                           812	EXIST::FUNCTION:
+X509V3_get_section                      813	EXIST::FUNCTION:
+DSO_get_loaded_filename                 814	EXIST::FUNCTION:
+lh_free                                 815	EXIST::FUNCTION:
+NETSCAPE_SPKI_b64_decode                816	EXIST::FUNCTION:EVP
+BN_bntest_rand                          817	EXIST::FUNCTION:
+X509_ATTRIBUTE_it                       818	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_ATTRIBUTE_it                       818	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ERR_set_error_data                      819	EXIST::FUNCTION:
+PEM_write_RSA_PUBKEY                    820	EXIST:!WIN16:FUNCTION:RSA
+TS_RESP_CTX_set_accuracy                821	EXIST::FUNCTION:
+X509_set_issuer_name                    822	EXIST::FUNCTION:
+OCSP_ONEREQ_get_ext_by_NID              823	EXIST::FUNCTION:
+ENGINE_add                              824	EXIST::FUNCTION:ENGINE
+TS_ACCURACY_set_millis                  825	EXIST::FUNCTION:
+X509_get_default_cert_dir               826	EXIST::FUNCTION:
+PKCS12_decrypt_skey                     827	EXIST::FUNCTION:
+KRB5_AUTHENT_it                         828	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_AUTHENT_it                         828	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_RSAPrivateKey_fp                    829	EXIST::FUNCTION:FP_API,RSA
+X509_REQ_add_extensions                 830	EXIST::FUNCTION:
+ASN1_check_infinite_end                 831	EXIST::FUNCTION:
+UI_dup_error_string                     832	EXIST::FUNCTION:
+_ossl_old_des_read_pw_string            833	EXIST::FUNCTION:
+BN_mod_word                             834	EXIST::FUNCTION:
+X509v3_get_ext_by_critical              835	EXIST::FUNCTION:
+RSAPublicKey_it                         836	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:RSA
+RSAPublicKey_it                         836	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:RSA
+i2d_OCSP_REQUEST                        837	EXIST::FUNCTION:
+X509_EXTENSION_get_object               838	EXIST::FUNCTION:
+d2i_RSA_PUBKEY                          839	EXIST::FUNCTION:RSA
+PKCS12_PBE_keyivgen                     840	EXIST::FUNCTION:
+BIO_get_retry_reason                    841	EXIST::FUNCTION:
+ASN1_ENUMERATED_free                    842	EXIST::FUNCTION:
+PKCS12_x509crl2certbag                  843	EXIST::FUNCTION:
+OCSP_SERVICELOC_it                      844	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_SERVICELOC_it                      844	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BUF_MEM_free                            845	EXIST::FUNCTION:
+X509_SIG_new                            846	EXIST::FUNCTION:
+ASN1_item_sign                          847	EXIST::FUNCTION:EVP
+PKCS12_free                             848	EXIST::FUNCTION:
+ASN1_verify                             849	EXIST::FUNCTION:EVP
+MD4_Final                               850	EXIST::FUNCTION:MD4
+X509_CRL_set_issuer_name                851	EXIST::FUNCTION:
+bn_add_words                            852	EXIST::FUNCTION:
+X509_get_serialNumber                   853	EXIST::FUNCTION:
+X509_cmp                                854	EXIST::FUNCTION:
+X509_digest                             855	EXIST::FUNCTION:EVP
+TS_REQ_get_ext_by_NID                   856	EXIST::FUNCTION:
+TS_ACCURACY_get_micros                  857	EXIST::FUNCTION:
+DSO_bind_var                            858	EXIST::FUNCTION:
+FIPS_corrupt_rsa                        859	EXIST:OPENSSL_FIPS:FUNCTION:
+TS_RESP_CTX_set_signer_cert             860	EXIST::FUNCTION:
+OBJ_NAME_do_all_sorted                  861	EXIST::FUNCTION:
+MD2_options                             862	EXIST::FUNCTION:MD2
+ASN1_STRING_set_by_NID                  863	EXIST::FUNCTION:
+OPENSSL_load_builtin_modules            864	EXIST::FUNCTION:
+d2i_PKCS8_PRIV_KEY_INFO_fp              865	EXIST::FUNCTION:FP_API
+i2d_OCSP_BASICRESP                      866	EXIST::FUNCTION:
+ASN1_TIME_set                           867	EXIST::FUNCTION:
+X509V3_section_free                     868	EXIST::FUNCTION:
+PKCS7_dataFinal                         869	EXIST::FUNCTION:
+PEM_read_PUBKEY                         870	EXIST:!WIN16:FUNCTION:
+i2d_OCSP_RESPBYTES                      871	EXIST::FUNCTION:
+RC2_encrypt                             872	EXIST::FUNCTION:RC2
+PKCS7_ISSUER_AND_SERIAL_digest          873	EXIST::FUNCTION:
+EVP_rc5_32_12_16_cbc                    874	EXIST::FUNCTION:RC5
+EVP_CipherInit                          875	EXIST::FUNCTION:
+X509_NAME_ENTRY_create_by_OBJ           876	EXIST::FUNCTION:
+AUTHORITY_KEYID_free                    877	EXIST::FUNCTION:
+OBJ_nid2ln                              878	EXIST::FUNCTION:
+i2d_X509_ATTRIBUTE                      879	EXIST::FUNCTION:
+X509_ALGOR_dup                          880	EXIST::FUNCTION:
+AES_ofb128_encrypt                      881	EXIST::FUNCTION:AES
+ASN1_seq_unpack                         882	EXIST::FUNCTION:
+PKCS12_unpack_p7encdata                 883	EXIST::FUNCTION:
+OPENSSL_config                          884	EXIST::FUNCTION:
+TS_CONF_set_ess_cert_id_chain           885	EXIST::FUNCTION:
+NETSCAPE_SPKI_set_pubkey                886	EXIST::FUNCTION:EVP
+ASN1_TYPE_set                           887	EXIST::FUNCTION:
+i2d_DHparams                            888	EXIST::FUNCTION:DH
+ESS_SIGNING_CERT_new                    889	EXIST::FUNCTION:
+X509_REVOKED_get_ext_by_NID             890	EXIST::FUNCTION:
+HMAC_CTX_init                           891	EXIST::FUNCTION:HMAC
+ENGINE_get_digest                       892	EXIST::FUNCTION:ENGINE
+TS_TST_INFO_set_serial                  893	EXIST::FUNCTION:
+NCONF_get_section                       894	EXIST::FUNCTION:
+CONF_modules_unload                     895	EXIST::FUNCTION:
+EVP_DecryptFinal                        896	EXIST::FUNCTION:
+X509_get_ex_new_index                   897	EXIST::FUNCTION:
+X509_print                              898	EXIST::FUNCTION:BIO
+BN_BLINDING_free                        899	EXIST::FUNCTION:
+bn_mul_add_words                        900	EXIST::FUNCTION:
+OCSP_RESPONSE_print                     901	EXIST::FUNCTION:
+i2d_DSA_PUBKEY                          902	EXIST::FUNCTION:DSA
+X509_reject_clear                       903	EXIST::FUNCTION:
+BN_mpi2bn                               904	EXIST::FUNCTION:
+KRB5_TKTBODY_it                         905	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_TKTBODY_it                         905	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BN_reciprocal                           906	EXIST::FUNCTION:
+BN_clear                                907	EXIST::FUNCTION:
+ACCESS_DESCRIPTION_it                   908	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ACCESS_DESCRIPTION_it                   908	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PKCS12_BAGS_new                         909	EXIST::FUNCTION:
+EVP_rc4_40                              910	EXIST::FUNCTION:RC4
+bn_sub_words                            911	EXIST::FUNCTION:
+POLICYQUALINFO_new                      912	EXIST::FUNCTION:
+RC2_decrypt                             913	EXIST::FUNCTION:RC2
+TS_RESP_set_tst_info                    914	EXIST::FUNCTION:
+ASN1_STRING_data                        915	EXIST::FUNCTION:
+BN_CTX_new                              916	EXIST::FUNCTION:
+PKCS7_ISSUER_AND_SERIAL_it              917	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_ISSUER_AND_SERIAL_it              917	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PBE2PARAM_it                            918	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PBE2PARAM_it                            918	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_REQ_get_policy_id                    919	EXIST::FUNCTION:
+EVP_EncodeInit                          920	EXIST::FUNCTION:
+i2d_DSAPrivateKey_bio                   921	EXIST::FUNCTION:BIO,DSA
+X509_REQ_set_version                    922	EXIST::FUNCTION:
+PEM_write_DSA_PUBKEY                    923	EXIST:!WIN16:FUNCTION:DSA
+DH_OpenSSL                              924	EXIST::FUNCTION:DH
+NCONF_free_data                         925	EXIST::FUNCTION:
+PKCS12_certbag2x509crl                  926	EXIST::FUNCTION:
+RSA_null_method                         927	EXIST::FUNCTION:RSA
+d2i_PBE2PARAM                           928	EXIST::FUNCTION:
+ERR_get_next_error_library              929	EXIST::FUNCTION:
+RC2_cfb64_encrypt                       930	EXIST::FUNCTION:RC2
+CRYPTO_realloc_clean                    931	EXIST::FUNCTION:
+SMIME_text                              932	EXIST::FUNCTION:
+i2d_ASN1_NULL                           933	EXIST::FUNCTION:
+d2i_ASN1_ENUMERATED                     934	EXIST::FUNCTION:
+PKCS7_SIGNED_it                         935	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_SIGNED_it                         935	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ENGINE_get_cipher                       936	EXIST::FUNCTION:ENGINE
+i2d_OCSP_CRLID                          937	EXIST::FUNCTION:
+PKCS8_encrypt                           938	EXIST::FUNCTION:
+BN_to_ASN1_INTEGER                      939	EXIST::FUNCTION:
+X509_OBJECT_up_ref_count                940	EXIST::FUNCTION:
+i2d_ASN1_TIME                           941	EXIST::FUNCTION:
+TS_RESP_CTX_set_def_policy              942	EXIST::FUNCTION:
+i2d_PKCS8PrivateKey_fp                  943	EXIST::FUNCTION:
+BUF_strlcpy                             944	EXIST::FUNCTION:
+_ossl_old_des_ede3_ofb64_encrypt        945	EXIST:!VMS:FUNCTION:DES
+_ossl_odes_ede3_ofb64_encrypt           945	EXIST:VMS:FUNCTION:DES
+DES_ede3_cbc_encrypt                    946	EXIST::FUNCTION:DES
+DES_cbc_cksum                           947	EXIST::FUNCTION:DES
+TS_RESP_CTX_get_tst_info                948	EXIST::FUNCTION:
+ERR_load_TS_strings                     949	EXIST::FUNCTION:
+OCSP_SINGLERESP_new                     950	EXIST::FUNCTION:
+ASN1_TYPE_get_octetstring               951	EXIST::FUNCTION:
+PEM_write_bio_PUBKEY                    952	EXIST::FUNCTION:
+ENGINE_cmd_is_executable                953	EXIST::FUNCTION:ENGINE
+ENGINE_get_ctrl_function                954	EXIST::FUNCTION:ENGINE
+CRYPTO_remove_all_info                  955	EXIST::FUNCTION:
+RSA_up_ref                              956	EXIST::FUNCTION:RSA
+d2i_DSA_PUBKEY                          957	EXIST::FUNCTION:DSA
+ASN1_GENERALSTRING_it                   958	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_GENERALSTRING_it                   958	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PEM_SealUpdate                          959	EXIST::FUNCTION:RSA
+lh_stats_bio                            960	EXIST::FUNCTION:BIO
+OBJ_txt2nid                             961	EXIST::FUNCTION:
+ENGINE_register_DSA                     962	EXIST::FUNCTION:ENGINE
+EVP_add_digest                          963	EXIST::FUNCTION:
+i2s_ASN1_INTEGER                        964	EXIST::FUNCTION:
+X509V3_add_value_bool                   965	EXIST::FUNCTION:
+PEM_read_bio_X509_CRL                   966	EXIST::FUNCTION:
+sk_num                                  967	EXIST::FUNCTION:
+TS_REQ_delete_ext                       968	EXIST::FUNCTION:
+X509_find_by_subject                    969	EXIST::FUNCTION:
+X509_CRL_get_ext_count                  970	EXIST::FUNCTION:
+COMP_rle                                971	EXIST::FUNCTION:
+BIO_fd_should_retry                     972	EXIST::FUNCTION:
+FIPS_md5_allowed                        973	EXIST:OPENSSL_FIPS:FUNCTION:
+X509V3_EXT_add_nconf_sk                 974	EXIST::FUNCTION:
+ASN1_BIT_STRING_set_asc                 975	EXIST::FUNCTION:
+BN_print                                976	EXIST::FUNCTION:
+_ossl_old_des_read_2passwords           977	EXIST::FUNCTION:DES
+_ossl_old_des_enc_write                 978	EXIST::FUNCTION:DES
+d2i_RSAPrivateKey                       979	EXIST::FUNCTION:RSA
+ESS_ISSUER_SERIAL_new                   980	EXIST::FUNCTION:
+PEM_read_bio_X509_REQ                   981	EXIST::FUNCTION:
+BN_clear_bit                            982	EXIST::FUNCTION:
+ERR_load_CONF_strings                   983	EXIST::FUNCTION:
+ENGINE_set_load_pubkey_function         984	EXIST::FUNCTION:ENGINE
+BIO_ctrl                                985	EXIST::FUNCTION:
+i2d_ASN1_BMPSTRING                      986	EXIST::FUNCTION:
+d2i_PKCS7_ENC_CONTENT                   987	EXIST::FUNCTION:
+PKCS8_decrypt                           988	EXIST::FUNCTION:
+PEM_bytes_read_bio                      989	EXIST::FUNCTION:BIO
+idea_cbc_encrypt                        990	EXIST::FUNCTION:IDEA
+PKCS7_add_attribute                     991	EXIST::FUNCTION:
+ENGINE_get_default_DH                   992	EXIST::FUNCTION:ENGINE
+SHA1_Init                               993	EXIST::FUNCTION:SHA,SHA1
+ERR_clear_error                         994	EXIST::FUNCTION:
+DIRECTORYSTRING_it                      995	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+DIRECTORYSTRING_it                      995	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+FIPS_corrupt_des                        996	EXIST:OPENSSL_FIPS:FUNCTION:
+MD4_Update                              997	EXIST::FUNCTION:MD4
+EVP_sha1                                998	EXIST::FUNCTION:SHA
+d2i_OCSP_CRLID                          999	EXIST::FUNCTION:
+DSA_new                                 1000	EXIST::FUNCTION:DSA
+TS_CONF_set_default_engine              1001	EXIST::FUNCTION:
+ENGINE_load_cryptodev                   1002	EXIST::FUNCTION:ENGINE
+DSO_set_default_method                  1003	EXIST::FUNCTION:
+DH_new                                  1004	EXIST::FUNCTION:DH
+OBJ_obj2nid                             1005	EXIST::FUNCTION:
+BN_set_word                             1006	EXIST::FUNCTION:
+TS_CONF_set_policies                    1007	EXIST::FUNCTION:
+CONF_imodule_get_value                  1008	EXIST::FUNCTION:
+i2d_PKCS7_RECIP_INFO                    1009	EXIST::FUNCTION:
+EVP_add_cipher                          1010	EXIST::FUNCTION:
+BN_print_fp                             1011	EXIST::FUNCTION:FP_API
+EC_POINT_is_on_curve                    1012	EXIST::FUNCTION:EC
+lh_strhash                              1013	EXIST::FUNCTION:
+i2d_TS_ACCURACY                         1014	EXIST::FUNCTION:
+i2d_ACCESS_DESCRIPTION                  1015	EXIST::FUNCTION:
+CRYPTO_set_locked_mem_ex_functions      1016	EXIST:!VMS:FUNCTION:
+CRYPTO_set_locked_mem_ex_funcs          1016	EXIST:VMS:FUNCTION:
+d2i_KRB5_CHECKSUM                       1017	EXIST::FUNCTION:
+ASN1_item_dup                           1018	EXIST::FUNCTION:
+RC5_32_cbc_encrypt                      1019	EXIST::FUNCTION:RC5
+i2c_ASN1_BIT_STRING                     1020	EXIST::FUNCTION:
+ASN1_OCTET_STRING_new                   1021	EXIST::FUNCTION:
+X509_it                                 1022	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_it                                 1022	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_REQ_sign                           1023	EXIST::FUNCTION:EVP
+BIO_s_mem                               1024	EXIST::FUNCTION:
+X509_CRL_sign                           1025	EXIST::FUNCTION:EVP
+ASN1_mbstring_ncopy                     1026	EXIST::FUNCTION:
+BN_mod_add                              1027	EXIST::FUNCTION:
+DH_get_ex_new_index                     1028	EXIST::FUNCTION:DH
+i2d_RSAPublicKey_fp                     1029	EXIST::FUNCTION:FP_API,RSA
+KRB5_AUTHDATA_free                      1030	EXIST::FUNCTION:
+X509_STORE_CTX_set_trust                1031	EXIST::FUNCTION:
+ASN1_GENERALIZEDTIME_set_string         1032	EXIST::FUNCTION:
+PKCS7_RECIP_INFO_set                    1033	EXIST::FUNCTION:
+ASN1_TYPE_get_int_octetstring           1034	EXIST::FUNCTION:
+DES_check_key_parity                    1035	EXIST::FUNCTION:DES
+d2i_X509_CRL                            1036	EXIST::FUNCTION:
+OBJ_nid2sn                              1037	EXIST::FUNCTION:
+CRYPTO_new_ex_data                      1038	EXIST::FUNCTION:
+EVP_cast5_cbc                           1039	EXIST::FUNCTION:CAST
+i2d_DSA_SIG                             1040	EXIST::FUNCTION:DSA
+ASN1_item_verify                        1041	EXIST::FUNCTION:EVP
+SHA                                     1042	EXIST::FUNCTION:SHA,SHA0
+CRYPTO_set_mem_ex_functions             1043	EXIST::FUNCTION:
+X509at_add1_attr_by_txt                 1044	EXIST::FUNCTION:
+ERR_load_PKCS7_strings                  1045	EXIST::FUNCTION:
+EC_POINT_get_Jprojective_coordinates_GFp 1046	EXIST:!VMS:FUNCTION:EC
+EC_POINT_get_Jproj_coords_GFp           1046	EXIST:VMS:FUNCTION:EC
+PEM_read_X509_CRL                       1047	EXIST:!WIN16:FUNCTION:
+EVP_rc2_ecb                             1048	EXIST::FUNCTION:RC2
+TXT_DB_read                             1049	EXIST::FUNCTION:BIO
+d2i_PKCS12_SAFEBAG                      1050	EXIST::FUNCTION:
+ZLONG_it                                1051	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ZLONG_it                                1051	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+RAND_set_rand_method                    1052	EXIST::FUNCTION:
+DES_set_key_unchecked                   1053	EXIST::FUNCTION:DES
+d2i_X509_REQ                            1054	EXIST::FUNCTION:
+CRYPTO_get_locked_mem_ex_functions      1055	EXIST:!VMS:FUNCTION:
+CRYPTO_get_locked_mem_ex_funcs          1055	EXIST:VMS:FUNCTION:
+d2i_PKCS7_ISSUER_AND_SERIAL             1056	EXIST::FUNCTION:
+d2i_ASN1_PRINTABLE                      1057	EXIST::FUNCTION:
+EVP_read_pw_string                      1058	EXIST::FUNCTION:
+ASN1_TIME_check                         1059	EXIST::FUNCTION:
+X509_set_subject_name                   1060	EXIST::FUNCTION:
+d2i_DSA_SIG                             1061	EXIST::FUNCTION:DSA
+i2d_ASN1_OCTET_STRING                   1062	EXIST::FUNCTION:
+EVP_des_cfb64                           1063	EXIST::FUNCTION:DES
+PEM_read_X509_REQ                       1064	EXIST:!WIN16:FUNCTION:
+UI_get0_user_data                       1065	EXIST::FUNCTION:
+BUF_MEM_grow_clean                      1066	EXIST::FUNCTION:
+HMAC_CTX_cleanup                        1067	EXIST::FUNCTION:HMAC
+EVP_rc2_cfb64                           1068	EXIST::FUNCTION:RC2
+GENERAL_NAME_free                       1069	EXIST::FUNCTION:
+EVP_rc4                                 1070	EXIST::FUNCTION:RC4
+EVP_PKEY_new                            1071	EXIST::FUNCTION:
+PEM_write_bio_X509_REQ_NEW              1072	EXIST::FUNCTION:
+BIO_s_bio                               1073	EXIST::FUNCTION:
+CONF_module_set_usr_data                1074	EXIST::FUNCTION:
+RAND_status                             1075	EXIST::FUNCTION:
+CONF_parse_list                         1076	EXIST::FUNCTION:
+TS_CONF_set_crypto_device               1077	EXIST::FUNCTION:
+OBJ_add_object                          1078	EXIST::FUNCTION:
+CRYPTO_dbg_set_options                  1079	EXIST::FUNCTION:
+ENGINE_setup_bsd_cryptodev              1080	EXIST:__FreeBSD__:FUNCTION:ENGINE
+PKCS12_init                             1081	EXIST::FUNCTION:
+X509_LOOKUP_free                        1082	EXIST::FUNCTION:
+DSA_up_ref                              1083	EXIST::FUNCTION:DSA
+PEM_read_PKCS8_PRIV_KEY_INFO            1084	EXIST:!VMS,!WIN16:FUNCTION:
+PEM_read_P8_PRIV_KEY_INFO               1084	EXIST:VMS:FUNCTION:
+ASN1_BMPSTRING_it                       1085	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_BMPSTRING_it                       1085	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_STORE_CTX_set_flags                1086	EXIST::FUNCTION:
+BIO_ctrl_pending                        1087	EXIST::FUNCTION:
+X509_CRL_add_ext                        1088	EXIST::FUNCTION:
+PEM_write_bio_DHparams                  1089	EXIST::FUNCTION:DH
+i2d_OTHERNAME                           1090	EXIST::FUNCTION:
+EVP_CIPHER_CTX_ctrl                     1091	EXIST::FUNCTION:
+ASN1_tag2bit                            1092	EXIST::FUNCTION:
+ERR_error_string_n                      1093	EXIST::FUNCTION:
+CONF_module_add                         1094	EXIST::FUNCTION:
+PBKDF2PARAM_free                        1095	EXIST::FUNCTION:
+i2d_PKCS12_BAGS                         1096	EXIST::FUNCTION:
+ENGINE_set_init_function                1097	EXIST::FUNCTION:ENGINE
+TS_TST_INFO_set_ordering                1098	EXIST::FUNCTION:
+RAND_egd                                1099	EXIST::FUNCTION:
+X509_subject_name_hash                  1100	EXIST::FUNCTION:
+ASN1_IA5STRING_free                     1101	EXIST::FUNCTION:
+TXT_DB_free                             1102	EXIST::FUNCTION:
+SXNET_add_id_ulong                      1103	EXIST::FUNCTION:
+UI_method_set_flusher                   1104	EXIST::FUNCTION:
+FIPS_rand_method                        1105	EXIST:OPENSSL_FIPS:FUNCTION:
+TS_MSG_IMPRINT_set_msg                  1106	EXIST::FUNCTION:
+X509_alias_get0                         1107	EXIST::FUNCTION:
+idea_encrypt                            1108	EXIST::FUNCTION:IDEA
+X509_STORE_CTX_trusted_stack            1109	EXIST::FUNCTION:
+X509_ocspid_print                       1110	EXIST::FUNCTION:BIO
+ASN1_BIT_STRING_asn1_meth               1111	EXIST::FUNCTION:
+FIPS_rand_seed                          1112	EXIST:OPENSSL_FIPS:FUNCTION:
+X509_get_issuer_name                    1113	EXIST::FUNCTION:
+KRB5_ENCDATA_it                         1114	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_ENCDATA_it                         1114	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_REQ_ext_free                         1115	EXIST::FUNCTION:
+d2i_PUBKEY_fp                           1116	EXIST::FUNCTION:FP_API
+RSAPublicKey_dup                        1117	EXIST::FUNCTION:RSA
+_ossl_096_des_random_seed               1118	EXIST::FUNCTION:DES
+EVP_CIPHER_asn1_to_param                1119	EXIST::FUNCTION:
+X509V3_EXT_add_conf                     1120	EXIST::FUNCTION:
+X509_REQ_get_attr                       1121	EXIST::FUNCTION:
+BIO_sock_init                           1122	EXIST::FUNCTION:
+ENGINE_get_load_pubkey_function         1123	EXIST::FUNCTION:ENGINE
+UI_add_user_data                        1124	EXIST::FUNCTION:
+BN_is_prime                             1125	EXIST::FUNCTION:
+X509_free                               1126	EXIST::FUNCTION:
+BF_cfb64_encrypt                        1127	EXIST::FUNCTION:BF
+OCSP_REQUEST_delete_ext                 1128	EXIST::FUNCTION:
+UI_get_method                           1129	EXIST::FUNCTION:
+BN_CTX_get                              1130	EXIST::FUNCTION:
+BIO_set_ex_data                         1131	EXIST::FUNCTION:
+TS_REQ_dup                              1132	EXIST::FUNCTION:
+POLICYINFO_new                          1133	EXIST::FUNCTION:
+BN_mod_exp_recp                         1134	EXIST::FUNCTION:
+RAND_pseudo_bytes                       1135	EXIST::FUNCTION:
+X509V3_get_d2i                          1136	EXIST::FUNCTION:
+BN_MONT_CTX_new                         1137	EXIST::FUNCTION:
+OCSP_ONEREQ_free                        1138	EXIST::FUNCTION:
+ASN1_PRINTABLESTRING_it                 1139	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_PRINTABLESTRING_it                 1139	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_CONF_set_ordering                    1140	EXIST::FUNCTION:
+X509_CRL_set_nextUpdate                 1141	EXIST::FUNCTION:
+TS_MSG_IMPRINT_get_msg                  1142	EXIST::FUNCTION:
+OCSP_REQUEST_it                         1143	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_REQUEST_it                         1143	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+RC5_32_cfb64_encrypt                    1144	EXIST::FUNCTION:RC5
+EVP_aes_192_cfb128                      1145	EXIST::FUNCTION:AES
+OCSP_BASICRESP_it                       1146	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_BASICRESP_it                       1146	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+CRYPTO_set_locked_mem_functions         1147	EXIST::FUNCTION:
+BIO_free_all                            1148	EXIST::FUNCTION:
+ASN1_OCTET_STRING_cmp                   1149	EXIST::FUNCTION:
+BN_ucmp                                 1150	EXIST::FUNCTION:
+AES_ecb_encrypt                         1151	EXIST::FUNCTION:AES
+NCONF_load_bio                          1152	EXIST::FUNCTION:
+BN_mod_sqr                              1153	EXIST::FUNCTION:
+BN_rand_range                           1154	EXIST::FUNCTION:
+i2d_DIST_POINT                          1155	EXIST::FUNCTION:
+NETSCAPE_CERT_SEQUENCE_it               1156	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+NETSCAPE_CERT_SEQUENCE_it               1156	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_ATTRIBUTE_get0_data                1157	EXIST::FUNCTION:
+CONF_get1_default_config_file           1158	EXIST::FUNCTION:
+EVP_EncryptInit                         1159	EXIST::FUNCTION:
+GENERAL_NAMES_it                        1160	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+GENERAL_NAMES_it                        1160	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PKCS12_MAKE_KEYBAG                      1161	EXIST::FUNCTION:
+POLICYINFO_free                         1162	EXIST::FUNCTION:
+AUTHORITY_INFO_ACCESS_it                1163	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+AUTHORITY_INFO_ACCESS_it                1163	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_FBOOLEAN_it                        1164	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_FBOOLEAN_it                        1164	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+UI_set_ex_data                          1165	EXIST::FUNCTION:
+X509_STORE_CTX_get_error                1166	EXIST::FUNCTION:
+ENGINE_register_all_RSA                 1167	EXIST::FUNCTION:ENGINE
+DES_ncbc_encrypt                        1168	EXIST::FUNCTION:DES
+ENGINE_set_default_RSA                  1169	EXIST::FUNCTION:ENGINE
+d2i_KRB5_PRINCNAME                      1170	EXIST::FUNCTION:
+BIO_set_cipher                          1171	EXIST::FUNCTION:BIO
+EVP_DecodeInit                          1172	EXIST::FUNCTION:
+X509_ATTRIBUTE_create_by_NID            1173	EXIST::FUNCTION:
+CRYPTO_lock                             1174	EXIST::FUNCTION:
+X509_NAME_add_entry_by_NID              1175	EXIST::FUNCTION:
+OCSP_RESPBYTES_it                       1176	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_RESPBYTES_it                       1176	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_EncodeUpdate                        1177	EXIST::FUNCTION:
+d2i_TS_REQ                              1178	EXIST::FUNCTION:
+X509_CINF_it                            1179	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_CINF_it                            1179	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+FIPS_selftest_failed                    1180	EXIST:OPENSSL_FIPS:FUNCTION:
+d2i_PKCS7_SIGNER_INFO                   1181	EXIST::FUNCTION:
+ENGINE_unregister_digests               1182	EXIST::FUNCTION:ENGINE
+d2i_EDIPARTYNAME                        1183	EXIST::FUNCTION:
+ASN1_GENERALIZEDTIME_check              1184	EXIST::FUNCTION:
+X509_NAME_ENTRY_free                    1185	EXIST::FUNCTION:
+d2i_OCSP_SERVICELOC                     1186	EXIST::FUNCTION:
+X509_NAME_oneline                       1187	EXIST::FUNCTION:EVP
+ENGINE_get_digests                      1188	EXIST::FUNCTION:ENGINE
+i2d_ASN1_BIT_STRING                     1189	EXIST::FUNCTION:
+i2d_TS_TST_INFO_fp                      1190	EXIST::FUNCTION:
+PKCS7_get_signer_info                   1191	EXIST::FUNCTION:
+BF_set_key                              1192	EXIST::FUNCTION:BF
+AUTHORITY_KEYID_new                     1193	EXIST::FUNCTION:
+X509_ATTRIBUTE_count                    1194	EXIST::FUNCTION:
+BUF_MEM_grow                            1195	EXIST::FUNCTION:
+DSO_free                                1196	EXIST::FUNCTION:
+OCSP_RESPDATA_free                      1197	EXIST::FUNCTION:
+ERR_load_DSO_strings                    1198	EXIST::FUNCTION:
+PKCS12_pack_p7encdata                   1199	EXIST::FUNCTION:
+SHA_Transform                           1200	EXIST::FUNCTION:SHA,SHA0
+d2i_DIST_POINT                          1201	EXIST::FUNCTION:
+PKCS7_SIGNER_INFO_set                   1202	EXIST::FUNCTION:
+d2i_KRB5_TICKET                         1203	EXIST::FUNCTION:
+PKCS7_ISSUER_AND_SERIAL_free            1204	EXIST::FUNCTION:
+RSA_print                               1205	EXIST::FUNCTION:BIO,RSA
+OTHERNAME_it                            1206	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OTHERNAME_it                            1206	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509V3_EXT_get                          1207	EXIST::FUNCTION:
+d2i_X509_VAL                            1208	EXIST::FUNCTION:
+COMP_CTX_new                            1209	EXIST::FUNCTION:
+TS_TST_INFO_set_accuracy                1210	EXIST::FUNCTION:
+ASN1_UTF8STRING_free                    1211	EXIST::FUNCTION:
+FIPS_set_prng_key                       1212	EXIST:OPENSSL_FIPS:FUNCTION:
+X509_REQ_add1_attr_by_NID               1213	EXIST::FUNCTION:
+EVP_MD_CTX_cleanup                      1214	EXIST::FUNCTION:
+d2i_ASN1_GENERALSTRING                  1215	EXIST::FUNCTION:
+X509V3_conf_free                        1216	EXIST::FUNCTION:
+X509_CRL_set_version                    1217	EXIST::FUNCTION:
+BN_mod_sub                              1218	EXIST::FUNCTION:
+TS_TST_INFO_set_policy_id               1219	EXIST::FUNCTION:
+TS_STATUS_INFO_print_bio                1220	EXIST::FUNCTION:
+ASN1_d2i_fp                             1221	EXIST::FUNCTION:FP_API
+BN_bn2bin                               1222	EXIST::FUNCTION:
+X509_INFO_new                           1223	EXIST::FUNCTION:EVP
+X509_EXTENSION_new                      1224	EXIST::FUNCTION:
+sk_delete                               1225	EXIST::FUNCTION:
+OCSP_SINGLERESP_get_ext_by_NID          1226	EXIST::FUNCTION:
+TS_RESP_CTX_set_status_info_cond        1227	EXIST::FUNCTION:
+X509_STORE_CTX_get_error_depth          1228	EXIST::FUNCTION:
+ENGINE_get_ex_new_index                 1229	EXIST::FUNCTION:ENGINE
+BIO_s_null                              1230	EXIST::FUNCTION:
+OCSP_REQUEST_free                       1231	EXIST::FUNCTION:
+OCSP_REQUEST_add1_ext_i2d               1232	EXIST::FUNCTION:
+BIO_gets                                1233	EXIST::FUNCTION:
+X509_VAL_it                             1234	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_VAL_it                             1234	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_RESP_CTX_get_request                 1235	EXIST::FUNCTION:
+X509_NAME_free                          1236	EXIST::FUNCTION:
+BN_num_bits                             1237	EXIST::FUNCTION:
+EVP_des_ecb                             1238	EXIST::FUNCTION:DES
+EC_POINTs_make_affine                   1239	EXIST::FUNCTION:EC
+BIO_new                                 1240	EXIST::FUNCTION:
+EC_POINT_mul                            1241	EXIST::FUNCTION:EC
+X509_CRL_INFO_new                       1242	EXIST::FUNCTION:
+X509V3_EXT_add_nconf                    1243	EXIST::FUNCTION:
+BIO_ctrl_get_read_request               1244	EXIST::FUNCTION:
+DES_enc_read                            1245	EXIST::FUNCTION:DES
+PEM_write_DSAparams                     1246	EXIST:!WIN16:FUNCTION:DSA
+RSA_get_default_method                  1247	EXIST::FUNCTION:RSA
+X509_EXTENSION_get_data                 1248	EXIST::FUNCTION:
+TS_CONF_set_accuracy                    1249	EXIST::FUNCTION:
+X509_set_ex_data                        1250	EXIST::FUNCTION:
+BN_mul                                  1251	EXIST::FUNCTION:
+v2i_GENERAL_NAME                        1252	EXIST::FUNCTION:
+idea_options                            1253	EXIST::FUNCTION:IDEA
+RIPEMD160_Init                          1254	EXIST::FUNCTION:RIPEMD
+ESS_CERT_ID_dup                         1255	EXIST::FUNCTION:
+ESS_SIGNING_CERT_free                   1256	EXIST::FUNCTION:
+RAND_bytes                              1257	EXIST::FUNCTION:
+X509_EXTENSION_create_by_OBJ            1258	EXIST::FUNCTION:
+ASN1_TYPE_set_int_octetstring           1259	EXIST::FUNCTION:
+EVP_ripemd160                           1260	EXIST::FUNCTION:RIPEMD
+EVP_des_ede                             1261	EXIST::FUNCTION:DES
+PEM_read_X509                           1262	EXIST:!WIN16:FUNCTION:
+DES_pcbc_encrypt                        1263	EXIST::FUNCTION:DES
+X509_TRUST_set                          1264	EXIST::FUNCTION:
+X509_time_adj                           1265	EXIST::FUNCTION:
+i2d_ASN1_bytes                          1266	EXIST::FUNCTION:
+PEM_read_bio_PKCS7                      1267	EXIST::FUNCTION:
+TS_TST_INFO_free                        1268	EXIST::FUNCTION:
+ASN1_INTEGER_set                        1269	EXIST::FUNCTION:
+PEM_read_bio_PKCS8                      1270	EXIST::FUNCTION:
+X509_CRL_add1_ext_i2d                   1271	EXIST::FUNCTION:
+BIO_new_file                            1272	EXIST:!WIN16:FUNCTION:FP_API
+PKCS7_ctrl                              1273	EXIST::FUNCTION:
+GENERAL_NAME_dup                        1274	EXIST::FUNCTION:
+ASN1_GENERALIZEDTIME_set                1275	EXIST::FUNCTION:
+ERR_load_EVP_strings                    1276	EXIST::FUNCTION:
+DISPLAYTEXT_it                          1277	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+DISPLAYTEXT_it                          1277	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_CRL_set_lastUpdate                 1278	EXIST::FUNCTION:
+ENGINE_load_4758cca                     1279	EXIST::FUNCTION:ENGINE
+PKCS7_get_attribute                     1280	EXIST::FUNCTION:
+_ossl_old_des_fcrypt                    1281	EXIST::FUNCTION:DES
+OCSP_BASICRESP_free                     1282	EXIST::FUNCTION:
+ASN1_VISIBLESTRING_free                 1283	EXIST::FUNCTION:
+PEM_read_bio_DHparams                   1284	EXIST::FUNCTION:DH
+ERR_load_DSA_strings                    1285	EXIST::FUNCTION:DSA
+FIPS_corrupt_dsa                        1286	EXIST:OPENSSL_FIPS:FUNCTION:
+CRYPTO_get_locked_mem_functions         1287	EXIST::FUNCTION:
+ASN1_BIT_STRING_check                   1288	EXIST::FUNCTION:
+DSO_new                                 1289	EXIST::FUNCTION:
+TS_RESP_CTX_set_certs                   1290	EXIST::FUNCTION:
+TS_OBJ_print_bio                        1291	EXIST::FUNCTION:
+X509_get_ext_d2i                        1292	EXIST::FUNCTION:
+X509_LOOKUP_init                        1293	EXIST::FUNCTION:
+i2d_ASN1_UTF8STRING                     1294	EXIST::FUNCTION:
+DSA_print                               1295	EXIST::FUNCTION:BIO,DSA
+MD2_Final                               1296	EXIST::FUNCTION:MD2
+DES_ede3_cfb_encrypt                    1297	EXIST::FUNCTION:DES
+i2d_PUBKEY                              1298	EXIST::FUNCTION:
+OCSP_BASICRESP_add1_ext_i2d             1299	EXIST::FUNCTION:
+sk_push                                 1300	EXIST::FUNCTION:
+d2i_KRB5_AUTHENTBODY                    1301	EXIST::FUNCTION:
+CRYPTO_set_ex_data_implementation       1302	EXIST:!VMS:FUNCTION:
+CRYPTO_set_ex_data_impl                 1302	EXIST:VMS:FUNCTION:
+EVP_CIPHER_CTX_set_key_length           1303	EXIST::FUNCTION:
+X509_STORE_CTX_set_chain                1304	EXIST::FUNCTION:
+PEM_write_bio_RSAPrivateKey             1305	EXIST::FUNCTION:RSA
+KRB5_ENCDATA_new                        1306	EXIST::FUNCTION:
+HMAC_Init                               1307	EXIST::FUNCTION:HMAC
+ASN1_BIT_STRING_name_print              1308	EXIST::FUNCTION:BIO
+d2i_TS_TST_INFO_bio                     1309	EXIST::FUNCTION:
+X509_ATTRIBUTE_get0_object              1310	EXIST::FUNCTION:
+ASN1_d2i_bio                            1311	EXIST::FUNCTION:BIO
+DSO_up_ref                              1312	EXIST::FUNCTION:
+OCSP_crl_reason_str                     1313	EXIST::FUNCTION:
+ASN1_BIT_STRING_free                    1314	EXIST::FUNCTION:
+DSA_SIG_free                            1315	EXIST::FUNCTION:DSA
+sk_unshift                              1316	EXIST::FUNCTION:
+ASN1_INTEGER_dup                        1317	EXIST::FUNCTION:
+ERR_error_string                        1318	EXIST::FUNCTION:
+X509_NAME_ENTRY_set_data                1319	EXIST::FUNCTION:
+X509V3_string_free                      1320	EXIST::FUNCTION:
+i2a_ASN1_OBJECT                         1321	EXIST::FUNCTION:BIO
+i2d_DIST_POINT_NAME                     1322	EXIST::FUNCTION:
+d2i_ASN1_bytes                          1323	EXIST::FUNCTION:
+CRYPTO_malloc_locked                    1324	EXIST::FUNCTION:
+X509_REQ_set_subject_name               1325	EXIST::FUNCTION:
+X509_get_ext_by_critical                1326	EXIST::FUNCTION:
+sk_new_null                             1327	EXIST::FUNCTION:
+X509v3_get_ext_by_NID                   1328	EXIST::FUNCTION:
+SHA_Update                              1329	EXIST::FUNCTION:SHA,SHA0
+DSAparams_print                         1330	EXIST::FUNCTION:BIO,DSA
+i2d_PBE2PARAM                           1331	EXIST::FUNCTION:
+RSAPrivateKey_asn1_meth                 1332	EXIST::FUNCTION:RSA
+ASN1_UNIVERSALSTRING_free               1333	EXIST::FUNCTION:
+CRYPTO_destroy_dynlockid                1334	EXIST::FUNCTION:
+OBJ_new_nid                             1335	EXIST::FUNCTION:
+i2a_ASN1_INTEGER                        1336	EXIST::FUNCTION:BIO
+UI_get0_result_string                   1337	EXIST::FUNCTION:
+ASN1_GENERALSTRING_new                  1338	EXIST::FUNCTION:
+d2i_RSAPrivateKey_bio                   1339	EXIST::FUNCTION:BIO,RSA
+d2i_DSA_PUBKEY_fp                       1340	EXIST::FUNCTION:DSA,FP_API
+X509_SIG_it                             1341	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_SIG_it                             1341	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+RAND_get_rand_method                    1342	EXIST::FUNCTION:
+CONF_imodule_get_flags                  1343	EXIST::FUNCTION:
+idea_cfb64_encrypt                      1344	EXIST::FUNCTION:IDEA
+X509_check_purpose                      1345	EXIST::FUNCTION:
+CRYPTO_get_mem_debug_options            1346	EXIST::FUNCTION:
+ERR_set_implementation                  1347	EXIST::FUNCTION:
+ERR_peek_error_line                     1348	EXIST::FUNCTION:
+BN_MONT_CTX_free                        1349	EXIST::FUNCTION:
+PKCS8_add_keyusage                      1350	EXIST::FUNCTION:
+DSO_METHOD_win32                        1351	EXIST::FUNCTION:
+X509v3_delete_ext                       1352	EXIST::FUNCTION:
+X509_CERT_AUX_free                      1353	EXIST::FUNCTION:
+EVP_PKEY_copy_parameters                1354	EXIST::FUNCTION:
+d2i_ASN1_INTEGER                        1355	EXIST::FUNCTION:
+DES_decrypt3                            1356	EXIST::FUNCTION:DES
+DES_ede3_ofb64_encrypt                  1357	EXIST::FUNCTION:DES
+d2i_DHparams                            1358	EXIST::FUNCTION:DH
+ERR_load_EC_strings                     1359	EXIST::FUNCTION:EC
+EVP_CipherFinal                         1360	EXIST::FUNCTION:
+UI_get0_action_string                   1361	EXIST::FUNCTION:
+BIO_sock_should_retry                   1362	EXIST::FUNCTION:
+d2i_TS_MSG_IMPRINT_fp                   1363	EXIST::FUNCTION:
+X509at_add1_attr                        1364	EXIST::FUNCTION:
+EVP_des_cfb1                            1365	EXIST::FUNCTION:DES
+OCSP_ONEREQ_get_ext                     1366	EXIST::FUNCTION:
+PEM_read_DHparams                       1367	EXIST:!WIN16:FUNCTION:DH
+COMP_CTX_free                           1368	EXIST::FUNCTION:
+MD5_Transform                           1369	EXIST::FUNCTION:MD5
+EVP_des_cfb8                            1370	EXIST::FUNCTION:DES
+OpenSSL_add_all_ciphers                 1371	EXIST::FUNCTION:
+PEM_write_X509_AUX                      1372	EXIST:!WIN16:FUNCTION:
+BF_ecb_encrypt                          1373	EXIST::FUNCTION:BF
+BIO_new_file_internal                   1374	EXIST:WIN16:FUNCTION:FP_API
+EC_POINT_method_of                      1375	EXIST::FUNCTION:EC
+i2d_KRB5_APREQBODY                      1376	EXIST::FUNCTION:
+d2i_X509_REVOKED                        1377	EXIST::FUNCTION:
+i2d_DISPLAYTEXT                         1378	EXIST::FUNCTION:
+d2i_CRL_DIST_POINTS                     1379	EXIST::FUNCTION:
+X509_ALGOR_free                         1380	EXIST::FUNCTION:
+CRYPTO_get_mem_ex_functions             1381	EXIST::FUNCTION:
+ENGINE_set_id                           1382	EXIST::FUNCTION:ENGINE
+ENGINE_get_ex_data                      1383	EXIST::FUNCTION:ENGINE
+UI_destroy_method                       1384	EXIST::FUNCTION:
+i2v_GENERAL_NAME                        1385	EXIST::FUNCTION:
+ERR_load_ENGINE_strings                 1386	EXIST::FUNCTION:ENGINE
+EVP_idea_ofb                            1387	EXIST::FUNCTION:IDEA
+i2d_X509_SIG                            1388	EXIST::FUNCTION:
+sk_is_sorted                            1389	EXIST::FUNCTION:
+ASN1_item_i2d_bio                       1390	EXIST::FUNCTION:BIO
+ERR_load_OBJ_strings                    1391	EXIST::FUNCTION:
+OCSP_ONEREQ_get_ext_by_OBJ              1392	EXIST::FUNCTION:
+ASN1_STRING_length_set                  1393	EXIST::FUNCTION:
+i2d_ASN1_GENERALIZEDTIME                1394	EXIST::FUNCTION:
+X509_REQ_delete_attr                    1395	EXIST::FUNCTION:
+d2i_NETSCAPE_SPKI                       1396	EXIST::FUNCTION:
+d2i_GENERAL_NAME                        1397	EXIST::FUNCTION:
+DSA_set_default_method                  1398	EXIST::FUNCTION:DSA
+PKCS12_get_friendlyname                 1399	EXIST::FUNCTION:
+ASN1_primitive_new                      1400	EXIST::FUNCTION:
+CAST_ofb64_encrypt                      1401	EXIST::FUNCTION:CAST
+d2i_ASN1_OBJECT                         1402	EXIST::FUNCTION:
+ASN1_PRINTABLE_it                       1403	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_PRINTABLE_it                       1403	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_des_ede3_cbc                        1404	EXIST::FUNCTION:DES
+X509_TRUST_add                          1405	EXIST::FUNCTION:
+EVP_aes_192_ecb                         1406	EXIST::FUNCTION:AES
+OCSP_SIGNATURE_new                      1407	EXIST::FUNCTION:
+LONG_it                                 1408	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+LONG_it                                 1408	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_CIPHER_CTX_cleanup                  1409	EXIST::FUNCTION:
+ASN1_VISIBLESTRING_it                   1410	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_VISIBLESTRING_it                   1410	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+OCSP_SINGLERESP_add1_ext_i2d            1411	EXIST::FUNCTION:
+TS_RESP_print_bio                       1412	EXIST::FUNCTION:
+TXT_DB_get_by_index                     1413	EXIST::FUNCTION:
+d2i_RSAPublicKey_bio                    1414	EXIST::FUNCTION:BIO,RSA
+X509_issuer_and_serial_hash             1415	EXIST::FUNCTION:
+ASN1_UTCTIME_set                        1416	EXIST::FUNCTION:
+CRYPTO_pop_info                         1417	EXIST::FUNCTION:
+d2i_OCSP_CERTID                         1418	EXIST::FUNCTION:
+X509_TRUST_get0                         1419	EXIST::FUNCTION:
+d2i_ASN1_VISIBLESTRING                  1420	EXIST::FUNCTION:
+X509_STORE_CTX_set_verify_cb            1421	EXIST::FUNCTION:
+EVP_aes_256_cfb128                      1422	EXIST::FUNCTION:AES
+ASN1_item_d2i_fp                        1423	EXIST::FUNCTION:FP_API
+CRL_DIST_POINTS_it                      1424	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+CRL_DIST_POINTS_it                      1424	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+GENERAL_NAME_print                      1425	EXIST::FUNCTION:
+d2i_X509                                1426	EXIST::FUNCTION:
+OCSP_SINGLERESP_delete_ext              1427	EXIST::FUNCTION:
+BN_bn2mpi                               1428	EXIST::FUNCTION:
+PEM_write_RSAPublicKey                  1429	EXIST:!WIN16:FUNCTION:RSA
+PEM_write_PUBKEY                        1430	EXIST:!WIN16:FUNCTION:
+PKCS12_SAFEBAGS_it                      1431	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS12_SAFEBAGS_it                      1431	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_OCSP_SIGNATURE                      1432	EXIST::FUNCTION:
+d2i_DSAPublicKey                        1433	EXIST::FUNCTION:DSA
+CAST_set_key                            1434	EXIST::FUNCTION:CAST
+DISPLAYTEXT_new                         1435	EXIST::FUNCTION:
+ASN1_PRINTABLE_type                     1436	EXIST::FUNCTION:
+NCONF_dump_bio                          1437	EXIST::FUNCTION:
+BN_RECP_CTX_set                         1438	EXIST::FUNCTION:
+X509_PUBKEY_set                         1439	EXIST::FUNCTION:
+_ossl_old_des_ede3_cbc_encrypt          1440	EXIST::FUNCTION:DES
+TS_REQ_get_ext_by_OBJ                   1441	EXIST::FUNCTION:
+i2d_X509_CRL_fp                         1442	EXIST::FUNCTION:FP_API
+X509_cmp_time                           1443	EXIST::FUNCTION:
+i2d_PrivateKey_bio                      1444	EXIST::FUNCTION:BIO
+OCSP_request_add1_nonce                 1445	EXIST::FUNCTION:
+DHparams_print                          1446	EXIST::FUNCTION:BIO,DH
+PKCS12_add_friendlyname_uni             1447	EXIST::FUNCTION:
+EVP_PKEY_set1_RSA                       1448	EXIST::FUNCTION:RSA
+i2d_RSA_PUBKEY_fp                       1449	EXIST::FUNCTION:FP_API,RSA
+ENGINE_set_cmd_defns                    1450	EXIST::FUNCTION:ENGINE
+OCSP_SERVICELOC_free                    1451	EXIST::FUNCTION:
+CONF_get_string                         1452	EXIST::FUNCTION:
+EC_GROUP_free                           1453	EXIST::FUNCTION:EC
+ERR_free_strings                        1454	EXIST::FUNCTION:
+PKCS12_PBE_add                          1455	EXIST::FUNCTION:
+ENGINE_load_public_key                  1456	EXIST::FUNCTION:ENGINE
+RAND_cleanup                            1457	EXIST::FUNCTION:
+TS_REQ_to_TS_VERIFY_CTX                 1458	EXIST::FUNCTION:
+X509_set_notBefore                      1459	EXIST::FUNCTION:
+OBJ_NAME_init                           1460	EXIST::FUNCTION:
+ASN1_BIT_STRING_it                      1461	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_BIT_STRING_it                      1461	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_ACCURACY_get_seconds                 1462	EXIST::FUNCTION:
+X509_REQ_it                             1463	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_REQ_it                             1463	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ERR_unload_strings                      1464	EXIST::FUNCTION:
+X509_CERT_AUX_new                       1465	EXIST::FUNCTION:
+ERR_load_BIO_strings                    1466	EXIST::FUNCTION:
+PEM_X509_INFO_write_bio                 1467	EXIST::FUNCTION:BIO
+ms_time_free                            1468	EXIST::FUNCTION:
+d2i_PublicKey                           1469	EXIST::FUNCTION:
+X509_get_ext_by_NID                     1470	EXIST::FUNCTION:
+PEM_ASN1_write_bio                      1471	EXIST::FUNCTION:BIO
+PKCS7_SIGN_ENVELOPE_it                  1472	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_SIGN_ENVELOPE_it                  1472	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EDIPARTYNAME_free                       1473	EXIST::FUNCTION:
+ASN1_STRING_TABLE_add                   1474	EXIST::FUNCTION:
+FIPS_corrupt_aes                        1475	EXIST:OPENSSL_FIPS:FUNCTION:
+ENGINE_get_last                         1476	EXIST::FUNCTION:ENGINE
+lh_node_usage_stats                     1477	EXIST::FUNCTION:FP_API
+OCSP_REQINFO_free                       1478	EXIST::FUNCTION:
+TS_STATUS_INFO_free                     1479	EXIST::FUNCTION:
+EC_GROUP_new_curve_GFp                  1480	EXIST::FUNCTION:EC
+ENGINE_get_default_RSA                  1481	EXIST::FUNCTION:ENGINE
+X509_REVOKED_get_ext_by_OBJ             1482	EXIST::FUNCTION:
+TS_TST_INFO_get_time                    1483	EXIST::FUNCTION:
+X509_CRL_verify                         1484	EXIST::FUNCTION:EVP
+ESS_ISSUER_SERIAL_free                  1485	EXIST::FUNCTION:
+OCSP_REQUEST_get1_ext_d2i               1486	EXIST::FUNCTION:
+PKCS12_item_pack_safebag                1487	EXIST::FUNCTION:
+asn1_ex_c2i                             1488	EXIST::FUNCTION:
+ENGINE_register_digests                 1489	EXIST::FUNCTION:ENGINE
+d2i_X509_REQ_INFO                       1490	EXIST::FUNCTION:
+TS_REQ_get_nonce                        1491	EXIST::FUNCTION:
+DES_xwhite_in2out                       1492	EXIST::FUNCTION:DES
+i2d_OCSP_REVOKEDINFO                    1493	EXIST::FUNCTION:
+X509_STORE_add_crl                      1494	EXIST::FUNCTION:
+ASN1_NULL_new                           1495	EXIST::FUNCTION:
+d2i_X509_CRL_INFO                       1496	EXIST::FUNCTION:
+OTHERNAME_free                          1497	EXIST::FUNCTION:
+EVP_aes_192_cfb1                        1498	EXIST::FUNCTION:AES
+TS_ACCURACY_dup                         1499	EXIST::FUNCTION:
+EVP_PKEY2PKCS8                          1500	EXIST::FUNCTION:
+i2d_PKCS12_MAC_DATA                     1501	EXIST::FUNCTION:
+RSA_verify                              1502	EXIST::FUNCTION:RSA
+ASN1_UTCTIME_set_string                 1503	EXIST::FUNCTION:
+ASN1_UTCTIME_check                      1504	EXIST::FUNCTION:
+RSA_padding_add_SSLv23                  1505	EXIST::FUNCTION:RSA
+NOTICEREF_new                           1506	EXIST::FUNCTION:
+PKCS5_v2_PBE_keyivgen                   1507	EXIST::FUNCTION:
+EVP_aes_192_cfb8                        1508	EXIST::FUNCTION:AES
+ASN1_BIT_STRING_set_bit                 1509	EXIST::FUNCTION:
+ENGINE_remove                           1510	EXIST::FUNCTION:ENGINE
+TS_RESP_verify_token                    1511	EXIST::FUNCTION:
+asn1_enc_restore                        1512	EXIST::FUNCTION:
+X509_EXTENSION_set_object               1513	EXIST::FUNCTION:
+UI_free                                 1514	EXIST::FUNCTION:
+UI_new_method                           1515	EXIST::FUNCTION:
+EVP_EncryptInit_ex                      1516	EXIST::FUNCTION:
+TS_X509_ALGOR_print_bio                 1517	EXIST::FUNCTION:
+X509_pubkey_digest                      1518	EXIST::FUNCTION:EVP
+X509_REVOKED_get_ext_d2i                1519	EXIST::FUNCTION:
+EVP_DecryptInit                         1520	EXIST::FUNCTION:
+EC_POINT_invert                         1521	EXIST::FUNCTION:EC
+_ossl_old_des_encrypt2                  1522	EXIST::FUNCTION:DES
+ERR_load_BN_strings                     1523	EXIST::FUNCTION:
+OCSP_basic_sign                         1524	EXIST::FUNCTION:
+_ossl_old_des_encrypt3                  1525	EXIST::FUNCTION:DES
+ASN1_UTCTIME_cmp_time_t                 1526	EXIST::FUNCTION:
+i2d_TS_MSG_IMPRINT                      1527	EXIST::FUNCTION:
+c2i_ASN1_INTEGER                        1528	EXIST::FUNCTION:
+i2d_OCSP_RESPID                         1529	EXIST::FUNCTION:
+_ossl_old_des_xwhite_in2out             1530	EXIST::FUNCTION:DES
+X509at_add1_attr_by_NID                 1531	EXIST::FUNCTION:
+OCSP_check_nonce                        1532	EXIST::FUNCTION:
+d2i_DSAPrivateKey_bio                   1533	EXIST::FUNCTION:BIO,DSA
+i2d_PUBKEY_fp                           1534	EXIST::FUNCTION:FP_API
+ENGINE_ctrl_cmd                         1535	EXIST::FUNCTION:ENGINE
+ASN1_BIT_STRING_get_bit                 1536	EXIST::FUNCTION:
+TS_ACCURACY_set_micros                  1537	EXIST::FUNCTION:
+BN_generate_prime                       1538	EXIST::FUNCTION:
+ASN1_HEADER_new                         1539	EXIST::FUNCTION:
+PKCS12_parse                            1540	EXIST::FUNCTION:
+d2i_KRB5_ENCKEY                         1541	EXIST::FUNCTION:
+OCSP_parse_url                          1542	EXIST::FUNCTION:
+PKCS12_pack_p7data                      1543	EXIST::FUNCTION:
+sk_zero                                 1544	EXIST::FUNCTION:
+ERR_load_DH_strings                     1545	EXIST::FUNCTION:DH
+i2v_GENERAL_NAMES                       1546	EXIST::FUNCTION:
+PEM_write_bio_PKCS8PrivateKey_nid       1547	EXIST:!VMS:FUNCTION:
+PEM_write_bio_PKCS8PrivKey_nid          1547	EXIST:VMS:FUNCTION:
+X509V3_EXT_i2d                          1548	EXIST::FUNCTION:
+PKCS7_ENCRYPT_free                      1549	EXIST::FUNCTION:
+X509_LOOKUP_by_fingerprint              1550	EXIST::FUNCTION:
+OCSP_SINGLERESP_get_ext                 1551	EXIST::FUNCTION:
+OCSP_CRLID_free                         1552	EXIST::FUNCTION:
+DSA_SIG_new                             1553	EXIST::FUNCTION:DSA
+EVP_des_ede3_cfb64                      1554	EXIST::FUNCTION:DES
+OBJ_txt2obj                             1555	EXIST::FUNCTION:
+OCSP_BASICRESP_get1_ext_d2i             1556	EXIST::FUNCTION:
+i2d_X509_PUBKEY                         1557	EXIST::FUNCTION:
+TS_TST_INFO_get_ext_by_NID              1558	EXIST::FUNCTION:
+BN_pseudo_rand                          1559	EXIST::FUNCTION:
+RSAPrivateKey_it                        1560	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:RSA
+RSAPrivateKey_it                        1560	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:RSA
+i2d_DSAPrivateKey_fp                    1561	EXIST::FUNCTION:DSA,FP_API
+ENGINE_register_all_DH                  1562	EXIST::FUNCTION:ENGINE
+a2i_ASN1_ENUMERATED                     1563	EXIST::FUNCTION:BIO
+i2d_EDIPARTYNAME                        1564	EXIST::FUNCTION:
+EC_POINT_get_affine_coordinates_GFp     1565	EXIST:!VMS:FUNCTION:EC
+EC_POINT_get_affine_coords_GFp          1565	EXIST:VMS:FUNCTION:EC
+OCSP_CRLID_new                          1566	EXIST::FUNCTION:
+SHA_Init                                1567	EXIST::FUNCTION:SHA,SHA0
+ENGINE_get_flags                        1568	EXIST::FUNCTION:ENGINE
+BIO_set_tcp_ndelay                      1569	EXIST::FUNCTION:
+BIO_snprintf                            1570	EXIST::FUNCTION:
+EVP_PKEY2PKCS8_broken                   1571	EXIST::FUNCTION:
+TS_REQ_set_msg_imprint                  1572	EXIST::FUNCTION:
+PKCS8_set_broken                        1573	EXIST::FUNCTION:
+RIPEMD160                               1574	EXIST::FUNCTION:RIPEMD
+_ossl_old_des_cbc_encrypt               1575	EXIST::FUNCTION:DES
+OCSP_ONEREQ_it                          1576	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_ONEREQ_it                          1576	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+CONF_imodule_get_module                 1577	EXIST::FUNCTION:
+EVP_PBE_CipherInit                      1578	EXIST::FUNCTION:
+BN_mod_mul_montgomery                   1579	EXIST::FUNCTION:
+UI_process                              1580	EXIST::FUNCTION:
+TS_CONF_get_tsa_section                 1581	EXIST::FUNCTION:
+X509V3_parse_list                       1582	EXIST::FUNCTION:
+ASN1_INTEGER_it                         1583	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_INTEGER_it                         1583	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BIO_s_accept                            1584	EXIST::FUNCTION:
+TS_REQ_free                             1585	EXIST::FUNCTION:
+BN_add_word                             1586	EXIST::FUNCTION:
+EVP_aes_256_cfb1                        1587	EXIST::FUNCTION:AES
+BN_MONT_CTX_init                        1588	EXIST::FUNCTION:
+sk_insert                               1589	EXIST::FUNCTION:
+EVP_CipherInit_ex                       1590	EXIST::FUNCTION:
+d2i_X509_NAME_ENTRY                     1591	EXIST::FUNCTION:
+DES_ofb64_encrypt                       1592	EXIST::FUNCTION:DES
+ENGINE_get_name                         1593	EXIST::FUNCTION:ENGINE
+EVP_aes_256_cfb8                        1594	EXIST::FUNCTION:AES
+TS_MSG_IMPRINT_free                     1595	EXIST::FUNCTION:
+UI_get_string_type                      1596	EXIST::FUNCTION:
+BIO_f_buffer                            1597	EXIST::FUNCTION:
+MD5_Update                              1598	EXIST::FUNCTION:MD5
+EVP_VerifyFinal                         1599	EXIST::FUNCTION:
+ASN1_TIME_print                         1600	EXIST::FUNCTION:BIO
+BASIC_CONSTRAINTS_new                   1601	EXIST::FUNCTION:
+X509_sign                               1602	EXIST::FUNCTION:EVP
+ENGINE_unregister_DH                    1603	EXIST::FUNCTION:ENGINE
+i2d_PKCS8PrivateKeyInfo_fp              1604	EXIST::FUNCTION:FP_API
+X509_NAME_get_index_by_NID              1605	EXIST::FUNCTION:
+DES_set_key                             1606	EXIST::FUNCTION:DES
+ENGINE_register_all_DSA                 1607	EXIST::FUNCTION:ENGINE
+ENGINE_set_default_DSA                  1608	EXIST::FUNCTION:ENGINE
+sk_set                                  1609	EXIST::FUNCTION:
+X509_NAME_ENTRY_dup                     1610	EXIST::FUNCTION:
+OCSP_ONEREQ_get_ext_by_critical         1611	EXIST::FUNCTION:
+TS_RESP_get_token                       1612	EXIST::FUNCTION:
+EVP_PBE_cleanup                         1613	EXIST::FUNCTION:
+DSA_verify                              1614	EXIST::FUNCTION:DSA
+bn_dup_expand                           1615	EXIST::FUNCTION:
+sk_set_cmp_func                         1616	EXIST::FUNCTION:
+OCSP_cert_id_new                        1617	EXIST::FUNCTION:
+BASIC_CONSTRAINTS_it                    1618	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+BASIC_CONSTRAINTS_it                    1618	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PKCS7_set_signed_attributes             1619	EXIST::FUNCTION:
+X509V3_EXT_get_nid                      1620	EXIST::FUNCTION:
+DSA_dup_DH                              1621	EXIST::FUNCTION:DH,DSA
+X509_LOOKUP_new                         1622	EXIST::FUNCTION:
+_ossl_old_des_ofb64_encrypt             1623	EXIST::FUNCTION:DES
+PEM_do_header                           1624	EXIST::FUNCTION:
+d2i_X509_CERT_AUX                       1625	EXIST::FUNCTION:
+BN_mod_add_quick                        1626	EXIST::FUNCTION:
+CONF_modules_load                       1627	EXIST::FUNCTION:
+DH_compute_key                          1628	EXIST::FUNCTION:DH
+PEM_read_RSAPublicKey                   1629	EXIST:!WIN16:FUNCTION:RSA
+X509_PURPOSE_get0_name                  1630	EXIST::FUNCTION:
+RC2_cbc_encrypt                         1631	EXIST::FUNCTION:RC2
+BN_dec2bn                               1632	EXIST::FUNCTION:
+EC_POINT_new                            1633	EXIST::FUNCTION:EC
+ERR_load_CRYPTO_strings                 1634	EXIST:!OS2,!VMS,!WIN16:FUNCTION:
+ERR_load_CRYPTOlib_strings              1634	EXIST:OS2,VMS,WIN16:FUNCTION:
+EVP_des_ede_ofb                         1635	EXIST::FUNCTION:DES
+X509v3_get_ext                          1636	EXIST::FUNCTION:
+ENGINE_free                             1637	EXIST::FUNCTION:ENGINE
+ENGINE_get_init_function                1638	EXIST::FUNCTION:ENGINE
+EVP_MD_CTX_destroy                      1639	EXIST::FUNCTION:
+TS_RESP_CTX_set_clock_precision_digits  1640	EXIST::FUNCTION:
+RSA_padding_add_PKCS1_type_1            1641	EXIST::FUNCTION:RSA
+RSA_padding_add_PKCS1_type_2            1642	EXIST::FUNCTION:RSA
+EVP_bf_cfb64                            1643	EXIST::FUNCTION:BF
+i2d_PrivateKey_fp                       1644	EXIST::FUNCTION:FP_API
+CERTIFICATEPOLICIES_new                 1645	EXIST::FUNCTION:
+ASN1_put_object                         1646	EXIST::FUNCTION:
+_ossl_old_des_crypt                     1647	EXIST::FUNCTION:DES
+d2i_ASN1_TYPE                           1648	EXIST::FUNCTION:
+BN_new                                  1649	EXIST::FUNCTION:
+OCSP_RESPBYTES_free                     1650	EXIST::FUNCTION:
+X509_set_serialNumber                   1651	EXIST::FUNCTION:
+EVP_aes_128_cbc                         1652	EXIST::FUNCTION:AES
+OCSP_SINGLERESP_get1_ext_d2i            1653	EXIST::FUNCTION:
+X509V3_EXT_add_alias                    1654	EXIST::FUNCTION:
+X509_issuer_name_cmp                    1655	EXIST::FUNCTION:
+ENGINE_load_private_key                 1656	EXIST::FUNCTION:ENGINE
+d2i_ASN1_OCTET_STRING                   1657	EXIST::FUNCTION:
+CAST_ecb_encrypt                        1658	EXIST::FUNCTION:CAST
+EC_POINT_free                           1659	EXIST::FUNCTION:EC
+sk_dup                                  1660	EXIST::FUNCTION:
+FIPS_allow_md5                          1661	EXIST:OPENSSL_FIPS:FUNCTION:
+ASN1_STRING_print                       1662	EXIST::FUNCTION:BIO
+DH_up_ref                               1663	EXIST::FUNCTION:DH
+EVP_get_pw_prompt                       1664	EXIST::FUNCTION:
+X509_NAME_ENTRY_it                      1665	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_NAME_ENTRY_it                      1665	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_NAME_add_entry                     1666	EXIST::FUNCTION:
+PEM_write_bio                           1667	EXIST::FUNCTION:BIO
+d2i_PKCS12_fp                           1668	EXIST::FUNCTION:
+EVP_PKEY_free                           1669	EXIST::FUNCTION:
+DES_xcbc_encrypt                        1670	EXIST::FUNCTION:DES
+TS_ext_print_bio                        1671	EXIST::FUNCTION:
+UI_get_ex_new_index                     1672	EXIST::FUNCTION:
+X509_keyid_set1                         1673	EXIST::FUNCTION:
+lh_node_usage_stats_bio                 1674	EXIST::FUNCTION:BIO
+RSA_get_method                          1675	EXIST::FUNCTION:RSA
+DSO_METHOD_vms                          1676	EXIST::FUNCTION:
+ASN1_BIT_STRING_num_asc                 1677	EXIST::FUNCTION:
+X509_STORE_set_default_paths            1678	EXIST::FUNCTION:STDIO
+FIPS_mode                               1679	EXIST:OPENSSL_FIPS:FUNCTION:
+X509_CRL_new                            1680	EXIST::FUNCTION:
+BN_mod_sub_quick                        1681	EXIST::FUNCTION:
+X509_asn1_meth                          1682	EXIST::FUNCTION:
+PEM_SignFinal                           1683	EXIST::FUNCTION:
+i2d_ASN1_UNIVERSALSTRING                1684	EXIST::FUNCTION:
+OCSP_ONEREQ_add_ext                     1685	EXIST::FUNCTION:
+ERR_load_ERR_strings                    1686	EXIST::FUNCTION:
+s2i_ASN1_INTEGER                        1687	EXIST::FUNCTION:
+BIO_get_host_ip                         1688	EXIST::FUNCTION:
+OCSP_request_sign                       1689	EXIST::FUNCTION:
+AES_ctr128_encrypt                      1690	EXIST::FUNCTION:AES
+ASN1_ENUMERATED_new                     1691	EXIST::FUNCTION:
+PEM_write_NETSCAPE_CERT_SEQUENCE        1692	EXIST:!VMS,!WIN16:FUNCTION:
+PEM_write_NS_CERT_SEQ                   1692	EXIST:VMS:FUNCTION:
+EVP_DigestFinal_ex                      1693	EXIST::FUNCTION:
+ENGINE_set_digests                      1694	EXIST::FUNCTION:ENGINE
+asn1_GetSequence                        1695	EXIST::FUNCTION:
+OCSP_id_issuer_cmp                      1696	EXIST::FUNCTION:
+BIO_write                               1697	EXIST::FUNCTION:
+OBJ_NAME_do_all                         1698	EXIST::FUNCTION:
+i2t_ASN1_OBJECT                         1699	EXIST::FUNCTION:
+EC_POINTs_mul                           1700	EXIST::FUNCTION:EC
+BN_from_montgomery                      1701	EXIST::FUNCTION:
+ASN1_UTF8STRING_new                     1702	EXIST::FUNCTION:
+BN_MONT_CTX_copy                        1703	EXIST::FUNCTION:
+NETSCAPE_SPKI_b64_encode                1704	EXIST::FUNCTION:EVP
+DSA_print_fp                            1705	EXIST::FUNCTION:DSA,FP_API
+X509_get_default_cert_file              1706	EXIST::FUNCTION:
+i2d_PKCS7_ISSUER_AND_SERIAL             1707	EXIST::FUNCTION:
+BIO_sock_error                          1708	EXIST::FUNCTION:
+EVP_SealFinal                           1709	EXIST::FUNCTION:RSA
+PKCS7_get_smimecap                      1710	EXIST::FUNCTION:
+d2i_ASN1_UINTEGER                       1711	EXIST::FUNCTION:
+ASN1_unpack_string                      1712	EXIST::FUNCTION:
+PEM_read_DSAPrivateKey                  1713	EXIST:!WIN16:FUNCTION:DSA
+ENGINE_register_complete                1714	EXIST::FUNCTION:ENGINE
+X509V3_EXT_nconf_nid                    1715	EXIST::FUNCTION:
+_ossl_old_des_random_key                1716	EXIST::FUNCTION:DES
+PEM_ASN1_read_bio                       1717	EXIST::FUNCTION:BIO
+ASN1_GENERALIZEDTIME_print              1718	EXIST::FUNCTION:BIO
+i2d_ASN1_INTEGER                        1719	EXIST::FUNCTION:
+AES_cfbr_encrypt_block                  1720	EXIST::FUNCTION:AES
+ERR_get_state                           1721	EXIST::FUNCTION:
+PKCS7_DIGEST_new                        1722	EXIST::FUNCTION:
+ASN1_SEQUENCE_it                        1723	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_SEQUENCE_it                        1723	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+UI_set_default_method                   1724	EXIST::FUNCTION:
+NCONF_new                               1725	EXIST::FUNCTION:
+RAND_query_egd_bytes                    1726	EXIST::FUNCTION:
+PEM_SignUpdate                          1727	EXIST::FUNCTION:
+d2i_TS_RESP_bio                         1728	EXIST::FUNCTION:
+BIO_dump                                1729	EXIST::FUNCTION:
+PKCS7_get_signed_attribute              1730	EXIST::FUNCTION:
+lh_retrieve                             1731	EXIST::FUNCTION:
+EVP_rc5_32_12_16_ofb                    1732	EXIST::FUNCTION:RC5
+UI_method_get_writer                    1733	EXIST::FUNCTION:
+CONF_imodule_get_name                   1734	EXIST::FUNCTION:
+UI_OpenSSL                              1735	EXIST::FUNCTION:
+BN_mod_exp                              1736	EXIST::FUNCTION:
+BUF_strdup                              1737	EXIST::FUNCTION:
+PEM_def_callback                        1738	EXIST::FUNCTION:
+PEM_read_PrivateKey                     1739	EXIST:!WIN16:FUNCTION:
+i2d_X509_REVOKED                        1740	EXIST::FUNCTION:
+ENGINE_cleanup                          1741	EXIST::FUNCTION:ENGINE
+DIST_POINT_it                           1742	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+DIST_POINT_it                           1742	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_verify                             1743	EXIST::FUNCTION:EVP
+CONF_load                               1744	EXIST::FUNCTION:
+OBJ_NAME_get                            1745	EXIST::FUNCTION:
+RSA_blinding_off                        1746	EXIST::FUNCTION:RSA
+RSA_padding_check_SSLv23                1747	EXIST::FUNCTION:RSA
+OCSP_SINGLERESP_it                      1748	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_SINGLERESP_it                      1748	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+COMP_expand_block                       1749	EXIST::FUNCTION:
+RC4_set_key                             1750	EXIST::FUNCTION:RC4
+ASN1_STRING_type                        1751	EXIST::FUNCTION:
+X509_ATTRIBUTE_create_by_OBJ            1752	EXIST::FUNCTION:
+BIO_ctrl_wpending                       1753	EXIST::FUNCTION:
+PEM_write_bio_PrivateKey                1754	EXIST::FUNCTION:
+X509_NAME_add_entry_by_OBJ              1755	EXIST::FUNCTION:
+d2i_KRB5_TKTBODY                        1756	EXIST::FUNCTION:
+EC_POINT_cmp                            1757	EXIST::FUNCTION:EC
+OCSP_REVOKEDINFO_new                    1758	EXIST::FUNCTION:
+OPENSSL_no_config                       1759	EXIST::FUNCTION:
+i2d_OCSP_CERTSTATUS                     1760	EXIST::FUNCTION:
+X509_REQ_extension_nid                  1761	EXIST::FUNCTION:
+X509_dup                                1762	EXIST::FUNCTION:
+i2d_GENERAL_NAME                        1763	EXIST::FUNCTION:
+OCSP_basic_add1_nonce                   1764	EXIST::FUNCTION:
+i2d_AUTHORITY_KEYID                     1765	EXIST::FUNCTION:
+lh_new                                  1766	EXIST::FUNCTION:
+TS_TST_INFO_dup                         1767	EXIST::FUNCTION:
+DES_quad_cksum                          1768	EXIST::FUNCTION:DES
+DES_read_password                       1769	EXIST::FUNCTION:DES
+BN_cmp                                  1770	EXIST::FUNCTION:
+ASN1_item_ex_d2i                        1771	EXIST::FUNCTION:
+PKCS5_pbe_set                           1772	EXIST::FUNCTION:
+X509_set_version                        1773	EXIST::FUNCTION:
+NCONF_WIN32                             1774	EXIST::FUNCTION:
+ASN1_STRING_get_default_mask            1775	EXIST::FUNCTION:
+BN_mod_lshift1_quick                    1776	EXIST::FUNCTION:
+TS_MSG_IMPRINT_set_algo                 1777	EXIST::FUNCTION:
+i2d_DSAPublicKey                        1778	EXIST::FUNCTION:DSA
+i2d_POLICYINFO                          1779	EXIST::FUNCTION:
+X509V3_EXT_conf_nid                     1780	EXIST::FUNCTION:
+UI_set_method                           1781	EXIST::FUNCTION:
+OCSP_id_get0_info                       1782	EXIST::FUNCTION:
+BN_mod_sqrt                             1783	EXIST::FUNCTION:
+X509_OBJECT_free_contents               1784	EXIST::FUNCTION:
+BN_gcd                                  1785	EXIST::FUNCTION:
+EC_GROUP_copy                           1786	EXIST::FUNCTION:EC
+CRYPTO_free_locked                      1787	EXIST::FUNCTION:
+X509_REQ_add1_attr_by_OBJ               1788	EXIST::FUNCTION:
+EVP_EncryptUpdate                       1789	EXIST::FUNCTION:
+_ossl_old_des_read_password             1790	EXIST::FUNCTION:DES
+PKCS12_SAFEBAG_free                     1791	EXIST::FUNCTION:
+KRB5_ENCDATA_free                       1792	EXIST::FUNCTION:
+X509_CRL_cmp                            1793	EXIST::FUNCTION:
+sk_find                                 1794	EXIST::FUNCTION:
+CRYPTO_get_lock_name                    1795	EXIST::FUNCTION:
+i2d_PKCS7                               1796	EXIST::FUNCTION:
+BIO_dup_chain                           1797	EXIST::FUNCTION:
+d2i_PKCS8_bio                           1798	EXIST::FUNCTION:BIO
+OCSP_SINGLERESP_get_ext_by_OBJ          1799	EXIST::FUNCTION:
+DH_set_default_method                   1800	EXIST::FUNCTION:DH
+TS_VERIFY_CTX_new                       1801	EXIST::FUNCTION:
+SMIME_write_PKCS7                       1802	EXIST::FUNCTION:
+d2i_NETSCAPE_SPKAC                      1803	EXIST::FUNCTION:
+OCSP_cert_to_id                         1804	EXIST::FUNCTION:
+OCSP_RESPID_new                         1805	EXIST::FUNCTION:
+i2d_PKCS12_SAFEBAG                      1806	EXIST::FUNCTION:
+OCSP_RESPDATA_it                        1807	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_RESPDATA_it                        1807	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_OCSP_RESPDATA                       1808	EXIST::FUNCTION:
+ASN1_parse                              1809	EXIST::FUNCTION:BIO
+a2i_ASN1_INTEGER                        1810	EXIST::FUNCTION:BIO
+ENGINE_register_all_complete            1811	EXIST::FUNCTION:ENGINE
+i2d_ASN1_PRINTABLE                      1812	EXIST::FUNCTION:
+d2i_ASN1_IA5STRING                      1813	EXIST::FUNCTION:
+OCSP_check_validity                     1814	EXIST::FUNCTION:
+BF_encrypt                              1815	EXIST::FUNCTION:BF
+PKCS12_BAGS_it                          1816	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS12_BAGS_it                          1816	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+i2d_TS_RESP_fp                          1817	EXIST::FUNCTION:
+OCSP_url_svcloc_new                     1818	EXIST::FUNCTION:
+COMP_compress_block                     1819	EXIST::FUNCTION:
+FIPS_mode_set                           1820	EXIST:OPENSSL_FIPS:FUNCTION:
+i2d_X509_AUX                            1821	EXIST::FUNCTION:
+ASN1_template_free                      1822	EXIST::FUNCTION:
+d2i_POLICYINFO                          1823	EXIST::FUNCTION:
+d2i_ASN1_UTCTIME                        1824	EXIST::FUNCTION:
+X509V3_set_ctx                          1825	EXIST::FUNCTION:
+BIO_new_fd                              1826	EXIST::FUNCTION:
+OBJ_cmp                                 1827	EXIST::FUNCTION:
+X509_INFO_free                          1828	EXIST::FUNCTION:EVP
+OCSP_SINGLERESP_add_ext                 1829	EXIST::FUNCTION:
+TS_REQ_get_msg_imprint                  1830	EXIST::FUNCTION:
+TS_REQ_set_policy_id                    1831	EXIST::FUNCTION:
+TS_RESP_CTX_free                        1832	EXIST::FUNCTION:
+BIO_new_fp                              1833	EXIST:!WIN16:FUNCTION:FP_API
+ENGINE_init                             1834	EXIST::FUNCTION:ENGINE
+X509_NAME_new                           1835	EXIST::FUNCTION:
+X509_EXTENSION_free                     1836	EXIST::FUNCTION:
+BIO_sock_cleanup                        1837	EXIST::FUNCTION:
+ASN1_BIT_STRING_new                     1838	EXIST::FUNCTION:
+TS_TST_INFO_get_nonce                   1839	EXIST::FUNCTION:
+KRB5_AUTHENTBODY_it                     1840	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_AUTHENTBODY_it                     1840	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+i2d_PublicKey                           1841	EXIST::FUNCTION:
+d2i_X509_SIG                            1842	EXIST::FUNCTION:
+FIPS_dsa_check                          1843	EXIST:OPENSSL_FIPS:FUNCTION:
+OTHERNAME_new                           1844	EXIST::FUNCTION:
+X509_supported_extension                1845	EXIST::FUNCTION:
+RC2_ofb64_encrypt                       1846	EXIST::FUNCTION:RC2
+TS_MSG_IMPRINT_new                      1847	EXIST::FUNCTION:
+i2d_KRB5_AUTHDATA                       1848	EXIST::FUNCTION:
+BF_decrypt                              1849	EXIST::FUNCTION:BF
+EVP_get_cipherbyname                    1850	EXIST::FUNCTION:
+i2d_PBEPARAM                            1851	EXIST::FUNCTION:
+EVP_PKEY_set1_DSA                       1852	EXIST::FUNCTION:DSA
+DSO_METHOD_dl                           1853	EXIST::FUNCTION:
+PKCS7_verify                            1854	EXIST::FUNCTION:
+ERR_get_error_line_data                 1855	EXIST::FUNCTION:
+UI_method_get_opener                    1856	EXIST::FUNCTION:
+SXNETID_new                             1857	EXIST::FUNCTION:
+PKCS12_add_localkeyid                   1858	EXIST::FUNCTION:
+ENGINE_set_ex_data                      1859	EXIST::FUNCTION:ENGINE
+OCSP_REQUEST_print                      1860	EXIST::FUNCTION:
+MD2                                     1861	EXIST::FUNCTION:MD2
+d2i_TS_RESP_fp                          1862	EXIST::FUNCTION:
+BIO_number_written                      1863	EXIST::FUNCTION:
+MD4                                     1864	EXIST::FUNCTION:MD4
+TS_TST_INFO_get_version                 1865	EXIST::FUNCTION:
+RSA_padding_add_none                    1866	EXIST::FUNCTION:RSA
+MD5                                     1867	EXIST::FUNCTION:MD5
+PKCS12_BAGS_free                        1868	EXIST::FUNCTION:
+TS_RESP_new                             1869	EXIST::FUNCTION:
+EVP_dss                                 1870	EXIST::FUNCTION:DSA,SHA
+BIO_f_md                                1871	EXIST::FUNCTION:BIO
+CONF_load_bio                           1872	EXIST::FUNCTION:
+ASN1_PRINTABLESTRING_free               1873	EXIST::FUNCTION:
+EVP_cast5_ofb                           1874	EXIST::FUNCTION:CAST
+ASN1_ENUMERATED_get                     1875	EXIST::FUNCTION:
+CBIGNUM_it                              1876	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+CBIGNUM_it                              1876	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+KRB5_TICKET_new                         1877	EXIST::FUNCTION:
+ENGINE_get_default_DSA                  1878	EXIST::FUNCTION:ENGINE
+d2i_ASN1_T61STRING                      1879	EXIST::FUNCTION:
+KRB5_APREQ_new                          1880	EXIST::FUNCTION:
+ENGINE_load_aep                         1881	EXIST::FUNCTION:ENGINE
+TS_CONF_set_certs                       1882	EXIST::FUNCTION:
+X509_REQ_add_extensions_nid             1883	EXIST::FUNCTION:
+X509_get_ext                            1884	EXIST::FUNCTION:
+PEM_write_X509                          1885	EXIST:!WIN16:FUNCTION:
+d2i_AUTHORITY_INFO_ACCESS               1886	EXIST::FUNCTION:
+EC_GROUP_get_curve_GFp                  1887	EXIST::FUNCTION:EC
+USERNOTICE_new                          1888	EXIST::FUNCTION:
+KRB5_ENCKEY_new                         1889	EXIST::FUNCTION:
+_ossl_old_des_cfb_encrypt               1890	EXIST::FUNCTION:DES
+X509_ATTRIBUTE_create                   1891	EXIST::FUNCTION:
+ASN1_template_d2i                       1892	EXIST::FUNCTION:
+X509v3_get_ext_by_OBJ                   1893	EXIST::FUNCTION:
+TS_TST_INFO_get_ext_count               1894	EXIST::FUNCTION:
+TS_TST_INFO_get_ext_d2i                 1895	EXIST::FUNCTION:
+d2i_PKCS7_ENCRYPT                       1896	EXIST::FUNCTION:
+DES_cbc_encrypt                         1897	EXIST::FUNCTION:DES
+OCSP_single_get0_status                 1898	EXIST::FUNCTION:
+d2i_X509_REQ_fp                         1899	EXIST::FUNCTION:FP_API
+BN_swap                                 1900	EXIST::FUNCTION:
+POLICYINFO_it                           1901	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+POLICYINFO_it                           1901	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_REQ_get_ext                          1902	EXIST::FUNCTION:
+CRYPTO_set_mem_debug_functions          1903	EXIST::FUNCTION:
+X509_REQ_new                            1904	EXIST::FUNCTION:
+ENGINE_set_destroy_function             1905	EXIST::FUNCTION:ENGINE
+ESS_SIGNING_CERT_dup                    1906	EXIST::FUNCTION:
+TS_REQ_get_version                      1907	EXIST::FUNCTION:
+asn1_enc_free                           1908	EXIST::FUNCTION:
+BN_rshift1                              1909	EXIST::FUNCTION:
+EVP_sha                                 1910	EXIST::FUNCTION:SHA
+PEM_write_bio_DSAparams                 1911	EXIST::FUNCTION:DSA
+X509_REQ_print_ex                       1912	EXIST::FUNCTION:BIO
+i2d_PKCS7_SIGN_ENVELOPE                 1913	EXIST::FUNCTION:
+CERTIFICATEPOLICIES_free                1914	EXIST::FUNCTION:
+OCSP_RESPID_it                          1915	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_RESPID_it                          1915	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+SHA1_Update                             1916	EXIST::FUNCTION:SHA,SHA1
+BN_get_word                             1917	EXIST::FUNCTION:
+lh_num_items                            1918	EXIST::FUNCTION:
+DSA_generate_key                        1919	EXIST::FUNCTION:DSA
+X509v3_add_ext                          1920	EXIST::FUNCTION:
+CRYPTO_free_ex_data                     1921	EXIST::FUNCTION:
+EC_GROUP_new                            1922	EXIST::FUNCTION:EC
+EVP_aes_256_cbc                         1923	EXIST::FUNCTION:AES
+EVP_bf_cbc                              1924	EXIST::FUNCTION:BF
+X509_CRL_get_ext_by_critical            1925	EXIST::FUNCTION:
+i2d_KRB5_PRINCNAME                      1926	EXIST::FUNCTION:
+X509V3_get_string                       1927	EXIST::FUNCTION:
+TS_CONF_load_key                        1928	EXIST::FUNCTION:
+BN_mod_exp2_mont                        1929	EXIST::FUNCTION:
+TS_REQ_get_ext_d2i                      1930	EXIST::FUNCTION:
+X509_REQ_print_fp                       1931	EXIST::FUNCTION:FP_API
+ERR_peek_last_error_line_data           1932	EXIST::FUNCTION:
+TS_RESP_CTX_new                         1933	EXIST::FUNCTION:
+RSA_memory_lock                         1934	EXIST::FUNCTION:RSA
+ASN1_OBJECT_create                      1935	EXIST::FUNCTION:
+PKCS8_PRIV_KEY_INFO_it                  1936	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS8_PRIV_KEY_INFO_it                  1936	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_PRINTABLESTRING_new                1937	EXIST::FUNCTION:
+ASN1_UNIVERSALSTRING_it                 1938	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_UNIVERSALSTRING_it                 1938	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+OCSP_REQINFO_it                         1939	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_REQINFO_it                         1939	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_ACCURACY_set_seconds                 1940	EXIST::FUNCTION:
+PBEPARAM_it                             1941	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PBEPARAM_it                             1941	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BN_rshift                               1942	EXIST::FUNCTION:
+CRYPTO_get_dynlock_lock_callback        1943	EXIST:!VMS:FUNCTION:
+CRYPTO_get_dynlock_lock_cb              1943	EXIST:VMS:FUNCTION:
+MDC2_Init                               1944	EXIST::FUNCTION:MDC2
+CRYPTO_set_dynlock_destroy_callback     1945	EXIST:!VMS:FUNCTION:
+CRYPTO_set_dynlock_destroy_cb           1945	EXIST:VMS:FUNCTION:
+EVP_CipherUpdate                        1946	EXIST::FUNCTION:
+TS_CONF_set_serial                      1947	EXIST::FUNCTION:
+KRB5_AUTHENTBODY_new                    1948	EXIST::FUNCTION:
+ASN1_UTCTIME_free                       1949	EXIST::FUNCTION:
+EVP_PKEY_missing_parameters             1950	EXIST::FUNCTION:
+ERR_lib_error_string                    1951	EXIST::FUNCTION:
+X509_ATTRIBUTE_new                      1952	EXIST::FUNCTION:
+NETSCAPE_CERT_SEQUENCE_free             1953	EXIST::FUNCTION:
+i2d_ESS_SIGNING_CERT                    1954	EXIST::FUNCTION:
+BIO_nwrite                              1955	EXIST::FUNCTION:
+CRYPTO_mem_leaks_cb                     1956	EXIST::FUNCTION:
+X509_CRL_add0_revoked                   1957	EXIST::FUNCTION:
+PKEY_USAGE_PERIOD_free                  1958	EXIST::FUNCTION:
+DES_enc_write                           1959	EXIST::FUNCTION:DES
+BF_options                              1960	EXIST::FUNCTION:BF
+_ossl_old_des_ecb3_encrypt              1961	EXIST::FUNCTION:DES
+FIPS_selftest_rsa                       1962	EXIST:OPENSSL_FIPS:FUNCTION:
+PEM_write_bio_NETSCAPE_CERT_SEQUENCE    1963	EXIST:!VMS:FUNCTION:
+PEM_write_bio_NS_CERT_SEQ               1963	EXIST:VMS:FUNCTION:
+ASN1_STRING_new                         1964	EXIST::FUNCTION:
+EDIPARTYNAME_it                         1965	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+EDIPARTYNAME_it                         1965	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+NETSCAPE_SPKI_it                        1966	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+NETSCAPE_SPKI_it                        1966	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BN_rand                                 1967	EXIST::FUNCTION:
+X509_gmtime_adj                         1968	EXIST::FUNCTION:
+DSO_bind_func                           1969	EXIST::FUNCTION:
+UI_get0_test_string                     1970	EXIST::FUNCTION:
+d2i_ASN1_HEADER                         1971	EXIST::FUNCTION:
+X509_NAME_cmp                           1972	EXIST::FUNCTION:
+X509_NAME_print                         1973	EXIST::FUNCTION:BIO
+X509_PURPOSE_get_id                     1974	EXIST::FUNCTION:
+ENGINE_get_cipher_engine                1975	EXIST::FUNCTION:ENGINE
+X509_ATTRIBUTE_get0_type                1976	EXIST::FUNCTION:
+ENGINE_register_all_ciphers             1977	EXIST::FUNCTION:ENGINE
+OTHERNAME_cmp                           1978	EXIST::FUNCTION:
+POLICYQUALINFO_free                     1979	EXIST::FUNCTION:
+SXNET_get_id_asc                        1980	EXIST::FUNCTION:
+EC_POINT_copy                           1981	EXIST::FUNCTION:EC
+d2i_PKCS8PrivateKey_fp                  1982	EXIST::FUNCTION:
+ASN1_OCTET_STRING_set                   1983	EXIST::FUNCTION:
+PKCS7_set_type                          1984	EXIST::FUNCTION:
+DES_crypt                               1985	EXIST::FUNCTION:DES
+X509V3_add_value_uchar                  1986	EXIST::FUNCTION:
+BN_kronecker                            1987	EXIST::FUNCTION:
+BIO_get_port                            1988	EXIST::FUNCTION:
+PKCS12_new                              1989	EXIST::FUNCTION:
+ENGINE_get_finish_function              1990	EXIST::FUNCTION:ENGINE
+EVP_idea_ecb                            1991	EXIST::FUNCTION:IDEA
+EVP_CIPHER_get_asn1_iv                  1992	EXIST::FUNCTION:
+PEM_read_RSA_PUBKEY                     1993	EXIST:!WIN16:FUNCTION:RSA
+UI_method_get_reader                    1994	EXIST::FUNCTION:
+BN_mul_word                             1995	EXIST::FUNCTION:
+ESS_ISSUER_SERIAL_dup                   1996	EXIST::FUNCTION:
+OCSP_BASICRESP_get_ext_count            1997	EXIST::FUNCTION:
+ASN1_ENUMERATED_it                      1998	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_ENUMERATED_it                      1998	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BN_free                                 1999	EXIST::FUNCTION:
+PEM_SignInit                            2000	EXIST::FUNCTION:
+PEM_write_RSAPrivateKey                 2001	EXIST:!WIN16:FUNCTION:RSA
+bn_div_words                            2002	EXIST::FUNCTION:
+i2d_RSAPrivateKey_fp                    2003	EXIST::FUNCTION:FP_API,RSA
+SXNET_free                              2004	EXIST::FUNCTION:
+AES_cfb128_encrypt                      2005	EXIST::FUNCTION:AES
+ASN1_UTCTIME_print                      2006	EXIST::FUNCTION:BIO
+UI_set_result                           2007	EXIST::FUNCTION:
+i2d_PKCS12                              2008	EXIST::FUNCTION:
+i2d_KRB5_TICKET                         2009	EXIST::FUNCTION:
+X509_print_ex_fp                        2010	EXIST::FUNCTION:FP_API
+CRYPTO_get_ex_data                      2011	EXIST::FUNCTION:
+TS_RESP_verify_signature                2012	EXIST::FUNCTION:
+BN_to_ASN1_ENUMERATED                   2013	EXIST::FUNCTION:
+RIPEMD160_Transform                     2014	EXIST::FUNCTION:RIPEMD
+EVP_CIPHER_CTX_set_padding              2015	EXIST::FUNCTION:
+PEM_write_bio_RSA_PUBKEY                2016	EXIST::FUNCTION:RSA
+d2i_ASN1_GENERALIZEDTIME                2017	EXIST::FUNCTION:
+ASN1_STRING_to_UTF8                     2018	EXIST::FUNCTION:
+CRYPTO_set_dynlock_create_callback      2019	EXIST:!VMS:FUNCTION:
+CRYPTO_set_dynlock_create_cb            2019	EXIST:VMS:FUNCTION:
+TS_RESP_CTX_set_serial_cb               2020	EXIST::FUNCTION:
+X509_REQ_get_extension_nids             2021	EXIST::FUNCTION:
+PEM_ASN1_write                          2022	EXIST:!WIN16:FUNCTION:
+NCONF_dump_fp                           2023	EXIST::FUNCTION:
+d2i_RSAPublicKey_fp                     2024	EXIST::FUNCTION:FP_API,RSA
+PEM_write_bio_PKCS7                     2025	EXIST::FUNCTION:
+i2d_ASN1_TYPE                           2026	EXIST::FUNCTION:
+X509_get_ext_by_OBJ                     2027	EXIST::FUNCTION:
+PEM_write_bio_PKCS8                     2028	EXIST::FUNCTION:
+PEM_write_bio_X509_AUX                  2029	EXIST::FUNCTION:
+ASN1_BMPSTRING_free                     2030	EXIST::FUNCTION:
+DSA_new_method                          2031	EXIST::FUNCTION:DSA
+BIO_accept                              2032	EXIST::FUNCTION:
+RSA_new_method                          2033	EXIST::FUNCTION:RSA
+d2i_OCSP_RESPONSE                       2034	EXIST::FUNCTION:
+AES_cfb8_encrypt                        2035	EXIST::FUNCTION:AES
+EVP_DigestInit                          2036	EXIST::FUNCTION:
+X509_OBJECT_retrieve_by_subject         2037	EXIST::FUNCTION:
+CRYPTO_mem_leaks_fp                     2038	EXIST::FUNCTION:FP_API
+EVP_aes_128_cfb128                      2039	EXIST::FUNCTION:AES
+i2a_ASN1_ENUMERATED                     2040	EXIST::FUNCTION:BIO
+NETSCAPE_SPKI_verify                    2041	EXIST::FUNCTION:EVP
+ASN1_OCTET_STRING_dup                   2042	EXIST::FUNCTION:
+PKCS7_ENC_CONTENT_new                   2043	EXIST::FUNCTION:
+CAST_encrypt                            2044	EXIST::FUNCTION:CAST
+d2i_X509_CINF                           2045	EXIST::FUNCTION:
+ASN1_UTCTIME_it                         2046	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_UTCTIME_it                         2046	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+AUTHORITY_INFO_ACCESS_free              2047	EXIST::FUNCTION:
+BF_ofb64_encrypt                        2048	EXIST::FUNCTION:BF
+UI_UTIL_read_pw                         2049	EXIST::FUNCTION:
+OCSP_RESPONSE_new                       2050	EXIST::FUNCTION:
+PKCS7_SIGN_ENVELOPE_new                 2051	EXIST::FUNCTION:
+i2d_PKCS12_fp                           2052	EXIST::FUNCTION:
+AES_set_encrypt_key                     2053	EXIST::FUNCTION:AES
+d2i_ACCESS_DESCRIPTION                  2054	EXIST::FUNCTION:
+PEM_read_bio_PKCS8_PRIV_KEY_INFO        2055	EXIST:!VMS:FUNCTION:
+PEM_read_bio_P8_PRIV_KEY_INFO           2055	EXIST:VMS:FUNCTION:
+BIO_s_connect                           2056	EXIST::FUNCTION:
+OCSP_resp_count                         2057	EXIST::FUNCTION:
+PKCS7_DIGEST_free                       2058	EXIST::FUNCTION:
+RC5_32_ofb64_encrypt                    2059	EXIST::FUNCTION:RC5
+KRB5_CHECKSUM_new                       2060	EXIST::FUNCTION:
+PKCS12_gen_mac                          2061	EXIST::FUNCTION:
+CRYPTO_get_dynlock_create_callback      2062	EXIST:!VMS:FUNCTION:
+CRYPTO_get_dynlock_create_cb            2062	EXIST:VMS:FUNCTION:
+d2i_GENERAL_NAMES                       2063	EXIST::FUNCTION:
+ENGINE_get_DH                           2064	EXIST::FUNCTION:ENGINE
+ENGINE_load_cswift                      2065	EXIST::FUNCTION:ENGINE
+OCSP_onereq_get0_id                     2066	EXIST::FUNCTION:
+EVP_idea_cfb64                          2067	EXIST::FUNCTION:IDEA
+SXNETID_free                            2068	EXIST::FUNCTION:
+CRYPTO_set_locking_callback             2069	EXIST::FUNCTION:
+EVP_DecodeUpdate                        2070	EXIST::FUNCTION:
+TS_CONF_set_signer_cert                 2071	EXIST::FUNCTION:
+ENGINE_get_next                         2072	EXIST::FUNCTION:ENGINE
+ENGINE_set_default_ciphers              2073	EXIST::FUNCTION:ENGINE
+NOTICEREF_it                            2074	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+NOTICEREF_it                            2074	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+AES_cfb1_encrypt                        2075	EXIST::FUNCTION:AES
+BIO_f_cipher                            2076	EXIST::FUNCTION:BIO
+X509at_add1_attr_by_OBJ                 2077	EXIST::FUNCTION:
+X509V3_EXT_CRL_add_nconf                2078	EXIST::FUNCTION:
+OCSP_REVOKEDINFO_it                     2079	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_REVOKEDINFO_it                     2079	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ENGINE_get_default_RAND                 2080	EXIST::FUNCTION:ENGINE
+CAST_decrypt                            2081	EXIST::FUNCTION:CAST
+AES_encrypt                             2082	EXIST::FUNCTION:AES
+OCSP_REQUEST_new                        2083	EXIST::FUNCTION:
+BIO_s_file                              2084	EXIST:!WIN16:FUNCTION:FP_API
+X509_TRUST_get0_name                    2085	EXIST::FUNCTION:
+d2i_DSAPrivateKey                       2086	EXIST::FUNCTION:DSA
+ASN1_ANY_it                             2087	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_ANY_it                             2087	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+CRYPTO_ex_data_new_class                2088	EXIST::FUNCTION:
+TS_STATUS_INFO_new                      2089	EXIST::FUNCTION:
+DSA_free                                2090	EXIST::FUNCTION:DSA
+ERR_reason_error_string                 2091	EXIST::FUNCTION:
+FIPS_test_mode                          2092	EXIST:OPENSSL_FIPS:FUNCTION:
+FIPS_selftest_des                       2093	EXIST:OPENSSL_FIPS:FUNCTION:
+ASN1_STRING_cmp                         2094	EXIST::FUNCTION:
+BN_CTX_free                             2095	EXIST::FUNCTION:
+i2d_PKEY_USAGE_PERIOD                   2096	EXIST::FUNCTION:
+_ossl_old_des_key_sched                 2097	EXIST::FUNCTION:DES
+d2i_PKCS7_SIGN_ENVELOPE                 2098	EXIST::FUNCTION:
+BIO_copy_next_retry                     2099	EXIST::FUNCTION:
+i2d_KRB5_TKTBODY                        2100	EXIST::FUNCTION:
+d2i_RSAPublicKey                        2101	EXIST::FUNCTION:RSA
+TS_TST_INFO_get_ext_by_OBJ              2102	EXIST::FUNCTION:
+BN_MONT_CTX_set                         2103	EXIST::FUNCTION:
+BIO_f_linebuffer                        2104	EXIST:VMS:FUNCTION:
+RSA_blinding_on                         2105	EXIST::FUNCTION:RSA
+lh_doall_arg                            2106	EXIST::FUNCTION:
+X509V3_EXT_add                          2107	EXIST::FUNCTION:
+ASN1_STRING_TABLE_cleanup               2108	EXIST::FUNCTION:
+PEM_read_DSA_PUBKEY                     2109	EXIST:!WIN16:FUNCTION:DSA
+EVP_cast5_cfb64                         2110	EXIST::FUNCTION:CAST
+bn_mul_words                            2111	EXIST::FUNCTION:
+CRYPTO_get_new_lockid                   2112	EXIST::FUNCTION:
+DES_set_odd_parity                      2113	EXIST::FUNCTION:DES
+ASN1_IA5STRING_asn1_meth                2114	EXIST::FUNCTION:
+X509_issuer_name_hash                   2115	EXIST::FUNCTION:
+PKCS12_key_gen_asc                      2116	EXIST::FUNCTION:
+X509_REQ_get_pubkey                     2117	EXIST::FUNCTION:
+i2d_AUTHORITY_INFO_ACCESS               2118	EXIST::FUNCTION:
+PEM_read_NETSCAPE_CERT_SEQUENCE         2119	EXIST:!VMS,!WIN16:FUNCTION:
+PEM_read_NS_CERT_SEQ                    2119	EXIST:VMS:FUNCTION:
+EC_POINT_clear_free                     2120	EXIST::FUNCTION:EC
+AES_decrypt                             2121	EXIST::FUNCTION:AES
+idea_ecb_encrypt                        2122	EXIST::FUNCTION:IDEA
+BN_uadd                                 2123	EXIST::FUNCTION:
+RSA_PKCS1_SSLeay                        2124	EXIST::FUNCTION:RSA
+s2i_ASN1_OCTET_STRING                   2125	EXIST::FUNCTION:
+PEM_write_bio_DSA_PUBKEY                2126	EXIST::FUNCTION:DSA
+PEM_read_bio_PUBKEY                     2127	EXIST::FUNCTION:
+X509_get_default_cert_area              2128	EXIST::FUNCTION:
+SHA_Final                               2129	EXIST::FUNCTION:SHA,SHA0
+asn1_enc_init                           2130	EXIST::FUNCTION:
+PKCS7_dataInit                          2131	EXIST::FUNCTION:
+d2i_NOTICEREF                           2132	EXIST::FUNCTION:
+UI_get_result_maxsize                   2133	EXIST::FUNCTION:
+i2d_RSA_NET                             2134	EXIST::FUNCTION:RSA
+SXNET_add_id_asc                        2135	EXIST::FUNCTION:
+CRYPTO_mem_ctrl                         2136	EXIST::FUNCTION:
+d2i_Netscape_RSA                        2137	EXIST::FUNCTION:RSA
+DES_string_to_key                       2138	EXIST::FUNCTION:DES
+MD2_Init                                2139	EXIST::FUNCTION:MD2
+i2d_PKCS12_bio                          2140	EXIST::FUNCTION:
+OCSP_CERTID_new                         2141	EXIST::FUNCTION:
+X509_EXTENSION_get_critical             2142	EXIST::FUNCTION:
+ENGINE_unregister_RAND                  2143	EXIST::FUNCTION:ENGINE
+BN_is_bit_set                           2144	EXIST::FUNCTION:
+i2d_ASN1_SET                            2145	EXIST::FUNCTION:
+PKCS12_get_attr_gen                     2146	EXIST::FUNCTION:
+UI_method_get_closer                    2147	EXIST::FUNCTION:
+d2i_KRB5_ENCDATA                        2148	EXIST::FUNCTION:
+OCSP_request_onereq_count               2149	EXIST::FUNCTION:
+TS_RESP_CTX_add_flags                   2150	EXIST::FUNCTION:
+OCSP_basic_verify                       2151	EXIST::FUNCTION:
+EVP_enc_null                            2152	EXIST::FUNCTION:
+d2i_RSA_NET                             2153	EXIST::FUNCTION:RSA
+ASN1_i2d_fp                             2154	EXIST::FUNCTION:FP_API
+lh_delete                               2155	EXIST::FUNCTION:
+RC5_32_ecb_encrypt                      2156	EXIST::FUNCTION:RC5
+CONF_dump_bio                           2157	EXIST::FUNCTION:
+X509_NAME_get_index_by_OBJ              2158	EXIST::FUNCTION:
+X509at_get_attr_count                   2159	EXIST::FUNCTION:
+EVP_rc2_64_cbc                          2160	EXIST::FUNCTION:RC2
+BN_mod_mul                              2161	EXIST::FUNCTION:
+i2d_TS_MSG_IMPRINT_bio                  2162	EXIST::FUNCTION:
+KRB5_AUTHENTBODY_free                   2163	EXIST::FUNCTION:
+BN_num_bits_word                        2164	EXIST::FUNCTION:
+EVP_dss1                                2165	EXIST::FUNCTION:DSA,SHA
+ms_time_new                             2166	EXIST::FUNCTION:
+ASN1_item_d2i                           2167	EXIST::FUNCTION:
+d2i_PUBKEY                              2168	EXIST::FUNCTION:
+ASN1_primitive_free                     2169	EXIST::FUNCTION:
+BIO_vfree                               2170	EXIST::FUNCTION:
+TS_RESP_set_status_info                 2171	EXIST::FUNCTION:
+EVP_CIPHER_param_to_asn1                2172	EXIST::FUNCTION:
+i2d_EXTENDED_KEY_USAGE                  2173	EXIST::FUNCTION:
+_ossl_old_des_string_to_key             2174	EXIST::FUNCTION:DES
+PKCS7_digest_from_attributes            2175	EXIST::FUNCTION:
+i2d_OCSP_SIGNATURE                      2176	EXIST::FUNCTION:
+BIO_callback_ctrl                       2177	EXIST::FUNCTION:
+asn1_enc_save                           2178	EXIST::FUNCTION:
+X509_REVOKED_get_ext                    2179	EXIST::FUNCTION:
+ENGINE_load_nuron                       2180	EXIST::FUNCTION:ENGINE
+i2d_ASN1_UTCTIME                        2181	EXIST::FUNCTION:
+SXNET_new                               2182	EXIST::FUNCTION:
+CRYPTO_get_ex_new_index                 2183	EXIST::FUNCTION:
+PEM_read_bio_RSAPrivateKey              2184	EXIST::FUNCTION:RSA
+d2i_ASN1_BIT_STRING                     2185	EXIST::FUNCTION:
+ASN1_pack_string                        2186	EXIST::FUNCTION:
+X509_load_crl_file                      2187	EXIST::FUNCTION:STDIO
+BIO_read                                2188	EXIST::FUNCTION:
+i2d_RSAPrivateKey                       2189	EXIST::FUNCTION:RSA
+PKCS12_MAC_DATA_it                      2190	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS12_MAC_DATA_it                      2190	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_TRUST_cleanup                      2191	EXIST::FUNCTION:
+i2d_PKCS8_PRIV_KEY_INFO                 2192	EXIST::FUNCTION:
+OCSP_accept_responses_new               2193	EXIST::FUNCTION:
+i2d_PKCS8_bio                           2194	EXIST::FUNCTION:BIO
+asn1_do_lock                            2195	EXIST::FUNCTION:
+OBJ_create_objects                      2196	EXIST::FUNCTION:
+PEM_write_PKCS8_PRIV_KEY_INFO           2197	EXIST:!VMS,!WIN16:FUNCTION:
+PEM_write_P8_PRIV_KEY_INFO              2197	EXIST:VMS:FUNCTION:
+BIO_vprintf                             2198	EXIST::FUNCTION:
+X509_ATTRIBUTE_free                     2199	EXIST::FUNCTION:
+PKCS7_ATTR_VERIFY_it                    2200	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_ATTR_VERIFY_it                    2200	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_add_ext                            2201	EXIST::FUNCTION:
+KRB5_APREQBODY_it                       2202	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_APREQBODY_it                       2202	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+BIO_sock_non_fatal_error                2203	EXIST::FUNCTION:
+ENGINE_finish                           2204	EXIST::FUNCTION:ENGINE
+BIO_next                                2205	EXIST::FUNCTION:
+MD4_Transform                           2206	EXIST::FUNCTION:MD4
+i2d_OCSP_SINGLERESP                     2207	EXIST::FUNCTION:
+ASN1_item_ex_new                        2208	EXIST::FUNCTION:
+UI_add_verify_string                    2209	EXIST::FUNCTION:
+RAND_load_file                          2210	EXIST::FUNCTION:
+d2i_PKCS12_bio                          2211	EXIST::FUNCTION:
+i2d_ASN1_OBJECT                         2212	EXIST::FUNCTION:
+EVP_OpenFinal                           2213	EXIST::FUNCTION:RSA
+X509_VAL_free                           2214	EXIST::FUNCTION:
+DSAparams_print_fp                      2215	EXIST::FUNCTION:DSA,FP_API
+PKCS12_pbe_crypt                        2216	EXIST::FUNCTION:
+EVP_rc2_cbc                             2217	EXIST::FUNCTION:RC2
+KRB5_PRINCNAME_it                       2218	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_PRINCNAME_it                       2218	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_DecryptInit_ex                      2219	EXIST::FUNCTION:
+X509_LOOKUP_hash_dir                    2220	EXIST::FUNCTION:
+BIO_set                                 2221	EXIST::FUNCTION:
+TS_REQ_add_ext                          2222	EXIST::FUNCTION:
+NCONF_free                              2223	EXIST::FUNCTION:
+BN_BLINDING_update                      2224	EXIST::FUNCTION:
+i2d_OCSP_CERTID                         2225	EXIST::FUNCTION:
+ASN1_NULL_free                          2226	EXIST::FUNCTION:
+ERR_get_string_table                    2227	EXIST::FUNCTION:LHASH
+X509_STORE_CTX_set_error                2228	EXIST::FUNCTION:
+COMP_zlib                               2229	EXIST::FUNCTION:
+BIO_get_retry_BIO                       2230	EXIST::FUNCTION:
+ASN1_item_d2i_bio                       2231	EXIST::FUNCTION:BIO
+d2i_PKCS7                               2232	EXIST::FUNCTION:
+ENGINE_set_finish_function              2233	EXIST::FUNCTION:ENGINE
+BN_init                                 2234	EXIST::FUNCTION:
+PEM_read_bio_X509_AUX                   2235	EXIST::FUNCTION:
+X509_get_default_cert_file_env          2236	EXIST::FUNCTION:
+ERR_peek_error_line_data                2237	EXIST::FUNCTION:
+BN_mod_inverse                          2238	EXIST::FUNCTION:
+EC_POINT_dbl                            2239	EXIST::FUNCTION:EC
+asn1_get_choice_selector                2240	EXIST::FUNCTION:
+X509_verify_cert_error_string           2241	EXIST::FUNCTION:
+X509_get_pubkey                         2242	EXIST::FUNCTION:
+TS_CONF_set_signer_key                  2243	EXIST::FUNCTION:
+i2d_KRB5_CHECKSUM                       2244	EXIST::FUNCTION:
+BIO_nwrite0                             2245	EXIST::FUNCTION:
+ENGINE_set_table_flags                  2246	EXIST::FUNCTION:ENGINE
+AES_options                             2247	EXIST::FUNCTION:AES
+BIO_f_nbio_test                         2248	EXIST::FUNCTION:
+BUF_MEM_new                             2249	EXIST::FUNCTION:
+DHparams_print_fp                       2250	EXIST::FUNCTION:DH,FP_API
+EVP_des_ede_ecb                         2251	EXIST::FUNCTION:DES
+ENGINE_load_chil                        2252	EXIST::FUNCTION:ENGINE
+_ossl_old_crypt                         2253	EXIST:!NeXT,!PERL5:FUNCTION:DES
+RAND_egd_bytes                          2254	EXIST::FUNCTION:
+OCSP_id_cmp                             2255	EXIST::FUNCTION:
+ERR_load_COMP_strings                   2256	EXIST::FUNCTION:
+X509_NAME_digest                        2257	EXIST::FUNCTION:EVP
+X509_NAME_ENTRY_get_data                2258	EXIST::FUNCTION:
+i2d_PKCS7_fp                            2259	EXIST::FUNCTION:FP_API
+PKCS7_get_issuer_and_serial             2260	EXIST::FUNCTION:
+OCSP_BASICRESP_new                      2261	EXIST::FUNCTION:
+OCSP_REQUEST_get_ext_by_NID             2262	EXIST::FUNCTION:
+RAND_write_file                         2263	EXIST::FUNCTION:
+KRB5_APREQ_it                           2264	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_APREQ_it                           2264	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+OBJ_sn2nid                              2265	EXIST::FUNCTION:
+EVP_des_ede3_ofb                        2266	EXIST::FUNCTION:DES
+ENGINE_get_destroy_function             2267	EXIST::FUNCTION:ENGINE
+DES_cfb_encrypt                         2268	EXIST::FUNCTION:DES
+CONF_set_nconf                          2269	EXIST::FUNCTION:
+X509_EXTENSION_dup                      2270	EXIST::FUNCTION:
+CRYPTO_dbg_free                         2271	EXIST::FUNCTION:
+i2d_PKCS8PrivateKey_nid_bio             2272	EXIST::FUNCTION:
+BIO_free                                2273	EXIST::FUNCTION:
+NCONF_load_fp                           2274	EXIST::FUNCTION:FP_API
+d2i_POLICYQUALINFO                      2275	EXIST::FUNCTION:
+ASN1_PRINTABLE_free                     2276	EXIST::FUNCTION:
+idea_ofb64_encrypt                      2277	EXIST::FUNCTION:IDEA
+X509V3_EXT_val_prn                      2278	EXIST::FUNCTION:
+X509_PURPOSE_get0_sname                 2279	EXIST::FUNCTION:
+ENGINE_load_sureware                    2280	EXIST::FUNCTION:ENGINE
+EVP_aes_128_cfb1                        2281	EXIST::FUNCTION:AES
+OCSP_BASICRESP_get_ext_by_NID           2282	EXIST::FUNCTION:
+d2i_TS_STATUS_INFO                      2283	EXIST::FUNCTION:
+sk_pop                                  2284	EXIST::FUNCTION:
+EVP_aes_128_cfb8                        2285	EXIST::FUNCTION:AES
+ENGINE_set_RAND                         2286	EXIST::FUNCTION:ENGINE
+DIST_POINT_NAME_it                      2287	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+DIST_POINT_NAME_it                      2287	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PEM_write_PKCS7                         2288	EXIST:!WIN16:FUNCTION:
+PEM_write_PKCS8                         2289	EXIST:!WIN16:FUNCTION:
+TS_RESP_free                            2290	EXIST::FUNCTION:
+X509V3_extensions_print                 2291	EXIST::FUNCTION:
+BN_div_recp                             2292	EXIST::FUNCTION:
+NETSCAPE_SPKI_free                      2293	EXIST::FUNCTION:
+DSO_METHOD_dlfcn                        2294	EXIST::FUNCTION:
+RAND_poll                               2295	EXIST::FUNCTION:
+ASN1_ENUMERATED_to_BN                   2296	EXIST::FUNCTION:
+X509_trust_clear                        2297	EXIST::FUNCTION:
+RSA_set_default_method                  2298	EXIST::FUNCTION:RSA
+d2i_ASN1_UTF8STRING                     2299	EXIST::FUNCTION:
+X509_REVOKED_add1_ext_i2d               2300	EXIST::FUNCTION:
+PKCS7_ENVELOPE_new                      2301	EXIST::FUNCTION:
+d2i_X509_AUX                            2302	EXIST::FUNCTION:
+UTF8_putc                               2303	EXIST::FUNCTION:
+RSA_private_encrypt                     2304	EXIST::FUNCTION:RSA
+KRB5_TKTBODY_new                        2305	EXIST::FUNCTION:
+ms_time_cmp                             2306	EXIST::FUNCTION:
+X509_PURPOSE_get_by_id                  2307	EXIST::FUNCTION:
+ASN1_OCTET_STRING_it                    2308	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_OCTET_STRING_it                    2308	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+d2i_ASN1_UNIVERSALSTRING                2309	EXIST::FUNCTION:
+PEM_read_X509_AUX                       2310	EXIST:!WIN16:FUNCTION:
+ENGINE_set_default                      2311	EXIST::FUNCTION:ENGINE
+lh_node_stats_bio                       2312	EXIST::FUNCTION:BIO
+PKCS7_add_crl                           2313	EXIST::FUNCTION:
+d2i_X509_PKEY                           2314	EXIST::FUNCTION:
+PKCS7_dataDecode                        2315	EXIST::FUNCTION:
+SXNET_get_id_ulong                      2316	EXIST::FUNCTION:
+DSA_set_method                          2317	EXIST::FUNCTION:DSA
+OpenSSLDie                              2318	EXIST::FUNCTION:
+PKCS7_add_signature                     2319	EXIST::FUNCTION:
+DES_string_to_2keys                     2320	EXIST::FUNCTION:DES
+SHA1_Final                              2321	EXIST::FUNCTION:SHA,SHA1
+RSA_set_method                          2322	EXIST::FUNCTION:RSA
+X509V3_set_conf_lhash                   2323	EXIST::FUNCTION:
+ERR_load_UI_strings                     2324	EXIST::FUNCTION:
+DH_free                                 2325	EXIST::FUNCTION:DH
+X509_STORE_CTX_cleanup                  2326	EXIST::FUNCTION:
+BN_CTX_init                             2327	EXIST::FUNCTION:
+d2i_DIST_POINT_NAME                     2328	EXIST::FUNCTION:
+i2d_DIRECTORYSTRING                     2329	EXIST::FUNCTION:
+_ossl_old_des_random_seed               2330	EXIST::FUNCTION:DES
+X509_CRL_INFO_free                      2331	EXIST::FUNCTION:
+i2d_KRB5_ENCKEY                         2332	EXIST::FUNCTION:
+CRYPTO_push_info_                       2333	EXIST::FUNCTION:
+PBEPARAM_free                           2334	EXIST::FUNCTION:
+d2i_PBEPARAM                            2335	EXIST::FUNCTION:
+RSA_free                                2336	EXIST::FUNCTION:RSA
+BN_usub                                 2337	EXIST::FUNCTION:
+CRYPTO_num_locks                        2338	EXIST::FUNCTION:
+BIO_nread0                              2339	EXIST::FUNCTION:
+X509_CRL_get_ext_by_NID                 2340	EXIST::FUNCTION:
+HMAC_Final                              2341	EXIST::FUNCTION:HMAC
+d2i_DSA_PUBKEY_bio                      2342	EXIST::FUNCTION:BIO,DSA
+DSO_load                                2343	EXIST::FUNCTION:
+EVP_rc5_32_12_16_ecb                    2344	EXIST::FUNCTION:RC5
+ENGINE_new                              2345	EXIST::FUNCTION:ENGINE
+d2i_RSA_PUBKEY_bio                      2346	EXIST::FUNCTION:BIO,RSA
+d2i_TS_TST_INFO                         2347	EXIST::FUNCTION:
+RSA_private_decrypt                     2348	EXIST::FUNCTION:RSA
+i2d_ASN1_PRINTABLESTRING                2349	EXIST::FUNCTION:
+ASN1_template_new                       2350	EXIST::FUNCTION:
+OCSP_SIGNATURE_free                     2351	EXIST::FUNCTION:
+DSO_get_method                          2352	EXIST::FUNCTION:
+ASN1_item_i2d_fp                        2353	EXIST::FUNCTION:FP_API
+BN_copy                                 2354	EXIST::FUNCTION:
+CONF_imodule_get_usr_data               2355	EXIST::FUNCTION:
+BN_get_params                           2356	EXIST::FUNCTION:
+BIO_gethostbyname                       2357	EXIST::FUNCTION:
+PEM_write                               2358	EXIST:!WIN16:FUNCTION:
+OBJ_bsearch                             2359	EXIST::FUNCTION:
+KRB5_PRINCNAME_free                     2360	EXIST::FUNCTION:
+PKCS7_RECIP_INFO_it                     2361	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_RECIP_INFO_it                     2361	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+DES_options                             2362	EXIST::FUNCTION:DES
+_ossl_old_des_set_key                   2363	EXIST::FUNCTION:DES
+EXTENDED_KEY_USAGE_it                   2364	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+EXTENDED_KEY_USAGE_it                   2364	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EC_GFp_simple_method                    2365	EXIST::FUNCTION:EC
+d2i_PKCS7_ENVELOPE                      2366	EXIST::FUNCTION:
+DSO_METHOD_null                         2367	EXIST::FUNCTION:
+PEM_read_bio_PrivateKey                 2368	EXIST::FUNCTION:
+X509at_get_attr_by_NID                  2369	EXIST::FUNCTION:
+EC_GROUP_precompute_mult                2370	EXIST::FUNCTION:EC
+OCSP_request_onereq_get0                2371	EXIST::FUNCTION:
+ASN1_get_object                         2372	EXIST::FUNCTION:
+BN_sub_word                             2373	EXIST::FUNCTION:
+EVP_PKEY_get1_RSA                       2374	EXIST::FUNCTION:RSA
+PKCS7_add_certificate                   2375	EXIST::FUNCTION:
+d2i_X509_EXTENSION                      2376	EXIST::FUNCTION:
+PEM_write_bio_X509                      2377	EXIST::FUNCTION:
+PKCS7_new                               2378	EXIST::FUNCTION:
+i2d_PKCS8_fp                            2379	EXIST::FUNCTION:FP_API
+EVP_DecryptUpdate                       2380	EXIST::FUNCTION:
+DES_set_key_checked                     2381	EXIST::FUNCTION:DES
+ERR_peek_error                          2382	EXIST::FUNCTION:
+TS_TST_INFO_set_version                 2383	EXIST::FUNCTION:
+d2i_PKCS8_PRIV_KEY_INFO                 2384	EXIST::FUNCTION:
+PKCS12_setup_mac                        2385	EXIST::FUNCTION:
+TS_VERIFY_CTX_free                      2386	EXIST::FUNCTION:
+RSA_print_fp                            2387	EXIST::FUNCTION:FP_API,RSA
+UI_method_set_writer                    2388	EXIST::FUNCTION:
+DIRECTORYSTRING_new                     2389	EXIST::FUNCTION:
+PKCS7_ENC_CONTENT_free                  2390	EXIST::FUNCTION:
+PEM_read_bio_RSAPublicKey               2391	EXIST::FUNCTION:RSA
+RC5_32_set_key                          2392	EXIST::FUNCTION:RC5
+KRB5_AUTHENT_new                        2393	EXIST::FUNCTION:
+ms_time_get                             2394	EXIST::FUNCTION:
+X509_ATTRIBUTE_set1_object              2395	EXIST::FUNCTION:
+ERR_load_crypto_strings                 2396	EXIST::FUNCTION:
+PKCS7_set_attributes                    2397	EXIST::FUNCTION:
+X509_CRL_INFO_it                        2398	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_CRL_INFO_it                        2398	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+FIPS_selftest_dsa                       2399	EXIST:OPENSSL_FIPS:FUNCTION:
+DSO_set_name_converter                  2400	EXIST::FUNCTION:
+_ossl_old_des_ofb_encrypt               2401	EXIST::FUNCTION:DES
+X509_SIG_free                           2402	EXIST::FUNCTION:
+AES_set_decrypt_key                     2403	EXIST::FUNCTION:AES
+BN_div                                  2404	EXIST::FUNCTION:
+CONF_imodule_set_flags                  2405	EXIST::FUNCTION:
+BIO_new_socket                          2406	EXIST::FUNCTION:
+RSA_generate_key                        2407	EXIST::FUNCTION:RSA
+PKCS7_DIGEST_it                         2408	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_DIGEST_it                         2408	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PKCS12_x5092certbag                     2409	EXIST::FUNCTION:
+EVP_des_cbc                             2410	EXIST::FUNCTION:DES
+ERR_load_strings                        2411	EXIST::FUNCTION:
+EVP_DigestInit_ex                       2412	EXIST::FUNCTION:
+i2d_X509_bio                            2413	EXIST::FUNCTION:BIO
+i2d_USERNOTICE                          2414	EXIST::FUNCTION:
+i2a_ACCESS_DESCRIPTION                  2415	EXIST::FUNCTION:
+CRYPTO_get_locking_callback             2416	EXIST::FUNCTION:
+d2i_X509_CRL_bio                        2417	EXIST::FUNCTION:BIO
+OCSP_RESPONSE_it                        2418	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_RESPONSE_it                        2418	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+PKCS7_ENC_CONTENT_it                    2419	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_ENC_CONTENT_it                    2419	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+OCSP_request_add0_id                    2420	EXIST::FUNCTION:
+TS_REQ_set_version                      2421	EXIST::FUNCTION:
+ASN1_STRING_print_ex                    2422	EXIST::FUNCTION:BIO
+EVP_des_ede3_cfb1                       2423	EXIST::FUNCTION:DES
+BN_is_prime_fasttest                    2424	EXIST::FUNCTION:
+EVP_des_ede3_cfb8                       2425	EXIST::FUNCTION:DES
+PEM_write_bio_DSAPrivateKey             2426	EXIST::FUNCTION:DSA
+NOTICEREF_free                          2427	EXIST::FUNCTION:
+NETSCAPE_SPKI_print                     2428	EXIST::FUNCTION:EVP
+EC_POINT_make_affine                    2429	EXIST::FUNCTION:EC
+X509_LOOKUP_ctrl                        2430	EXIST::FUNCTION:
+BIO_vsnprintf                           2431	EXIST::FUNCTION:
+MDC2                                    2432	EXIST::FUNCTION:MDC2
+DSO_get_filename                        2433	EXIST::FUNCTION:
+BIO_ctrl_reset_read_request             2434	EXIST::FUNCTION:
+BIO_f_null                              2435	EXIST::FUNCTION:
+d2i_ESS_CERT_ID                         2436	EXIST::FUNCTION:
+X509_load_cert_crl_file                 2437	EXIST::FUNCTION:STDIO
+PKCS7_add_attrib_smimecap               2438	EXIST::FUNCTION:
+OCSP_CERTSTATUS_it                      2439	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_CERTSTATUS_it                      2439	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_object_size                        2440	EXIST::FUNCTION:
+i2d_X509_CINF                           2441	EXIST::FUNCTION:
+SSLeay_version                          2442	EXIST::FUNCTION:
+OCSP_request_add1_cert                  2443	EXIST::FUNCTION:
+UI_get0_output_string                   2444	EXIST::FUNCTION:
+UI_dup_verify_string                    2445	EXIST::FUNCTION:
+X509_STORE_CTX_purpose_inherit          2446	EXIST::FUNCTION:
+ACCESS_DESCRIPTION_new                  2447	EXIST::FUNCTION:
+BN_mod_lshift                           2448	EXIST::FUNCTION:
+KRB5_AUTHDATA_it                        2449	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_AUTHDATA_it                        2449	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509_load_cert_file                     2450	EXIST::FUNCTION:STDIO
+BN_mask_bits                            2451	EXIST::FUNCTION:
+PKCS7_add_signed_attribute              2452	EXIST::FUNCTION:
+SMIME_crlf_copy                         2453	EXIST::FUNCTION:
+OpenSSL_add_all_digests                 2454	EXIST::FUNCTION:
+asn1_set_choice_selector                2455	EXIST::FUNCTION:
+sk_shift                                2456	EXIST::FUNCTION:
+ASN1_STRING_type_new                    2457	EXIST::FUNCTION:
+d2i_PKCS7_RECIP_INFO                    2458	EXIST::FUNCTION:
+i2d_RSAPublicKey                        2459	EXIST::FUNCTION:RSA
+SXNET_get_id_INTEGER                    2460	EXIST::FUNCTION:
+i2c_ASN1_INTEGER                        2461	EXIST::FUNCTION:
+OCSP_basic_add1_status                  2462	EXIST::FUNCTION:
+PKCS8_PRIV_KEY_INFO_new                 2463	EXIST::FUNCTION:
+MD2_Update                              2464	EXIST::FUNCTION:MD2
+X509_NAME_get_text_by_NID               2465	EXIST::FUNCTION:
+CRYPTO_dbg_malloc                       2466	EXIST::FUNCTION:
+TS_RESP_CTX_add_md                      2467	EXIST::FUNCTION:
+d2i_USERNOTICE                          2468	EXIST::FUNCTION:
+X509_to_X509_REQ                        2469	EXIST::FUNCTION:
+CRYPTO_get_mem_debug_functions          2470	EXIST::FUNCTION:
+X509_NAME_ENTRY_create_by_txt           2471	EXIST::FUNCTION:
+UI_UTIL_read_pw_string                  2472	EXIST::FUNCTION:
+X509_PKEY_new                           2473	EXIST::FUNCTION:
+OCSP_RESPID_free                        2474	EXIST::FUNCTION:
+FIPS_selftest_sha1                      2475	EXIST:OPENSSL_FIPS:FUNCTION:
+CRYPTO_set_dynlock_lock_callback        2476	EXIST:!VMS:FUNCTION:
+CRYPTO_set_dynlock_lock_cb              2476	EXIST:VMS:FUNCTION:
+asn1_get_field_ptr                      2477	EXIST::FUNCTION:
+UI_add_input_string                     2478	EXIST::FUNCTION:
+OCSP_CRLID_it                           2479	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+OCSP_CRLID_it                           2479	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_RESP_get_status_info                 2480	EXIST::FUNCTION:
+i2d_KRB5_AUTHENTBODY                    2481	EXIST::FUNCTION:
+OCSP_REQUEST_get_ext_count              2482	EXIST::FUNCTION:
+ENGINE_load_atalla                      2483	EXIST::FUNCTION:ENGINE
+DSO_METHOD_openssl                      2484	EXIST::FUNCTION:
+X509_LOOKUP_by_subject                  2485	EXIST::FUNCTION:
+d2i_PKCS12_MAC_DATA                     2486	EXIST::FUNCTION:
+lh_node_stats                           2487	EXIST::FUNCTION:FP_API
+EVP_aes_128_ofb                         2488	EXIST::FUNCTION:AES
+X509_NAME_it                            2489	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_NAME_it                            2489	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+X509V3_add_value_int                    2490	EXIST::FUNCTION:
+USERNOTICE_it                           2491	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+USERNOTICE_it                           2491	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_UNIVERSALSTRING_new                2492	EXIST::FUNCTION:
+_ossl_old_des_string_to_2keys           2493	EXIST::FUNCTION:DES
+X509_ALGOR_new                          2494	EXIST::FUNCTION:
+OCSP_REQINFO_new                        2495	EXIST::FUNCTION:
+ENGINE_set_default_DH                   2496	EXIST::FUNCTION:ENGINE
+OCSP_BASICRESP_get_ext                  2497	EXIST::FUNCTION:
+EVP_CIPHER_set_asn1_iv                  2498	EXIST::FUNCTION:
+X509_REVOKED_add_ext                    2499	EXIST::FUNCTION:
+CRYPTO_get_ex_data_implementation       2500	EXIST:!VMS:FUNCTION:
+CRYPTO_get_ex_data_impl                 2500	EXIST:VMS:FUNCTION:
+EVP_cast5_ecb                           2501	EXIST::FUNCTION:CAST
+lh_insert                               2502	EXIST::FUNCTION:
+EVP_PKEY_set1_DH                        2503	EXIST::FUNCTION:DH
+X509_REQ_digest                         2504	EXIST::FUNCTION:EVP
+CRL_DIST_POINTS_free                    2505	EXIST::FUNCTION:
+i2d_SXNET                               2506	EXIST::FUNCTION:
+BN_CTX_end                              2507	EXIST::FUNCTION:
+ASN1_item_pack                          2508	EXIST::FUNCTION:
+PEM_read_PKCS7                          2509	EXIST:!WIN16:FUNCTION:
+PEM_read_PKCS8                          2510	EXIST:!WIN16:FUNCTION:
+i2d_Netscape_RSA                        2511	EXIST::FUNCTION:RSA
+BIO_f_base64                            2512	EXIST::FUNCTION:BIO
+RC4_options                             2513	EXIST::FUNCTION:RC4
+NETSCAPE_CERT_SEQUENCE_new              2514	EXIST::FUNCTION:
+ENGINE_add_conf_module                  2515	EXIST::FUNCTION:ENGINE
+i2d_KRB5_ENCDATA                        2516	EXIST::FUNCTION:
+BIO_f_reliable                          2517	EXIST::FUNCTION:BIO
+CRYPTO_set_ex_data                      2518	EXIST::FUNCTION:
+DSA_sign_setup                          2519	EXIST::FUNCTION:DSA
+ASN1_STRING_set_default_mask_asc        2520	EXIST:!VMS:FUNCTION:
+ASN1_STRING_set_def_mask_asc            2520	EXIST:VMS:FUNCTION:
+X509_PURPOSE_set                        2521	EXIST::FUNCTION:
+DSA_get_ex_data                         2522	EXIST::FUNCTION:DSA
+TS_REQ_get_ext_count                    2523	EXIST::FUNCTION:
+EVP_PKEY_size                           2524	EXIST::FUNCTION:
+RIPEMD160_Update                        2525	EXIST::FUNCTION:RIPEMD
+PEM_write_X509_REQ_NEW                  2526	EXIST:!WIN16:FUNCTION:
+TS_CONF_load_certs                      2527	EXIST::FUNCTION:
+c2i_ASN1_OBJECT                         2528	EXIST::FUNCTION:
+X509V3_EXT_conf                         2529	EXIST::FUNCTION:
+X509_REQ_INFO_it                        2530	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+X509_REQ_INFO_it                        2530	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+UI_method_set_opener                    2531	EXIST::FUNCTION:
+X509_ATTRIBUTE_set1_data                2532	EXIST::FUNCTION:
+ERR_peek_last_error                     2533	EXIST::FUNCTION:
+ASN1_item_ex_free                       2534	EXIST::FUNCTION:
+X509_STORE_CTX_get_ex_data              2535	EXIST::FUNCTION:
+ASN1_T61STRING_new                      2536	EXIST::FUNCTION:
+ASN1_BOOLEAN_it                         2537	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_BOOLEAN_it                         2537	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ENGINE_get_table_flags                  2538	EXIST::FUNCTION:ENGINE
+ASN1_TIME_new                           2539	EXIST::FUNCTION:
+i2d_TS_RESP_bio                         2540	EXIST::FUNCTION:
+EVP_PKEY_get1_DH                        2541	EXIST::FUNCTION:DH
+UI_create_method                        2542	EXIST::FUNCTION:
+TS_TST_INFO_get_ext                     2543	EXIST::FUNCTION:
+i2d_PKCS8PrivateKey_nid_fp              2544	EXIST::FUNCTION:
+X509V3_EXT_REQ_add_conf                 2545	EXIST::FUNCTION:
+TS_REQ_set_nonce                        2546	EXIST::FUNCTION:
+X509_STORE_CTX_get1_chain               2547	EXIST::FUNCTION:
+d2i_PKCS8_PRIV_KEY_INFO_bio             2548	EXIST::FUNCTION:BIO
+X509_get_ext_count                      2549	EXIST::FUNCTION:
+SHA1_Transform                          2550	EXIST::FUNCTION:SHA,SHA1
+OCSP_ONEREQ_add1_ext_i2d                2551	EXIST::FUNCTION:
+EVP_PKEY_encrypt                        2552	EXIST::FUNCTION:
+X509_STORE_new                          2553	EXIST::FUNCTION:
+i2d_NOTICEREF                           2554	EXIST::FUNCTION:
+_shadow_DES_check_key                   2555	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:DES
+_shadow_DES_check_key                   2555	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:DES
+asn1_add_error                          2556	EXIST::FUNCTION:
+ASN1_T61STRING_free                     2557	EXIST::FUNCTION:
+TS_TST_INFO_get_ext_by_critical         2558	EXIST::FUNCTION:
+BN_RECP_CTX_free                        2559	EXIST::FUNCTION:
+ASN1_INTEGER_free                       2560	EXIST::FUNCTION:
+d2i_OCSP_REQINFO                        2561	EXIST::FUNCTION:
+UI_add_info_string                      2562	EXIST::FUNCTION:
+TS_CONF_set_digests                     2563	EXIST::FUNCTION:
+ASN1_TYPE_new                           2564	EXIST::FUNCTION:
+PKCS7_free                              2565	EXIST::FUNCTION:
+PKCS7_to_TS_TST_INFO                    2566	EXIST::FUNCTION:
+HMAC_Update                             2567	EXIST::FUNCTION:HMAC
+DSA_sign                                2568	EXIST::FUNCTION:DSA
+UI_get_result_minsize                   2569	EXIST::FUNCTION:
+RSA_get_ex_new_index                    2570	EXIST::FUNCTION:RSA
+ASN1_STRING_set_default_mask            2571	EXIST::FUNCTION:
+ASN1_NULL_it                            2572	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_NULL_it                            2572	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+TS_REQ_get_cert_req                     2573	EXIST::FUNCTION:
+DSO_ctrl                                2574	EXIST::FUNCTION:
+BN_div_word                             2575	EXIST::FUNCTION:
+i2d_DSA_PUBKEY_fp                       2576	EXIST::FUNCTION:DSA,FP_API
+i2a_ASN1_STRING                         2577	EXIST::FUNCTION:BIO
+BN_mod_lshift1                          2578	EXIST::FUNCTION:
+d2i_OCSP_ONEREQ                         2579	EXIST::FUNCTION:
+OCSP_ONEREQ_new                         2580	EXIST::FUNCTION:
+FIPS_selftest_aes                       2581	EXIST:OPENSSL_FIPS:FUNCTION:
+i2s_ASN1_ENUMERATED                     2582	EXIST::FUNCTION:
+i2d_ASN1_ENUMERATED                     2583	EXIST::FUNCTION:
+KRB5_TICKET_it                          2584	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+KRB5_TICKET_it                          2584	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+EVP_aes_192_cbc                         2585	EXIST::FUNCTION:AES
+i2d_NETSCAPE_SPKAC                      2586	EXIST::FUNCTION:
+DES_encrypt1                            2587	EXIST::FUNCTION:DES
+DES_encrypt2                            2588	EXIST::FUNCTION:DES
+ERR_remove_state                        2589	EXIST::FUNCTION:
+KRB5_TICKET_free                        2590	EXIST::FUNCTION:
+UI_new                                  2591	EXIST::FUNCTION:
+EVP_set_pw_prompt                       2592	EXIST::FUNCTION:
+DES_encrypt3                            2593	EXIST::FUNCTION:DES
+RSA_verify_ASN1_OCTET_STRING            2594	EXIST::FUNCTION:RSA
+BN_bn2dec                               2595	EXIST::FUNCTION:
+i2d_NETSCAPE_CERT_SEQUENCE              2596	EXIST::FUNCTION:
+NCONF_get_string                        2597	EXIST::FUNCTION:
+MDC2_Final                              2598	EXIST::FUNCTION:MDC2
+DSO_flags                               2599	EXIST::FUNCTION:
+EVP_PKEY_decrypt                        2600	EXIST::FUNCTION:
+ASN1_TIME_free                          2601	EXIST::FUNCTION:
+OCSP_response_create                    2602	EXIST::FUNCTION:
+PKCS7_it                                2603	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+PKCS7_it                                2603	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_STRING_free                        2604	EXIST::FUNCTION:
+i2d_RSAPublicKey_bio                    2605	EXIST::FUNCTION:BIO,RSA
+i2d_ASN1_IA5STRING                      2606	EXIST::FUNCTION:
+i2d_PKCS8PrivateKey_bio                 2607	EXIST::FUNCTION:
+d2i_PBKDF2PARAM                         2608	EXIST::FUNCTION:
+X509_REQ_get_attr_by_NID                2609	EXIST::FUNCTION:
+DSO_get_default_method                  2610	EXIST::FUNCTION:
+EVP_CIPHER_CTX_init                     2611	EXIST::FUNCTION:
+OCSP_REQUEST_get_ext_by_critical        2612	EXIST:!VMS:FUNCTION:
+OCSP_REQUEST_get_ext_by_crit            2612	EXIST:VMS:FUNCTION:
+v2i_GENERAL_NAMES                       2613	EXIST::FUNCTION:
+EVP_PKEY_assign                         2614	EXIST::FUNCTION:
+X509_add1_trust_object                  2615	EXIST::FUNCTION:
+PEM_write_bio_RSAPublicKey              2616	EXIST::FUNCTION:RSA
+_ossl_old_des_cbc_cksum                 2617	EXIST::FUNCTION:DES
+ENGINE_set_flags                        2618	EXIST::FUNCTION:ENGINE
+TS_VERIFY_CTX_init                      2619	EXIST::FUNCTION:
+PBEPARAM_new                            2620	EXIST::FUNCTION:
+sk_sort                                 2621	EXIST::FUNCTION:
+BN_pseudo_rand_range                    2622	EXIST::FUNCTION:
+EVP_rc5_32_12_16_cfb64                  2623	EXIST::FUNCTION:RC5
+ASN1_dup                                2624	EXIST::FUNCTION:
+X509_get_pubkey_parameters              2625	EXIST::FUNCTION:
+BIO_socket_nbio                         2626	EXIST::FUNCTION:
+ASN1_digest                             2627	EXIST::FUNCTION:EVP
+TS_RESP_CTX_add_failure_info            2628	EXIST::FUNCTION:
+OCSP_response_get1_basic                2629	EXIST::FUNCTION:
+PEM_ASN1_read                           2630	EXIST:!WIN16:FUNCTION:
+EVP_Digest                              2631	EXIST::FUNCTION:
+BIO_ptr_ctrl                            2632	EXIST::FUNCTION:
+EVP_cleanup                             2633	EXIST::FUNCTION:
+CONF_dump_fp                            2634	EXIST::FUNCTION:
+X509_PUBKEY_free                        2635	EXIST::FUNCTION:
+RSA_get_ex_data                         2636	EXIST::FUNCTION:RSA
+PKCS7_simple_smimecap                   2637	EXIST::FUNCTION:
+PKCS7_set_content                       2638	EXIST::FUNCTION:
+TS_RESP_verify_response                 2639	EXIST::FUNCTION:
+CRYPTO_thread_id                        2640	EXIST::FUNCTION:
+OCSP_ONEREQ_delete_ext                  2641	EXIST::FUNCTION:
+i2d_NETSCAPE_SPKI                       2642	EXIST::FUNCTION:
+X509_STORE_get_by_subject               2643	EXIST::FUNCTION:
+X509_LOOKUP_by_alias                    2644	EXIST::FUNCTION:
+ASN1_TBOOLEAN_it                        2645	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_TBOOLEAN_it                        2645	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ASN1_item_new                           2646	EXIST::FUNCTION:
+X509_NAME_ENTRY_get_object              2647	EXIST::FUNCTION:
+d2i_ASN1_SET                            2648	EXIST::FUNCTION:
+X509_alias_set1                         2649	EXIST::FUNCTION:
+ASN1_TIME_to_generalizedtime            2650	EXIST::FUNCTION:
+X509_STORE_add_lookup                   2651	EXIST::FUNCTION:
+CRYPTO_free                             2652	EXIST::FUNCTION:
+X509_LOOKUP_file                        2653	EXIST::FUNCTION:
+DH_get_ex_data                          2654	EXIST::FUNCTION:DH
+BIGNUM_it                               2655	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+BIGNUM_it                               2655	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+ms_time_diff                            2656	EXIST::FUNCTION:
+X509_REVOKED_delete_ext                 2657	EXIST::FUNCTION:
+string_to_hex                           2658	EXIST::FUNCTION:
+PEM_read_bio_RSA_PUBKEY                 2659	EXIST::FUNCTION:RSA
+EVP_EncryptFinal                        2660	EXIST::FUNCTION:
+CRYPTO_set_add_lock_callback            2661	EXIST::FUNCTION:
+EVP_PKEY_save_parameters                2662	EXIST::FUNCTION:
+EVP_desx_cbc                            2663	EXIST::FUNCTION:DES
+AES_cbc_encrypt                         2664	EXIST::FUNCTION:AES
+d2i_PKCS7_DIGEST                        2665	EXIST::FUNCTION:
+ENGINE_get_load_privkey_function        2666	EXIST:!VMS:FUNCTION:ENGINE
+ENGINE_get_load_privkey_fn              2666	EXIST:VMS:FUNCTION:ENGINE
+X509V3_add_value_bool_nf                2667	EXIST::FUNCTION:
+OCSP_RESPONSE_free                      2668	EXIST::FUNCTION:
+i2d_CERTIFICATEPOLICIES                 2669	EXIST::FUNCTION:
+OBJ_NAME_add                            2670	EXIST::FUNCTION:
+sk_pop_free                             2671	EXIST::FUNCTION:
+ASN1_ENUMERATED_set                     2672	EXIST::FUNCTION:
+d2i_X509_REQ_bio                        2673	EXIST::FUNCTION:BIO
+PKCS7_SIGN_ENVELOPE_free                2674	EXIST::FUNCTION:
+X509_PURPOSE_add                        2675	EXIST::FUNCTION:
+ASN1_seq_pack                           2676	EXIST::FUNCTION:
+UI_method_set_reader                    2677	EXIST::FUNCTION:
+BN_dup                                  2678	EXIST::FUNCTION:
+i2d_ASN1_T61STRING                      2679	EXIST::FUNCTION:
+_ossl_old_des_ede3_cfb64_encrypt        2680	EXIST:!VMS:FUNCTION:DES
+_ossl_odes_ede3_cfb64_encrypt           2680	EXIST:VMS:FUNCTION:DES
+MDC2_Update                             2681	EXIST::FUNCTION:MDC2
+EVP_OpenInit                            2682	EXIST::FUNCTION:RSA
+X509at_get_attr                         2683	EXIST::FUNCTION:
+EVP_mdc2                                2684	EXIST::FUNCTION:MDC2
+EC_POINT_set_to_infinity                2685	EXIST::FUNCTION:EC
+ERR_load_OCSP_strings                   2686	EXIST::FUNCTION:
+_ossl_old_des_read_pw                   2687	EXIST::FUNCTION:
+X509_REQ_get_extensions                 2688	EXIST::FUNCTION:
+EC_POINT_point2oct                      2689	EXIST::FUNCTION:EC
+PEM_proc_type                           2690	EXIST::FUNCTION:
+X509_find_by_issuer_and_serial          2691	EXIST::FUNCTION:
+TS_TST_INFO_get_exts                    2692	EXIST::FUNCTION:
+BN_options                              2693	EXIST::FUNCTION:
+ASN1_BMPSTRING_new                      2694	EXIST::FUNCTION:
+BIO_socket_ioctl                        2695	EXIST::FUNCTION:
+PKCS12_MAKE_SHKEYBAG                    2696	EXIST::FUNCTION:
+KRB5_APREQ_free                         2697	EXIST::FUNCTION:
+ASN1_OBJECT_it                          2698	EXIST:!EXPORT_VAR_AS_FUNCTION:VARIABLE:
+ASN1_OBJECT_it                          2698	EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:
+DES_random_key                          2699	EXIST::FUNCTION:DES
+X509_check_issued                       2700	EXIST::FUNCTION:
+X509_VAL_new                            2701	EXIST::FUNCTION:
+ASN1_TYPE_cmp                           2702	EXIST::FUNCTION:
+TS_TST_INFO_set_tsa                     2703	EXIST::FUNCTION:
+i2d_PKCS8PrivateKeyInfo_bio             2704	EXIST::FUNCTION:BIO
+ACCESS_DESCRIPTION_free                 2705	EXIST::FUNCTION:
+_ossl_old_des_ncbc_encrypt              2706	EXIST::FUNCTION:DES
+BIO_fd_non_fatal_error                  2707	EXIST::FUNCTION:
+PEM_SealFinal                           2708	EXIST::FUNCTION:RSA
+X509_NAME_hash                          2709	EXIST::FUNCTION:
+PKCS7_RECIP_INFO_new                    2710	EXIST::FUNCTION:
+d2i_PKEY_USAGE_PERIOD                   2711	EXIST::FUNCTION:
+OCSP_crlID_new                          2712	EXIST:!OS2,!VMS,!WIN16:FUNCTION:
+OCSP_crlID2_new                         2712	EXIST:OS2,VMS,WIN16:FUNCTION:
+uni2asc                                 2713	EXIST::FUNCTION:
+X509_CRL_dup                            2714	EXIST::FUNCTION:
+DES_fcrypt                              2715	EXIST::FUNCTION:DES
+i2d_X509_ALGOR                          2716	EXIST::FUNCTION:
+GENERAL_NAMES_new                       2717	EXIST::FUNCTION:
+PEM_read                                2718	EXIST:!WIN16:FUNCTION:
Index: openssl/util/mkdef.pl
diff -u openssl/util/mkdef.pl:1.1.1.7 openssl/util/mkdef.pl:1.1.1.7.2.1
--- openssl/util/mkdef.pl:1.1.1.7	Mon Nov  8 15:33:16 2004
+++ openssl/util/mkdef.pl	Mon Nov  8 16:31:18 2004
@@ -261,6 +261,7 @@
 $crypto.=" crypto/x509/x509.h";
 $crypto.=" crypto/x509/x509_vfy.h";
 $crypto.=" crypto/x509v3/x509v3.h";
+$crypto.=" crypto/ts/ts.h";
 $crypto.=" crypto/rand/rand.h";
 $crypto.=" crypto/comp/comp.h" ; # unless $no_comp;
 $crypto.=" crypto/ocsp/ocsp.h";
Index: openssl/util/mkerr.pl
diff -u openssl/util/mkerr.pl:1.1.1.5 openssl/util/mkerr.pl:1.1.1.5.2.1
--- openssl/util/mkerr.pl:1.1.1.5	Mon Nov  8 15:33:16 2004
+++ openssl/util/mkerr.pl	Mon Nov  8 16:31:18 2004
@@ -1,6 +1,7 @@
 #!/usr/local/bin/perl -w
 
 my $config = "crypto/err/openssl.ec";
+my $hprefix = "openssl/";
 my $debug = 0;
 my $rebuild = 0;
 my $static = 1;
@@ -14,6 +15,9 @@
 	if($arg eq "-conf") {
 		shift @ARGV;
 		$config = shift @ARGV;
+	} elsif($arg eq "-hprefix") {
+		shift @ARGV;
+		$hprefix = shift @ARGV;
 	} elsif($arg eq "-debug") {
 		$debug = 1;
 		shift @ARGV;
@@ -394,7 +398,7 @@
 	my $hincf;
 	if($static) {
 		$hfile =~ /([^\/]+)$/;
-		$hincf = "<openssl/$1>";
+		$hincf = "<${hprefix}$1>";
 	} else {
 		$hincf = "\"$hfile\"";
 	}
Index: openssl/util/mkfiles.pl
diff -u openssl/util/mkfiles.pl:1.1.1.4 openssl/util/mkfiles.pl:1.1.1.4.2.1
--- openssl/util/mkfiles.pl:1.1.1.4	Mon Nov  8 15:33:16 2004
+++ openssl/util/mkfiles.pl	Mon Nov  8 16:31:18 2004
@@ -51,6 +51,7 @@
 "crypto/ocsp",
 "crypto/ui",
 "crypto/krb5",
+"crypto/ts",
 "fips",
 "fips/aes",
 "fips/des",
